

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theory &mdash; FLOW-3D User Manual</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="FLOW-3D User Manual" href="index.html"/>
        <link rel="next" title="Model Reference" href="model-reference.html"/>
        <link rel="prev" title="Troubleshooting" href="troubleshooting.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html">
          

          
            
            <img src="_static/FLOW-3D-ICON.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search..." />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation and Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#computer-setup">Computer Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#supported-operating-systems">Supported Operating Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#hardware-requirements-and-recommendations">Hardware Requirements and Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#virtual-machines">Virtual machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#remote-visualization-for-setup-and-post-processing">Remote Visualization for Setup and Post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#settings">Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#licensing-information">Licensing Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#licensing-requirements">Licensing Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#flexnet-license-administration-tools">FlexNet License Administration Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#licensing-terminology">Licensing Terminology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installation.html#tokens">Tokens</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#floating-vs-node-locked-licenses">Floating vs. Node-Locked Licenses</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#license-token-checkout-order">License Token Checkout Order</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#procedure">Procedure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#windows-installation">Windows Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installation.html#standard-installation">Standard Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#special-considerations">Special considerations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="installation.html#windows-8-and-8-1">Windows 8 and 8.1</a></li>
<li class="toctree-l5"><a class="reference internal" href="installation.html#remote-desktop">Remote Desktop</a></li>
<li class="toctree-l5"><a class="reference internal" href="installation.html#multi-user-machines">Multi-User Machines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#linux-installation">Linux Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installation.html#id3">Standard Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="installation.html#linux-license-server-lmgrd">Linux License Server: lmgrd</a><ul>
<li class="toctree-l5"><a class="reference internal" href="installation.html#id4">Installation</a></li>
<li class="toctree-l5"><a class="reference internal" href="installation.html#hasp-usb-dongle-driver">HASP USB dongle driver</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="maintenance.html">Maintenance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="maintenance.html#moving-license-servers">Moving License Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="maintenance.html#installing-a-new-replacement-license-file">Installing a New/Replacement License File</a><ul>
<li class="toctree-l3"><a class="reference internal" href="maintenance.html#windows">Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="maintenance.html#linux">Linux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="maintenance.html#license-servers-using-lmadmin">License Servers Using lmadmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="maintenance.html#license-servers-using-lmgrd">License Servers Using lmgrd</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="maintenance.html#troubleshooting-license-problems">Troubleshooting License Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="maintenance.html#id2">Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="maintenance.html#id3">Linux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="maintenance.html#id4">License Servers Using lmadmin</a></li>
<li class="toctree-l4"><a class="reference internal" href="maintenance.html#id5">License Servers Using lmgrd</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Software configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#remote-solving-setup">Remote Solving Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#terminology-and-requirements">Terminology and Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#remote-servers">Remote Servers</a></li>
<li class="toctree-l3"><a class="reference internal" href="configuration.html#clients">Clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#preferences">Preferences</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using FLOW-3D</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What’s New in this Version?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="whats-new.html#new-solver-features-and-improvements">New solver features and  improvements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#physical-and-numerical-models">Physical and Numerical Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#immersed-boundary-method">Immersed boundary method</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#two-field-temperature-for-the-two-fluid-model">Two-field temperature for the two-fluid model</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#sludge-settling-model">Sludge settling model</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#steady-state-accelerator-for-free-surface-flows">Steady-state accelerator for free surface flows</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#void-particles">Void particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#sediment-scour-model">Sediment scour model</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#outflow-pressure-boundary-condition">Outflow pressure boundary condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#moving-particle-sources">Moving particle sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#variable-center-of-gravity">Variable center of gravity</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#air-entrainment-model">Air entrainment model</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#tracer-diffusion">Tracer diffusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#model-setup">Model Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#simulation-units">Simulation units</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#shallow-water-model">Shallow water model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="whats-new.html#manning-s-roughness-in-shallow-water-model">Manning’s roughness in shallow water model</a></li>
<li class="toctree-l5"><a class="reference internal" href="whats-new.html#mesh-generation">Mesh generation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#component-transformations">Component transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#changing-the-number-of-threads-at-runtime">Changing the number of threads at runtime</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#probe-controlled-heat-sources">Probe-controlled heat sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#time-dependent-temperature-at-sources">Time-dependent temperature at sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#emissivity-coefficients">Emissivity coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#reference-temperature-input">Reference temperature input</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#temperature-dependent-electric-conductivity">Temperature-dependent electric conductivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#maximum-number-of-electric-charge-field-iterations">Maximum number of electric charge-field iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="whats-new.html#contact-line-pinning">Contact line pinning</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#new-customizable-source-routines">New Customizable Source Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="whats-new.html#redesigned-user-interface">Redesigned user interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#setup-dock-widgets">Setup dock widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#new-icons-setup">New icons - Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#new-icons-physics">New icons - Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#rss-feed">RSS Feed</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#configurable-simulation-monitor">Configurable Simulation Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#conforming-mesh-visualization">Conforming Mesh Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#large-raster-and-stl-data">Large raster and STL data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="whats-new.html#flowsight">FlowSight</a><ul>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#spline-clips">Spline clips</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#directional-scaling-of-views">Directional Scaling of Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats-new.html#history-data-annotations">History Data Annotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial / Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#philosophy-for-using-cfd">Philosophy for Using CFD</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#important-files">Important files</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#simulation-manager">Simulation Manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#workspaces">Workspaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#creating-a-new-workspace">Creating a new workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#closing-a-workspace">Closing a workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#opening-an-existing-workspace">Opening an existing workspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#working-with-simulations-in-a-workspace">Working with simulations in a workspace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#add-an-example">Add an example</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#removing-a-simulation-from-a-workspace">Removing a simulation from a workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#delete-a-simulation-from-all-workspaces-and-disk">Delete a simulation from all workspaces and disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#adding-an-existing-simulation-to-a-workspace">Adding an existing simulation to a workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#adding-a-new-simulation-to-a-workspace">Adding a new simulation to a workspace</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#other-options">Other options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#preprocessing-and-running-simulations">Preprocessing and running simulations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#preprocessing-a-simulation">Preprocessing a simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#running-a-simulation">Running a simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#running-all-simulations-in-a-workspace">Running all simulations in a workspace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#the-queue">The queue</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#finding-files-in-the-file-system">Finding files in the file system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#model-setup">Model Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#navigation">Navigation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#controls">Controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#global">Global</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#physics">Physics</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#fluids">Fluids</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#geometry">Geometry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#component-properties">Component properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#meshing">Meshing</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#boundary-conditions">Boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#initial-conditions">Initial conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#numerics">Numerics</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#checklist-for-general-simulation-setups">Checklist for General Simulation Setups</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#before-starting">Before starting</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-general">Model setup: General</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-physics">Model setup: Physics</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-fluids">Model setup: Fluids</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-meshing-geometry">Model setup: Meshing &amp; Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-output">Model setup: Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#model-setup-numerics">Model setup: Numerics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.html#post-processing-in-flow-3d">Post-processing in FLOW-3D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#existing-plots">Existing Plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial.html#custom-plots">Custom Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#d-plots">3-D Plots</a><ul>
<li class="toctree-l5"><a class="reference internal" href="tutorial.html#show-symmetric-flow">Show Symmetric Flow</a></li>
<li class="toctree-l5"><a class="reference internal" href="tutorial.html#create-a-3-d-animation">Create a 3-D Animation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#dgraphics">2-D Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#id2">1-D Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#probe-plots">Probe Plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="tutorial.html#text-output">Text Output</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sim-manager.html">Simulation Manager</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#portfolio">Portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#queue">Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#run-time-plots">Run-time plots</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sim-manager.html#graphing-area">Graphing area</a></li>
<li class="toctree-l3"><a class="reference internal" href="sim-manager.html#plot-controls">Plot controls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sim-manager.html#legend-style">Legend/Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="sim-manager.html#variables">Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="sim-manager.html#plot-database">Plot Database</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#solver-messages-window">Solver Messages Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#menus">Menus</a></li>
<li class="toctree-l2"><a class="reference internal" href="sim-manager.html#supporting-functions">Supporting functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model-setup.html">Model Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#layout-controls-and-general-behavior">Layout, controls, and general behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#global">Global</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#units">Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#pressure-type">Pressure Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#start-and-finish-conditions">Start and Finish Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#restart">Restart</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#creating-a-restart-simulation">Creating a Restart Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#restart-options">Restart options</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#general">General</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#events">Events</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#time">Time</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#fluid-initialization">Fluid Initialization</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#turbulence">Turbulence</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#scalar-transport">Scalar Transport</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#particles">Particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#thermal-options-restart-data">Thermal Options Restart Data</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#thermal-options-initialization">Thermal Options Initialization</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#thermal-options-solidification-data">Thermal Options Solidification Data</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#related-options-for-restart-simulations">Related Options for Restart Simulations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#version-options">Version Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#physics">Physics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#interface-tracking-number-of-fluids-and-flow-mode">Interface Tracking, Number of Fluids, and Flow Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#physical-models">Physical models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#fluids">Fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#geometry">Geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#favor">FAVOR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#closing-gaps-in-geometry">Closing Gaps in Geometry</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#converting-skins">Converting skins</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#reviewing-the-favorized-geometry-and-mesh">Reviewing the FAVORized Geometry and Mesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#creating-geometry-objects">Creating Geometry Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#creating-subcomponents">Creating Subcomponents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#primitives">Primitives</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#stereolithography-stl-geometry-file-s">Stereolithography (STL) Geometry File(s)</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#raster-file-s">Raster File(s)</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#creating-components">Creating Components</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#general-solid">General (Solid)</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#lost-foam">Lost Foam</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#fan-impeller">Fan/Impeller</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#packed-sediment">Packed Sediment</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#phantom">Phantom</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#domain-removing">Domain Removing</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#flow-vent">Flow Vent</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#fea-domain-removing">FEA Domain Removing</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#surface-roughness">Surface roughness</a><ul>
<li class="toctree-l6"><a class="reference internal" href="model-setup.html#surface-roughness-legend-file">Surface roughness legend file</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#wave-absorbing">Wave absorbing</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#meshing">Meshing</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#porous">Porous</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#core-gas">Core Gas</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#component-and-subcomponent-properties">Component and Subcomponent Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#creating-a-solidified-fluid-region">Creating a Solidified Fluid Region</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#modifying-geometry-objects">Modifying Geometry Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#modifying-components">Modifying Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#modifying-subcomponents">Modifying Subcomponents</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#manual-edits">Manual edits</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#interactive-edits">Interactive edits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#constructing-geometry-using-the-text-editor">Constructing Geometry Using the Text Editor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#generating-primitives-and-quadratic-functions">Generating Primitives and Quadratic Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#importing-stl-files">Importing STL Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#copying-components-with-the-text-editor">Copying Components with the Text Editor</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#virtual-components">Virtual Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#zero-blockage-components">Zero Blockage Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#component-properties">Component Properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#meshingms">Meshing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#coordinate-system">Coordinate System</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#mesh-types">Mesh Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#basic-meshes">Basic Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#reduced-dimensionality-1d-and-2d-meshes">Reduced Dimensionality (1D and 2D) Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#multi-block-meshes">Multi-Block Meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#conforming-meshes">Conforming Meshes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#conform-to-open-volume">Conform to open volume</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#conform-to-blocked-volume">Conform to blocked volume</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#conform-to-meshing-component">Conform to meshing component</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#conform-to-cavity">Conform to cavity</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#conform-to-cooling-channel">Conform to cooling channel</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#shallow-water-meshes">Shallow water meshes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#finite-element-meshes">Finite Element Meshes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#procedures">Procedures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#navigating-the-mesh-widget">Navigating the mesh widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#defining-and-modifying-mesh-blocks">Defining and Modifying Mesh Blocks</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#coordinates-procedure">Coordinate system</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#adding-mesh-blocks">Adding mesh blocks</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#multi-block-meshing">Multi-block meshing</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#mesh-building-and-modification-in-the-text-editor">Mesh Building and Modification in the Text Editor</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#meshing-tips-and-guidelines">Meshing Tips and Guidelines</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#avoiding-errors-with-cartesian-meshes">Avoiding Errors with Cartesian Meshes</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#avoiding-errors-with-cylindrical-meshes">Avoiding Errors with Cylindrical Meshes</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#avoiding-errors-with-multi-block-meshes">Avoiding Errors with Multi-block Meshes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#mesh-boundary-conditions">Mesh Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#boundary-condition-types">Boundary condition types</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#procedure">Procedure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#transferring-boundary-conditions">Transferring boundary conditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#boundary-values">Boundary values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#general-comments">General comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#fluid-distribution">Fluid distribution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#initial-conditions">Initial Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#index-211">Global</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#regions">Regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#pointers">Pointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#components">Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#special-objects">Special Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#particle-blocks-and-sources">Particle blocks and sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#mass-momentum-sources">Mass-momentum sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#types-and-placement">Types and placement</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#planar-sources">Planar sources</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#spray-bars">Spray bars</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-setup.html#stl-baffle-based-sources">STL baffle-based sources</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#flow-rate-and-mass-momentum-source-properties">Flow rate and mass momentum source properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#baffles">Baffles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#manual-definition">Manual definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#interactive-definition">Interactive definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-setup.html#baffle-properties">Baffle properties</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#valves">Valves</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#springs-ropes-and-mooring-lines">Springs, Ropes, and Mooring Lines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#measurement-devices">Measurement devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#history-probes">History Probes</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#flux-surfaces">Flux surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#sampling-volumes">Sampling Volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#global-conditions-for-active-simulation-control">Global conditions for active simulation control</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#output">Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#basis-for-output">Basis for output</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#spatial-data">Spatial Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#history-data">History Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#solidification-data">Solidification Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#diagnostic-data">Diagnostic data</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#time-dependent-output">Time-dependent output</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#batch-mode">Batch Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#mentor-options">Mentor Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#numerical-options">Numerical Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#volume-of-fluid-advection">Volume-of-fluid advection</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#momentum-advection">Momentum advection</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#time-step-controls">Time-step controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#pressure-solver-options">Pressure solver options</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#fsi-tse-solver-options">FSI/TSE solver options</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#viscous-stress-solver-options">Viscous stress solver options</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#other-explicit-implicit-solver-options">Other explicit/implicit solver options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-setup.html#materials-database">Materials Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-setup.html#setting-flags-to-automatically-load-temperature-dependent-data">Setting Flags to Automatically Load Temperature Dependent Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="simulate.html">Computing Results</a><ul>
<li class="toctree-l2"><a class="reference internal" href="simulate.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulate.html#simulation-pre-check">Simulation Pre-check</a><ul>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#tips-warnings-and-fatal-errors">Tips, Warnings, and Fatal Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#missing-and-out-of-range-inputs">Missing and Out-of-range Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#material-properties">Material Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#mesh-quality">Mesh Quality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulate.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="simulate.html#running-the-solver">Running the Solver</a><ul>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#running-a-simulation">Running a Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#monitoring-simulation-progress">Monitoring Simulation Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#making-runtime-changes">Making Runtime Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="simulate.html#command-line-operations">Command Line Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#runscripts">Runscripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#using-the-runscripts">Using the Runscripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="simulate.html#using-the-monitoring-program-peek">Using the Monitoring Program (PEEK)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="postprocessing.html">Post-processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#post-processing-in-flowsight">Post-processing in FlowSight</a><ul>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#batch-post-processing">Batch post-processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#active-batch-tab">Active Batch Tab</a><ul>
<li class="toctree-l5"><a class="reference internal" href="postprocessing.html#creating-graphic-results">Creating Graphic Results</a><ul>
<li class="toctree-l6"><a class="reference internal" href="postprocessing.html#d">3D</a></li>
<li class="toctree-l6"><a class="reference internal" href="postprocessing.html#d-contour">2D Contour</a></li>
<li class="toctree-l6"><a class="reference internal" href="postprocessing.html#history-plot">History Plot</a></li>
<li class="toctree-l6"><a class="reference internal" href="postprocessing.html#text-result">Text Result</a></li>
<li class="toctree-l6"><a class="reference internal" href="postprocessing.html#context-file">Context File</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="postprocessing.html#creating-and-appending-to-templates">Creating and Appending to Templates</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#load-from-user-template-tab">Load from User Template Tab</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#running-batch-processes">Running Batch Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#report-generation">Report Generation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#post-processing-in-flow-3d">Post-processing in FLOW-3D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#existing-plots">Existing Plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#generating-custom-plots">Generating Custom Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#probe-data-at-a-point-vs-time">Probe: Data at a Point vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#d-data-along-a-line-vs-time">1-D:  Data Along a Line vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#d-data-in-a-plane-vs-time">2-D:  Data in a Plane vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#d-data-on-a-surface-vs-time">3-D:  Data on a Surface vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#text-spatial-data-output-in-ascii-format-vs-time">Text:  Spatial Data Output in ASCII Format vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#neutral-file-spatial-data-output-at-user-defined-coordinates-vs-time">Neutral File:  Spatial Data Output at User-defined Coordinates vs. Time</a><ul>
<li class="toctree-l5"><a class="reference internal" href="postprocessing.html#the-coordinate-file-format">The Coordinate File Format</a></li>
<li class="toctree-l5"><a class="reference internal" href="postprocessing.html#the-neutral-file-format">The Neutral File Format</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#fsi-tse-structural-data-on-surfaces-vs-time">FSI / TSE:  Structural Data on Surfaces vs. Time</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#customizing-plots-using-the-flsinp-file">Customizing Plots Using the FLSINP File</a><ul>
<li class="toctree-l5"><a class="reference internal" href="postprocessing.html#data-transformations">Data Transformations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#exporting-plot3d-function-file-data">Exporting PLOT3D Function File Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#viewing-and-manipulating-plots">Viewing and Manipulating Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#probe-1-d-2-d-and-existing-plot-display">Probe, 1-D, 2-D, and Existing Plot Display</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#d-display">3-D Display</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#fsi-tse-display">FSI / TSE Display</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#combining-multiple-results-files">Combining Multiple Results Files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#combine-2-d-plots">Combine 2-D plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#combine-3-d-plots">Combine 3-D plots</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#plot-request-variables">Plot Request Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-contrl">Namelist CONTRL</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-advfrm-bval2">Namelist PLTREQ Variables ADVFRM - BVAL2</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-clrtps-drwfrm">Namelist PLTREQ Variables CLRTPS - DRWFRM</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-ibinry-ifrhid">Namelist PLTREQ Variables IBINRY - IFRHID</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-ihide-itmgrp">Namelist PLTREQ Variables IHIDE - ITMGRP</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-itrans-and-itransc">Namelist PLTREQ Variables ITRANS and ITRANSC</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-ivarn-ivrnp5">Namelist PLTREQ Variables IVARN - IVRNP5</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-ix-jmin">Namelist PLTREQ Variables IX - JMIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variable-kopplt">Namelist PLTREQ Variable KOPPLT</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-lbaxis-nylab">Namelist PLTREQ Variables LBAXIS - NYLAB</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-omode-pvnam5">Namelist PLTREQ Variables OMODE - PVNAM5</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-qmn-tmin">Namelist PLTREQ Variables QMN - TMIN</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-varmin-vscale">Namelist PLTREQ Variables VARMIN - VSCALE</a></li>
<li class="toctree-l4"><a class="reference internal" href="postprocessing.html#namelist-pltreq-variables-xshrnk-ymag">Namelist PLTREQ Variables XSHRNK - YMAG</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postprocessing.html#command-line-post-processing-pltfsi-and-flowplot">Command Line Post-processing: PLTFSI and FLOWPLOT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#modifying-plot-requests">Modifying Plot Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="postprocessing.html#running-pltfsi-and-flowplot">Running PLTFSI and FLOWPLOT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#preprocessor-diagnostic-files">Preprocessor Diagnostic Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#preprocessor-summary-file">Preprocessor Summary File</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#preprocessor-errors-file">Preprocessor Errors File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#solver-diagnostic-files">Solver Diagnostic Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#solver-messages-file">Solver Messages File</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#solver-summary-file">Solver Summary File</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#solver-errors-file">Solver Errors File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#preprocessor-warnings-and-errors">Preprocessor Warnings and Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-open-area-mismatch-at-inter-block-boundaries-of-all-blocks-as-of-total-open-area-at-these-mesh-boundaries-x">Message: “Open area mismatch at inter-block boundaries of all blocks as % of total open area at these mesh boundaries = X”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-open-areas-between-blocks-b1-b2-differ-by-more-than-5-area-diff-x-percent-try-improving-resolution-or-reduce-the-number-of-blocks">Message: “Open areas between blocks B1, B2 differ by more than 5% area, diff = X percent. Try improving resolution or reduce the number of blocks.”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#warning-no-open-area-at-b-boundary">Warning: “No open area at B boundary”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#solver-warnings-and-errors">Solver Warnings and Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-convective-flux-exceeded-stability-limit">Message: “Convective flux exceeded stability limit”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-excessive-convection-failures-calculation-terminated">Message: “Excessive convection failures - calculation terminated”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-pressure-iteration-did-not-converge-in-itmax-imax-iterations">Message: “Pressure iteration did not converge in ITMAX = IMAX iterations”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-excessive-pressure-iteration-failures-calculation-terminated">Message: “Excessive pressure iteration failures - calculation terminated”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-pressure-iteration-diverging-restarting-cycle-with-smaller-omega-and-time-step-size">Message: “Pressure iteration diverging - restarting cycle with smaller omega and time-step size”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-excessive-diverging-pressure-solver-failures-calculation-terminated">Message: “Excessive diverging pressure solver failures - calculation terminated”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-time-step-size-dtmin">Message: “Time-step size &lt; dtmin”</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#message-elements-not-viable-due-to-large-deformations-ensure-material-properties-are-correct">Message: “Elements not viable due to large deformations. Ensure material properties are correct.”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#the-mentor">The Mentor</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#stability-codes">Stability Codes</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference Information</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#equations-of-motion">Equations of Motion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#coordinate-systems">Coordinate Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-continuity-equation-and-its-variations">Mass Continuity Equation and Its Variations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#momentum-equations">Momentum Equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wall-shear-stress">Wall-Shear Stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="#viscosity-evaluation">Viscosity Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#baffle-flow-losses">Baffle Flow Losses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-inertial-reference-frame-motion">Non-Inertial Reference Frame Motion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fluid-interfaces-and-free-surfaces">Fluid Interfaces and Free-Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluid-energy-equations">Fluid Energy Equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#heat-of-transformation">Heat of Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macro-segregation-model">Macro-Segregation Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermal-diffusion-and-sources">Thermal Diffusion and Sources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#structure-temperature-equation">Structure Temperature Equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equation-of-state">Equation-of-State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#general-scalar-transport">General Scalar Transport</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#auxiliary-models">Auxiliary Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bubble-and-void-region-models">Bubble and Void Region Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constant-pressure-void-regions">Constant Pressure Void Regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adiabatic-bubble-model">Adiabatic Bubble Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#homogeneous-thermal-bubble-model">Homogeneous (Thermal) Bubble Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#liquid-vapor-phase-change">Liquid-Vapor Phase Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cavitating-void-regions">Cavitating Void Regions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vaporization-residue">Vaporization Residue</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buoyant-flow-model">Buoyant Flow Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-gas-generation-and-flow-in-sand-cores-and-molds">Core Gas Generation and Flow in Sand Cores and Molds</a></li>
<li class="toctree-l3"><a class="reference internal" href="#permeable-mold-model">Permeable Mold Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defect-tracking">Defect Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drift-flux-model">Drift-Flux Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#electro-mechanics">Electro-mechanics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#electric-field-model">Electric Field Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#electro-osmosis">Electro-osmosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#particle-movement-and-fluid-flow-due-to-electric-field">Particle Movement and Fluid Flow Due to Electric Field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#high-concentration-granular-media-model">High Concentration Granular Media Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sand-core-blowing-model">Sand Core Blowing Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#slurry-model">Slurry Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#elasto-visco-plastic-and-viscoelastic-model">Elasto-visco-plastic and Viscoelastic Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#model-formulation">Model Formulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elasto-viscoplastic-model">Elasto-viscoplastic model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#viscoelastic-models">Viscoelastic models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-method">Solution Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computation-of-parameters">Computation of parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#elastic-membrane-and-elastic-wall-model">Elastic Membrane and Elastic Wall Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elastic-membrane">Elastic Membrane</a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic-wall">Elastic Wall</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-limitations">Model Limitations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fan-and-impeller-model">Fan and Impeller Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluid-structure-interaction-fsi-and-thermal-stress-evolution-tse-models">Fluid-Structure Interaction (FSI) and Thermal Stress Evolution (TSE) Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equation-of-motion-and-stress">Equation of Motion and Stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finite-element-method-fem">Finite Element Method (FEM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#boundary-conditions-on-solid-regions">Boundary Conditions on Solid Regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solidified-non-solidified-coupling">Solidified/non-Solidified Coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yielding-model">Yielding model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#general-moving-objects-model">General Moving Objects Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equations-of-motion-for-rigid-body">Equations of Motion for Rigid Body</a></li>
<li class="toctree-l4"><a class="reference internal" href="#source-terms-in-conservation-equations">Source Terms in Conservation Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dynamic-equations-for-rigid-body-collision">Dynamic Equations for Rigid-Body Collision</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#coulomb-s-law-of-friction">Coulomb’s Law of Friction</a></li>
<li class="toctree-l5"><a class="reference internal" href="#stronge-s-energetic-coefficient-of-restitution">Stronge’s Energetic Coefficient of Restitution</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dynamic-equations-in-general-form">Dynamic Equations in General Form</a></li>
<li class="toctree-l5"><a class="reference internal" href="#dynamic-equations-in-terms-of-normal-impulse">Dynamic Equations in Terms of Normal Impulse</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#mooring-line-model">Mooring Line Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dissolving-solid-solute-model">Dissolving Solid Solute Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combustible-object-model">Combustible Object Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lost-foam-model">Lost Foam Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#porous-media-models">Porous Media Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#governing-equations-in-porous-media">Governing Equations in Porous Media</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saturated-porous-media">Saturated porous media</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#resistance-to-flow-drag">Resistance to flow (drag)</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#darcian-saturated-drag">Darcian Saturated Drag</a></li>
<li class="toctree-l6"><a class="reference internal" href="#forchheimer-saturated-drag">Forchheimer Saturated Drag</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#capillary-pressure">Capillary Pressure</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#unsaturated-porous-media">Unsaturated Porous Media</a></li>
<li class="toctree-l4"><a class="reference internal" href="#drag-calculations-in-unsaturated-flows">Drag Calculations in Unsaturated Flows</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#power-law-unsaturated-drag-model">Power Law Unsaturated Drag Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="#exponential-unsaturated-drag-model">Exponential Unsaturated Drag Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mualem-s-unsaturated-drag-model-for-relative-permeability">Mualem’s Unsaturated Drag Model for Relative Permeability</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#capillary-pressure-in-unsaturated-flows">Capillary Pressure in Unsaturated Flows</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#simplified-unsaturated-capillary-pressure-model">Simplified Unsaturated Capillary Pressure Model</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#transition-between-draining-and-filling-curves">Transition between Draining and Filling Curves</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#van-genuchten-unsaturated-capillary-pressure-model">Van Genuchten Unsaturated Capillary Pressure Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rigid-body-dynamics-for-non-inertial-reference-frame">Rigid Body Dynamics for Non-Inertial Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sediment-scour-model">Sediment Scour Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shallow-water-model">Shallow Water Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sludge-settling-model">Sludge Settling Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solidification-model">Solidification Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#solidification-shrinkage-and-porosity-models">Solidification Shrinkage and Porosity Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solidification-drag">Solidification Drag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#turbulence-models">Turbulence Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#turbulence-transport-models">Turbulence Transport Models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#one-equation-model">One-equation model</a></li>
<li class="toctree-l5"><a class="reference internal" href="#k-epsilon">k-epsilon</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rng-k-epsilon">RNG k-epsilon</a></li>
<li class="toctree-l5"><a class="reference internal" href="#k-omega">k-omega</a></li>
<li class="toctree-l5"><a class="reference internal" href="#prandtl-mixing-length-model">Prandtl Mixing Length Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="#large-eddy-simulation-model">Large Eddy Simulation Model</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#turbulent-scales">Turbulent Scales</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turbulence-boundary-conditions">Turbulence Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wall-heat-transfer">Wall Heat Transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#energy-source-terms">Energy Source Terms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-area-evaluation">Surface Area Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluid-obstacle-heat-transfer-coefficient">Fluid/Obstacle Heat Transfer Coefficient</a></li>
<li class="toctree-l4"><a class="reference internal" href="#baffle-heat-transfer">Baffle Heat Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#heat-transfer-to-void-regions">Heat Transfer to Void Regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#heat-transfer-to-cooling-channels">Heat Transfer to Cooling Channels</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-approximations">Numerical Approximations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#numericaloverviewth">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notation">Notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outline-of-finite-difference-solution-method">Outline of Finite Difference Solution Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#momentum-equation-approximations">Momentum Equation Approximations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#advective-fluxes">Advective Fluxes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#first-order-method">First-Order Method</a></li>
<li class="toctree-l5"><a class="reference internal" href="#second-order-monotonicity-preserving-method">Second-Order Monotonicity Preserving Method</a></li>
<li class="toctree-l5"><a class="reference internal" href="#second-order-method">Second-Order Method</a></li>
<li class="toctree-l5"><a class="reference internal" href="#immersed-boundary-method">Immersed Boundary Method</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#density-evaluation">Density Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wall-shear-stresses">Wall Shear Stresses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#porous-baffle-flow-losses">Porous Baffle Flow Losses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generalized-drag-forces">Generalized Drag Forces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-inertial-reference-frame">Non-Inertial Reference Frame</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#gravitational-force-in-non-inertial-frames">Gravitational Force in Non-inertial Frames</a></li>
<li class="toctree-l5"><a class="reference internal" href="#specifying-non-inertial-reference-frame-motion">Specifying Non-Inertial Reference Frame Motion</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#simple-rotation-or-acceleration-along-the-x-axis">Simple Rotation or Acceleration along the X-Axis</a></li>
<li class="toctree-l6"><a class="reference internal" href="#harmonic-oscillation">Harmonic Oscillation</a></li>
<li class="toctree-l6"><a class="reference internal" href="#tabular-specification">Tabular Specification</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="#coupled-rigid-body-dynamics">Coupled Rigid Body Dynamics</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#input-data">Input Data</a></li>
<li class="toctree-l6"><a class="reference internal" href="#explicit-solution-algorithm-and-stability-limitations">Explicit Solution Algorithm and Stability Limitations</a></li>
<li class="toctree-l6"><a class="reference internal" href="#implicit-solution-algorithms">Implicit Solution Algorithms</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pressure-solution-algorithm">Pressure Solution Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#incompressible-sor-method">Incompressible SOR Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#incompressible-line-implicit-sadi-method">Incompressible Line Implicit SADI Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compressible-solution-method">Compressible Solution Method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gmres-pressure-velocity-solvers">GMRES Pressure-Velocity Solvers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-advection">Scalar Advection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#time-advancement-of-fluid-configuration">Time Advancement of Fluid Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-scalar-advection">Other Scalar Advection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#determining-surface-normals-and-cell-flags">Determining Surface Normals and Cell Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-location-within-a-cell">Surface Location within a Cell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cleanup-of-misty-fluid-regions">Cleanup of Misty Fluid Regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bookkeeping-adjustments">Bookkeeping Adjustments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#locally-implicit-approximation-of-advection">Locally Implicit Approximation of Advection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#diffusion-process-heat-conduction-and-heat-transfer">Diffusion Process, Heat Conduction and Heat Transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#diffusion-process">Diffusion Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#heat-conduction-and-heat-transfer">Heat Conduction and Heat Transfer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implicit-viscous-stress-and-heat-flux-approximations">Implicit Viscous Stress and Heat Flux Approximations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#free-slip-vs-non-slip-boundaries">Free-Slip vs. Non-Slip Boundaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turbulence-model-boundary-conditions">Turbulence Model Boundary Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#free-surface-boundaries">Free-Surface Boundaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#internal-obstacle-boundaries">Internal Obstacle Boundaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#surface-tension-with-wall-adhesion">Surface Tension with Wall Adhesion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mesh-block-boundaries">Mesh Block Boundaries</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#pressure-boundary-conditions">Pressure Boundary Conditions</a></li>
<li class="toctree-l5"><a class="reference internal" href="#continuative-boundary-conditions">Continuative Boundary Conditions</a></li>
<li class="toctree-l5"><a class="reference internal" href="#outflow-boundary-conditions">Outflow Boundary Conditions</a></li>
<li class="toctree-l5"><a class="reference internal" href="#wave-absorbing-layer-sponge-layer-at-open-boundary">Wave-absorbing Layer (Sponge Layer) at Open Boundary</a></li>
<li class="toctree-l5"><a class="reference internal" href="#periodic-linear-wave-generator">Periodic Linear Wave Generator</a></li>
<li class="toctree-l5"><a class="reference internal" href="#stokes-wave-generator">Stokes Wave Generator</a></li>
<li class="toctree-l5"><a class="reference internal" href="#stokes-and-cnoidal-waves-generator-fourier-series-method">Stokes and Cnoidal Waves Generator (Fourier Series Method)</a></li>
<li class="toctree-l5"><a class="reference internal" href="#solitary-wave-generator">Solitary Wave Generator</a></li>
<li class="toctree-l5"><a class="reference internal" href="#random-wave">Random Wave</a></li>
<li class="toctree-l5"><a class="reference internal" href="#rating-curve-and-natural-inlet-boundary">Rating Curve and Natural Inlet Boundary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stability-considerations">Stability Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#discrete-particle-dynamics">Discrete Particle Dynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#marker-particles">Marker Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#material-mass-liquid-and-gas-particles">Material (Mass, Liquid, and Gas) Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fluid-particles-with-heat-transfer-and-phase-change">Fluid Particles with Heat Transfer and Phase Change</a></li>
<li class="toctree-l4"><a class="reference internal" href="#particle-fluid-momentum-interaction">Particle/Fluid Momentum Interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#particle-wall-interaction">Particle/Wall Interaction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rigid-body-dynamics-algorithm-for-non-inertial-reference-frame-model">Rigid Body Dynamics Algorithm for Non-Inertial Reference Frame Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#evaluation-of-environmental-forces-and-torques">Evaluation of Environmental Forces and Torques</a></li>
<li class="toctree-l4"><a class="reference internal" href="#evaluation-of-control-forces-and-torques">Evaluation of Control Forces and Torques</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-of-the-fluid-dynamics-equations">Solution of the Fluid Dynamics Equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-of-the-dynamic-equations-for-the-rigid-body-center-of-mass">Solution of the Dynamic Equations for the Rigid-Body Center of Mass</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solution-of-the-dynamic-equations-for-the-rotation-of-the-rigid-body">Solution of the Dynamic Equations for the Rotation of the Rigid Body</a></li>
<li class="toctree-l4"><a class="reference internal" href="#integration-of-the-kinematic-equations-for-the-rigid-body-attitude">Integration of the Kinematic Equations for the Rigid-Body Attitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="#convergence-testing">Convergence Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#simplified-solidification-shrinkage-algorithm">Simplified Solidification Shrinkage Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reactive-flows-algorithm">Reactive Flows Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model-reference.html">Model Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#active-simulation-control">Active Simulation Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#description-and-usage">Description and Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#model-setup">Model Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#restart">Restart</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#adiabatic-bubbles">Adiabatic Bubbles</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#air-entrainment">Air Entrainment</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#cavitation-and-bubble-formation-nucleation">Cavitation and Bubble Formation (Nucleation)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#inertial-cavitation-opening-of-voids-in-high-velocity-flows">Inertial Cavitation: Opening of voids in high-velocity flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#temperature-dependent-cavitation">Temperature-Dependent Cavitation</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#cavitation-potential-model">Cavitation Potential Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#combustible-objects">Combustible Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#compressible-flows">Compressible Flows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#fully-compressible-flows">Fully-compressible flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#acoustic-waves-limited-compressibility">Acoustic Waves (Limited Compressibility)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#condensation-evaporation-at-free-surfaces">Condensation/Evaporation at Free Surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#evaporation-into-constant-pressure-bubbles">Evaporation into Constant Pressure Bubbles</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#phase-change-with-thermal-bubbles">Phase Change with Thermal Bubbles</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#two-fluid-model">Two-fluid Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#two-fluids-with-non-condensable-gas">Two Fluids with Non-condensable Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#vaporization-residue">Vaporization Residue</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#cooling-channels">Cooling Channels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#cooling-channel-definition">Cooling channel definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-transfer-coefficients-for-cooling-channels">Heat transfer coefficients for cooling channels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#core-gas">Core Gas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#model-dependencies">Model Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#global-model-controls">Global Model Controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#core-gas-component-properties">Core Gas Component Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#model-output">Model Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#defect-tracking">Defect tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#drift-flux">Drift Flux</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#versions-of-the-model">Versions of the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#calculation-of-drag-between-the-phases">Calculation of drag between the phases</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#dispersed-phase-drop-size">Dispersed Phase Drop Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#escape-of-gas-through-a-free-surface">Escape of Gas through a Free Surface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#elastic-plastic-and-viscoelastic-fluids">Elastic, Plastic, and Viscoelastic Fluids</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#elastic-and-plastic-materials">Elastic and Plastic Materials</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#elastic-fluid-example-bingham-material-approximation">Elastic fluid example:  Bingham Material Approximation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#viscoelastic-materials">Viscoelastic Materials</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#electro-mechanics">Electro-mechanics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#electric-fields">Electric Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#electro-osmosis-zeta-potential">Electro-osmosis (Zeta Potential)</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#electro-thermal-effects">Electro-thermal Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#dielectrophoresis">Dielectrophoresis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#fan-and-impeller-model">Fan and Impeller Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#flows-with-density-variations">Flows with Density Variations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#buoyant-flow">Buoyant Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#fluid-sources">Fluid sources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#droplet-and-bubble-sources">Droplet and bubble sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#mass-sources">Mass Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#mass-sources-in-different-scenarios">Mass sources in different scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#setup-procedure">Setup procedure</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#activate-mass-source">Activate Mass Source</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#define-source-properties">Define Source Properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#define-flow-rate">Define Flow Rate</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#define-scalars-at-source">Define Scalars at Source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#mass-momentum-sources">Mass-Momentum Sources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#fluid-structure-interaction-fsi">Fluid-Structure Interaction (FSI)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#fsitsemodelsetupmr">Model Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#fsi-meshing">FSI meshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#simulation">Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#post-processing">Post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#export-import-fsi-meshes">Export/Import FSI Meshes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#free-surface-vs-confined-flows">Free Surface vs. Confined Flows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#confined-flow">Confined Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#free-surface-flow">Free Surface Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#granular-flow">Granular Flow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#granular-flow-application-example-core-blowing">Granular flow application example:  Core Blowing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#gravity">Gravity</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#heat-transfer">Heat Transfer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#transport-of-heat-in-fluid">Transport of Heat in Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-sources">Heat Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#heat-sources-in-fluid">Heat sources in fluid</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#heat-sources-in-components">Heat sources in components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-transfer-across-baffles">Heat Transfer across Baffles</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-transfer-and-conduction-in-components">Heat Transfer and Conduction in Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#component-heat-transfer-modes">Component heat transfer modes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#heat-transfer-coefficients">Heat transfer coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#thermal-contact-resistance">Thermal contact resistance</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#special-considerations-for-heat-transfer-in-porous-components">Special considerations for heat transfer in porous components</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-transfer-to-voids">Heat Transfer to Voids</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#heat-transfer-only">Heat Transfer Only</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#lost-foam-casting-process">Lost Foam Casting Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#lost-foam-model">Lost foam model</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#lost-foam-residue-tracking">Lost foam residue tracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#mesh-boundary-conditions">Mesh Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#outflow-type-of-pressure-boundary">Outflow Type of Pressure Boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#rating-curve">Rating curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#natural-inlet">Natural inlet</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#wave-boundary-condition">Wave Boundary Condition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#linear-wave">Linear Wave</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#stokes-wave-and-cnoidal-wave">Stokes Wave and Cnoidal Wave</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#solitary-wave">Solitary Wave</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#random-wave">Random Wave</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#initialization-of-wave-motion">Initialization of Wave Motion</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#minimizing-wave-reflections-from-mesh-boundaries">Minimizing Wave Reflections from Mesh Boundaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#using-the-shallow-water-model-for-wave-simulations">Using the shallow water model for wave simulations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#wave-absorbing-layer-sponge-layer-at-outflow-boundary">Wave-absorbing Layer (Sponge Layer) at Outflow Boundary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#wave-absorbing-component">Wave-absorbing Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#wave-absorbing-boundary">Wave-absorbing Boundary</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#moisture-drying-model">Moisture Drying Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#moving-objects">Moving objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#general-moving-objects">General Moving Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#basics">Basics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#step-1-activate-the-gmo-model">Step 1: Activate the GMO Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#step-2-create-the-gmo-s-initial-geometry">Step 2: Create the GMO’s Initial Geometry</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#step-3-specify-the-gmo-s-motion-related-parameters">Step 3: Specify the GMO’s Motion Related Parameters</a><ul>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#prescribed-6-dof-motion">Prescribed 6-DOF Motion</a></li>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#prescribed-fixed-point-motion">Prescribed Fixed-point Motion</a></li>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#prescribed-fixed-axis-motion">Prescribed Fixed-Axis Motion</a></li>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#coupled-6-dof-motion">Coupled 6-DOF motion</a></li>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#coupled-fixed-point-motion">Coupled Fixed-Point Motion</a></li>
<li class="toctree-l6"><a class="reference internal" href="model-reference.html#coupled-fixed-axis-motion">Coupled Fixed-Axis Motion</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#step-4-specify-the-gmo-s-mass-properties">Step 4: Specify the GMO’s Mass Properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#transformation-of-gmo-properties">Transformation of GMO Properties</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#output">Output</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#collision">Collision</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#pq2-analysis">PQ<sup>2</sup> Analysis</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#index-219">Model Setup</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#index-220">Post-processing</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#simple-deforming-objects">Simple Deforming Objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#elastic-membrane">Elastic Membrane</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#elastic-wall">Elastic Wall</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#springs-ropes-and-mooring-lines">Springs, Ropes and Mooring Lines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#springs-ropes">Springs &amp; Ropes</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#mooring-lines">Mooring Lines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#moving-components-with-tangential-surface-velocity">Moving Components with Tangential Surface Velocity</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#rotating-axisymmetric-components">Rotating Axisymmetric Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#non-inertial-reference-frame-motion">Non-Inertial Reference Frame Motion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#smooth-tabular-motion">Smooth Tabular Motion</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#impulsive-motion-of-non-inertial-reference-frame">Impulsive Motion of Non-inertial Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#center-of-gravity-for-non-inertial-reference-frame">Center of Gravity for Non-inertial Reference Frame</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#rigid-body-dynamics">Rigid Body Dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#non-inertial-reference-frame-application-example-centrifugal-casting">Non-inertial reference frame application example:  Centrifugal Casting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#particles">Particles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#setup-and-dependencies">Setup and dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#particle-definition-and-physics">Particle definition and physics</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#marker-particles">Marker particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#mass-particles">Mass particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#fluid-particles">Fluid particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#gas-particles">Gas particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#void-particles">Void Particles</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#user-customizable-particles">User-customizable particles</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#particle-blocks-and-sources">Particle blocks and sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#probe-particles">Probe particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#particle-output">Particle output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#porous-media">Porous Media</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#creating-a-porous-component">Creating a Porous Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#porous-component-properties">Porous Component Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#porous-media-drag-models">Porous Media Drag Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#calculating-the-porous-media-drag-coefficient">Calculating the Porous Media Drag Coefficient</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#saturated-porous-media-drag-models">Saturated Porous Media Drag Models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#darcian-saturated-drag-model">Darcian Saturated Drag Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#forchheimer-saturated-drag-model">Forchheimer Saturated Drag Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#permeability-dependent-saturated-drag">Permeability Dependent Saturated Drag</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#unsaturated-porous-media-drag-models">Unsaturated Porous Media Drag Models</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#capillary-pressure-models">Capillary Pressure Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#saturated-capillary-effects-in-porous-components">Saturated Capillary Effects in Porous Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#unsaturated-capillary-effects-in-porous-components">Unsaturated Capillary Effects in Porous Components</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#simplified-unsaturated-capillary-pressure-model">Simplified Unsaturated Capillary Pressure Model</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#van-genuchten-unsaturated-capillary-pressure-model">Van Genuchten Unsaturated Capillary Pressure Model</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#porous-baffles">Porous Baffles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#reaction-kinetics">Reaction Kinetics</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#scalars">Scalars</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#id8">Description and usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#id9">Setup and dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#id10">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#sediment-scour-and-deposition">Sediment Scour and Deposition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#sediment-properties">Sediment properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#packed-sediment-components">Packed sediment components</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#initial-sediment-concentrations">Initial sediment concentrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#sediment-concentrations-at-boundary-conditions-and-sources">Sediment concentrations at boundary conditions and sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#sediment-modeling-considerations">Sediment modeling considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#shallow-water-model">Shallow Water Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#id15">Description and Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#shallow-water-shear-stress-method">Shallow Water Shear Stress Method</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#laminar-flow">Laminar Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#turbulent-flow">Turbulent Flow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#shallow-water-mesh-block">Shallow Water Mesh Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#combining-shallow-watter-with-other-physical-models">Combining Shallow Watter with Other Physical Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#shallow-water-3d-flow">Shallow Water / 3D Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#shallow-water-geophysical-flow">Shallow Water / Geophysical Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#shallow-water-wind">Shallow Water / Wind</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#shallow-water-porous-media">Shallow Water / Porous media</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#sludge-settling">Sludge Settling</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#solidification">Solidification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#criterion-functions">Criterion Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#drag-in-the-mushy-zone">Drag in the Mushy Zone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#solidification-drag-models-in-flow-3d">Solidification Drag Models in FLOW-3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#how-to-calculate-permeability">How to Calculate Permeability</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#how-flow-3d-defines-the-coefficient-of-solidification-drag">How FLOW-3D Defines the Coefficient of Solidification Drag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#macro-segregation-during-alloy-solidification">Macro-Segregation during Alloy Solidification</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#microporosity-formation">Microporosity Formation</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#moving-solid-phase">Moving Solid Phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#solidification-shrinkage">Solidification Shrinkage</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#thermal-modulus">Thermal Modulus</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#squeeze-pins">Squeeze Pins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#index-329">Description and Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#index-333">Model Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#index-335">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#index-336">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#surface-tension">Surface Tension</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#tabular-data">Tabular Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#temperature-dependent-properties">Temperature Dependent Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#time-dependent-properties">Time Dependent Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#thermal-die-cycling">Thermal Die Cycling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#defining-the-stages-in-the-die-cycle">Defining the stages in the die cycle</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#tdc-solidfication-stage">Solidification</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#open-before-ejection">Open before ejection</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#closed">Closed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#numerical-settings">Numerical settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#tdc-output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#spray-cooling-for-thermal-die-cycling">Spray Cooling for Thermal Die Cycling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#spray-area-computation">Spray Area Computation</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#the-heat-transfer-coefficient">The Heat Transfer Coefficient</a><ul>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#the-heat-transfer-coefficient-based-on-dependencies">The Heat Transfer Coefficient Based on Dependencies</a></li>
<li class="toctree-l5"><a class="reference internal" href="model-reference.html#the-heat-transfer-coefficient-based-on-spray-medium-properties">The Heat Transfer Coefficient Based on Spray Medium Properties</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#id25">Model Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#output-options">Output Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#id26">Post Processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#thermal-stress-evolution-tse-in-solidified-fluid-regions">Thermal Stress Evolution (TSE) in Solidified Fluid Regions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#tsesolidificationmodelsetupmr">Model Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#tse-properties">TSE properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#tse-meshing">TSE meshing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#tse-controls">TSE Controls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#solid-fraction-activation">Solid fraction activation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#numerical-options">Numerical Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#important-considerations">Important considerations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#tsesolidificationpostprocessingmr">Post-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#export-import-tse-meshes">Export/Import TSE Meshes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#two-fluid-flow">Two-Fluid Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#viscosity-and-turbulence">Viscosity and Turbulence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#wall-effects-slip-shear-and-component-roughness">Wall Effects: Slip, Shear, and Component Roughness</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#wall-slip">Wall Slip</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#wall-shear">Wall Shear</a></li>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#component-and-sub-component-roughness">Component and Sub-Component Roughness</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#temperature-and-strain-rate-dependent-viscosity">Temperature and Strain Rate Dependent Viscosity</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#thixotropic-fluids">Thixotropic Fluids</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#turbulence">Turbulence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="model-reference.html#turbulent-diffusion-coefficients">Turbulent Diffusion Coefficients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#viscous-heating">Viscous Heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="model-reference.html#viscosity-output">Viscosity Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="model-reference.html#wind-shear-stress">Wind Shear Stress</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Output variables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#additional-output">Additional output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#distance-traveled-by-fluid">Distance Traveled by Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#fluid-arrival-time">Fluid arrival time</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#fluid-residence-time">Fluid residence time</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#wall-contact-time">Wall Contact Time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#geometry-data">Geometry Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#component-wetted-area">Component wetted area</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#forces-and-torques-on-components">Forces and torques on components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#forces">Forces</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#torques">Torques</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#buoyancy-center-and-metacentric-height">Buoyancy center and metacentric height</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#advanced">Advanced</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#fluid-vorticity-q-criterion">Fluid vorticity &amp; Q-criterion</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#hydraulic-data-and-total-hydraulic-head-3d">Hydraulic Data and Total Hydraulic Head 3D</a><ul>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#hydraulic-data">Hydraulic Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#total-hydraulic-head-3d">Total Hydraulic Head 3D</a></li>
<li class="toctree-l4"><a class="reference internal" href="outputs.html#flux-averaged-hydraulic-head">Flux-averaged hydraulic head</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outputs.html#measurement-device-outputs">Measurement Device Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#history-probe-outputs">History Probe Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#flux-surface-outputs">Flux Surface Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="outputs.html#sampling-volume-outputs">Sampling Volume Outputs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="numerical-options.html">Numerical Options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#volume-of-fluid-advection">Volume-of-fluid advection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#fluidinterfacevofapproximationsmr">Volume-of-fluid advection</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#advanced-options">Advanced Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#f-packing-controls">F-Packing controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#fluid-fraction-cleanup">Fluid fraction cleanup</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#automatic-volume-correction">Automatic volume correction</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#two-fluid-interface-slip">Two-fluid interface slip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#momentum-advection">Momentum advection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#order-of-approximation">Order of approximation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#fluid-flow-solver-options">Fluid flow solver options</a></li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#time-step-controls">Time-Step Controls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#advancedtimestepcontrolmr">Advanced Options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#favor-options">FAVOR Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#favor-tolerance">FAVOR Tolerance</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#gap-tolerance">Gap Tolerance</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#skin-tolerance">Skin Tolerance</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#volume-fraction-cleanup">Volume fraction cleanup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#pressure-solver-options">Pressure solver options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#pressure-solver-type">Pressure solver type</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#implicit-solver-type">Implicit solver type</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#convergence-controls">Convergence Controls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#convergence-criterion">Convergence criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#relaxation-factor">Relaxation factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#minimum-number-of-iterations">Minimum number of iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#maximum-number-of-iterations">Maximum number of iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#maximum-number-of-iterations-before-time-step-is-reduced">Maximum number of iterations before time step is reduced</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#maximum-number-of-iteration-failures-allowed">Maximum number of iteration failures allowed</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#subspace">Subspace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#compressible-pressure-iterations">Compressible Pressure Iterations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#fsi-tse-solver-options">FSI/TSE Solver Options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#id3">Convergence Controls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#gmres-subspace-size">GMRES subspace size</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id4">Maximum number of iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#convergence-tolerance">Convergence tolerance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#solver-options">Solver Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#additional-memory">Additional memory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#coupling-between-solidified-fluid-fsi">Coupling between solidified fluid/FSI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#friction-coefficient">Friction coefficient</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#viscous-stress-solver-options">Viscous stress solver options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#viscous-stress-solver-type">Viscous stress solver type</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#viscoussolverconvergencecontrolsno">Convergence Controls</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#multiplier-for-convergence-criterion">Multiplier for convergence criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id6">Relaxation factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id7">Maximum number of iterations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#electric-field-solver-options">Electric field solver options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#electric-potential">Electric Potential</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#convergence-criterion-for-electric-potential">Convergence criterion for electric potential</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#maximum-number-of-electric-potential-iterations">Maximum number of electric potential iterations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#zeta-potential">Zeta Potential</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#convergence-criterion-for-zeta-potential">Convergence criterion for zeta potential</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id8">Maximum number of electric potential iterations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#other-explicit-implicit-solver-options">Other explicit/implicit solver options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#heat-transfer">Heat Transfer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id9">Convergence controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id10">Multiplier for convergence criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#over-relaxation-factor">Over-relaxation factor</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id11">Maximum number of iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id12">Maximum number of iterations before time step is reduced</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#elastic-stress">Elastic Stress</a><ul>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id13">Convergence controls</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id14">Multiplier for convergence criterion</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id15">Maximum number of iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="numerical-options.html#id16">Maximum number of iterations before time step is reduced</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#surface-tension">Surface tension</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#free-surface-pressure">Free surface pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#bubble-pressure">Bubble pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#advection">Advection</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#moving-object-fluid-coupling">Moving object/Fluid coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#shallow-water">Shallow water</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#additional-options">Additional options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#coriolis-acceleration-implicit-weighting-factor">Coriolis acceleration implicit weighting factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#steady-state-accelerator">Steady-state accelerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#steady-state-accelerator-for-confined-flows">Steady-state accelerator for confined flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#wave-boundary-condition">Wave boundary condition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="numerical-options.html#numerical-options-not-found-in-the-numerics-widget">Numerical options not found in the Numerics widget</a><ul>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#density-advection">Density advection</a></li>
<li class="toctree-l3"><a class="reference internal" href="numerical-options.html#energy-advection">Energy advection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input-variable-summary-units.html">Input Variable Summary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#input-file-specifications">Input File Specifications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#editing-the-input-file-directly">Editing the input file directly</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#input-file-structure-and-namelist-blocks">Input File Structure and Namelist Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#namelist-format">Namelist Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#namelist-rules">Namelist Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#problem-title">Problem Title</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#adding-comments-using-the-remark-variable">Adding Comments Using the Remark Variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#conventions-used-for-the-input-variable-summary">Conventions Used for the Input Variable Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#physical-and-computational-parameters-xput">Physical and Computational Parameters - XPUT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#advection-options">Advection Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#automatic-volume-correction-options">Automatic Volume Correction Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#collision-model-options">Collision Model Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#convergence-criteria-options">Convergence Criteria Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#core-gas-generation">Core Gas Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#energy-and-heat-transfer-options">Energy and Heat Transfer Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#energy-options">Energy Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#heat-transfer-options">Heat Transfer Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#explicit-implicit-options">Explicit/Implicit Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#file-control-options">File Control Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#flow-mode-options">Flow Mode Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#global-conditions-for-active-simulation-control">Global Conditions for Active Simulation Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#gravity-and-non-inertial-reference-frame-options">Gravity and Non-Inertial Reference Frame Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initialization-and-restart-options">Initialization and Restart Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#initialization-option">Initialization Option</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#restart-options">Restart Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#numerical-options">Numerical Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#physical-model-options">Physical Model Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#plot-output-control">Plot Output Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-restart-data-interval">Active simulation control of restart data interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-selected-data-interval">Active simulation control of selected data interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-history-data-interval">Active simulation control of history data interval</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#pressure-iteration-options">Pressure Iteration Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#print-output-control">Print Output Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#shallow-water-model-options">Shallow Water Model Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#termination-control">Termination Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-termination">Active simulation control of termination</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#thermal-die-cycling-options">Thermal Die Cycling Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#time-step-control">Time-Step Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#turbulence-and-viscous-options">Turbulence and Viscous Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#turbulence-equation-coefficients-and-diffusion-parameters">Turbulence Equation Coefficients and Diffusion Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#user-defined-variables">User Defined Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#void-heat-transfer-coefficients">Void Heat Transfer Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#solidified-fluid-wall-gap-heat-transfer-properties">Solidified Fluid/Wall Gap Heat Transfer Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#computational-and-print-limits-limits">Computational and Print Limits - LIMITS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#computational-limits">Computational Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#print-limits">Print Limits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#fluid-properties-namelist-props">Fluid Properties Namelist - PROPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#cavitation-properties">Cavitation Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#density-properties">Density Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#electrostatic-properties">Electrostatic Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#drift-flux">Drift Flux</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#elastic-and-plastic-properties">Elastic and Plastic Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#fluid-names-and-units-identifiers">Fluid Names and Units Identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#granular-flow-properties">Granular Flow Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#moisture-fluid-properties-for-isothermal-moisture-drying-model">Moisture Fluid Properties for Isothermal Moisture Drying Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#phase-change-properties">Phase Change Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#segregation-model-parameters">Segregation Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#cast-iron-solidification-model-parameters">Cast Iron Solidification Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#solidification-properties">Solidification Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#state-equation-properties">State Equation Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#surface-tension-properties">Surface Tension Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#thermal-properties">Thermal Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#viscous-properties">Viscous Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#wall-shear-properties">Wall Shear Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#tabular-property-input">Tabular Property Input</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#scalar-transport-namelist-scalar">Scalar Transport Namelist - SCALAR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#general-and-scalar-advection-parameters">General and Scalar Advection Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#fluid-properties-associated-with-scalars">Fluid Properties Associated with Scalars</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#scalar-electrostatics-electro-osmosis-and-electromechanics-model-parameters">Scalar Electrostatics, Electro-osmosis and Electromechanics Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#defect-tracking-parameters-for-lost-foam-and-free-surface-models">Defect Tracking Parameters for Lost Foam and Free-Surface Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#air-entrainment-model-parameters">Air Entrainment Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#dissolution-model-parameters">Dissolution Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#dynamic-droplet-model-parameters">Dynamic Droplet Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#combustible-object-model-parameters">Combustible Object Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#microporosity-and-shrinkage-model-parameters">Microporosity and Shrinkage Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#filling-time">Filling Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-condensable-gas-model-parameters">Non-condensable Gas Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#cavitation-potential-model">Cavitation Potential Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#binary-alloy-segregation-parameters">Binary Alloy Segregation Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#fluid-residence-time">Fluid Residence Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#spray-cooling-for-thermal-die-cycling">Spray Cooling (for thermal die cycling)</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#tracers">Tracers</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#wall-contact-time-with-fluid">Wall Contact Time with Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#gas-pressure-and-venting-efficiency">Gas pressure and Venting Efficiency</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#distance-traveled-by-fluid">Distance Traveled by Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#vaporization-residue-parameters">Vaporization Residue Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#sedimentation-scour-parameters">Sedimentation &amp; Scour Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#sludge-settling-model-parameters">Sludge Settling Model Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#reaction-kinetics-namelist-chm">Reaction Kinetics Namelist - CHM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#reaction-kinetics-parameters">Reaction Kinetics Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#rigid-body-namelist-rbdata">Rigid Body Namelist - RBDATA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#rigid-body-dynamics-numerical-options">Rigid Body Dynamics Numerical Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#rigid-body-dynamics-initial-conditions">Rigid Body Dynamics Initial Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#rigid-body-dynamics-properties">Rigid Body Dynamics Properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#mesh-boundary-condition-namelist-bcdata">Mesh Boundary Condition Namelist - BCDATA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-condition-types-and-time-table">Boundary Condition Types and Time Table</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#boundary-condition-types">Boundary Condition Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#boundary-condition-time-table">Boundary Condition Time Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-elastic-stresses">Boundary Elastic Stresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-electric-charge-density">Boundary Electric Charge Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-entrained-air-volume-fraction">Boundary Entrained Air Volume Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-dissolved-solute-concentration">Boundary Dissolved Solute Concentration</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-dynamic-droplet-size">Boundary Dynamic Droplet Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-external-potential">Boundary External Potential</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-fluid-fraction">Boundary Fluid Fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-fluid-density">Boundary Fluid Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-non-condensable-gas-volume-fractions">Boundary Non-condensable Gas Volume Fractions</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-pressure">Boundary Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-scalar-concentration">Boundary Scalar Concentration</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-sediment-concentration">Boundary Sediment Concentration</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-segregation-solute-mass-concentrations">Boundary Segregation Solute Mass Concentrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-sludge-settling">Boundary Sludge Settling</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-temperature-and-wall-power">Boundary Temperature and Wall Power</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#boundary-wall-power">Boundary Wall Power</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-thermal-properties-and-heat-transfer-coefficients">Boundary Thermal Properties and Heat Transfer Coefficients</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#thermalpropertiesivs">Thermal Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#heat-transfer-coefficients">Heat Transfer Coefficients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-turbulence-and-dissipation">Boundary Turbulence and Dissipation</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-velocity">Boundary Velocity</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#outflow-boundary-options">Outflow Boundary Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#linear-surface-wave-boundary-options">Linear Surface Wave Boundary Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-linear-surface-wave-boundary-options">Non-linear Surface Wave Boundary Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#random-wave-boundary-condition">Random Wave Boundary Condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#rating-curve-and-natural-inlet-boundary-condition">Rating curve and natural inlet boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#boundary-flow-rate">Boundary Flow Rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-boundary-conditions">Active simulation control of boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#wave-absorbing-layer">Wave Absorbing Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#mesh-namelist-mesh">Mesh Namelist - MESH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#mesh-generator">Mesh Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#uniform-mesh-specifications">Uniform Mesh Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#number-of-cells-in-specified-directions">Number of Cells in Specified Directions</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#grid-plane-location">Grid Plane Location</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#grid-location-specifications">Grid Location Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#partially-overlapping-mesh-specifications">Partially Overlapping Mesh Specifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#conforming-mesh-specifications">Conforming Mesh Specifications</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#component-setup-namelist-obs">Component Setup Namelist -  OBS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-general-parameters">Component: General Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#subcomponents-general-parameters">Subcomponents: General Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#subcomponents-limiters">Subcomponents: Limiters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#subcomponents-function-coefficients">Subcomponents: Function Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#subcomponents-transformations">Subcomponents: Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#subcomponents-cooling-channel">Subcomponents: Cooling Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-transformations-parameters">Component Transformations: Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-copy-parameters">Component Copy: Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-contact-angle-and-roughness">Component Properties: Contact Angle and Roughness</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-electrostatic-and-electroosmotic-potential-joule-heating">Component Properties: Electrostatic and Electroosmotic Potential, Joule Heating</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-heat-transfer-coefficients">Component Properties: Heat Transfer Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-lost-foam-casting-model-parameters">Component Properties: Lost Foam Casting Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-contact-time-with-fluid">Component Properties: Contact Time with Fluid</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-spray-cooling-for-thermal-die-cycling">Component Properties: Spray Cooling for thermal die cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-dissolving-components">Component Properties: Dissolving Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-combustible-components">Component Properties: Combustible Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-vents">Component Properties: Vents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-vents">Active simulation control of vents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-mass-sources">Component Properties: Mass Sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-mass-sources">Active simulation control of mass sources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-moisture-drying-model">Component Properties: Moisture Drying Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-fluid-structure-interaction-fsi-model">Component Properties: Fluid-Structure Interaction (FSI) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-thermal-stress-evolution-tse-model">Component Properties: Thermal Stress Evolution (TSE) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-general-moving-objects-gmo">Component Properties: General Moving Objects (GMO)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-general-moving-objects-gmo">Active simulation control of general moving objects (GMO)</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#pq2-analysis">PQ<sup>2</sup> Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-squeeze-pins">Component Properties: Squeeze Pins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-squeeze-pin-activation">Active simulation control of squeeze pin activation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#elastic-springs-ropes-and-mooring-lines">Elastic Springs, Ropes and Mooring Lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-sediment-scour-component-parameters">Component Properties: Sediment Scour Component Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-shallow-water">Component Properties: Shallow Water</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-simple-moving-objects">Component Properties: Simple Moving Objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#moving-web-components">Moving Web Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#spinning-components">Spinning Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#fan-or-impeller-components">Fan or Impeller Components</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#linear-motion-for-continuous-casting">Linear Motion for Continuous Casting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-particles">Component Properties: Particles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#output-sampling-volumes">Output: Sampling Volumes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-deforming-components">Component Properties: Deforming Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#elastic-membrane">Elastic Membrane</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#elastic-wall">Elastic Wall</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-porous-components">Component Properties: Porous Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#capillary-pressure">Capillary Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-temperature-and-power">Component Properties: Temperature and Power</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#tabularpropertyinputivs">Tabular Property Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-thermal-and-heat-transfer">Component Properties: Thermal and Heat Transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-sand-core-gas">Component Properties: Sand Core Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-permeable-mold">Component Properties: Permeable Mold</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-thermal-die-cycling">Component Properties: Thermal Die Cycling</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-wave-absorbing">Component Properties: Wave Absorbing</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#component-properties-shell-mold">Component Properties: Shell Mold</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-namelist-fl">Initial Conditions Namelist - FL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-uniform">Initial Conditions: Uniform</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-general-region-parameters">Initial Conditions: General Region Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-region-values">Initial Conditions: Region Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-region-limiters">Initial Conditions: Region Limiters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-sludge-settling">Initial Conditions: Sludge Settling</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-region-function-coefficients">Initial Conditions: Region Function Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-region-transformations">Initial Conditions: Region Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-pointers">Initial Conditions: Pointers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions">Initial Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#void-properties-heat-transfer">Void Properties / Heat Transfer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#initial-conditions-valves">Initial Conditions: Valves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-valves">Active simulation control of valves</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#deep-water-velocity-for-mooring-line-model">Deep Water Velocity for Mooring Line Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#wind-shear">Wind Shear</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#fluid-droplet-bubble-sources">Fluid Droplet/Bubble Sources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#baffle-namelist-bf">Baffle Namelist - BF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-setup">Baffle Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-properties-heat-transfer-coefficients">Baffle Properties: Heat Transfer Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-properties-porous-properties">Baffle Properties: Porous Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-properties-flux-surfaces">Baffle Properties: Flux Surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-regions-baffle-location">Baffle Regions: Baffle Location</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-regions-function-coefficients">Baffle Regions: Function Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-regions-general-parameters">Baffle Regions: General Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-regions-limiters">Baffle Regions: Limiters</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffle-regions-transformations">Baffle Regions: Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#baffles-general-parameters">Baffles: General Parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-namelist-motn">Non-Inertial Reference Frame Namelist - MOTN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-general-parameters">Non-Inertial Reference Frame: General Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#center-of-rotation">Center of Rotation</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-type">Non-Inertial Reference Frame Type</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#rigid-body-dynamics-force-flag">Rigid Body Dynamics Force Flag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-simple-spin-and-shake-model">Non-Inertial Reference Frame: Simple Spin and Shake Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-gravity-field">Non-Inertial Reference Frame: Gravity Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-sinusoidal-6-degree-of-freedom-model">Non-Inertial Reference Frame: Sinusoidal 6 Degree-of-Freedom Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-tabular-data">Non-Inertial Reference Frame: Tabular Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#tabular-data-conversion-factors">Tabular Data Conversion Factors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-rigid-body-control-forces">Non-Inertial Reference Frame: Rigid Body Control Forces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#radial-oscillator-control-forces-iatype-1">Radial Oscillator Control Forces (IATYPE = 1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#angular-oscillator-control-forces-iatype-2">Angular Oscillator Control Forces (IATYPE = 2)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#non-inertial-reference-frame-geophysical-fluid-flow">Non-Inertial Reference Frame: Geophysical Fluid Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-namelist-grafic">Graphic Output Namelist - GRAFIC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-default-color-flag-and-symmetry-reflections">Graphic Output: Default Color Flag and Symmetry Reflections</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-selected-data">Graphic Output: Selected Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-contour-plots">Graphic Output: Contour Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#variable-specification">Variable Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#plot-specification">Plot Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#data-limits">Data Limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-export-data">Graphic Output: Export Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id5">Variable Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#format-specification">Format Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#index-6643">Data Limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-history-probes">Graphic Output: History Probes</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-iso-surface-plots">Graphic Output: Iso-Surface Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id7">Variable Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id8">Plot Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id9">Data Limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-particle-plots">Graphic Output: Particle Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id10">Variable Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id11">Plot Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id12">Data Limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-pre-processor-geometry-plots">Graphic Output: Pre-processor Geometry Plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-velocity-vector-plots">Graphic Output: Velocity Vector Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id13">Variable Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id14">Plot Specification</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id15">Data Limits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#graphic-output-viewpoint-specification">Graphic Output: Viewpoint Specification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#id16">Variable Specification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#renderspace-namelist-renderspace">Renderspace Namelist - RENDERSPACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#header-namelist-header">Header Namelist - HEADER</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-namelist-parts">Particle Setup Namelist - PARTS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-general-particle-data">Particle Setup: General Particle Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-block-initialized-particles">Particle Setup: Block Initialized Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-source-initialized-particles">Particle Setup: Source Initialized Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-history-particles">Particle Setup: History Particles</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-setup-mass-momentum-sources">Particle Setup: Mass-Momentum Sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="input-variable-summary-units.html#particle-classes">Particle Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#marker-particles">Marker Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#mass-particles">Mass Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#fluid-particles">Fluid Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#gas-particles">Gas Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#void-particles">Void Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#user-particles">User Particles</a></li>
<li class="toctree-l4"><a class="reference internal" href="input-variable-summary-units.html#active-simulation-control-of-mass-momentum-sources">Active simulation control of mass-momentum sources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#spray-cooling-namelist-spray">Spray Cooling Namelist - SPRAY</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-variable-summary-units.html#user-defined-namelist-usrdat">User Defined Namelist - USRDAT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="customization.html">Customization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="customization.html#general-customization-information">General Customization Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#customizing-prod-on-windows">Customizing <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> on Windows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#visual-studio-solution-files-compiling-and-linking">Visual Studio Solution Files: Compiling and Linking</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#building">Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#adding-new-source-files">Adding New Source Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#customizing-prod-on-linux-platforms">Customizing <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> on Linux Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#customizable-source-directory-structure">Customizable Source Directory Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#fortran-include-statements">FORTRAN Include Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#concept-of-sub-domains">Concept of Sub-domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#important-comdeck-files">Important Comdeck Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#subroutines-included-in-distribution">Subroutines Included in Distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#user-customizable-namelist">User Customizable Namelist</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#boundary-conditions">Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#fluid-properties">Fluid Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#general-moving-objects-gmo-model">General Moving Objects (GMO) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#vapor-properties">Vapor Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#cavitation-model">Cavitation Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#component-thermal-properties">Component Thermal Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#component-and-subcomponent-definitions">Component and Subcomponent Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#heat-transfer-coefficients">Heat Transfer Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#mass-transfer-coefficients">Mass Transfer Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#phase-change-mass-flux">Phase Change Mass Flux</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#dynamic-droplet-size-in-two-phase-drift-flux-model">Dynamic Droplet Size in Two-Phase Drift-flux Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#sludge-settling-velocity">Sludge Settling Velocity</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#drag-porous-media-model">Drag/Porous Media Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#bottom-shear-stress-in-shallow-water-model">Bottom Shear Stress in Shallow Water Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#mass-source-model">Mass Source Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#turbulence-models">Turbulence Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#sediment-scour-model">Sediment Scour Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#combustible-object-model">Combustible Object Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#elasto-visco-plastic-fluids">Elasto-visco-plastic Fluids</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#fluid-structure-interaction-fsi-and-thermal-stress-evolution-tse-models">Fluid-structure Interaction (FSI) and Thermal Stress Evolution (TSE) Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#electro-mechanics-model">Electro-mechanics Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#non-inertial-reference-frame-nirf-model">Non-Inertial Reference Frame (NIRF) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#lagrangian-particle-model">Lagrangian Particle Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#special-models">Special Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#important-variables">Important Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#existing-variables">Existing Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#dummy-variables">Dummy Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#user-definable-variables">User Definable Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="customization.html#sample-customizations">Sample Customizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="customization.html#customizing-region-functions-in-the-preprocessor">Customizing Region Functions in the Preprocessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#customizing-boundary-conditions-in-subroutine-bc">Customizing Boundary Conditions in Subroutine BC</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#example-velocity-at-bottom-boundary-as-a-function-of-time-and-space">Example: Velocity at Bottom Boundary as a Function of Time and Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#adding-new-models-at-the-end-of-a-time-cycle">Adding New Models at the End of a Time Cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#example-counting-particle-concentration-in-mesh-cells">Example: Counting Particle Concentration in Mesh Cells</a></li>
<li class="toctree-l3"><a class="reference internal" href="customization.html#user-particles">User Particles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#tools-for-file-conversion-and-checking-stl-quality">Tools for file conversion and checking STL quality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#cad2stl">Cad2Stl</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#qadmesh">qAdmesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#minimagics">MiniMagics</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html#topo2stl">Topo2STL</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#finite-element-mesh-file-format-conversion-with-fsai">Finite Element Mesh File Format Conversion with FSAI</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#calculators">Calculators</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#material-properties-database-mpdb-expansion">Material Properties Database (MPDB) Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html#editing-the-flsgrf-file-with-grfedit">Editing the flsgrf file with grfedit</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Glossary and Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="zbibliography.html">Bibliography</a></li>
</ul>
<p class="caption"><span class="caption-text">License Agreements and Feedback</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="eula.html">End User License Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="eula.html#supplemental-license-agreements">Supplemental License Agreements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="eula.html#exodus-ii-library">EXODUS II Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="eula.html#netcdf-library">NETCDF Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="eula.html#hdf5-library">HDF5 Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="eula.html#curl-library">cURL Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="eula.html#material-properties-by-ken-mills">Material Properties by Ken Mills</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user-feedback.html">User Feedback</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html"><strong><em>FLOW-3D</em></strong> User Manual</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html"><strong><em>FLOW-3D</em></strong> User Manual</a> &raquo;</li>
        
      <li>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="theoryoverviewth"></span><span id="index-0"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is a general-purpose computational fluid dynamics (CFD) software. It
employs specially developed numerical techniques to solve the equations of
motion for fluids to obtain transient, three-dimensional solutions to
multi-scale, multi-physics flow problems. An array of physical and numerical options
allows users to apply <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to a wide variety of fluid flow and heat transfer
phenomena.</p>
<p>Fluid motion is described with non-linear, transient, second-order differential
equations. The fluid equations of motion must be employed to solve these
equations. The science (and often art) of developing these methods is called
<em>computational fluid dynamics</em>. A numerical solution of these equations involves
approximating the various terms with algebraic expressions. The resulting
equations are then solved to yield an approximate solution to the original
problem. The process is called simulation. An outline of the numerical solution
algorithms available in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> follows the section on the equations of motion.</p>
<p>Typically, a numerical model starts with a <em>computational mesh</em>, or <em>grid</em>. It
consists of a number of interconnected elements, or cells. These cells subdivide
the physical space into small volumes with several nodes associated with each
such volume. The nodes are used to store values of the unknowns, such as
pressure, temperature and velocity. The mesh is effectively the numerical space
that replaces the original physical one. It provides the means for defining the
flow parameters at discrete locations, setting boundary conditions and, of
course, for developing numerical approximations of the fluid motion equations.
The <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> approach is to subdivide the flow domain into a grid of rectangular
cells, sometimes called brick elements.</p>
<p>A computational mesh effectively <em>discretizes</em> the physical space. Each fluid
parameter is represented in a mesh by an array of values at discrete points.
Since the actual physical parameters vary continuously in space, a mesh with a
fine spacing between nodes provides a better representation to the reality than
a coarser one. We arrive then at a fundamental property of a numerical
approximation: any valid numerical approximation approaches the original
equations as the grid spacing is reduced. If an approximation does not satisfy
this condition, then it must be deemed incorrect.</p>
<p>Reducing the grid spacing, or <em>refining the mesh</em>, for the same physical space
results in more elements and nodes and, therefore, increases the size of the
numerical model. But apart from the physical reality of fluid flow and heat
transfer, there is also the reality of design cycles, computer hardware and
deadlines, which combine in forcing the simulation engineers to choose a
reasonable size of the mesh. Reaching a compromise between satisfying these
constraints and obtaining accurate solutions by the user is a balancing act that
is a no lesser art than the CFD model development itself.</p>
<p>Rectangular grids are very easy to generate and store because of their regular,
or <em>structured</em>, nature. A non-uniform grid spacing adds flexibility when
meshing complex flow domains. The computational cells are numbered in a
consecutive manner using three indices: <em>i</em> in the x-direction, <em>j</em> in the
y-direction and <em>k</em> in the z-direction. This way each cell in a
three-dimensional mesh can be identified by a unique address (<em>i</em>, <em>j</em>, <em>k</em>),
similar to coordinates of a point in the physical space.</p>
<p>Structured rectangular grids carry additional benefits of the relative ease of
the development of numerical methods, transparency of the latter with respect to
their relationship to the original physical problem and, finally, accuracy and
stability of the numerical solutions. The oldest numerical algorithms based on
the <em>finite difference</em> and <em>finite volume</em> methods have been originally
developed on such meshes. They form the core of the numerical approach in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>.
The finite difference method is based on the properties of the Taylor expansion
and on the straightforward application of the definition of derivatives. It is
the oldest of the methods applied to obtain numerical solutions to differential
equations, and the first application is considered to have been developed by
Euler in 1768. The finite volume method derives directly from the integral form
of the conservation laws for fluid motion and, therefore, naturally possesses
the conservation properties.</p>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be operated in several modes corresponding to different limiting cases
of the general fluid equations. For instance, one mode is for compressible
flows, while another is for purely incompressible flow situations. In the latter
case, the fluid density and energy may be assumed constant and do not need to be
computed. Additionally, there are one fluid and two fluid modes. Free surface
can be included in the one-fluid incompressible mode. These modes of operations
correspond to different choices for the governing equations of motion.</p>
<p>Free surface exists in many simulations carried out with <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. It is
challenging to model free surfaces in any computational environment because flow
parameters and materials properties, such as density, velocity and pressure
experience a discontinuity at it. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the inertia of the gas adjacent to
the liquid is neglected, and the volume occupied by the gas is replaced with an
empty space, void of mass, represented only by uniform pressure and temperature.
This approach has an advantage of reducing the computational effort since in
most cases the details of the gas motion are unimportant for the motion of much
heavier liquid. Free surface becomes one of the liquid’s external boundaries. A
proper definition of the boundary conditions at the free surface is important
for an accurate capture of the free-surface dynamics.</p>
<p>The <em>Volume of Fluid (VOF)</em> method is employed in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> for this purpose. It
consists of three main components: the definition of the volume of fluid
function, a method to solve the VOF transport equation and setting the boundary
conditions at the free surface.</p>
<p>Some physical and numerical models are described in more detail in Flow
Science’s Technical Notes: <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>,
which also include examples.</p>
</div>
<div class="section" id="equations-of-motion">
<span id="equationsofmotionth"></span><span id="index-1"></span><h2>Equations of Motion<a class="headerlink" href="#equations-of-motion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="coordinate-systems">
<span id="coordinatesystemsth"></span><span id="index-2"></span><h3>Coordinate Systems<a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h3>
<p>The differential equations to be solved are written in terms of Cartesian
coordinates (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>). For cylindrical coordinates
(<img class="math" src="_images/math/d77e09b1ac0f59812794adc2b8da7f9a192d32bc.png" alt="r" style="vertical-align: 0px"/>, <img class="math" src="_images/math/3f2fed604982fac0106624a80d0210ef44c1e258.png" alt="\theta" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>) the x-coordinate is interpreted as the
radial direction, the y-coordinate is transformed to the azimuthal coordinate,
<img class="math" src="_images/math/3f2fed604982fac0106624a80d0210ef44c1e258.png" alt="\theta" style="vertical-align: 0px"/>, and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> is the axial coordinate. For cylindrical geometry,
additional terms must be added to the Cartesian equations of motion. These terms
are included with a coefficient <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/>, such that <img class="math" src="_images/math/bc84282e534a7c6b32c9b7a931223eb318d20264.png" alt="\xi = 0" style="vertical-align: -4px"/> corresponds to
Cartesian geometry, while <img class="math" src="_images/math/8d0663c6f0e7ea2c6f95d485fba7075190ebfafe.png" alt="\xi = 1" style="vertical-align: -4px"/> corresponds to cylindrical geometry.</p>
<p>All equations are formulated with area and volume porosity functions. This
formulation, called FAVOR<sup>TM</sup> for Fractional Area/Volume Obstacle Representation
Method <a class="reference internal" href="zbibliography.html#hirt-sicilian-1985" id="id1">[HS85]</a> is used to model complex geometric regions.</p>
<p>For example, zero-volume porosity regions are used to define obstacles, while
area porosities may be used to model thin porous baffles. Porosity functions
also introduce some simplifications in the specification of free-surface and
wall boundary conditions.</p>
<p>Generally, in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, area and volume fractions are time independent. However,
these quantities may vary with time when the moving obstacle model is employed.</p>
</div>
<div class="section" id="mass-continuity-equation-and-its-variations">
<span id="masscontinuityequationth"></span><span id="index-3"></span><h3>Mass Continuity Equation and Its Variations<a class="headerlink" href="#mass-continuity-equation-and-its-variations" title="Permalink to this headline">¶</a></h3>
<p>The general mass continuity equation is:</p>
<div class="math" id="equation-generalmasscontinuityequation">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-generalmasscontinuityequation" title="Permalink to this equation">¶</a></span><img src="_images/math/7eabb141ae2f6c464fbd7dcd03ddc9bc40f1f2a7.png" alt="{V_F}\frac{\partial \rho }{\partial t} + \frac{\partial }{\partial x}(\rho u{A_x}) + R\frac{\partial }{\partial y}(\rho v{A_y}) + \frac{\partial }{\partial z}(\rho w{A_z}) + \xi \frac{\rho u{A_x}}{x} = {R_{\rm{DIF}}} + {R_{\rm{SOR}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/2618d92ec29b4b2156fc2251e70e6459ddf41c2d.png" alt="V_F" style="vertical-align: -3px"/> is the fractional volume open to flow,</li>
<li><img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the fluid density,</li>
<li><img class="math" src="_images/math/296986853c45e4164ff907d1f178da9e496153dc.png" alt="R_{\rm{DIF}}" style="vertical-align: -3px"/> is a turbulent diffusion term, and</li>
<li><img class="math" src="_images/math/d84972fae0fa0caba3629f23a2c9dba1ec693948.png" alt="R_{\rm{SOR}}" style="vertical-align: -3px"/> is a mass source.</li>
</ul>
<p>The velocity components (<img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>, <img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/>, <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>) are in the
coordinate directions (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>) or (<img class="math" src="_images/math/d77e09b1ac0f59812794adc2b8da7f9a192d32bc.png" alt="r" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/d84972fae0fa0caba3629f23a2c9dba1ec693948.png" alt="R_{\rm{SOR}}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>). <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/> is the fractional area open to
flow in the x-direction, <img class="math" src="_images/math/8adf1860c3314cce8ae4bd9d6e57e19bf0ffd1de.png" alt="A_y" style="vertical-align: -6px"/> and <img class="math" src="_images/math/2e6a1ee0ee3e238e36573fb81bfaaaeaa81ff9cc.png" alt="A_z" style="vertical-align: -3px"/> are similar area
fractions for flow in the <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> directions, respectively.
The coefficient <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> depends on the choice of coordinate system in the
following way. When cylindrical coordinates are used, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> derivatives
must be converted to azimuthal derivatives,</p>
<div class="math" id="equation-azimuthalderivatives">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-azimuthalderivatives" title="Permalink to this equation">¶</a></span><img src="_images/math/1a73b786a4046c9708129ae91e5ddad1c19ad3af.png" alt="\frac{\partial }{\partial y} \to \frac{1}{r}\frac{\partial }{\partial \theta }"/></p>
</div><p>This transformation is accomplished by using the equivalent form</p>
<div class="math" id="equation-azimuthalderivativesequivalentform">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-azimuthalderivativesequivalentform" title="Permalink to this equation">¶</a></span><img src="_images/math/3f5003d8dbcd03faee6211e612bc4d430e6f4378.png" alt="\frac{1}{r}\frac{\partial }{\partial \theta } = \frac{r_m}{r}\frac{\partial }{\partial y}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/94a7ccc85066dd3a8fd053cd3f3f07d22a8c7811.png" alt="y = {r_m}\theta" style="vertical-align: -4px"/> and</li>
<li><img class="math" src="_images/math/11fac034c2b3e24306be4bfa6db7511b66fad02d.png" alt="r_m" style="vertical-align: -3px"/> is a fixed reference radius.</li>
</ul>
<p>The transformation given by Eq. <a class="reference internal" href="#equation-azimuthalderivativesequivalentform">(3)</a> is
particularly convenient because its implementation only requires the multiplier
<img class="math" src="_images/math/3bdb3ae3ff9bbcf17add831027d4569a3c5fde80.png" alt="R = {r_m}/r" style="vertical-align: -5px"/> on each <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> derivative in the original Cartesian
coordinate equations. When Cartesian coordinates are to be used, <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> is
set to unity and <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/> is set to zero.</p>
<p>The first term on the right side of Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>, is
a turbulent diffusion term,</p>
<div class="math" id="equation-turbulentdiffusionterm">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-turbulentdiffusionterm" title="Permalink to this equation">¶</a></span><img src="_images/math/00c4dfd115074d24061f5fbfcae0d17213af11ce.png" alt="{R_{\rm{DIF}}} = \frac{\partial }{\partial x}\left( {{\upsilon _\rho }{A_x}\frac{\partial \rho }{\partial x}} \right) + R\frac{\partial }{\partial y}\left( {{\upsilon _\rho }{A_y}R\frac{\partial \rho }{\partial y}} \right) + \frac{\partial }{\partial z}\left( {{\upsilon _\rho }{A_z}\frac{\partial \rho }{\partial z}} \right) + \xi \frac{{\upsilon _\rho }{A_x}}{x} \frac{\partial \rho }{\partial x}"/></p>
</div><p>where:</p>
<ul class="simple">
<li>the coefficient <img class="math" src="_images/math/4d170321278def5ad622b9671e531a035a640d7f.png" alt="{\upsilon _\rho }" style="vertical-align: -6px"/> is equal to <img class="math" src="_images/math/7c31162148c7ce6eed6384a8faf026d0a907b29e.png" alt="S_c" style="vertical-align: -3px"/> <img class="math" src="_images/math/579b9862e0205830f0b7d51fdcc9520aeaed3a6e.png" alt="\mu /\rho" style="vertical-align: -5px"/>, in which <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> is the coefficient of momentum diffusion (i.e., the viscosity) and</li>
<li><img class="math" src="_images/math/7c31162148c7ce6eed6384a8faf026d0a907b29e.png" alt="S_c" style="vertical-align: -3px"/> is a constant whose reciprocal is usually referred to as the turbulent Schmidt number.</li>
<li>This type of mass diffusion only makes sense for turbulent mixing processes in fluids having a non-uniform density.</li>
</ul>
<p>The last term, <img class="math" src="_images/math/4aefc4d923c405e9f6bc4af17c74be687a489212.png" alt="R_{SOR}" style="vertical-align: -3px"/>, on the right side of Eq.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a> is a density source term that can be used,
for example, to model mass injection through porous obstacle surfaces.</p>
<p>Compressible flow problems require solution of the full density transport
equation as stated in Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>. For
incompressible fluids, <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is a constant and Eq.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a> reduces to the incompressibility condition</p>
<div class="math" id="equation-impressibilitycondition">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-impressibilitycondition" title="Permalink to this equation">¶</a></span><img src="_images/math/3b463b99a0dc388977afa08cb8a74f0ec1706f8d.png" alt="\frac{\partial }{\partial x}(u{A_x}) + R\frac{\partial }{\partial y}(v{A_y}) + \frac{\partial }{\partial z}(w{A_z}) + \xi \frac{u{A_x}}{x} = \frac{R_{\rm{SOR}}}{\rho }"/></p>
</div><p>For problems in which the propagation of acoustic pressure waves is important,
but the fluid may otherwise be treated as incompressible, the density time
derivative is approximated by</p>
<div class="math" id="equation-densitytimederivative">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-densitytimederivative" title="Permalink to this equation">¶</a></span><img src="_images/math/78a0b843d1743a34887386146946e2d1b6d70b2c.png" alt="\frac{\partial \rho }{\partial t} \approx \frac{1}{c^2}\frac{\partial p}{\partial t}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/e96d625a818b3cf2924b9beb9689153fba8786c6.png" alt="c^2" style="vertical-align: 0px"/> is the square of the sound speed and</li>
<li><img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is the pressure.</li>
</ul>
<p>This approximation is valid in the range</p>
<div class="math" id="equation-rangefordensitytimederivative">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-rangefordensitytimederivative" title="Permalink to this equation">¶</a></span><img src="_images/math/a1304a48b8ed39e5bcea371ae1163673511f8c87.png" alt="\left| {\frac{\delta \rho }{\rho }} \right| &lt; 0.1 ."/></p>
</div><p>With this approximation the modified continuity equation then becomes</p>
<div class="math" id="equation-modifiedcontinuityequation">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-modifiedcontinuityequation" title="Permalink to this equation">¶</a></span><img src="_images/math/c251dbaddf7a31285134e9c6df590d829fbbb38d.png" alt="\frac{V_F}{\rho {c^2}}\frac{\partial p}{\partial t} + \frac{\partial u{A_x}}{\partial x} + R\frac{\partial v{A_y}}{\partial y} + \frac{\partial w{A_z}}{\partial z} + \xi \frac{u{A_x}}{x} = \frac{R_{\rm{SOR}}}{\rho }"/></p>
</div></div>
<div class="section" id="momentum-equations">
<span id="momentumequationsth"></span><span id="index-4"></span><h3>Momentum Equations<a class="headerlink" href="#momentum-equations" title="Permalink to this headline">¶</a></h3>
<p>The equations of motion for the fluid velocity components (<img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/>, <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>) in the three coordinate directions are the Navier-Stokes
equations with some additional terms</p>
<div class="math" id="equation-momentumconservation">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-momentumconservation" title="Permalink to this equation">¶</a></span><img src="_images/math/28f08b02fdc7504e5305b6da572a54418f44f274.png" alt="\begin{gathered}
\frac{\partial u}{\partial t} + \frac{1}{V_F}\left\{ {u{A_x}\frac{\partial u}{\partial x} + v{A_y}R\frac{\partial u}{\partial y} + w{A_z}\frac{\partial u}{\partial z}} \right\} - \xi \frac{{A_y}{v^2}}{x{V_F}} =  - \frac{1}{\rho }\frac{\partial p}{\partial x} + {G_x} + {f_x} - {b_x} - \frac{R_{\rm{SOR}}}{\rho {V_F}}(u - {u_w} - \delta {u_s}) \hfill \\
\frac{\partial v}{\partial t} + \frac{1}{V_F}\left\{ {u{A_x}\frac{\partial v}{\partial x} + v{A_y}R\frac{\partial v}{\partial y} + w{A_z}\frac{\partial v}{\partial z}} \right\} + \xi \frac{{A_y}uv}{x{V_F}} =  - \frac{1}{\rho }\left( {R\frac{\partial p}{\partial y}} \right) + {G_y} + {f_y} - {b_y} - \frac{R_{\rm{SOR}}}{\rho {V_F}}(v - {v_w} - \delta {v_s}) \hfill \\
\frac{\partial w}{\partial t} + \frac{1}{V_F}\left\{ {u{A_x}\frac{\partial w}{\partial x} + v{A_y}R\frac{\partial w}{\partial y} + w{A_z}\frac{\partial w}{\partial z}} \right\} =  - \frac{1}{\rho }\frac{\partial p}{\partial z} + {G_z} + {f_z} - {b_z} - \frac{R_{\rm{SOR}}}{\rho {V_F}}(w - {w_w} - \delta {w_s}) \hfill \\
\end{gathered}"/></p>
</div><p>In these equations:</p>
<ul class="simple">
<li>(<img class="math" src="_images/math/89cf2b2e24d6998cf2ebf3bdf662a789df3e59ca.png" alt="G_x" style="vertical-align: -3px"/>, <img class="math" src="_images/math/bafce695e0f6a2c16b0ce6b0804c3b4862aa7fea.png" alt="G_y" style="vertical-align: -6px"/>, <img class="math" src="_images/math/060025498afbb6b7c47c6a7c670a74da7a48a95c.png" alt="G_z" style="vertical-align: -3px"/>) are body accelerations,</li>
<li>(<img class="math" src="_images/math/aa7bb4ba48c837bd0c09129ff2fa35fb2e83755f.png" alt="f_x" style="vertical-align: -4px"/>, <img class="math" src="_images/math/569ab83aa4088ae75f450cc65d4008055ee42cfb.png" alt="f_y" style="vertical-align: -6px"/>, <img class="math" src="_images/math/e455978dcc63477e4073b933063622e49a736b06.png" alt="f_z" style="vertical-align: -4px"/>) are viscous accelerations,</li>
<li>(<img class="math" src="_images/math/982b1a828b735670bffab1299fb029ea162c6daa.png" alt="b_x" style="vertical-align: -3px"/>, <img class="math" src="_images/math/4add02e222e609f8089ecec1bf13f621837abc53.png" alt="b_y" style="vertical-align: -6px"/>, <img class="math" src="_images/math/9f888f6edf11712ae9dc5a272202819f15f573aa.png" alt="b_z" style="vertical-align: -3px"/>) are flow losses in porous media or across porous baffle plates, and the final terms account for the injection of mass at a source represented by a geometry component.</li>
</ul>
<p>The term <img class="math" src="_images/math/85647c42885943335f8548fb9d149aa203fa3173.png" alt="{\mathbf{U}}_w = \left( {{u_w}, {v_w}, {w_w}} \right)" style="vertical-align: -5px"/> in Eq.
<a class="reference internal" href="#equation-momentumconservation">(9)</a> is the velocity of the source component, which will
generally be non-zero for a mass source at a <a class="reference internal" href="#gmomodelth"><span class="std std-ref">General Moving Objects Model</span></a>.</p>
<p>The term <img class="math" src="_images/math/29a827283a7f22439ba518162f75d581b83297bf.png" alt="{\mathbf{U}}_s = \left( {{u_s},{v_s},{w_s}} \right)" style="vertical-align: -5px"/> is
the velocity of the fluid at the surface of the source relative to the source
itself. It is computed in each control volume as</p>
<div class="math" id="equation-masssources">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-masssources" title="Permalink to this equation">¶</a></span><img src="_images/math/316c1e6c41ce7f89e8ee7b4f6474c6c83ed14eff.png" alt="{\mathbf{U}_s} = \frac{dQ}{{\rho _Q}dA}\mathbf{n}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/cbc918c7e6f9653db23cacce0e153d228494aa29.png" alt="dQ" style="vertical-align: -4px"/> is the mass flow rate,</li>
<li><img class="math" src="_images/math/df92a8d26171ae89bd043a63caf972509d1f7377.png" alt="{\rho _Q}" style="vertical-align: -6px"/> is the fluid source density,</li>
<li><img class="math" src="_images/math/a69647592ac940ec9af8354c7d37812f127bc52b.png" alt="dA" style="vertical-align: 0px"/> is the area of the source surface in the cell and</li>
<li><img class="math" src="_images/math/54c90b60c0e2e2783289133a9e2fb8251f2ccd63.png" alt="{\mathbf{n}}" style="vertical-align: 0px"/> the outward normal to the surface. When <img class="math" src="_images/math/95bf750766dc25a2eb889132e2b252082e2b1e30.png" alt="\delta = 0.0" style="vertical-align: 0px"/> in Eq. <a class="reference internal" href="#equation-momentumconservation">(9)</a> the source is of the <em>stagnation pressure</em> type. If <img class="math" src="_images/math/775a99c7c70bab7cc5d98343de50bd540ef24b18.png" alt="\delta = 1.0" style="vertical-align: 0px"/>, the source is of the <em>static pressure</em> type.</li>
</ul>
<p>At a stagnation pressure source, fluid is assumed to enter the domain at zero
velocity. As a result, pressure must build up at the source to move the fluid
away from the source. Such sources are designed to model fluid emerging at the
end of a rocket or a deflating balloon. In general, stagnation pressure sources
apply to cases when the momentum of the emerging fluid is created <em>inside</em> the
source component, like in a rocket engine.</p>
<p>At a static pressure source the fluid velocity is computed from the mass flow
rate and the surface area of the source. In this case, no extra pressure is
required to propel the fluid away from the source. An example of such source is
fluid emerging from a long straight pipe.  Note that in this case the fluid
momentum is created far from where the source is located.
The distinction between those two types of mass sources is important when the
force acting from the fluid on the source component must be computed accurately.
This is the case with coupled-motion <a class="reference internal" href="#gmomodelth"><span class="std std-ref">GMO components</span></a>. Note
that the static or stagnation pressure property does not apply to negative mass
source, i.e., sinks.</p>
<p>For a variable dynamic viscosity <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>, the viscous accelerations are</p>
<div class="math" id="equation-viscousaccelerations">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-viscousaccelerations" title="Permalink to this equation">¶</a></span><img src="_images/math/3e3905fcc84d96b29867ece337e4fb41b8552ed9.png" alt="\begin{gathered}
\rho {V_F}{f_x} = wsx - \left\{ {\frac{\partial }{\partial x}\left( {A_x}{\tau _{xx}} \right) + R\frac{\partial }{\partial y}\left( {A_y}{\tau _{xy}} \right) + \frac{\partial }{\partial z}\left( {A_z}{\tau _{xz}} \right) + \frac{\xi }{x}\left( {A_x}{\tau _{xx}} - {A_y}{\tau _{yy}} \right)} \right\} \hfill \\
\rho {V_F}{f_y} = wsy - \left\{ {\frac{\partial }{{\partial x}}\left( {A_x}{\tau _{xy}} \right) + R\frac{\partial }{\partial y}\left( {A_y}{\tau _{yy}} \right) + \frac{\partial }{\partial z}\left( {A_z}{\tau _{yz}} \right) + \frac{\xi }{x}\left( {A_x} + {A_y} \right) {\tau _{xy}}} \right\} \hfill \\
\rho {V_F}{f_z} = wsz - \left\{ {\frac{\partial }{\partial x}\left( {A_x}{\tau _{xz}} \right) + R\frac{\partial }{\partial y}\left( {A_y}{\tau _{yz}} \right) + \frac{\partial }{\partial z}\left( {A_z}{\tau _{zz}} \right) + \frac{\xi }{x}\left( {A_x}{\tau _{xz}} \right)} \right\} \hfill \\
\end{gathered}"/></p>
</div><p>where</p>
<div class="math" id="equation-viscousstress">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-viscousstress" title="Permalink to this equation">¶</a></span><img src="_images/math/6dd467453e91f11a6971761a6fb7579a768ab826.png" alt="\begin{gathered}
{\tau _{xx}} =  - 2\mu \left\{ {\frac{\partial u}{\partial x} - \frac{1}{3}\left( {\frac{\partial u}{\partial x} + R\frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} + \frac{\xi u}{x}} \right)} \right\} \hfill \\
{\tau _{yy}} =  - 2\mu \left\{ {R\frac{\partial v}{\partial y} + \xi \frac{u}{x} - \frac{1}{3}\left( {\frac{\partial u}{\partial x} + R\frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} + \frac{\xi u}{x}} \right)} \right\} \hfill \\
{\tau _{zz}} =  - 2\mu \left\{ {\frac{\partial w}{\partial z} - \frac{1}{3}\left( {\frac{\partial u}{\partial x} + R\frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} + \frac{\xi u}{x}} \right)} \right\} \hfill \\
{\tau _{xy}} =  - \mu \left\{ {\frac{\partial v}{\partial x} + R\frac{\partial u}{\partial y} - \frac{\xi v}{x}} \right\} \hfill \\
{\tau _{xz}} =  - \mu \left\{ {\frac{\partial u}{\partial z} + \frac{\partial w}{\partial x}} \right\} \hfill \\
{\tau _{yz}} =  - \mu \left\{ {\frac{\partial v}{\partial z} + R\frac{\partial w}{\partial y}} \right\} \hfill \\
\end{gathered}"/></p>
</div><div class="section" id="wall-shear-stress">
<span id="wallshearstressth"></span><span id="index-5"></span><h4>Wall-Shear Stress<a class="headerlink" href="#wall-shear-stress" title="Permalink to this headline">¶</a></h4>
<p>In the above expressions, the terms <img class="math" src="_images/math/99cd56a8356ba25401a26a2f5eb1146933ec6560.png" alt="wsx" style="vertical-align: 0px"/>, <img class="math" src="_images/math/a9a5040d5bedf699e141d9616643cccbcc80814e.png" alt="wsy" style="vertical-align: -4px"/> and <img class="math" src="_images/math/67c237c41f1feaa7fe3900af4ddb6f3f11f74b26.png" alt="wsz" style="vertical-align: 0px"/> are
wall shear stresses. If these terms are omitted, there is no wall shear stress
because the remaining terms contain the fractional flow areas (<img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/>,
<img class="math" src="_images/math/8adf1860c3314cce8ae4bd9d6e57e19bf0ffd1de.png" alt="A_y" style="vertical-align: -6px"/>, <img class="math" src="_images/math/2e6a1ee0ee3e238e36573fb81bfaaaeaa81ff9cc.png" alt="A_z" style="vertical-align: -3px"/>) which vanish at walls. The wall stresses are modeled
by assuming a zero tangential velocity on the portion of any area closed to
flow. Mesh and moving obstacle boundaries are an exception because they can be
assigned non-zero tangential velocities. In this case, the allowed boundary
motion corresponds to a rigid body translation of the boundary parallel to its
surface. For turbulent flows, a law-of-the-wall velocity profile is assumed near
the wall, which modifies the wall shear stress magnitude. These details are more
fully explained in <a class="reference internal" href="#turbulencemodelsth"><span class="std std-ref">Turbulence Models</span></a>.</p>
</div>
<div class="section" id="viscosity-evaluation">
<span id="viscosityevaluationth"></span><span id="nonnewtonianflth"></span><span id="index-6"></span><h4>Viscosity Evaluation<a class="headerlink" href="#viscosity-evaluation" title="Permalink to this headline">¶</a></h4>
<p>The dynamic viscosity, <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>, can be assigned constant molecular values for each
fluid in a one or two fluid problem. In mesh cells containing a mixture, the
viscosity is evaluated as a volume fraction weighted average of the constant
values. In the single-fluid model the fluid can consist of two components, each
with its own constant density and viscosity. In this case, the mixture fluid
viscosity is evaluated as a volume fraction weighted average of the two
constants. Furthermore, fluid viscosity can be a function of solid fraction for
partially solidified fluids (see <a class="reference internal" href="#solidifictiondragmodelth"><span class="std std-ref">Solidification</span></a>).</p>
<p>When the turbulence option is used, the viscosity is a sum of the molecular and
turbulent values. For non-Newtonian fluids the viscosity can be a function of
the strain rate and/or temperature. A generic expression based on the “Carreau”
model is used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> for the strain rate-dependent viscosity:</p>
<div class="math" id="equation-strainratedependentviscositycarreau">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-strainratedependentviscositycarreau" title="Permalink to this equation">¶</a></span><img src="_images/math/6fd4c35273bcc0bc6173e1e699d233c77d1c6040.png" alt="\mu  = {\mu _\infty } + \frac{{{\mu _0}{E_T} - {\mu _\infty }}}{{{\lambda _{00}} + {{\left[ {{\lambda _0} + \frac{1}{2}{{({\lambda _1}{E_T})}^2}{e_{ij}}{e_{ij}}} \right]}^{\frac{{1 - n}}{2}}}}} + \frac{{{\lambda _2}}}{{\sqrt {\frac{1}{2}{e_{ij}}{e_{ij}}} }}"/></p>
</div><p>where</p>
<div class="math" id="equation-fluidstrainrateincartesiantensornotation">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-fluidstrainrateincartesiantensornotation" title="Permalink to this equation">¶</a></span><img src="_images/math/86a98bab4a863162fddaadce1287cfd95773c108.png" alt="{e_{ij}} = \frac{1}{2}\left( {\frac{{\partial {u_i}}}{{\partial {x_j}}} + \frac{{\partial {u_j}}}{{\partial {x_i}}}} \right)"/></p>
</div><div class="math" id="equation-viscosityevaluation3">
<p><span class="eqno">(15)<a class="headerlink" href="#equation-viscosityevaluation3" title="Permalink to this equation">¶</a></span><img src="_images/math/355b811b71005b7659953478153d0c5e06113b20.png" alt="{E_T} = \exp \left[ {a\left( {\frac{T^*}{T - b} - c} \right)} \right]"/></p>
</div><p>and:</p>
<ul class="simple">
<li><img class="math" src="_images/math/41ff1f6ba3e53f880b91869fbdf905f448c59e9e.png" alt="{e_{ij}}" style="vertical-align: -6px"/> is the fluid strain rate in Cartesian tensor notation</li>
<li><img class="math" src="_images/math/eeff78f81fae5de77709dc5368cb65ef28152720.png" alt="{\mu _\infty }" style="vertical-align: -4px"/>, <img class="math" src="_images/math/6ea6a960195b7af618f4524a35d574e7ce08e5d8.png" alt="{\mu _0}" style="vertical-align: -4px"/>, <img class="math" src="_images/math/d796a2993fda25520ed640071cb1f15aaa5ec08c.png" alt="{\lambda _{00}}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/9a1ca0d527da4e36b9d9e0ea9b487f41da6e84e9.png" alt="{\lambda _0}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/843c8b8f803da16b6bef816e3e0ed12385c43907.png" alt="{\lambda _1}" style="vertical-align: -3px"/>,
<img class="math" src="_images/math/dd380f4c8d3df988db88d0863217a5af0e2aae36.png" alt="{\lambda_2}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>, <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/>, <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/>, and <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> are constants.</li>
<li><img class="math" src="_images/math/1c88c6f2e04776c5ed216385a3cecae5b6b5936a.png" alt="T^*" style="vertical-align: 0px"/> is a reference temperature.</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the fluid temperature.</li>
</ul>
<p>Expressions given by Eq. <a class="reference internal" href="#equation-strainratedependentviscositycarreau">(13)</a> and Eq.
<a class="reference internal" href="#equation-viscosityevaluation3">(15)</a> can be specified using input variables according to
the following correspondence table.  Note that <img class="math" src="_images/math/1c88c6f2e04776c5ed216385a3cecae5b6b5936a.png" alt="T^*" style="vertical-align: 0px"/> and the constant <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> have dimensions of a
temperature. Also, a temperature-dependent viscosity can be defined even when there
is no shear dependence.</p>
<table border="1" class="colwidths-given longtable docutils" id="nonnewtonianviscosityinput">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><img class="math" src="_images/math/6ea6a960195b7af618f4524a35d574e7ce08e5d8.png" alt="{\mu _0}" style="vertical-align: -4px"/> = <span class="target" id="index-7"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MU1</span></code></td>
<td>a = <span class="target" id="index-8"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUTMP1</span></code></td>
<td><img class="math" src="_images/math/d796a2993fda25520ed640071cb1f15aaa5ec08c.png" alt="{\lambda _{00}}" style="vertical-align: -3px"/> = <span class="target" id="index-9"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC00</span></code></td>
<td>T* = <span class="target" id="index-10"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TSTAR</span></code></td>
</tr>
<tr class="row-even"><td><img class="math" src="_images/math/eeff78f81fae5de77709dc5368cb65ef28152720.png" alt="{\mu _\infty }" style="vertical-align: -4px"/> = <span class="target" id="index-11"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC3</span></code></td>
<td>b = <span class="target" id="index-12"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUTMP2</span></code></td>
<td><img class="math" src="_images/math/9a1ca0d527da4e36b9d9e0ea9b487f41da6e84e9.png" alt="{\lambda _0}" style="vertical-align: -3px"/> = <span class="target" id="index-13"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC0</span></code></td>
<td>n = <span class="target" id="index-14"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC2</span></code></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>c = <span class="target" id="index-15"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUTMP3</span></code></td>
<td><img class="math" src="_images/math/843c8b8f803da16b6bef816e3e0ed12385c43907.png" alt="{\lambda _1}" style="vertical-align: -3px"/> = <span class="target" id="index-16"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC1</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><img class="math" src="_images/math/a347184b5098dd0a1219f0867c1b7339ad42c4a8.png" alt="{\lambda _2}" style="vertical-align: -3px"/> = <span class="target" id="index-17"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MUC4</span></code></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>For strain-rate-dependent viscosity, the primary variable is the strain rate magnitude, defined
as <img class="math" src="_images/math/dacb75fa66e051b6794d3e24bc7707fb83a3828d.png" alt="\|{e_{ij}}\| = \sqrt{\frac{1}{2}{e_{ij}}{e_{ij}}}" style="vertical-align: -11px"/>. The same variable is output during simulation
as the <span class="guilabel">Strain rate magnitude</span>.
Also, if the viscosity, <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>, is zero, no viscous stresses are computed. Furthermore,
wall shear stress evaluation may be turned off by the user in the input data
file (see <span class="target" id="index-18"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IWSH</span></code> in <a class="reference internal" href="input-variable-summary-units.html#turbulenceandviscousoptions"><span class="std std-ref">Turbulence and Viscous Options</span></a>).</p>
<p>Because the viscosity is evaluated in a separate subroutine (<strong class="program">mucal</strong>), the user
should find it relatively easy to customize other <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> non-Newtonian and
temperature-dependent viscosity models.</p>
</div>
<div class="section" id="baffle-flow-losses">
<span id="baffleflowlossesth"></span><span id="index-19"></span><h4>Baffle Flow Losses<a class="headerlink" href="#baffle-flow-losses" title="Permalink to this headline">¶</a></h4>
<p>Flow losses across porous baffle plates have the form (e.g., in the
x-direction),</p>
<div class="math" id="equation-baffleflowlosseseq1">
<p><span class="eqno">(16)<a class="headerlink" href="#equation-baffleflowlosseseq1" title="Permalink to this equation">¶</a></span><img src="_images/math/a60dd39440ae049f720adfddf68591c922497150.png" alt="{b_x} = \frac{1}{L}({\rm{KBAF1}} \cdot u + 0.5 \cdot {\rm{KBAF2}} \cdot u\left| {\left. u \right|)} \right."/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-20"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">KBAF1</span></code> is an input constant having dimensions of velocity</li>
<li><span class="target" id="index-21"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">KBAF2</span></code> is a dimensionless input constant</li>
<li><span class="target" id="index-22"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PBAF</span></code> is the porosity of the baffle</li>
<li><img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> is the length over which the loss occurs</li>
<li><img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is the microscopic fluid velocity inside the porous baffle</li>
</ul>
<p>It is important to distinguish between the microscopic velocity
(<img class="math" src="_images/math/1e8f9471f84d76f8b55a9ba42cfbcf1cca443a51.png" alt="{\mathbf{u}_{\text{microscopic}}}" style="vertical-align: -6px"/>) and the bulk velocity
(<img class="math" src="_images/math/40d5e959b12bacfc9196b5bfb04f43f814060139.png" alt="{\mathbf{u}_{\text{bulk}}}" style="vertical-align: -3px"/>), which are related as
<img class="math" src="_images/math/9b8c630180570f5816ac883d3f31676ab302e89b.png" alt="\mathbf{u}_{\text{microscopic}} = \frac{ \mathbf{u}_{\text{bulk}} }{\rm{PBAF}}" style="vertical-align: -6px"/>.
The microscopic velocity is the one computed in the flow Eqs.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a> and <a class="reference internal" href="#equation-momentumconservation">(9)</a>, and
displayed on 2D and 3D plots.</p>
<p>The length <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> is set equal to the distance between pressure values
located on either side of the baffle. At constant flow speed, <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>, this
form ensures a fixed pressure drop, <img class="math" src="_images/math/afdd4db1e21a66fc5bbaa1e5b1105235e99c1844.png" alt="\Delta p" style="vertical-align: -4px"/>, across the baffle
independent of mesh spacing:</p>
<div class="math" id="equation-baffleflowlosseseq2">
<p><span class="eqno">(17)<a class="headerlink" href="#equation-baffleflowlosseseq2" title="Permalink to this equation">¶</a></span><img src="_images/math/e3e297253b66498f4ff2d5fba96b98dd2dbbc019.png" alt="\Delta p = \rho  \cdot \left( {{\rm{KBAF1}} \cdot u + 0.5 \cdot {\rm{KBAF2}} \cdot u\left| u \right|} \right)"/></p>
</div><p>The <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> direction losses are defined in a similar manner
with the velocity and length in the corresponding direction. If <span class="target" id="index-23"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">KBAF1</span></code>
and <span class="target" id="index-24"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">KBAF2</span></code> are zero, no flow loss calculations are performed.</p>
<span class="target" id="index-25"></span></div>
<div class="section" id="non-inertial-reference-frame-motion">
<span id="noninertialreferenceframeth"></span><span id="index-26"></span><h4>Non-Inertial Reference Frame Motion<a class="headerlink" href="#non-inertial-reference-frame-motion" title="Permalink to this headline">¶</a></h4>
<p>For applications to fluid sloshing in moving or spinning containers, for example, it is
useful to modify the equations of motion to have a formulation for general
non-inertial accelerations. The form of such accelerations on a fluid element at <img class="math" src="_images/math/d77e09b1ac0f59812794adc2b8da7f9a192d32bc.png" alt="r" style="vertical-align: 0px"/>
and moving with velocity <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is</p>
<div class="math" id="equation-totalacceleration">
<p><span class="eqno">(18)<a class="headerlink" href="#equation-totalacceleration" title="Permalink to this equation">¶</a></span><img src="_images/math/301162ede7d7267393d5f146d0399d5bbba3d600.png" alt="\mathbf{G} = \mathbf{g} - \left\{ \mathbf{ \dot U + \dot \Omega \times ( r - R) + 2 \Omega \times u + \Omega \times \left[  \Omega \times ( r - R) \right] } \right\}"/></p>
</div><p>In this expression <img class="math" src="_images/math/649d529d718bc6af1e8de2faa5cf2a656a0ff5ec.png" alt="\mathbf g" style="vertical-align: -4px"/> is a constant gravitational acceleration
and <img class="math" src="_images/math/6f0dcec5bb4823c3ce1a1e2d0241ddebfbb86f9c.png" alt="\mathbf {\dot U}" style="vertical-align: 0px"/> is the translational acceleration of point
<img class="math" src="_images/math/308056519f0395537ce2b595d1927bf91f51075d.png" alt="\mathbf R" style="vertical-align: 0px"/> in the mesh coordinate system with respect to an inertial
reference frame <a class="reference internal" href="zbibliography.html#batchelor-1983" id="id2">[Bat83]</a>. Eq. <a class="reference internal" href="#equation-totalacceleration">(18)</a> is easily</p>
<p>derived from Eq. 3.2.9 in  <a class="reference internal" href="zbibliography.html#batchelor-1983" id="id3">[Bat83]</a> by a translation of origins.</p>
<p>Inclusion of the vector <img class="math" src="_images/math/308056519f0395537ce2b595d1927bf91f51075d.png" alt="\mathbf R" style="vertical-align: 0px"/> is useful in applications to rigid
bodies where <img class="math" src="_images/math/308056519f0395537ce2b595d1927bf91f51075d.png" alt="\mathbf R" style="vertical-align: 0px"/> is often chosen to be the center of mass of the
body. If this choice is made and no external forces act on the system, then
<img class="math" src="_images/math/fe191a2cfa17bfd5b8c411b6e08ea4da627cf3c3.png" alt="\mathbf {\dot U} = 0" style="vertical-align: 0px"/>. Often the origin of the body-fixed (mesh)
coordinate system is at the center of gravity, in which case <img class="math" src="_images/math/19b09f610cff458db28bd6390f5b207aacb9942d.png" alt="\mathbf {R}
= 0" style="vertical-align: 0px"/>. The user can specify constant gravitational accelerations through the
<img class="math" src="_images/math/649d529d718bc6af1e8de2faa5cf2a656a0ff5ec.png" alt="\mathbf g" style="vertical-align: -4px"/> term or time-dependent translational accelerations through the
<img class="math" src="_images/math/6f0dcec5bb4823c3ce1a1e2d0241ddebfbb86f9c.png" alt="\mathbf {\dot U}" style="vertical-align: 0px"/> term.</p>
<p>To use this last option, or for more general accelerations, the user must
specify the quantities <img class="math" src="_images/math/6f0dcec5bb4823c3ce1a1e2d0241ddebfbb86f9c.png" alt="\mathbf {\dot U}" style="vertical-align: 0px"/>, <img class="math" src="_images/math/6d4d4c0de63289346405f105b86ef7c8738722c2.png" alt="\mathbf \Omega" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/f49887fb50f54873fa568dc1f3f0073792d697b3.png" alt="\mathbf {\dot \Omega}" style="vertical-align: 0px"/> in the subroutine reserved for this purpose
(<strong class="program">motion</strong>). Furthermore, these quantities must be expressed in terms of the mesh
coordinate system (i.e., body-fixed system). They are always specified in
Cartesian coordinates regardless of whether Cartesian or cylindrical mesh
coordinates are used. For cylindrical coordinates, the accelerations are
automatically transformed to the proper local components. The components of the
local accelerations experienced by the fluid are automatically calculated by the
program from the nine reference frame motion components through
Eq. <a class="reference internal" href="#equation-totalacceleration">(18)</a>. This is a completely general computation and does not
require intervention by the user.</p>
<p>For special cases, the user must supply a <strong class="program">motion</strong> routine for each new
application. The standard version of <strong class="program">motion</strong> can handle a limited number of
situations via input data. These include harmonic variations of the acceleration
components and tabular specification, including impulses.</p>
<p>Another special case of the non-inertial reference frame is handled by the
coupled rigid body dynamics model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. This model solves the dynamic
equations for the movement of a rigid body in which the computational
reference frame is embedded. Use of this model usually involves specification
of control and environmental forces and torques experienced by the body
through input parameters or by modifications to the two subroutines
<strong class="program">rbctrl</strong> and <strong class="program">rbenvr</strong>. See <a class="reference internal" href="#coupledrigidbodydynamicsth"><span class="std std-ref">Coupled Rigid Body Dynamics</span></a> for a
more detailed description.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#nirfth"><span class="std std-ref">Non-Inertial Reference Frame</span></a> notation</li>
<li><a class="reference internal" href="#rigidbodydynamicsalgorithmth"><span class="std std-ref">Rigid Body Dynamics Algorithm for Non-Inertial Reference Frame Model</span></a></li>
<li><a class="reference internal" href="#noninertialreferenceframeth"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a> equations</li>
<li><a class="reference internal" href="#rigidbodydynamicsnirfth"><span class="std std-ref">Rigid Body Dynamics for Non-Inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#centrifugalcastingmr"><span class="std std-ref">Non-inertial reference frame application example:  Centrifugal Casting</span></a></li>
<li><a class="reference internal" href="model-reference.html#gravitysectionmr"><span class="std std-ref">Gravity</span></a></li>
<li><a class="reference internal" href="model-reference.html#impulsivemotionmr"><span class="std std-ref">Impulsive Motion of Non-inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#noninertialreferenceframemotionmr"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a></li>
<li><a class="reference internal" href="model-reference.html#smoothtabularmotionmr"><span class="std std-ref">Smooth Tabular Motion</span></a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="fluid-interfaces-and-free-surfaces">
<span id="fluidinterfacesandfreesurfacesth"></span><span id="index-27"></span><h3>Fluid Interfaces and Free-Surfaces<a class="headerlink" href="#fluid-interfaces-and-free-surfaces" title="Permalink to this headline">¶</a></h3>
<p>Fluid configurations are defined in terms of a volume of fluid (VOF) function,
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/>) <a class="reference internal" href="zbibliography.html#hirt-nichols-1981" id="id4">[HN81]</a>.
This function represents the volume of fluid #1 per unit volume and satisfies
the equation</p>
<div class="math" id="equation-fluidinterfacesandfreesurfaces1">
<p><span class="eqno">(19)<a class="headerlink" href="#equation-fluidinterfacesandfreesurfaces1" title="Permalink to this equation">¶</a></span><img src="_images/math/0fe41b84410fb2624340c27303f3013496677d01.png" alt="\frac{{\partial F}}{{\partial t}} + \frac{1}{{{V_F}}}\left[ {\frac{\partial }{{\partial x}}(F{A_x}u) + R\frac{\partial }{{\partial y}}(F{A_y}v) + \frac{\partial }{{\partial z}}(F{A_z}w) + \xi \frac{{F{A_x}u}}{x}} \right] = {F_{\rm{DIF}}} + {F_{\rm{SOR}}}"/></p>
</div><p>where</p>
<div class="math" id="equation-fluidinterfacesandfreesurfaces2">
<p><span class="eqno">(20)<a class="headerlink" href="#equation-fluidinterfacesandfreesurfaces2" title="Permalink to this equation">¶</a></span><img src="_images/math/eb04c15fdf37b265422992e8b2fc8cc11a54bfc8.png" alt="{F_{\rm{DIF}}} = \frac{1}{{{V_F}}}\left\{ {\frac{\partial }{{\partial x}}\left( {{\upsilon _F}{A_x}\frac{{\partial F}}{{\partial x}}} \right) + R\frac{\partial }{{\partial x}}\left( {{\upsilon _F}{A_y}R\frac{{\partial F}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{\upsilon _F}{A_z}\frac{{\partial F}}{{\partial z}}} \right) + \xi \frac{{{\upsilon _F}{A_x}F}}{x}} \right\}"/></p>
</div><p>The diffusion coefficient is defined as <img class="math" src="_images/math/6e1b94801e2899fd8435b55bbade553594cf3104.png" alt="\nu F = cF\mu /\rho" style="vertical-align: -5px"/> where
<img class="math" src="_images/math/51b258923fd0ec32e0eb15182ba25ba068ee0bbd.png" alt="cF" style="vertical-align: 0px"/> is a constant whose reciprocal is sometimes referred to as a
turbulent Schmidt number. This diffusion term only makes sense for the turbulent
mixing of two fluids whose distribution is defined by the F function.</p>
<p>The term <img class="math" src="_images/math/ed2fc71376aa0ac422e856ac1071eab5e352d484.png" alt="F_{\rm{SOR}}" style="vertical-align: -3px"/> corresponds to the density source <img class="math" src="_images/math/d84972fae0fa0caba3629f23a2c9dba1ec693948.png" alt="R_{\rm{SOR}}" style="vertical-align: -3px"/> in
Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>; <img class="math" src="_images/math/ed2fc71376aa0ac422e856ac1071eab5e352d484.png" alt="F_{\rm{SOR}}" style="vertical-align: -3px"/> is the time rate of
change of the volume fraction of fluid #1 associated with the mass source for
fluid #1.</p>
<p>The interpretation of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> depends on the type of problem being solved.
Incompressible problems must involve either a single fluid with a free-surface
or two fluids and no free-surfaces. For a single fluid, <em>F</em> represents the
volume fraction occupied by the fluid. Thus, fluid exists where <em>F=1</em>, and void
regions correspond to locations where <em>F=0</em>. “Voids” are regions without fluid
mass that have a uniform pressure assigned to them. Physically, they represent
regions filled with a vapor or gas whose density is insignificant with respect
to the fluid density.</p>
<p>Two-fluid problems may be composed of either two incompressible fluids or one
incompressible and one compressible fluid. <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> represents the volume fraction of
the incompressible fluid component in either case, which is referred to as fluid
#1. The complementary region with volume fraction, <img class="math" src="_images/math/71ef43c94757d0587fc11d4f8da1245cb25ad91e.png" alt="1-F" style="vertical-align: 0px"/>, represents fluid #2
and may have either a constant density or its density is computed from the
compressible fluid equation-of-state.</p>
</div>
<div class="section" id="fluid-energy-equations">
<span id="fluidenergyequationsth"></span><span id="index-28"></span><h3>Fluid Energy Equations<a class="headerlink" href="#fluid-energy-equations" title="Permalink to this headline">¶</a></h3>
<p>For compressible or thermal flow problems, the internal energy equation is</p>
<div class="math" id="equation-fluidenergyequations1">
<p><span class="eqno">(21)<a class="headerlink" href="#equation-fluidenergyequations1" title="Permalink to this equation">¶</a></span><img src="_images/math/8789aa92d82af6d00da63d7650b2bb4da5cb8f84.png" alt="\begin{gathered}
 {V_F}\frac{\partial }{{\partial t}}(\rho I) + \frac{\partial }{{\partial x}}(\rho Iu{A_x}) + R\frac{\partial }{{\partial y}}(\rho Iv{A_y}) + \frac{\partial }{{\partial z}}(\rho Iw{A_z}) + \xi \frac{{\rho Iu{A_x}}}{x} =  \hfill \\
 - p\left\{ {\frac{{\partial u{A_x}}}{{\partial x}} + R\frac{{\partial v{A_y}}}{{\partial y}} + \frac{{\partial w{A_z}}}{{\partial z}} + \xi \frac{{u{A_x}}}{x}} \right\} + R{I_{\rm{DIF}}} + {T_{\rm{DIF}}} + R{I_{\rm{SOR}}} \hfill \\
\end{gathered}"/></p>
</div><p>where <img class="math" src="_images/math/496af7d1f086e49a5be0614f2b933a137b0fd0a7.png" alt="I" style="vertical-align: 0px"/> is the macroscopic fluid internal energy. For two-fluid problems Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>
is solved separately for each fluid, <em>i.e.</em>, for fluid #1</p>
<div class="math" id="equation-fluidenergyequations2">
<p><span class="eqno">(22)<a class="headerlink" href="#equation-fluidenergyequations2" title="Permalink to this equation">¶</a></span><img src="_images/math/64edff2cd7eeb88ef343b307c4132842fb93da33.png" alt="\rho I = F{\rho _1}{I_1}"/></p>
</div><p>and for fluid #2</p>
<div class="math" id="equation-fluidenergyequations3">
<p><span class="eqno">(23)<a class="headerlink" href="#equation-fluidenergyequations3" title="Permalink to this equation">¶</a></span><img src="_images/math/e516a321de324f4549090052308323587ef621b3.png" alt="\rho I = (1 - F){\rho _2}{I_2}"/></p>
</div><p>where <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is the volume fraction of fluid #1 and indexes indicate quantities
related to fluid #1 or fluid #2.</p>
<div class="section" id="heat-of-transformation">
<span id="heatoftransformationsth"></span><span id="index-29"></span><h4>Heat of Transformation<a class="headerlink" href="#heat-of-transformation" title="Permalink to this headline">¶</a></h4>
<p>In general, fluid thermal energy is assumed to be a piecewise linear function of temperature,</p>
<div class="math" id="equation-heatoftransformation0">
<p><span class="eqno">(24)<a class="headerlink" href="#equation-heatoftransformation0" title="Permalink to this equation">¶</a></span><img src="_images/math/3492a1bcef5ba2685da44712bfa76ec0eb085c0a.png" alt="I(T) = C_V(T_1) T_1 + \sum_{i=2,N} {0.5\left[ C_V(T_{i-1}) + C_V(T_i)\right] (T-T_{i-1})}"/></p>
</div><p>where <img class="math" src="_images/math/002ca18a2097d5df4d3fab98af29e72fa86bdedb.png" alt="T_i" style="vertical-align: -3px"/> <img class="math" src="_images/math/4680a513b9e7f9369e0685f50ee74959afcec0b0.png" alt="C_V(T_i)" style="vertical-align: -5px"/> denote temperature and specific heat values in the tabular definition of <img class="math" src="_images/math/b37903c27de0852ffcb41821b23663a2e31571ba.png" alt="C_V(T)" style="vertical-align: -5px"/>,
and <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> is such that <img class="math" src="_images/math/62a01ab68fa82f5d3cf942498c523951c40666e2.png" alt="T_{N-1} &lt; T \leq T_N" style="vertical-align: -3px"/>.</p>
<p>Latent heat release due to solidification and melting, which can occur only in fluid #1, is accounted for
with an additional term in Eq. <a class="reference internal" href="#equation-heatoftransformation0">(24)</a>:</p>
<div class="math" id="equation-heatoftransformation1">
<p><span class="eqno">(25)<a class="headerlink" href="#equation-heatoftransformation1" title="Permalink to this equation">¶</a></span><img src="_images/math/f6a3d42ef116f639175eb3740a5ce00f92b4bbef.png" alt="I(T,f_s) = I(T) + (1 - {f_s}) L"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/36434a9974445ce37530db1b9e87b6e3e917181e.png" alt="f_s" style="vertical-align: -4px"/> is solid fraction, and</li>
<li><img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> the latent heat.</li>
</ul>
<p>Latent heat release can be defined
in one of two ways. The simplest method consists of specifying the solidus
temperature, <span class="target" id="index-30"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TS1</span></code>, the liquidus temperature, <span class="target" id="index-31"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TL1</span></code>, and the specific energy of
the phase transformation occurring between these two temperatures, <span class="target" id="index-32"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CLHT1</span></code>. In
this case the latent heat is applied linearly with temperature between <span class="target" id="index-33"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TL1</span></code> to <span class="target" id="index-34"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TS1</span></code>.</p>
<p>In many real materials, however, the release of latent heat is not a linear
function of temperature. In this case, the latent heat can be defined as a
tabular function of temperature. This can be done in the form of either
specific energy vs. temperature or solid-fraction vs. temperature.</p>
<p>The <span class="guilabel">Iron Solidification</span> model has its own default behavior of latent
heat release, although tabular input can also be used in it <a class="reference internal" href="zbibliography.html#carter-starobin-2011" id="id5">[CS11]</a>.</p>
<p>Only fluid #1 can undergo a liquid/solid or solid/solid phase change. Both
solidification and melting are allowed. Solidification shrinkage is a separate
option that can be activated (see
<a class="reference internal" href="#solidificationshrinkageporositymodelsth"><span class="std std-ref">Solidification</span></a>).</p>
<p>It is permitted to have <span class="target" id="index-35"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TS1</span></code> = <span class="target" id="index-36"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TL1</span></code>, which implies a discontinuity
in the energy-versus-temperature relation.</p>
<span class="target" id="index-37"></span></div>
<div class="section" id="macro-segregation-model">
<span id="macrosegregationmodelth"></span><span id="index-38"></span><h4>Macro-Segregation Model<a class="headerlink" href="#macro-segregation-model" title="Permalink to this headline">¶</a></h4>
<p>The macro-segregation model describes the evolution of binary alloy composition
due to phase transformation, diffusion in both liquid and solid phases and
convection in the liquid metal. The transport equation for the liquid-solid
mixture composition, <img class="math" src="_images/math/e729bc05c9b9a0e55f160ebd3570cdd7c92bc8ad.png" alt="C_m" style="vertical-align: -3px"/>, is</p>
<div class="math" id="equation-transportequationmacrosegregation">
<p><span class="eqno">(26)<a class="headerlink" href="#equation-transportequationmacrosegregation" title="Permalink to this equation">¶</a></span><img src="_images/math/05ae0ed3ddb8e0d3bb7f500ed2792d9a7819c092.png" alt="\begin{gathered}
 {V_F} \cdot \frac{{\partial {C_m}}}{{\partial t}} + \left( {u{A_x}\frac{{\partial {C_l}}}{{\partial x}} + vR{A_y}\frac{{\partial {C_l}}}{{\partial y}} + w{A_z}\frac{{\partial {C_l}}}{{\partial z}}} \right) = \frac{\partial }{{\partial x}}\left( {{A_x}{D_l}\frac{{\partial {C_l}}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {R{A_y}{D_l}\frac{{\partial {C_l}}}{{\partial y}}} \right) +  \hfill \\
 \frac{\partial }{{\partial z}}\left( {{A_z}{D_\ell }\frac{{\partial {C_\ell }}}{{\partial z}}} \right) + \frac{\partial }{{\partial x}}\left( {{A_x}{D_s}\frac{{\partial {C_s}}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {R{A_y}{D_s}\frac{{\partial {C_s}}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{A_z}{D_s}\frac{{\partial {C_s}}}{{\partial z}}} \right) \hfill \\
\end{gathered}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/f870203ce3ebed5ede64616d1bbface7fa92fc25.png" alt="C_l" style="vertical-align: -3px"/> and <img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/> are the liquid and solid phase compositions, and</li>
<li><img class="math" src="_images/math/b5d4bed3aadb798d03a85f2e9ae4f76b4c27a1ea.png" alt="D_l" style="vertical-align: -3px"/> and <img class="math" src="_images/math/b60b67498bffa4371916ba9b3c77a78c987288df.png" alt="D_s" style="vertical-align: -3px"/> the mass diffusion coefficients in the liquid and solid phases.</li>
</ul>
<p>Composition can be described as solute mass per unit metal volume or as weight
percentage. In this equation, the solid phase is assumed to be at rest with
respect to the computational domain.</p>
<p>The mixture composition <img class="math" src="_images/math/e729bc05c9b9a0e55f160ebd3570cdd7c92bc8ad.png" alt="C_m" style="vertical-align: -3px"/> is obtained by averaging the liquid and
solid phase compositions over the control volume. Assuming that <img class="math" src="_images/math/f870203ce3ebed5ede64616d1bbface7fa92fc25.png" alt="C_l" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/> are constant within the control volume, i.e., using the lever rule,
we have</p>
<div class="math" id="equation-mixturecompostion">
<p><span class="eqno">(27)<a class="headerlink" href="#equation-mixturecompostion" title="Permalink to this equation">¶</a></span><img src="_images/math/4ee79f8ec49d205145f9d8b9a254317030cf1159.png" alt="{C_m} = (1 - {f_s}){C_l} + {f_s}{C_s}"/></p>
</div><p>with</p>
<div class="math" id="equation-czvalue">
<p><span class="eqno">(28)<a class="headerlink" href="#equation-czvalue" title="Permalink to this equation">¶</a></span><img src="_images/math/313b5b2b3c9c3127c85eca02fb8dcc522395d019.png" alt="{C_s} = {\rm{PCOEF}} \cdot {C_l}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-39"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PCOEF</span></code> is the partition coefficient <a class="reference internal" href="zbibliography.html#flemings-1974" id="id6">[Fle74]</a>.</li>
<li><span class="target" id="index-40"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PCOEF</span></code> is constant, therefore, the liquidus and solidus lines of the phase diagram are straight lines.</li>
</ul>
<div class="math" id="equation-solidusandliquidustemp1">
<p><span class="eqno">(29)<a class="headerlink" href="#equation-solidusandliquidustemp1" title="Permalink to this equation">¶</a></span><img src="_images/math/ab2b4f515d5ac3cf4f23cac1fc2643cfe3d38780.png" alt="{T_l} = {\rm{TMELT}} - ({\rm{TMELT}} - {\rm{TL1}}) \cdot \frac{{Cm}}{{\rm{CSTAR}}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-solidusandliquidustemp2">
<p><span class="eqno">(30)<a class="headerlink" href="#equation-solidusandliquidustemp2" title="Permalink to this equation">¶</a></span><img src="_images/math/ff466a52465ff53684b4d4da99aa59889a816a16.png" alt="{T_s} = {\rm{TMELT}} - ({\rm{TMELT}} - {\rm{TS1}}) \cdot \frac{{Cm}}{{\rm{CSTAR}}}"/></p>
</div><p>where <span class="target" id="index-41"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TS1</span></code> and <span class="target" id="index-42"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TL1</span></code> are the solidus and liquidus temperatures at C =
<span class="target" id="index-43"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CSTAR</span></code>. If composition and temperature in a control volume are known,
then the solid fraction can be computed using Eqs. <a class="reference internal" href="#equation-mixturecompostion">(27)</a>,
<a class="reference internal" href="#equation-czvalue">(28)</a>, <a class="reference internal" href="#equation-solidusandliquidustemp1">(29)</a> and
<a class="reference internal" href="#equation-solidusandliquidustemp2">(30)</a>.</p>
<div class="math" id="equation-eutecticreaction">
<p><span class="eqno">(31)<a class="headerlink" href="#equation-eutecticreaction" title="Permalink to this equation">¶</a></span><img src="_images/math/afb332eb060816847d265ab181c7ee765ebc719c.png" alt="{f_s} = \frac{1}{1 - {\rm{PCOEF}}} \cdot \frac{T - {T_l}}{T - {\rm{TMELT}}}"/></p>
</div><p>Eutectic reaction is included in the phase diagram. In a eutectic reaction,
phase transformation proceeds isothermally at the eutectic temperature
T = <span class="target" id="index-44"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TEUT</span></code>. Then the mass fraction of the eutectic in the solidified casting
is given by</p>
<div class="math" id="equation-massfractioneutecticsolidifiedcasting">
<p><span class="eqno">(32)<a class="headerlink" href="#equation-massfractioneutecticsolidifiedcasting" title="Permalink to this equation">¶</a></span><img src="_images/math/dd93faefa24bff8b706f9f50315f5f1478ccf9db.png" alt="{f_e} = 1 - \left( {1 - \frac{{Cm}}{{\rm{CEUT}}}} \right) \cdot \frac{1}{{1 - {\rm{PCOEF}}}}"/></p>
</div><p>Liquid metal density variation due to the changes in the composition are taken
into account by using a linear expression for the liquid mixture density</p>
<div class="math" id="equation-macrosegreationmodel329">
<p><span class="eqno">(33)<a class="headerlink" href="#equation-macrosegreationmodel329" title="Permalink to this equation">¶</a></span><img src="_images/math/4cf699150afc599c1981208215d13f88a9dd5938.png" alt="{\rho _l} = {\rho _0}\left[ {1 - {\rm{CEXF1}}\left( {Cm - {\rm{CSTAR}}} \right)} \right]"/></p>
</div><p>where <img class="math" src="_images/math/31d563b2d45cb4d69c56a65957e97b1b66e62ae3.png" alt="\rho _0" style="vertical-align: -4px"/> is the liquid density at the composition C = <span class="target" id="index-45"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CSTAR</span></code> and</p>
<div class="math" id="equation-compostiondefinedaspercentageofweight">
<p><span class="eqno">(34)<a class="headerlink" href="#equation-compostiondefinedaspercentageofweight" title="Permalink to this equation">¶</a></span><img src="_images/math/19fde519628d5c33d22b38cdc4d4e3eddd4ccf61.png" alt="{\rm{CEXF1}} = \frac{{{\rho _0}\left( {\frac{1}{{{\rho _2}}} - \frac{1}{{{\rho _1}}}} \right)}}{{100}}"/></p>
</div><p>if the composition is defined as percentage of weight and</p>
<div class="math" id="equation-compositiondefinedasmasspervolume">
<p><span class="eqno">(35)<a class="headerlink" href="#equation-compositiondefinedasmasspervolume" title="Permalink to this equation">¶</a></span><img src="_images/math/a163ced5c6d792bf1d4a068bcab1bd899f530e15.png" alt="{\rm{CEXF1}} = \frac{1}{{{\rho _0}}}\left( {\frac{{{\rho _1}}}{{{\rho _2}}} - 1} \right)"/></p>
</div><p>if the composition is defined as mass per unit volume; <img class="math" src="_images/math/1ada0b4f0860d12949225ea370c1199b8beeb57d.png" alt="\rho _1" style="vertical-align: -4px"/> and
<img class="math" src="_images/math/b004e5c1e898c9fd52b692d32a2f27c4b047c984.png" alt="\rho _2" style="vertical-align: -4px"/> are the densities of the solvent and solute, respectively.</p>
<p>Liquid metal density can also include a temperature-dependent term, as described
in <a class="reference internal" href="#buoyantflowmodelth"><span class="std std-ref">Buoyant Flow</span></a>. Finally, the liquid/solid mixture
density is computed as the straight average of the liquid density given by Eq.
<a class="reference internal" href="#equation-macrosegreationmodel329">(33)</a> and the solid phase density <span class="target" id="index-46"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RHOFS</span></code>.</p>
<div class="math" id="equation-liquidsolidmixuredensity">
<p><span class="eqno">(36)<a class="headerlink" href="#equation-liquidsolidmixuredensity" title="Permalink to this equation">¶</a></span><img src="_images/math/a9f179c2020649408fe151ba06c32cc9f3be06f7.png" alt="\rho  = (1 - {f_s}){\rho _l} + {f_s} \cdot {\rm{RHOFS}}"/></p>
</div></div>
<div class="section" id="thermal-diffusion-and-sources">
<span id="thermaldiffusionandsourcesth"></span><span id="index-47"></span><h4>Thermal Diffusion and Sources<a class="headerlink" href="#thermal-diffusion-and-sources" title="Permalink to this headline">¶</a></h4>
<p>Two diffusion processes are included in Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>: one (<img class="math" src="_images/math/8aa7ef3c79e745545c23a2dfac65e488113cead5.png" alt="RI_{\rm{DIF}}" style="vertical-align: -3px"/>) for the turbulent diffusion of I and the other (<img class="math" src="_images/math/85b8e25465280c599f689a2ff74a9ba4b6fcc29a.png" alt="T_{\rm{DIF}}" style="vertical-align: -3px"/>) for heat conduction. These terms are defined as</p>
<div class="math" id="equation-thermaldiffusionandsources1">
<p><span class="eqno">(37)<a class="headerlink" href="#equation-thermaldiffusionandsources1" title="Permalink to this equation">¶</a></span><img src="_images/math/d5bce1e2bd082d4c5f60f6b26ae78f8e6c145f6f.png" alt="R{I_{\rm{DIF}}} = \frac{\partial }{\partial x}\left( {{\upsilon _I}{A_x}\frac{\partial \rho I}{\partial x}} \right) + R\frac{\partial }{\partial y}\left( {{\upsilon _I}{A_y}R\frac{\partial \rho I}{\partial y}} \right) + \frac{\partial }{\partial z}\left( {{\upsilon _I}{A_z}\frac{\partial \rho I}{\partial z}} \right) + \xi \frac{{\upsilon _I}{A_X}\rho I}{x}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-thermaldiffusionandsources2">
<p><span class="eqno">(38)<a class="headerlink" href="#equation-thermaldiffusionandsources2" title="Permalink to this equation">¶</a></span><img src="_images/math/0c8c5615d7f8530b35cffe043fca98b2dcf57c5c.png" alt="{T_{\rm{DIF}}} = \frac{\partial }{\partial x}\left( {k{A_x}\frac{\partial T}{\partial x}} \right) + R\frac{\partial }{\partial y}\left( {k{A_y}R\frac{\partial T}{\partial y}} \right) + \frac{\partial }{\partial z}\left( {k{A_z}\frac{\partial T}{\partial z}} \right) + \xi \frac{{k{A_x}T}}{x}"/></p>
</div><p>As with energy in Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, temperature in Eq. <a class="reference internal" href="#equation-thermaldiffusionandsources2">(38)</a> is specific
to each fluid in two-fluid problems.</p>
<p>The coefficient <img class="math" src="_images/math/1156b7b28150771ab2a06efbbfedf8591c7af472.png" alt="\upsilon _I" style="vertical-align: -3px"/> is equal to
<img class="math" src="_images/math/c1f636f4ee2905bdd3f42002734c43fdcb49e033.png" alt="{\text {c}_I} \mu /\rho" style="vertical-align: -5px"/>, where <img class="math" src="_images/math/649093967f1acd6209facebd6ab9a4114630a40d.png" alt="\text {c}_I" style="vertical-align: -3px"/> is a
reciprocal turbulent Prandtl number. In the thermal conduction term, the thermal
conductivity <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/> can be directly specified or the Prandtl number <img class="math" src="_images/math/2df08c88ef36d72a5579f80d8ad4be0127b0fb72.png" alt="C_T" style="vertical-align: -3px"/> can be
specified, in which case the conductivity is <img class="math" src="_images/math/c3df279fca82a8f274c05c6dd265e446610528d1.png" alt="k = \mu
{{\text{C}}_v}/{{\text{C}}_T}" style="vertical-align: -5px"/>. For two-fluid problems the conductivities for
each fluid are locally weighted by the fluid volume fraction <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>.</p>
<p>The last term, <img class="math" src="_images/math/df9be485fce7b3cd45fe9bab3bb1463d100f3b5d.png" alt="RI_{\rm{SOR}}" style="vertical-align: -3px"/>, on the right side of Eq.
<a class="reference internal" href="#equation-fluidenergyequations1">(21)</a> is an energy source term. Sources can be associated
with the mass source <img class="math" src="_images/math/d84972fae0fa0caba3629f23a2c9dba1ec693948.png" alt="R_{\rm{SOR}}" style="vertical-align: -3px"/>, with heat transfer mechanisms at solid
boundaries, distributed heat sources within the fluid or viscous heating. A
detailed discussion of wall heat transfer is given in <a class="reference internal" href="#wallheattransferth"><span class="std std-ref">Wall Heat Transfer</span></a>.
The viscous heating source term is</p>
<div class="math" id="equation-viscousheatingsource">
<p><span class="eqno">(39)<a class="headerlink" href="#equation-viscousheatingsource" title="Permalink to this equation">¶</a></span><img src="_images/math/af893e121bc5ba0f8bc31801f01dfca02cd28352.png" alt="{\text{2}}\mu \left[ {{e_{ij}}{e_{ij}} - \frac{1}{3}{{({e_{11}} + {e_{22}} + {e_{33}})}^2}} \right]"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/992f70236542777c373e18ea21c43911c1367e5e.png" alt="e_{ij}" style="vertical-align: -6px"/> are the components of the strain rate tensor, and</li>
<li><img class="math" src="_images/math/6dc337f85d5e41500f130883d4a64cca8d3560d7.png" alt="{e_{ij}}{e_{ij}} = \sum\limits_{i,j = 1}^3 {e_{ij}}{e_{ij}}" style="vertical-align: -19px"/>.</li>
</ul>
</div>
</div>
<div class="section" id="structure-temperature-equation">
<span id="structuretemperatureequationth"></span><span id="index-48"></span><h3>Structure Temperature Equation<a class="headerlink" href="#structure-temperature-equation" title="Permalink to this headline">¶</a></h3>
<p>If the heat transfer option is selected (<span class="target" id="index-49"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IHTC</span></code> &gt; 0) in the input, dynamic
temperatures of heat structures may be evaluated by <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. Heat structures can
be either mesh wall boundaries or obstacles. The most general equation solved
for dynamic structure temperatures is</p>
<div class="math" id="equation-dynamicstructuretemp">
<p><span class="eqno">(40)<a class="headerlink" href="#equation-dynamicstructuretemp" title="Permalink to this equation">¶</a></span><img src="_images/math/9d4949d75665601924ca430e504b0226a7c67170.png" alt="(1 - {V_F}){\rho _w}{C_w}\frac{\partial {T_w}}{\partial t} - \frac{\partial }{\partial x}\left[ {{k_w}(1 - {A_x})\frac{\partial {T_w}}{\partial x}} \right] - R\frac{\partial }{\partial y}\left[ {{k_w}(1 - {A_y})R\frac{\partial {T_w}}{\partial y}} \right] - \frac{\partial }{\partial z}\left[ {{k_w}(1 - {A_z})\frac{\partial {T_w}}{\partial z}} \right] = {T_{\rm{SOR}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/f661723e0c77ee24f137c489cf6bec1e092f2e44.png" alt="T_w" style="vertical-align: -3px"/> is the solid structure temperature,</li>
<li><img class="math" src="_images/math/1f4b5b24f167aebe6b9a0e966116998120aaf96d.png" alt="\rho _w" style="vertical-align: -4px"/>, <img class="math" src="_images/math/610244012a7285d9b3df0dc66f11f165963b8eb1.png" alt="C_w" style="vertical-align: -3px"/>, and <img class="math" src="_images/math/54f9428f5e0f07373bcf8ddddac9f035cd3f3bb5.png" alt="{\text {k}}_w" style="vertical-align: -3px"/> are the solid material values of density, specific heat, and thermal conductivity, and</li>
<li><img class="math" src="_images/math/9504ee3cabb29ade14f08fb07f13978b37d806cb.png" alt="T_{\rm{SOR}}" style="vertical-align: -3px"/> is a specific energy source term composed of contributions from specified external sources and solid-liquid heat transfer.</li>
</ul>
<p>Evaluation of heat transfer is discussed in <a class="reference internal" href="#wallheattransferth"><span class="std std-ref">Wall Heat Transfer</span></a>.</p>
<p>Some obstacles or wall boundaries may be treated by a lumped temperature model.
In this case the entire structure is assumed to be at a uniform temperature,
which eliminates the conduction term and results in</p>
<div class="math" id="equation-lumpedtempmodel">
<p><span class="eqno">(41)<a class="headerlink" href="#equation-lumpedtempmodel" title="Permalink to this equation">¶</a></span><img src="_images/math/0354be04b5318e1e5dd84d7e316b5b737e90f13f.png" alt="{M_w}{C_w}\frac{{d{T_w}}}{{dt}} = I{T_{\rm{SOR}}}"/></p>
</div><p>where now <img class="math" src="_images/math/32b1c4a383f136f53951ef8153cb1c365758f32d.png" alt="M_w" style="vertical-align: -3px"/> is the mass of the structure, and <img class="math" src="_images/math/1b2c45bcd2105613b06f2a56ece3043cb12e90fb.png" alt="IT_{\rm{SOR}}" style="vertical-align: -3px"/> is the
volume and/or area integrated energy source term.</p>
</div>
<div class="section" id="equation-of-state">
<span id="equationofstateth"></span><span id="index-50"></span><h3>Equation-of-State<a class="headerlink" href="#equation-of-state" title="Permalink to this headline">¶</a></h3>
<p>Compressible equations of state are assumed to have the form</p>
<div class="math" id="equation-compressibleequationsofstate">
<p><span class="eqno">(42)<a class="headerlink" href="#equation-compressibleequationsofstate" title="Permalink to this equation">¶</a></span><img src="_images/math/8c25a9425a1fe2f8fcc44c9c787a072b01154089.png" alt="\rho = \rho \left( p,T \right)"/></p>
</div><p>A single-mixture energy is generally not sufficient to determine separate fluid
states for two-material problems. Therefore, we assume that the two materials
have the same temperature, which partitions energy between the materials. A
perfect gas equation-of-state is the default available in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> for compressible
fluids.</p>
<p>For thermally buoyant flows the fluid densities are functions of temperature
only, as described in <a class="reference internal" href="#buoyantflowmodelth"><span class="std std-ref">Buoyant Flow</span></a>.</p>
<p>Incompressible fluids generally have a constant and uniform density. However,
one can also define a non-uniform density in an incompressible fluid.</p>
</div>
<div class="section" id="general-scalar-transport">
<span id="generalscalartransportth"></span><span id="index-51"></span><h3>General Scalar Transport<a class="headerlink" href="#general-scalar-transport" title="Permalink to this headline">¶</a></h3>
<p>In addition to the flow parameters described above, <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> also uses general scalar quantities.
A scalar can define a property of fluid #1, fluid #2, or both, in
which case it is called <em>advectable</em> scalar. A scalar can also define a quantity that is attached
to a location in the computational domain rather than fluid; such a scalar is called <em>non-advectable</em>.</p>
<p><em>Model</em> scalars are those that are used in standard models, e.g.,
<a class="reference internal" href="#defecttrackingth"><span class="std std-ref">Defect Tracking</span></a> or <a class="reference internal" href="model-reference.html#airentrainmentmr"><span class="std std-ref">Air Entrainment</span></a>. These scalars are
defined automatically when their respective models are activated. <em>User-defined</em> scalars are not used in
any standard model and can be introduced by the user either as a fluid marker, similar to
<a class="reference internal" href="#markerparticlesth"><span class="std std-ref">Marker Particles</span></a>, or as a part of a customization
(see <a class="reference internal" href="customization.html#countingparticleconcentrationmeshcells"><span class="std std-ref">Example: Counting Particle Concentration in Mesh Cells</span></a> in the Customization Chapter).</p>
<p>An advectable scalar is typically defined as concentration <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> in terms of mass per
fluid volume in cell. A transport equation is solved automatically for any advectable
scalar, user-defined or model:</p>
<div class="math" id="equation-scalartransport1">
<p><span class="eqno">(43)<a class="headerlink" href="#equation-scalartransport1" title="Permalink to this equation">¶</a></span><img src="_images/math/89903b3515dcd75b0e56f35f137f8c65c1e8a5ac.png" alt="\frac{{\partial C}}{{\partial t}} + \frac{1}{{{V_F}}}\left[ {u{A_x}\frac{{\partial C}}{{\partial x}} + v{A_y}\frac{{\partial C}}{{\partial y}} + w{A_z}\frac{{\partial C}}{{\partial z}}} \right] = \frac{1}{{{V_F}}}\left[ {\frac{\partial }{{\partial x}}\left( {{A_x}D\frac{{\partial C}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {{A_y}DR\frac{{\partial C}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{A_z}D\frac{{\partial C}}{{\partial z}}} \right)} \right]+C_{SOR}"/></p>
</div><p>in which <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is the diffusion coefficient and <img class="math" src="_images/math/89defa0df1fc8b85166a0c9c20a569db6a4ec5db.png" alt="C_{SOR}" style="vertical-align: -3px"/> is a source term.</p>
<p>In the simplest case, scalars do not affect the fluid dynamics. They move with the mean
flow and diffuse with the diffusion coefficient <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/></p>
<div class="math" id="equation-scalartransport2">
<p><span class="eqno">(44)<a class="headerlink" href="#equation-scalartransport2" title="Permalink to this equation">¶</a></span><img src="_images/math/26c6cf781e1151a22dc400608e6dafe23cc064c9.png" alt="\rho D = {\rm{RMSC}} \cdot \mu + {\rm{CMSC}}"/></p>
</div><p>where <span class="target" id="index-52"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMSC</span></code> is the inverse Schmidt number, <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> dynamic fluid viscosity,
<span class="target" id="index-53"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CMSC</span></code> is a constant scalar diffusion coefficient and <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the fluid density.</p>
<p>Scalars can also carry certain attributes that affect fluid properties such as density, viscosity,
elastic modulus and yield stress, providing a capability to model multiple materials or fluids
with localized variations of properties. When scalar mass is included in the calculation of the
fluid/scalar mixture it is simply added to that of the fluid. In other words, scalars are always
treated as <em>interstitial</em> solutes, when their molecules fit perfectly in the spaces between the
molecules of the solvent, i.e., fluid. A scalar can only make fluid heavier. Other mixture properties
carried by scalars are calculated as mass-averages of the pure fluid and scalar attributes. For example,
for a single scalar <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/>, the mixture viscosity <img class="math" src="_images/math/2c0feaadf306ff1c7d4ac9dcdf854b5a9bd744f8.png" alt="\mu_{mix}" style="vertical-align: -4px"/>:</p>
<div class="math" id="equation-scalartransport3">
<p><span class="eqno">(45)<a class="headerlink" href="#equation-scalartransport3" title="Permalink to this equation">¶</a></span><img src="_images/math/6c0d028ad0063e2229e2ff2755d90500e8e9a976.png" alt="\mu_{mix} = \frac{\rho \mu + \sum\limits_{i}{(C_{i}\mu_{C_{i}})}}{\rho+\sum\limits_{i}{C_{i}}}"/></p>
</div><p>where <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> and <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> are pure fluid density and viscosity, and <img class="math" src="_images/math/726784c1d1d47c888974fcd1f7f3f75af2a8d940.png" alt="\mu_{C_{i}}" style="vertical-align: -5px"/> is
the viscosity attributed to scalar <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>. The summation is done over all scalars contributing to
the mixture viscosity.</p>
<p>Scalars can be introduced in the initial conditions, at mesh inlet boundaries and at fluid sources.
They also provide a powerful platform for user customizations to fit particular modeling needs.</p>
<span class="target" id="index-54"></span></div>
</div>
<div class="section" id="auxiliary-models">
<span id="auxiliarymodelsth"></span><span id="index-55"></span><h2>Auxiliary Models<a class="headerlink" href="#auxiliary-models" title="Permalink to this headline">¶</a></h2>
<span class="target" id="index-56"></span><div class="section" id="bubble-and-void-region-models">
<span id="bubbleandoidregionmodelsth"></span><span id="index-57"></span><h3>Bubble and Void Region Models<a class="headerlink" href="#bubble-and-void-region-models" title="Permalink to this headline">¶</a></h3>
<p>Many calculations that involve the flow of both liquids and gases can be
idealized as “free-surface” flows. This type of flow is analyzed by treating the
gas as a region of uniform pressure and temperature, which frees one from
determining the dynamics of the gas. In free-surface calculations, <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
identifies the region occupied by fluid as regions where the fluid fraction
function is non-zero. Free-surface calculations must have domains in which the
fluid fraction is zero. Each such region is called a “void region” (or sometimes
a “bubble”). Void regions may be separated from one another by fluid cells,
obstacles, or baffles. These regions physically represent volumes that are
occupied by gas. The VOF solution algorithm does not solve for the dynamics of
the gas in these regions; instead, it treats them as regions of uniform
pressure, which is normally an excellent approximation. The pressure is used as
a boundary condition on the liquid/gas interface.</p>
<p>Evaluation of the pressure (and possibly temperature) of void regions depends on
the void region model. There are four kinds of void regions used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>:</p>
<ul class="simple">
<li><a class="reference internal" href="#constantpressurevoidregionsth"><span class="std std-ref">Constant Pressure Void Regions</span></a></li>
<li><a class="reference internal" href="#cavitationvoidregionsth"><span class="std std-ref">Cavitating Void Regions</span></a></li>
<li><a class="reference internal" href="#variablepressurevoidregionsth"><span class="std std-ref">Adiabatic Bubble Model</span></a></li>
<li><a class="reference internal" href="#homogeneousbubblemodelth"><span class="std std-ref">Homogeneous (Thermal) Bubble Model</span></a></li>
</ul>
<p>Some calculations may combine different models for different regions or even for
the same void region at different times.</p>
<p>The use of a single pressure for each connected void region presupposes that
sound waves traverse the region in much shorter times than those associated with
changes in the configuration of the surrounding incompressible fluid. These
assumptions are, however, sufficiently accurate for many interesting problems.</p>
<p>Bubbles that impinge upon the mesh boundary may be affected by the boundary
conditions. For example, any void region adjacent to a fixed pressure boundary
will automatically take on the prescribed boundary pressure regardless of volume
changes, coalescence, or breakup. Void regions adjacent to fixed velocity
boundaries will gain (or lose) enthalpy. If the flow is into the computational
region, the enthalpy gain is computed from the specified boundary conditions.
For an outflow boundary, it is the enthalpy in the bubble that is fluxed out.
Reference <a class="reference internal" href="zbibliography.html#nichols-hirt-1980" id="id7">[NH80]</a> describes the theoretical basis for
this bubble model.</p>
<div class="section" id="constant-pressure-void-regions">
<span id="constantpressurevoidregionsth"></span><span id="index-58"></span><h4>Constant Pressure Void Regions<a class="headerlink" href="#constant-pressure-void-regions" title="Permalink to this headline">¶</a></h4>
<p>When densities of the fluid and gas differ significantly, then small variations
of pressure within the gas and gas inertia can be neglected compared to those in
the fluid. For example, the ratio of water to air densities is about 1000. In
these cases each void region can be treated as a uniform pressure region. In
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> such flows are described with the one-fluid model with gas boundaries
treated as free-surfaces.</p>
<p>If the gas does not undergo volumetric changes (i.e., compression or expansion),
then it can be further assumed that the pressure of the void regions is constant
in time. The constant pressure void region model works well, for example, for
open channel flows where the gas is air at atmospheric pressure. Another example
is filling of a sand mold with liquid metal where the sand porosity ensures that
air in the mold escapes without getting trapped.</p>
<p>If the void is connected to a specified pressure boundary, then the void will
assume the pressure specified at that boundary, which may be a function of time.</p>
<span class="target" id="index-59"></span></div>
<div class="section" id="adiabatic-bubble-model">
<span id="variablepressurevoidregionsth"></span><span id="adiabaticbubbleth"></span><span id="index-60"></span><h4>Adiabatic Bubble Model<a class="headerlink" href="#adiabatic-bubble-model" title="Permalink to this headline">¶</a></h4>
<p>In situations when a volume of gas gets trapped in a confined region, the gas
pressure can no longer be considered constant. For example, a submerged air
bubble rising in water may have a variable pressure.</p>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can treat one or more void regions in its incompressible, one-fluid mode.
The bubble model evaluates the pressure <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> in each void region based on
the void region volume <img class="math" src="_images/math/f5a322f82f9e644cb83622202e5be0da6a7cbb00.png" alt="V" style="vertical-align: 0px"/> using the isentropic model of expansion or
compression in which <img class="math" src="_images/math/e6ec2b1e6199c9b60272a1d9cc7aa6fd6218b85b.png" alt="P{V^\gamma }" style="vertical-align: 0px"/> is constant. Here <img class="math" src="_images/math/0a9c286987ad5fd2f65853d796ca3f4366ae29ec.png" alt="\gamma" style="vertical-align: -4px"/> is normally
the isentropic exponent defined as the ratio of specific heats,
<img class="math" src="_images/math/1a66fa4dc7b509bdc4f8dd7a85b53d7171a11746.png" alt="\gamma  = {C_p}/{C_V}" style="vertical-align: -6px"/>.</p>
<p>Strictly speaking, this model of the bubble pressure is only valid if the void
region behaves as a perfect gas undergoing reversible adiabatic changes.</p>
<p>Void regions can behave in more complex ways than simple expansions and
contractions. They may break up or coalesce, and they may receive or lose mass
and energy at the mesh boundaries. All of these processes are approximated by
the bubble pressure model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The pressure of a coalesced bubble is
determined by volume weighting the pressures of the previous isolated bubbles. A
bubble that breaks up creates new bubbles at its old pressure. These processes
violate the constant <img class="math" src="_images/math/e6ec2b1e6199c9b60272a1d9cc7aa6fd6218b85b.png" alt="P{V^\gamma }" style="vertical-align: 0px"/> condition, but as they only occur at
discrete times, the accumulated error is expected to remain small.</p>
<p>If a bubble neither coalesces nor breaks up, the <img class="math" src="_images/math/e6ec2b1e6199c9b60272a1d9cc7aa6fd6218b85b.png" alt="P{V^\gamma }" style="vertical-align: 0px"/> relation
determines the new pressure.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The adiabatic bubble model cannot account for <a class="reference internal" href="#phasechangeth"><span class="std std-ref">Liquid-Vapor Phase Change</span></a></p>
</div>
<span class="target" id="index-61"></span></div>
<div class="section" id="homogeneous-thermal-bubble-model">
<span id="homogeneousbubblemodelth"></span><span id="index-62"></span><h4>Homogeneous (Thermal) Bubble Model<a class="headerlink" href="#homogeneous-thermal-bubble-model" title="Permalink to this headline">¶</a></h4>
<p>In this section we describe an extension of the adiabatic bubble model that adds
non-adiabatic mass and energy changes (see the Flow Science Technical Note #57
on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>). Solid-to-void heat transfer
provides for heat exchange between the gas in a bubble and solid obstacles
exposed to the bubble. Mass and energy exchanges resulting from phase changes at
the bubble’s surface can be included in cases where the bubble gas consists of
liquid vapor.</p>
<p>Homogeneous bubbles have a simple and robust formulation that is consistent with
the liquid thermodynamic properties used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The model is referred to as
the Homogeneous Bubble Model. The nomenclature is meant to emphasize the fact
that the pressure and temperature of gas in a bubble are spatially uniform
(i.e., homogeneous), but these values can vary with time. There can be many such
bubbles in a calculation, each having its own temperature and pressure.</p>
<p>The equation-of-state for a bubble is the ideal gas equation,</p>
<div class="math" id="equation-idealgasequation">
<p><span class="eqno">(46)<a class="headerlink" href="#equation-idealgasequation" title="Permalink to this equation">¶</a></span><img src="_images/math/f7e7edd9d20ca05d5670ef09a1d9dd54c4ad8261.png" alt="p = (\gamma  - 1)\rho C_v^{\rm{vap}}T"/></p>
</div><p>Here</p>
<ul class="simple">
<li><img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is the bubble pressure,</li>
<li><img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the gas density in the bubble,</li>
<li><img class="math" src="_images/math/e194e81de37cafe61b14fb10dc53ea10fd8b176a.png" alt="C_v^{\rm{vap}}" style="vertical-align: -5px"/> is the specific heat at constant volume of the vapor, and</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the vapor temperature in absolute units.</li>
<li>The quantity <img class="math" src="_images/math/0a9c286987ad5fd2f65853d796ca3f4366ae29ec.png" alt="\gamma" style="vertical-align: -4px"/> is the ratio of specific heats for the gas (see <a class="reference internal" href="#variablepressurevoidregionsth"><span class="std std-ref">Variable Pressure Void</span></a>).</li>
</ul>
<p>Note that the gas constant, <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/>, for the bubble is equal to the product
<img class="math" src="_images/math/9d4debbaa23765f14fddb4a92f7af9cf78b349f1.png" alt="\left( {\gamma  - 1} \right)C_V^{\rm{vap}}" style="vertical-align: -5px"/>.</p>
<p>If there are no sources of mass or energy for a bubble, then it will behave as though
it is adiabatic, changing pressure from some initial state (<img class="math" src="_images/math/39e9cb3a8b7c7ad28c1d81f0407b56e5219b5951.png" alt="p_0" style="vertical-align: -4px"/>,<img class="math" src="_images/math/e26a8b5fd23bb80e0b36010e3297f33d5c06357f.png" alt="V_0" style="vertical-align: -3px"/>) to a new state (<img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/>,<img class="math" src="_images/math/f5a322f82f9e644cb83622202e5be0da6a7cbb00.png" alt="V" style="vertical-align: 0px"/>) according to</p>
<div class="math" id="equation-changingpressure">
<p><span class="eqno">(47)<a class="headerlink" href="#equation-changingpressure" title="Permalink to this equation">¶</a></span><img src="_images/math/de42b29261f7e9d226724796be2e8425cda02901.png" alt="p = {p_0}{\left( {\frac{V_0}{V}} \right)^\gamma }"/></p>
</div></div>
<div class="section" id="liquid-vapor-phase-change">
<span id="phasechangeth"></span><h4>Liquid-Vapor Phase Change<a class="headerlink" href="#liquid-vapor-phase-change" title="Permalink to this headline">¶</a></h4>
<p>When phase changes occur it is necessary to have an analytical relation that
expresses the saturation pressure of a vapor in terms of its temperature. In
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> the default for this relation is the Clapeyron equation that gives
<img class="math" src="_images/math/3151f238b5182d5078a8a8cd09401c8058a14dbb.png" alt="P^{\rm{sat}}" style="vertical-align: 0px"/> as a function of temperature <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-clapeyronequation">
<p><span class="eqno">(48)<a class="headerlink" href="#equation-clapeyronequation" title="Permalink to this equation">¶</a></span><img src="_images/math/39becbbd6c6e762590f0ab07177218d85ff01d97.png" alt="{p^{\rm{sat}}} = {\rm{PV1}} \cdot \exp \left[ {\frac{{ - \left( {\frac{1}{T} - \frac{1}{{\rm{TV1}}}} \right)}}{{\rm{TVEXP}}}} \right]"/></p>
</div><p>where:</p>
<ul class="simple">
<li>(<span class="target" id="index-63"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PV1</span></code>, <span class="target" id="index-64"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TV1</span></code>) is a point on the saturation curve, and</li>
<li><span class="target" id="index-65"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TVEXP</span></code> is an exponent constant given by</li>
</ul>
<div class="math" id="equation-exponentconstant">
<p><span class="eqno">(49)<a class="headerlink" href="#equation-exponentconstant" title="Permalink to this equation">¶</a></span><img src="_images/math/de5d823d5dd4cd3472c49bf1b9a8960792342508.png" alt="{\rm{TVEXP}} = \frac{(\gamma  - 1)C_v^{\rm{vap}}}{\rm{CLHV1}}"/></p>
</div><p>where <span class="target" id="index-66"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CLHV1</span></code> is the heat of transformation (latent heat) of phase change.</p>
<p>The rate of phase change is typically modeled as proportional to something
that measures the deviation from saturation conditions. A typical formulation
<a class="reference internal" href="zbibliography.html#theofanous-et-al-1969" id="id8">[TBIF69]</a> based on kinetic theory is</p>
<div class="math" id="equation-proportionalphasechangekinetictheory">
<p><span class="eqno">(50)<a class="headerlink" href="#equation-proportionalphasechangekinetictheory" title="Permalink to this equation">¶</a></span><img src="_images/math/d48148d23db185a92897f74c9f43dfe541102ff2.png" alt="\mathbf{Net} \: \mathbf{mass} \: \mathbf{transfer} = \sqrt {\frac{M}{{2\pi R}}} \left( {{a_{\rm{vap}}}\frac{{{P_l}^{\rm{sat}}}}{{\sqrt {{T_l}} }} - {a_{\rm{con}}}\frac{{{P_v}}}{{\sqrt {{T_v}} }}} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> is the molecular weight of the vapor,</li>
<li><img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> the vapor gas constant,</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is temperature, with subscripts <img class="math" src="_images/math/c7660814d4975114ec4e34bd9165b85496522e7c.png" alt="l" style="vertical-align: 0px"/> and <img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/> referring to liquid and vapor states,</li>
<li>The superscript <img class="math" src="_images/math/29f535683456a5f90df68655b03f4c0f3b5d666c.png" alt="sat" style="vertical-align: 0px"/> on <img class="math" src="_images/math/e68c41700ae751fbbd812826c12b28dd4c9b3f03.png" alt="P_l" style="vertical-align: -3px"/> indicates the saturation pressure corresponding to the liquid temperature <img class="math" src="_images/math/30f3f282bd079b39628e4c1bcc609a222749fb59.png" alt="T_l" style="vertical-align: -3px"/>.</li>
<li>Finally, the coefficients <img class="math" src="_images/math/c67a77a938b8c89dbd6710f0cf5c9351846faae1.png" alt="a_{\rm{vap}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/74d372495c74a5e79fdce3871dfdd54dcea95099.png" alt="a_{\rm{con}}" style="vertical-align: -3px"/> are the “accommodation coefficients” for evaporation and condensation, respectively.</li>
</ul>
<p>The origin of this expression is that the mass flux (for example, condensation
on a liquid surface) must be proportional to the local vapor density and local
velocity of the molecules at the surface. Assuming a Maxwellian velocity
distribution the local velocity into the surface is <a class="reference internal" href="zbibliography.html#plesset-prosperetti-1976" id="id9">[PP76]</a>,</p>
<div class="math" id="equation-masstransferexpression">
<p><span class="eqno">(51)<a class="headerlink" href="#equation-masstransferexpression" title="Permalink to this equation">¶</a></span><img src="_images/math/04e1103c92ec94fe74ad6a5dd354fe672ce0b30b.png" alt="{u_{\rm{in}}} = \sqrt {\frac{{RT}}{{2\pi }}}"/></p>
</div><p>Combining this result with the vapor equation-of-state gives the second
(condensation) term in the mass transfer expression
Eq. <a class="reference internal" href="#equation-proportionalphasechangekinetictheory">(50)</a>. The evaporation term is arrived at in a similar
way. The accommodation coefficient, say <img class="math" src="_images/math/74d372495c74a5e79fdce3871dfdd54dcea95099.png" alt="a_{\rm{con}}" style="vertical-align: -3px"/>, is the probability that
vapor molecules striking the liquid surface are captured. With this
interpretation, the accommodation coefficients should generally be less than or
equal to unity.</p>
<p>Most often the evaporation and condensation accommodation coefficients are
assumed to be equal, but there is no theoretical reason why this must be so.
Furthermore, there are no theoretical predictions for these values. It is worth
noting here that this expression is for the “net” mass transfer from liquid to
vapor. It says nothing about the possibility of molecular exchanges between the
liquid and vapor that transfer energy without a net mass exchange. For present
purposes we have chosen to simplify the phase change rate to</p>
<div class="math" id="equation-simplifiedphasechange">
<p><span class="eqno">(52)<a class="headerlink" href="#equation-simplifiedphasechange" title="Permalink to this equation">¶</a></span><img src="_images/math/85bf9ff043620e5b32e817c5cd63b07acc2ed0d2.png" alt="\mathbf{Net} \: \mathbf{mass} \: \mathbf{transfer} = {\rm{RSIZE}}\sqrt {\frac{M}{{2\pi R{T_{body}}}}} (P_l^{\rm{sat}} - {P_v})"/></p>
</div><p>where <span class="target" id="index-67"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RSIZE</span></code> is a net “accommodation coefficient” and <img class="math" src="_images/math/cb4f9197924c9051c97a8ab28b9a040bd3a4ec74.png" alt="T_{body}" style="vertical-align: -6px"/> is the average liquid
temperature along the surface of the bubble. Different values of the accomodation coefficient can be defined
for evaporation and condensation thus allowing to account for situations when, for example, evaporation rate is lower
than that of condensation in otherwise similar conditions. By default, the two rates in the model are identical.</p>
<span class="target" id="index-68"></span></div>
<div class="section" id="cavitating-void-regions">
<span id="cavitationvoidregionsth"></span><span id="index-69"></span><h4>Cavitating Void Regions<a class="headerlink" href="#cavitating-void-regions" title="Permalink to this headline">¶</a></h4>
<p>Cavitating void regions are created in the fluid when the local pressure drops
below a critical value, <img class="math" src="_images/math/dbe69425cfaef9ef89180722fbc065efb4cba951.png" alt="P_{\rm{cav}}" style="vertical-align: -3px"/>. There are two models to select
from to simulate the rate of cavitation bubble growth: a <em>Simplified model</em>
and an <em>Empirical model</em> (refer to <a class="reference internal" href="model-reference.html#cavitationbubbleformationmr"><span class="std std-ref">Cavitation and Bubble Formation (Nucleation)</span></a> for
details). To simulate the opening of cavitating voids, ensure that the
<span class="guilabel">Active model</span> is selected.</p>
<p>In the <em>Simplified model</em>, the initial rate of void creation can be controlled
by the input parameter <span class="target" id="index-70"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CAVRT</span></code>; in cells where the local fluid
pressure falls below <img class="math" src="_images/math/dbe69425cfaef9ef89180722fbc065efb4cba951.png" alt="P_{\rm{cav}}" style="vertical-align: -3px"/>, the fluid fraction is reduced such
that 1% of the cell become void after <span class="target" id="index-71"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CAVRT</span></code> time. If <span class="target" id="index-72"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CAVRT</span></code>
is not specified, then <img class="math" src="_images/math/378e9bf6f6b13e1a9727d7851d7baf664113bd96.png" alt="5 \Delta t" style="vertical-align: 0px"/> is used as the time scale.</p>
<p>In the <em>Empirical model</em>, the initial rate of void formation is controlled by
a balance of <em>production</em> and <em>dissipation</em> terms. Cavitation production
occurs in cells where the local pressure is below <img class="math" src="_images/math/dbe69425cfaef9ef89180722fbc065efb4cba951.png" alt="P_{\rm{cav}}" style="vertical-align: -3px"/>; the
rate is determined by:</p>
<div class="math" id="equation-cavitation-rate-from-empirical-model">
<p><span class="eqno">(53)<a class="headerlink" href="#equation-cavitation-rate-from-empirical-model" title="Permalink to this equation">¶</a></span><img src="_images/math/c43b2e128bdd2e128f7a13d0b93cd090fe08c86d.png" alt="Cav_{\text{production}} = C_p \frac{E_{\text{turb}}}{\sigma} \rho_l \sqrt{ \left[ \frac{2}{3} \frac{P_{\rm{cav}}-P}{\rho_l} \right] } \left( 1 - f_{\rm{cav}} \right)"/></p>
</div><p>where <img class="math" src="_images/math/567bcd0009992e7590f4a0c19b96aca084a06353.png" alt="C_p" style="vertical-align: -6px"/> is the <span class="guilabel">Cavitation production coefficient</span>,
<img class="math" src="_images/math/65c8c7e86905c4438136ad97057b8b1033b5d764.png" alt="E_{\text{turb}}" style="vertical-align: -3px"/> is the turbulent kinetic energy (or 10% of the total
kinetic energy if no turbulence model selected), <img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> is the
<span class="guilabel">Surface tension coefficient</span>, <img class="math" src="_images/math/dbe69425cfaef9ef89180722fbc065efb4cba951.png" alt="P_{\rm{cav}}" style="vertical-align: -3px"/> is the specified
<span class="guilabel">Cavitation pressure</span>, <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> is the local fluid pressure, and
<img class="math" src="_images/math/3de18dad67614cfce130c173709fcc4fae48f912.png" alt="f_{\rm{cav}}" style="vertical-align: -4px"/> is the mass fraction of cavitation in the computational cell.
Note that this term is non-zero only for cells with <img class="math" src="_images/math/340d18e9b5042d561782a1978768e7c33591ecda.png" alt="P&lt;P_{\rm{cav}}" style="vertical-align: -3px"/>.</p>
<p>Cavitation dissipation occurs in cells where the local pressure is above
<img class="math" src="_images/math/dbe69425cfaef9ef89180722fbc065efb4cba951.png" alt="P_{\rm{cav}}" style="vertical-align: -3px"/>; the rate is determined by:</p>
<div class="math" id="equation-cavitation-rate-dissipation">
<p><span class="eqno">(54)<a class="headerlink" href="#equation-cavitation-rate-dissipation" title="Permalink to this equation">¶</a></span><img src="_images/math/def7638a63a61f8a0745b49ce348fcdf7cb4007b.png" alt="Cav_{\text{dissipation}} = C_d \frac{E_{\text{turb}}}{\sigma} \frac{{\rho_l}^2}{\rho_{\rm{cav}}} \sqrt{ \left[ \frac{2}{3} \frac{P - P_{\rm{cav}}}{\rho_l} \right] } f_{\rm{cav}}"/></p>
</div><p>where <img class="math" src="_images/math/8e43390132ebc319ee56de0fcd61f90e8de3bc2c.png" alt="C_d" style="vertical-align: -3px"/> is the <span class="guilabel">Cavitation dissipation coefficient</span>. This
term is non-zero only for cells with <img class="math" src="_images/math/aeae436da162988f3d4390bf918db6e0a000f353.png" alt="P&gt;P_{\rm{cav}}" style="vertical-align: -3px"/>, and is relevant
only where there is already a positive cavitation volume fraction (ie.,
cavitation volume fraction cannot be negative).</p>
<p>Summed together into the transport equation for cavitation volume fraction,
<img class="math" src="_images/math/76000ebc9b765c55c5893d84056f5daf9fe00058.png" alt="V_{cav}" style="vertical-align: -3px"/> gives:</p>
<div class="math" id="equation-transport-for-cavitation-volume-fraction">
<p><span class="eqno">(55)<a class="headerlink" href="#equation-transport-for-cavitation-volume-fraction" title="Permalink to this equation">¶</a></span><img src="_images/math/7c41d8436c71b3ac5938f3b298cabdcfdc6bae04.png" alt="\frac{D V_{\rm{cav}}}{D t} = Cav_{\text{production}} - Cav_{\text{dissipation}}"/></p>
</div><p>Regardless of the model chosen when the new void region opens it is treated as a
fixed pressure bubble with pressure equal to the cavitation pressure. The
latter is a fixed parameter and at present does not depend on temperature.</p>
<p>Cavitating bubbles can coexist with other types of void regions in a single
calculation.</p>
</div>
</div>
<div class="section" id="vaporization-residue">
<span id="vaporizationresiduetheoryth"></span><span id="index-73"></span><h3>Vaporization Residue<a class="headerlink" href="#vaporization-residue" title="Permalink to this headline">¶</a></h3>
<p>Fluids at free surfaces in a one-fluid problem can either evaporate or condense
when a phase change model is used. This holds true for both cases where the gas
side of the interface is a constant pressure or when it is a homogeneous bubble
region. If the fluid contains one or more solutes, the concentration of the
solutes must change in response to the gain or loss of liquid. Typically, the
solutes become more concentrated due to liquid evaporation.</p>
<p>In either the evaporation or condensation case, any scalar concentration that is
associated with the fluid will have its concentration altered by the phase
change. If a surface element is less than half filled with liquid, then the
concentration change is spread into the principal neighbor of the surface
element to the extent that the concentration region equals half the thickness of
the surface element.</p>
<p>If enough evaporation occurs and the solute concentration becomes high enough,
it may result in a surface skin or a residue may form on a solid surface if the
liquid is completely evaporated. For this to be simulated in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the residue
model must be selected. Activation of this model causes the solute to form a
non-moving residue once its concentration reaches a user-defined maximum packing
density. If more than one solute is present the residue model will record the
total of all solute contributions to the residue.</p>
<span class="target" id="index-74"></span></div>
<div class="section" id="buoyant-flow-model">
<span id="buoyantflowmodelth"></span><span id="index-75"></span><h3>Buoyant Flow Model<a class="headerlink" href="#buoyant-flow-model" title="Permalink to this headline">¶</a></h3>
<p>Many flow situations can be approximated using incompressible fluids but require
evaluation of the influence of buoyant forces associated with small density
variations. In such cases the density is usually represented as a function of
temperature only. Solidification and macro-segregation can also be taken into
account in the buoyant flow model.</p>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> permits a solution of these flows by coupling its incompressible flow
solution algorithm with the solution of the energy transport equation and with
a local evaluation of the density as a function of temperature. The model will
work with single-fluid calculations, with or without a free-surface, and for
two-incompressible-fluid problems. Additionally, the limited compressibility
model may be employed with the buoyant flow model. Buoyant forces are
automatically included in compressible fluids. Flow Science TN #58 on the
users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a> has details on the approximations and
limitations of the model.</p>
<p>When the buoyant flow option is used, the continuity equation, Eqs.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a> or <a class="reference internal" href="#equation-impressibilitycondition">(5)</a>, the
momentum-transport equations, Eq. <a class="reference internal" href="#equation-momentumconservation">(9)</a>, and the
internal-energy-transport equation, Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, are solved. For
free-surface or two-incompressible-fluid problems the fluid fraction equation,
Eq. <a class="reference internal" href="#equation-fluidinterfacesandfreesurfaces1">(19)</a>, is also solved.</p>
<p>Fluid density is determined in the buoyant flow model from the local fluid
fraction <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> and temperature as</p>
<div class="math" id="equation-buoyantflowmodel1">
<p><span class="eqno">(56)<a class="headerlink" href="#equation-buoyantflowmodel1" title="Permalink to this equation">¶</a></span><img src="_images/math/c47fa71abdabf1a0c82d304124914e6a12be9f3d.png" alt="\rho  = F \cdot {\rho _1}(T) + (1 - F) \cdot {\rho _2}(T)"/></p>
</div><p>where</p>
<div class="math" id="equation-buoyantflowmodel2">
<p><span class="eqno">(57)<a class="headerlink" href="#equation-buoyantflowmodel2" title="Permalink to this equation">¶</a></span><img src="_images/math/bfff9de9712e7260bccb05eb9829200a2dc5f28b.png" alt="\begin{gathered}
 {\rho _1}(T) = {\rm{RHOF}} \cdot \left[ {1 - {\rm{THEXF1}} \cdot (T - T^*)} \right] \hfill \\
 {\rho _2}(T) = {\rm{RHOFC}} \cdot \left[ {1 - {\rm{THEXF2}} \cdot (T - T^*)} \right] \hfill \\
\end{gathered}"/></p>
</div><p>In Eq. <a class="reference internal" href="#equation-buoyantflowmodel2">(57)</a>, <img class="math" src="_images/math/1c88c6f2e04776c5ed216385a3cecae5b6b5936a.png" alt="T^*" style="vertical-align: 0px"/> is a reference temperature at which
fluid #1 has the input density <span class="target" id="index-76"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RHOF</span></code> and fluid #2 density <span class="target" id="index-77"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RHOFC</span></code>.
The volumetric thermal expansion coefficients for these fluids are constants
<span class="target" id="index-78"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">THEXF1</span></code> and <span class="target" id="index-79"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">THEXF2</span></code>, respectively. Buoyant forces arise from
imbalances of the pressure gradient and body forces in Eq.
<a class="reference internal" href="#equation-momentumconservation">(9)</a>, which include non-inertial as well as gravitational
accelerations.</p>
<p>The fluid temperature is determined from the transport equation for the internal
energy with the assumption of equal local temperatures in two-fluid cases.</p>
<span class="target" id="index-80"></span></div>
<div class="section" id="core-gas-generation-and-flow-in-sand-cores-and-molds">
<span id="coregasgenerationth"></span><span id="index-81"></span><h3>Core Gas Generation and Flow in Sand Cores and Molds<a class="headerlink" href="#core-gas-generation-and-flow-in-sand-cores-and-molds" title="Permalink to this headline">¶</a></h3>
<p>Gas defects are often found in sand cast parts that arise from gas generated by
thermal decomposition of the sand binder in the sand. A computational model is
available to predict the generation of gas and its transport within cores. The
gas is treated as compressible to account for poor core venting scenarios and
for transport across core regions of steep temperature gradients. The model
considers true molding geometry and actual core venting locations and can be
used to predict the amount of gas that would enter liquid metal from any
location on the surface of the core.</p>
<p>A core is treated as a solid object in the program with no porosity, so that no
liquid metal can flow into its interior. The core gas model then treats the core
object as though it is a porous material in which gas can be generated, flow and
pass in or out of its boundaries using special boundary conditions as described
below.</p>
<p>The core gas generated is thought to be
ideal and have a fixed composition with the gas constant, <img class="math" src="_images/math/d1ed96da25ce38dc95b119df94b7ba78334c43db.png" alt="R_{\rm{cg}}" style="vertical-align: -6px"/>. The gas
constant can be deduced from the experiments in which the gas is collected in a
fixed volume apparatus and the gas pressure is measured. From the measured total
collected standard volume, <img class="math" src="_images/math/35be3c670bc4ce60eae4dbd15e34a1c36eb0f9e3.png" alt="V_{\rm{std}}" style="vertical-align: -3px"/>, and the initial mass of the binder,
<img class="math" src="_images/math/a8c4b0568ceb1a4520f89662e11e74696fa0c1a6.png" alt="m_b" style="vertical-align: -3px"/>, the gas constant is</p>
<div class="math" id="equation-gasconstant">
<p><span class="eqno">(58)<a class="headerlink" href="#equation-gasconstant" title="Permalink to this equation">¶</a></span><img src="_images/math/87b39e3275d878dbe8d9e715ec456b52a471973e.png" alt="{R_{\rm{cg}}} = \frac{p_{\rm{std}}}{T_{\rm{std}}}\frac{V_{\rm{std}}}{m_b}"/></p>
</div><p>The microscopic velocity of the core gas, <img class="math" src="_images/math/5087d4949587d6aabd6ca8f3a6f1b8b82dbb6e6d.png" alt="\vec u_{cg}" style="vertical-align: -6px"/>, is governed by the
equation for flow in porous media:</p>
<div class="math" id="equation-flowinporousmedia">
<p><span class="eqno">(59)<a class="headerlink" href="#equation-flowinporousmedia" title="Permalink to this equation">¶</a></span><img src="_images/math/d9c33c7da3fcd6df814cf06bfd836b4e8c83197c.png" alt="{\phi }{\vec u_{\rm{cg}}} =  - \frac{K}{{\mu}_{\rm{cg}} }\nabla {p_{\rm{cg}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> is the core porosity,</li>
<li><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is the sand permeability,</li>
<li><img class="math" src="_images/math/d68e4e68d44ae419165e23020b45beb8a1299a4c.png" alt="\mu _{\rm{cg}}" style="vertical-align: -6px"/> is the core gas viscosity and</li>
<li><img class="math" src="_images/math/c3b48e11fc1bb05d7a1b8c948ad9bc5814afc4fd.png" alt="p_{\rm{cg}}" style="vertical-align: -6px"/> is the core gas pressure.</li>
</ul>
<p>The macroscopic inertial terms are found to be small for the typical
conditions of the core gas flow and are not included in
<a class="reference internal" href="#equation-flowinporousmedia">(59)</a>. The permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> can be expressed in terms
of the drag coefficient <img class="math" src="_images/math/4a32eb5872138f195fa0a078ab2cd06b45679fa1.png" alt="F_{\rm{d}}" style="vertical-align: -3px"/> according to:</p>
<div class="math" id="equation-coregaspermeability">
<p><span class="eqno">(60)<a class="headerlink" href="#equation-coregaspermeability" title="Permalink to this equation">¶</a></span><img src="_images/math/2d96055708d886f2aa3ef3b2bdc2db50a7759884.png" alt="{K = \frac{{\phi } {\mu }_{\rm{cg }} } {{\rho }_{\rm{cg}} F_ {\rm{d}}}}"/></p>
</div><p>And the drag coefficient <img class="math" src="_images/math/4a32eb5872138f195fa0a078ab2cd06b45679fa1.png" alt="F_{\rm{d}}" style="vertical-align: -3px"/> has a linear Darcy term and a quadratic
Forchheimer term:</p>
<div class="math" id="equation-dragcoefficientk1">
<p><span class="eqno">(61)<a class="headerlink" href="#equation-dragcoefficientk1" title="Permalink to this equation">¶</a></span><img src="_images/math/069a0784f305d4af0d076cae1c493c6ce979f130.png" alt="{F_ {\rm{d}} } = a\frac{{{\mu _{\rm{cg}}}}}{{{\rho _{\rm{cg}}}}}\frac{{{{(1 - \phi )}^2}}}{{{\phi ^2}}} + b\frac{{1 - \phi }}{\phi }{\vec u_{\rm{cg}}},"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/f4054df6e4a79d3c0836e5e1ca381baba12385ed.png" alt="\rho _{\rm{cg}}" style="vertical-align: -6px"/> is the core gas density and</li>
<li><img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/>, <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> are sand specific linear and quadratic flow loss (valve) coefficients.</li>
</ul>
<p>The density of the core gas is governed by the mass transport equation:</p>
<div class="math" id="equation-densitycoregasmasstransportequation">
<p><span class="eqno">(62)<a class="headerlink" href="#equation-densitycoregasmasstransportequation" title="Permalink to this equation">¶</a></span><img src="_images/math/b275bcf534fb48ab48f0776542d9a62b12bf4fcc.png" alt="\frac{{\partial {\rho _{\rm{cg}}}}}{{\partial t}} + \nabla  \cdot \left( {{\rho _{\rm{cg}}}{{\vec u}_{\rm{cg}}}} \right) =  - \frac{{d{\rho _b}}}{{dt}}"/></p>
</div><p>where <img class="math" src="_images/math/d68e4e68d44ae419165e23020b45beb8a1299a4c.png" alt="\mu _{\rm{cg}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/df439395aedb73991a0f63d639d1842815056aa2.png" alt="\rho _b" style="vertical-align: -4px"/> are the microscopic core gas and
macroscopic core binder densities. Since the core gas is compressible, even in
the absence of gas sources there can be a thermal expansion and flow of the
initial air in the core as the core heats up.</p>
<p>The core gas density is further constrained by the ideal gas law:</p>
<div class="math" id="equation-idealgaslaw">
<p><span class="eqno">(63)<a class="headerlink" href="#equation-idealgaslaw" title="Permalink to this equation">¶</a></span><img src="_images/math/3aecb0c052811af5500b76acd1b5d2f81ae56e7b.png" alt="{p_{\rm{cg}}} = {R_{\rm{cg}}}{\rho _{\rm{cg}}}T"/></p>
</div><p>where the temperature of the gas is assumed to be equal to the local core
temperature. This is a good approximation because of the high heat content of
the solid core material compared to that of the gas.</p>
<p>Since it is assumed that the core and gas temperatures are equal, and the core
temperature <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is already computed by the heat transfer solver, the ideal
gas law can be used to compute gas pressure with its density defined by Eq.
<a class="reference internal" href="#equation-densitycoregasmasstransportequation">(62)</a>.</p>
<p>The conversion of the solid binder to gas is described by an Arrhenius equation,</p>
<div class="math" id="equation-arrheniusequation">
<p><span class="eqno">(64)<a class="headerlink" href="#equation-arrheniusequation" title="Permalink to this equation">¶</a></span><img src="_images/math/cc1e71cbcae79e5bb3914851ff1ec947cbc4605c.png" alt="\frac{{d{\rho _b}}}{{dt}} =  - {\rho _b}{C_b}\exp \left( { - \frac{{{E_b}}}{{RT}}} \right),"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/df439395aedb73991a0f63d639d1842815056aa2.png" alt="\rho _b" style="vertical-align: -4px"/> is the solid binder density,</li>
<li><img class="math" src="_images/math/64f87387f78f6e9712c232de2c4f5d8bc915d591.png" alt="C_b" style="vertical-align: -3px"/> is the reaction rate constant the value of which is obtained empirically,</li>
<li><img class="math" src="_images/math/3c69dcf38e80321e2c9b88cff54c55e79fd1b9ab.png" alt="E_b" style="vertical-align: -3px"/> is a component binding energy,</li>
<li><img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> is the universal gas constant and</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the core temperature.</li>
</ul>
<p>The gas source can exhibit an unphysical oscillatory behavior associated with
the discrete size of the computational elements. To alleviate this problem a
simple subdivision scheme is used in each computational cell. The solid binder
density is stored at the sub-cells nodes, while the sub-cell temperature is
obtained through a linear interpolation of the temperature field from the nodes
of the main mesh.</p>
<p>Because the core-gas model is used concurrently with a mold filling model, it is
possible that gas flow in cores may become sufficiently fast to limit the
computational time-step size (by the Courant stability condition for an explicit
advection approximation) to a value smaller than what is needed for the filling
simulation, resulting in longer calculation times. To counter this possibility,
a sub-time-stepping scheme has been incorporated into the core-gas model. This
is possible because the model is coupled to the metal filling simulation through
the boundary conditions at the outer surface of the core (see below). If it is
found that the time-step size for the core-gas model must be smaller than that
for the filling simulation, then the time-step size for the core-gas
computations is reduced to a stable value and the model is run for several
sub-time steps with the fixed thermal and flow solution in the metal. The size of
the sub-time step is an integer fraction of the main time step size, so that the
gas computations can be repeated for that integer number of steps to bring the
gas solution forward to the correct time.</p>
<p>There may be a flow of gas either in or out of the core at boundaries of the
core material. This exchange is treated as a boundary condition for the core-gas
model. The passage of the gas through the core boundary depends on what is
located outside the core. For instance, if the core surface is exposed to air,
then gas may flow across the boundary in either direction depending on the
pressure difference.</p>
<p>If there is liquid metal at the core surface, then gas is allowed to pass out of
the core when its pressure is greater than the pressure of the metal at that
location, but no metal is allowed to enter the core. If the metal has already
solidified at the surface of the core, then no gas is allowed to flow across the
boundary at that location.</p>
<p>Another boundary condition occurs at core print surfaces, that is, where a core
surface is in contact with another solid part of the mold. At these surface
locations, gas does not normally flow unless channels have been cut into the
mold to allow for venting. The core-gas model has an option for allowing venting
at print surfaces.</p>
<span class="target" id="index-82"></span></div>
<div class="section" id="permeable-mold-model">
<span id="index-83"></span><h3>Permeable Mold Model<a class="headerlink" href="#permeable-mold-model" title="Permalink to this headline">¶</a></h3>
<p>Sand is a common material for making casting molds. It is easily “molded” into
any shape, recyclable and has suitable structural and thermal properties.</p>
<p>In addition, a sand mold is permeable which allows the air initially residing in
the cavity to escape during pouring. However, the escape of the air occurs at a
certain rate which, if too low, may result in a significant buildup of back
pressure thus slowing down the filling process. There is a simple model for the
escape of air through a permeable mold in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> that provides the means to
account for the buildup of the back pressure.</p>
<p>The volume flow rate <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> of the air through the mold is computed using a
linear formulation:</p>
<div class="math" id="equation-volumeflowrateq">
<p><span class="eqno">(65)<a class="headerlink" href="#equation-volumeflowrateq" title="Permalink to this equation">¶</a></span><img src="_images/math/41fbc3109c4bb0e49a5243df9a195802e4c11ca7.png" alt="Q = \frac{AK}{\mu L}dP"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is the surface area of mold that is exposed to the air,</li>
<li><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> - the mold permeability,</li>
<li><img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> - the air viscosity,</li>
<li><img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> - average mold thickness, and</li>
<li><img class="math" src="_images/math/c13079bb6f99a9197a93e4bc03864fe9e15e82a8.png" alt="dP" style="vertical-align: 0px"/> is the pressure drop between the air inside and outside of the mold.</li>
</ul>
<p>The mold permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> can be estimated from the mold porosity,
<img class="math" src="_images/math/84e0a5e2ca530ec7d7f6fbc5be702f6c3c716836.png" alt="{\phi}" style="vertical-align: -4px"/>, and average sand grain size <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>:</p>
<div class="math" id="equation-moldpermeabilityk">
<p><span class="eqno">(66)<a class="headerlink" href="#equation-moldpermeabilityk" title="Permalink to this equation">¶</a></span><img src="_images/math/3fe4e2b3d0011365be3ec06842a66814050a573c.png" alt="K = \frac{{\phi}^3}{\left(1 - \phi \right)^2}\frac{d^2}{180}"/></p>
</div><p>The permeable mold model is used together with the adiabatic bubble model, in which
each air region, or bubble, has a uniform pressure that is a function of the
bubble volume. The flow rate <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> is evaluated for each air region using
the bubble pressure and its surface area with the mold. The ambient pressure is
assumed to be the constant and the same for all air regions.</p>
<p>Over a small increment of time, <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/>, the back pressure in an air region,
<img class="math" src="_images/math/9138397a7977b8d1f43aadf19cceae0eb85471f0.png" alt="P_{\rm{air}}" style="vertical-align: -3px"/>, changes due to the compression by the incoming metal,
<img class="math" src="_images/math/acd7e70cc826b7933f56ec842f6f64a582b83ae7.png" alt="dV" style="vertical-align: 0px"/>, and to venting through the mold, <img class="math" src="_images/math/6c4783ab954ba75b7407309823cc21e060cb80c9.png" alt="Qdt" style="vertical-align: -4px"/>:</p>
<div class="math" id="equation-backpressureairregion">
<p><span class="eqno">(67)<a class="headerlink" href="#equation-backpressureairregion" title="Permalink to this equation">¶</a></span><img src="_images/math/1f9205e79d9a977742729c8041b7d9efc27a98c0.png" alt="d{P_{\rm{air}}} = P_{\rm{air}} \cdot \gamma \cdot \frac{dV - Qdt}{V_{\rm{air}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/0a9c286987ad5fd2f65853d796ca3f4366ae29ec.png" alt="\gamma" style="vertical-align: -4px"/> is the ratio of the gas specific heats (1.4 for air) and</li>
<li><img class="math" src="_images/math/ea314ea4fdea1d4a065c36a58c374d98ee58c65c.png" alt="V_{\rm{air}}" style="vertical-align: -3px"/> is the air region volume.</li>
</ul>
<p>mold coating is currently not taken into account.</p>
</div>
<div class="section" id="defect-tracking">
<span id="defecttrackingth"></span><span id="index-84"></span><h3>Defect Tracking<a class="headerlink" href="#defect-tracking" title="Permalink to this headline">¶</a></h3>
<p>Mechanical properties of a casting may strongly depend on the “cleanness” of the
metal with regards to oxide films, air and other foreign inclusions that are
likely to get trapped inside the metal during the filling process. In this
section, a defect source and tracking scheme is described that gives a
qualitative prediction of casting defects originating from surface turbulence
<a class="reference internal" href="zbibliography.html#barkhudarov-hirt-1998" id="id10">[BH98]</a>. The defect model is also coupled with the
lost foam casting model to predict possible defects arising from the residue
remaining on metal surfaces after the foam has been decomposed.</p>
<p>Inclusions at the free surface and from the lost foam residue are represented
as separate quantities. In the free-surface defect model, the quantity
accumulates at free surfaces at a constant <span class="guilabel">Defect generation rate</span>
<span class="target" id="index-85"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DFTSRF</span></code>. The foam residue is incremented by an amount proportional to
the mass of degraded foam with the coefficient of proportionality defined by
<span class="guilabel">Residue generation rate</span> <span class="target" id="index-86"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DFTFOB</span></code>. A transport equation is
solved numerically for each quantity with advection and diffusion terms,
similar to the one given by Eq. <a class="reference internal" href="#equation-transportequation">(279)</a>. A second-order in
space, monotonicity-preserving scheme is used to approximate the advection
terms for increased accuracy. Diffusion of the inclusions is usually small
and, by default, is turned off, but can be included by defining positive
values for the <span class="guilabel">Molecular diffusion coefficient</span> and/or the
<span class="guilabel">Turbulent diffusion coefficient multiplier</span>, which is the inverse
Schmidt number, for the <span class="guilabel">Defect tracking</span> and <span class="guilabel">Lost foam</span>
models.</p>
<p>Both quantities represent the concentration of contamination material.
The likelihood of a defect due to contamination is proportional to the concentration.
Defects are more likely in places of highly localized peaks of concentration of either quantity.</p>
<p>At this point no buoyancy or oxide film strength effects are included in the
model. Also not included are such phenomena as oxide film sticking to mold walls
and foam residue escape through the porous sand mold. The wicking of the liquid
products of foam decomposition in the lost foam casting process can be included
(see the <a class="reference internal" href="model-reference.html#lostfoammr"><span class="std std-ref">Lost Foam Casting Process</span></a> for details).</p>
<p>At the conclusion of a simulation, the spatial distribution of the inclusion
concentrations indicates locations where defects are likely to be. In most
cases the majority of the inclusions are found at the last place to fill, as
would be expected. In other words, contaminants accumulate at the metal front
and are pushed along until there is nowhere else for them to go. More
interesting, however, are situations two fronts meet, trapping surface
inclusions in the interior of the metal, or near corners where flow
recirculation regions may develop. Even the circulation remaining in metal
after a mold has filled can redistribute surface-generated contaminants.</p>
<p>Without detailed experimental comparisons to correlate predictions from this
type of model with actual defects, it is impossible to assign any significance
to the absolute values of the scalar. Therefore, the rate coefficients
can have arbitrary positive values. However, qualitative results from even the
simplest of test cases reveals a considerable amount of useful insight into the
processes responsible for defect generation and their final distribution in a
cast part.</p>
<span class="target" id="index-87"></span></div>
<div class="section" id="drift-flux-model">
<span id="driftfluxmodelth"></span><span id="index-88"></span><h3>Drift-Flux Model<a class="headerlink" href="#drift-flux-model" title="Permalink to this headline">¶</a></h3>
<p>In fluids composed of multiple components, e.g., fluid/particles, fluid/bubbles,
fluid/fluid mixtures, where the components have different densities, it is
observed that the components can assume different flow velocities. Velocity
differences arise because the density differences result in non-uniform body
forces. Often the differences in velocities can be very pronounced, for example,
large raindrops falling through air or gravel sinking in water. Under many
conditions, however, the relative velocities are small enough to be described as
a “drift” of one component through the other. Examples are dust in air and silt
in water.</p>
<p>The “drift” distinction has to do with whether or not the inertia of a dispersed
component moving in a continuous component is significant. If the inertia of
relative motion can be ignored, and the relative velocity reduced to a balance
between a driving force (e.g., gravity or a pressure gradient) and an opposing
drag force between the components, then we can speak of a “drift-flux”
approximation. Drift velocities are primarily responsible for the transport of
mass and energy. Some momentum may be transported as well, but this is usually
quite small and has been neglected in the <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> drift model.</p>
<p>The idea behind the drift model is that the relative motion between components
can be approximated as a continuum, rather than by discrete elements (e.g.,
particles). This enhances computational efficiency, as the need for tracking the
motion and interaction of discrete elements do not need to be computed.</p>
<p>There are four different physical situations in which a drift velocity can be
employed in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>:</p>
<ul class="simple">
<li>One fluid, variable density flows, where the fluid is a mixture of two components
having densities <img class="math" src="_images/math/1ada0b4f0860d12949225ea370c1199b8beeb57d.png" alt="\rho _1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/b004e5c1e898c9fd52b692d32a2f27c4b047c984.png" alt="\rho _2" style="vertical-align: -4px"/>.</li>
<li>One fluid with solidification, where the fluid is a mixture of liquid and solid
having densities <img class="math" src="_images/math/1ada0b4f0860d12949225ea370c1199b8beeb57d.png" alt="\rho _1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/b004e5c1e898c9fd52b692d32a2f27c4b047c984.png" alt="\rho _2" style="vertical-align: -4px"/>.</li>
<li>Two incompressible fluids having densities <img class="math" src="_images/math/1ada0b4f0860d12949225ea370c1199b8beeb57d.png" alt="\rho _1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/b004e5c1e898c9fd52b692d32a2f27c4b047c984.png" alt="\rho _2" style="vertical-align: -4px"/>.</li>
<li>A compressible gas with an incompressible component. In this case the density of
the compressible gas is given by an equation-of-state, while the incompressible
material has density <img class="math" src="_images/math/1ada0b4f0860d12949225ea370c1199b8beeb57d.png" alt="\rho _1" style="vertical-align: -4px"/>, which is always assumed to be much larger
than the gas density.</li>
</ul>
<p>The formulation of the relative velocity in the drift approximation proceeds as
follows. Suppose a flow is composed of two discrete components or phases, one
the continuous phase, and the other the dispersed phase, which is discontinuous
and surrounded by the continuous phase. Note that the same system of fluids can
have opposite configurations: for the case of a small quantity of water
contaminating a large volume of diesel fuel, the water is the dispersed phase;
conversely, when small amounts of diesel fuel are present in water, the diesel
fuel is the dispersed phase.</p>
<p>Define <img class="math" src="_images/math/97fd6fd6d098a7e5f9ed25f174555b24b4cc7eb8.png" alt="\textbf u = f_1 \textbf {u}_1 + f_2 \textbf {u}_2" style="vertical-align: -4px"/> such that
<img class="math" src="_images/math/635e97b1ade4245398bfa31f7c488780693de253.png" alt="\nabla  \cdot \textbf u = 0" style="vertical-align: -1px"/> for the incompressible flow of a
two-component fluid.</p>
<p>The volume fractions of the two components making up a mixture are denoted by
<img class="math" src="_images/math/c7311e6aa81136d777636401fd2ec92920c43f5f.png" alt="f_1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/fc500bc2f435aa8b6a923d005e9cecd8c99fb795.png" alt="f_2" style="vertical-align: -4px"/>, where</p>
<div class="math" id="equation-volumefractions2components">
<p><span class="eqno">(68)<a class="headerlink" href="#equation-volumefractions2components" title="Permalink to this equation">¶</a></span><img src="_images/math/e9a25a510e234352371d05ae0130d366e74b7c9a.png" alt="{f_1} + {f_2} = 1"/></p>
</div><p>If we presume that the two phases are incompressible, the momentum balance for
the continuous phase is</p>
<div class="math" id="equation-momentumbalancecontinuousphase">
<p><span class="eqno">(69)<a class="headerlink" href="#equation-momentumbalancecontinuousphase" title="Permalink to this equation">¶</a></span><img src="_images/math/610ad67e3b7bd2e5647c787137eccfc09b7bf7de.png" alt="\frac{\partial {\mathbf{u}}_1}{\partial t} + {{\mathbf{u}}_1} \cdot \nabla {\mathbf{u}}_1 =  - \frac{1}{\rho _1}\nabla P + {\mathbf{F}} + \frac{K}{f{\rho _1}}{\mathbf{u}}_r"/></p>
</div><p>while for the dispersed phase it is</p>
<div class="math" id="equation-momentumbalancedispersedphase">
<p><span class="eqno">(70)<a class="headerlink" href="#equation-momentumbalancedispersedphase" title="Permalink to this equation">¶</a></span><img src="_images/math/3eee2fb2fe21817f9cf2f7e5867434e795e7bd23.png" alt="\frac{\partial {\mathbf{u}}_2}{\partial t} + {\mathbf{u}}_2 \cdot \nabla {\mathbf{u}}_2 =  - \frac{1}{\rho _2}\nabla P + \mathbf{F} - \frac{K}{(1 - f){\rho _2}}{\mathbf{u}}_r"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/b8b96e997bc251b0094d6ceedacee75d0a18f1c1.png" alt="{\textbf {u}}_1" style="vertical-align: -3px"/> and <img class="math" src="_images/math/563f087f7d4dc63d2e7167c4c51640ad12553331.png" alt="{\textbf {u}}_2" style="vertical-align: -3px"/> represent the microscopic velocities of the continuous and dispersed phases, respectively, and</li>
<li><img class="math" src="_images/math/3daf2576f9b26b234f68a5e23fcd520c09823740.png" alt="f" style="vertical-align: -4px"/> is the volume fraction of the continuous phase.</li>
<li>The microscopic velocity refers to the velocity of each phase about a small but finite volume of fluid.</li>
<li><img class="math" src="_images/math/5917aeb4b60b13725f1f4c0b44480274df6e6e5f.png" alt="\textbf F" style="vertical-align: 0px"/> is the body force,</li>
<li><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is a drag coefficient that relates the interaction of the two phases, and</li>
<li><img class="math" src="_images/math/331e442f7c4672a94559dc42fcccf2da52744e32.png" alt="{\textbf {u}}_r" style="vertical-align: -3px"/> is the relative velocity difference between the dispersed and continuous phases:</li>
</ul>
<div class="math" id="equation-volumeaveragedvelocity">
<p><span class="eqno">(71)<a class="headerlink" href="#equation-volumeaveragedvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/c284d21dee1b9bdd10cdfd0da3d71d87727b9250.png" alt="{\mathbf{u}}_r = {\mathbf{u}}_2 - {\mathbf{u}}_1"/></p>
</div><p>The goal of the drift-flux model is to compute the motion of the two phases
relative to the volume-averaged velocity, <img class="math" src="_images/math/911cc3ccdb6f7d2cb467b9454ecd8150438c3a97.png" alt="{\bar {\textbf {u}}}" style="vertical-align: 0px"/>. The
volume-weighted average velocity is</p>
<div class="math" id="equation-volumeweightedaveragevelocity">
<p><span class="eqno">(72)<a class="headerlink" href="#equation-volumeweightedaveragevelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/0897209d3078767b69095f088d53e15a5481c99f.png" alt="{\mathbf{\bar u}} = f{\mathbf{u}}_1 + (1 - f){\mathbf{u}}_2"/></p>
</div><p>The volume-weighted average velocity is chosen rather than the mass-weighted
average because mass continuity is automatically enforced, without alteration,</p>
<div class="math" id="equation-massweightedaverage">
<p><span class="eqno">(73)<a class="headerlink" href="#equation-massweightedaverage" title="Permalink to this equation">¶</a></span><img src="_images/math/ba4b048aa8cde8d9643a823309840350846c81e1.png" alt="\nabla  \cdot {\mathbf{\bar u}} = 0"/></p>
</div><p>as is momentum conservation.</p>
<p>Subtracting Eq. <a class="reference internal" href="#equation-momentumbalancecontinuousphase">(69)</a> from Eq.
<a class="reference internal" href="#equation-momentumbalancedispersedphase">(70)</a> produces an equation for the relative
velocity where <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is the drag coefficient per unit volume,</p>
<div class="math" id="equation-relativevelocity">
<p><span class="eqno">(74)<a class="headerlink" href="#equation-relativevelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/4a6751eec43bcd950fa72f70edd062fc64d7ce67.png" alt="\frac{{\partial {\mathbf{u}}_r}}{\partial t} + {\mathbf{u}}_2 \cdot \nabla {\mathbf{u}}_2 - {\mathbf{u}}_1 \cdot \nabla {\mathbf{u}}_1 = \left( {\frac{1}{\rho _1} - \frac{1}{\rho _2}} \right)\nabla P - \left( {\frac{1}{{(1 - f){\rho _2}}} + \frac{1}{{f{\rho _1}}}} \right)K{{\mathbf{u}}_r}"/></p>
</div><p>The goal is to determine the relative velocity, <img class="math" src="_images/math/331e442f7c4672a94559dc42fcccf2da52744e32.png" alt="{\textbf {u}}_r" style="vertical-align: -3px"/>. If we
employ Eq. <a class="reference internal" href="#equation-relativevelocity">(74)</a> in its entirety, this would constitute a
two-velocity-field model for two-component flow. For simplicity, however, we have
chosen to make the drift-flux approximation, i.e., we assume that the relative
velocity is nearly steady and the advective terms cancel (i.e., for small
relative velocity <img class="math" src="_images/math/331e442f7c4672a94559dc42fcccf2da52744e32.png" alt="{\textbf {u}}_r" style="vertical-align: -3px"/>). Under these assumptions we have</p>
<div class="math" id="equation-relativevelocitydriftfluxapprox">
<p><span class="eqno">(75)<a class="headerlink" href="#equation-relativevelocitydriftfluxapprox" title="Permalink to this equation">¶</a></span><img src="_images/math/2bf95796c801d9a774058f88093faba9ccd9fa7a.png" alt="\left( {\frac{1}{\rho _1} - \frac{1}{\rho _2}} \right)\nabla P = \left( {\frac{{f{\rho _1} + (1 - f){\rho _2}}}{{f(1 - f){\rho _1}{\rho _2}}}} \right)K{{\mathbf{u}}_r}"/></p>
</div><p>Since the relative velocity <img class="math" src="_images/math/331e442f7c4672a94559dc42fcccf2da52744e32.png" alt="{\textbf {u}}_r" style="vertical-align: -3px"/> is based on the microscopic
velocities of each phase, then the drag force must contain some information
about the volume fraction of the suspended phase. For example, a suspension with
an infinitesimally small amount of the suspended phase will produce an
infinitesimally small momentum exchange between the components.</p>
<p>If we presume that the suspended phase is composed of particles that are the
same size, and there are <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> of them in a unit volume, then</p>
<div class="math" id="equation-suspendedphaseparticlessamesize">
<p><span class="eqno">(76)<a class="headerlink" href="#equation-suspendedphaseparticlessamesize" title="Permalink to this equation">¶</a></span><img src="_images/math/96ca04458acde8c5556a23fadc2115c70adec8a7.png" alt="{{\mathbf{u}}_r} = \left( {\frac{{{V_p}}}{{{K_p}}}} \right)\frac{{f({\rho _2} - {\rho _1})}}{{\bar \rho }}\nabla P"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/e318f2ed388216ba36a8e3f20669cee7bd0a48fe.png" alt="{V_p} = \left( {1 - f} \right)/n" style="vertical-align: -6px"/> is the volume of a particle and</li>
<li><img class="math" src="_images/math/f260cf8d7d301afbe8939298464f1835db53f316.png" alt="K_p" style="vertical-align: -6px"/> is the drag coefficient for a single particle moving with velocity magnitude <img class="math" src="_images/math/6d12b89fda3513c7e6db1fea14155d2b60a8eeab.png" alt="\left| {{\textbf{u}}_r} \right|" style="vertical-align: -5px"/> through the continuous fluid, and</li>
</ul>
<div class="math" id="equation-volumeweightedaveragedensity">
<p><span class="eqno">(77)<a class="headerlink" href="#equation-volumeweightedaveragedensity" title="Permalink to this equation">¶</a></span><img src="_images/math/8d96d149f084bfb21dbaa674fdfd7cb0ee09299c.png" alt="\bar \rho  = f{\rho _1} + (1 - f){\rho _2}"/></p>
</div><p>is the volume-weighted average density.</p>
<p>A quadratic dependence between the drift coefficient and the relative flow
velocity is used in the model. If <img class="math" src="_images/math/cc8525efbda543301dd00b825755d76dbcd84de7.png" alt="U" style="vertical-align: 0px"/> is the magnitude of relative
velocity of the particle moving in a continuous fluid, then</p>
<div class="math" id="equation-quadraticdependencedriftcoefficientrelativeflowvelocity">
<p><span class="eqno">(78)<a class="headerlink" href="#equation-quadraticdependencedriftcoefficientrelativeflowvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/36a72908dd78d08b3cd3f75ef5c4001646c860b7.png" alt="{K_p} = \frac{1}{2}{A_p}{\rho _c}\left( {{C_d}U + \frac{{12{\mu _c}}}{{{\rho _c}{R_p}}}} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/8e43390132ebc319ee56de0fcd61f90e8de3bc2c.png" alt="C_d" style="vertical-align: -3px"/> is a drag coefficient,</li>
<li><img class="math" src="_images/math/36a7ab61377662a8efdc0c7f045bf8de74aaecfc.png" alt="R_p" style="vertical-align: -6px"/> is the average particle radius and</li>
<li><img class="math" src="_images/math/76f33918841510e15d8098f9d04510b3097370be.png" alt="A_p" style="vertical-align: -6px"/> is the cross sectional area of the particle, which is assumed to be spherical.</li>
</ul>
<p>The average particle size <img class="math" src="_images/math/36a7ab61377662a8efdc0c7f045bf8de74aaecfc.png" alt="R_p" style="vertical-align: -6px"/> is defined either as a constant for all of the
particulate phase or, when the particulate phase is made of gas bubbles or liquid droplets,
can be calculated dynamically in space and time based on the local flow conditions.</p>
<p>When the volume fraction of dispersed material is not vanishing small, the use
of a single particle drag force for computing the momentum exchange between
components is not quite correct. The most frequently used correction to account
for particle/particle interactions is an experimentally determined relation
referred to as the Richardson-Zaki correlation.</p>
<p>Richardson-Zaki’s correlation is dependent on the particle Reynolds number,
<img class="math" src="_images/math/ba3da9b640a699a63f1628d145f6c5f5407e4e10.png" alt="Re = \left( {2{\rho _c}{R_p}U/{\mu _c}} \right)" style="vertical-align: -6px"/>. The correlation
consists of replacing the drift velocity by multiplying the computed value,
<img class="math" src="_images/math/abd44f253dddf124fdfd2b08efffe6f22ba4caf7.png" alt="{\textbf{u}}_r" style="vertical-align: -3px"/>, by the continuous component volume fraction <img class="math" src="_images/math/3daf2576f9b26b234f68a5e23fcd520c09823740.png" alt="f" style="vertical-align: -4px"/> raised to a
power <img class="math" src="_images/math/641ac646152ce966fe12cc9c69c275954b47ab83.png" alt="\zeta" style="vertical-align: -4px"/>,</p>
<div class="math" id="equation-richardsonzakicorrelation">
<p><span class="eqno">(79)<a class="headerlink" href="#equation-richardsonzakicorrelation" title="Permalink to this equation">¶</a></span><img src="_images/math/7cdb51133dc2c6b08a636e319ca966c025cb5687.png" alt="{\mathbf{u}}_r^{eff} = {\mathbf{u}}_r\cdot max(0.5,f)^\zeta"/></p>
</div><p>The exponent <img class="math" src="_images/math/641ac646152ce966fe12cc9c69c275954b47ab83.png" alt="\zeta" style="vertical-align: -4px"/> is the product of the Richardson-Zaki coefficient
<img class="math" src="_images/math/b255373d60feef5e6c357388cbb47469a060b9af.png" alt="rzmlt" style="vertical-align: 0px"/> and <img class="math" src="_images/math/9628bdbabd75625e749f50b611587cb859842071.png" alt="\zeta _0" style="vertical-align: -4px"/>, that is, <img class="math" src="_images/math/75ce67d4b2f71e40e0be45b9be219f8dfbcde692.png" alt="\zeta  = rzmlt*{\zeta _0}" style="vertical-align: -4px"/>
where</p>
<table border="1" class="colwidths-given longtable docutils" id="richardsonzakicoefficienttable">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">Re &lt; 0.2</th>
<td><img class="math" src="_images/math/7f9b97abc3a8fc0d7ea81faf199c2f8b3a22732c.png" alt="{\zeta _0} = 4.35" style="vertical-align: -4px"/></td>
</tr>
<tr class="row-even"><th class="stub">0.2 &lt; Re &lt; 1.0</th>
<td><img class="math" src="_images/math/0e1809c1b52719916b71370a27b822c494104f9d.png" alt="{\zeta _0} = 4.35/{Re}^{0.03}" style="vertical-align: -5px"/></td>
</tr>
<tr class="row-odd"><th class="stub">1.0 &lt; Re &lt; 500</th>
<td><img class="math" src="_images/math/fbce196df8f8ae0371359151acc9414d893b84d2.png" alt="{\zeta _0} = 4.45/{Re}^{0.1}" style="vertical-align: -5px"/></td>
</tr>
<tr class="row-even"><th class="stub">500 &lt; Re</th>
<td><img class="math" src="_images/math/0888d9fad0cab515812744f48c4ec7c93ad0457c.png" alt="{\zeta _0} = 2.39" style="vertical-align: -4px"/></td>
</tr>
</tbody>
</table>
<p>The upper limit of 0.5 is used for the volume fraction of the continous phase to reflect
the fact that the Richardson-Zaki correclation has been empirically validated for the
dispersed phase concentrations below 50%. The adjusted, or effective, value of the relative
velocity, <img class="math" src="_images/math/517ddf06b1ca70f706602eba3626e94cbd9e4f68.png" alt="{\textbf{u}}_r^{eff}" style="vertical-align: -5px"/>, is used for the computation of all drift fluxes.</p>
</div>
<div class="section" id="electro-mechanics">
<span id="electromechanicsth"></span><span id="index-89"></span><h3>Electro-mechanics<a class="headerlink" href="#electro-mechanics" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-90"></span><div class="section" id="electric-field-model">
<span id="electricfieldmodelth"></span><span id="index-91"></span><h4>Electric Field Model<a class="headerlink" href="#electric-field-model" title="Permalink to this headline">¶</a></h4>
<p>To simulate physical processes such as movement of charged mass particles,
particle and liquid dielectrophoresis, and electro-osmosis, an electric field
distribution is needed. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the electric potential is solved for using the
following equation.</p>
<div class="math" id="equation-electricpotential">
<p><span class="eqno">(80)<a class="headerlink" href="#equation-electricpotential" title="Permalink to this equation">¶</a></span><img src="_images/math/6a4b7993f63339ddd7b8a4e6195ce5d23b863bc8.png" alt="\nabla  \cdot \left( {K\nabla \phi } \right) =  - \frac{\rho _e}{\varepsilon _0}"/></p>
</div><p>with the electric field calculated by</p>
<div class="math" id="equation-electricfieldequation">
<p><span class="eqno">(81)<a class="headerlink" href="#equation-electricfieldequation" title="Permalink to this equation">¶</a></span><img src="_images/math/8aa5424b379891086bebbc1f62766fd56302a6c1.png" alt="{\mathbf{E}} =  - \nabla \phi"/></p>
</div><p>where <img class="math" src="_images/math/3d888ddb2443e6da38df14a509870ab19f40bd8d.png" alt="\rho _e" style="vertical-align: -4px"/>, <img class="math" src="_images/math/cb71144687434ad55d8d245fef722f08c6ab68da.png" alt="\varepsilon _0" style="vertical-align: -3px"/> are free charge density (i.e.,
electric charge per unit volume) and permittivity of vacuum or void (defined by
<span class="target" id="index-92"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">elperm</span></code> in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>) respectively while <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is the spatially-varying
dielectric constant.</p>
<p>Numerical solution of the Poisson equation Eq. <a class="reference internal" href="#equation-electricpotential">(80)</a> is done by
an iterative solver using the GMRES method.</p>
<p>At open boundaries (i.e., boundaries through which fluid flow can occur),
either an insulation condition (i.e., <img class="math" src="_images/math/42198f9fcfff50951fdbe2ac4c434254387ba9b0.png" alt="{\mathbf{n}} \cdot \nabla \phi
= 0" style="vertical-align: -4px"/> where <img class="math" src="_images/math/42d0f992449e2f5fe826d9d67c67e5acc17f3c3b.png" alt="\textbf n" style="vertical-align: 0px"/> is a normal vector on the boundary in question)
or a specified value of the electric field can be specified. Solid objects can
be assigned time-dependent potentials if they are conductors. Alternatively,
an object can be a dielectric material with an assigned dielectric constant.
In this case, the electric potential is computed within the object. Also,
solid dielectrics may have non-zero conductivities that support free charges
and currents.</p>
<p>Optionally, a charge density equation that includes charge convection, charge
relaxation and charge sources associated with non-uniform electric properties is
solved simultaneously with the electric potential. Please refer to
<a class="reference internal" href="model-reference.html#electricfieldsmr"><span class="std std-ref">Electric Fields</span></a> in the Model Reference chapter and the <a class="reference internal" href="#electricfieldtechnotes"><span class="std std-ref">Technical
Notes</span></a> listed at the end of this section for more
information.</p>
<p>Most people use the SI system of units for electrostatic and electromagnetic
problems. In the SI system the standard unit of charge is the coulomb and the
unit of potential is the volt. Electric field intensities are measured in
Newton/coulomb in the SI system. When using the CGS system of units, it is
customary to express charge and potential in the “electrostatic” units of
statvolt and statcoulomb, where:</p>
<blockquote>
<div><p>1 coulomb (C) = 2.998 <img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/> 10<sup>9</sup> statcoulomb (statC)</p>
<p>1 volt (V) = 3.336 <img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/> 10<sup>-3</sup> statvolt (statV)</p>
</div></blockquote>
<p>Electric forces are then,</p>
<blockquote>
<div><p>1 Newton = 1 C <img class="math" src="_images/math/6ecb3a29a5c5a29b76e5ca9e375cb15b8f854dd7.png" alt="\cdot" style="vertical-align: 4px"/> V <img class="math" src="_images/math/6ecb3a29a5c5a29b76e5ca9e375cb15b8f854dd7.png" alt="\cdot" style="vertical-align: 4px"/> m<sup>-1</sup> = 10<sup>5</sup> dyne</p>
<p>1 dyne = 1 statC <img class="math" src="_images/math/6ecb3a29a5c5a29b76e5ca9e375cb15b8f854dd7.png" alt="\cdot" style="vertical-align: 4px"/> statV <img class="math" src="_images/math/6ecb3a29a5c5a29b76e5ca9e375cb15b8f854dd7.png" alt="\cdot" style="vertical-align: 4px"/> cm<sup>-1</sup> = 10<sup>-5</sup> Newton</p>
</div></blockquote>
<p>If the fluid or solid regions are conducting then charges may develop in
response to the applied field and to changes in conductivity and dielectric
properties. If a thermal model is activated then Joule heating due to these
currents is computed in all conducting fluids and solids. The heat source
per unit open cell volume and time associated with passing electric current through
conducting fluid, <img class="math" src="_images/math/493d491e9536fad3dddcb77e9ca6e445f8fdb0f3.png" alt="Q_{Joule}" style="vertical-align: -4px"/>, is</p>
<div class="math" id="equation-jouleheatingsourcefluid">
<p><span class="eqno">(82)<a class="headerlink" href="#equation-jouleheatingsourcefluid" title="Permalink to this equation">¶</a></span><img src="_images/math/e9b27728ed072d9ca0ac90cf8d7337958e8af857.png" alt="Q_{Joule} = F \cdot VF \cdot \kappa|\mathbf{E}|^{2}"/></p>
</div><p>where <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> and <img class="math" src="_images/math/1e4c5a07c8c91a43337b7c0861f9fb71bdde604a.png" alt="VF" style="vertical-align: 0px"/> are the fluid and open volume fractions in cell and
<img class="math" src="_images/math/8552154a335b142ca0da9298ca0c193c45daf188.png" alt="\kappa" style="vertical-align: 0px"/> is  the fluid electrical conductivity. For two-fluid problems, <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>
is replaced with 1.0 and <img class="math" src="_images/math/8552154a335b142ca0da9298ca0c193c45daf188.png" alt="\kappa" style="vertical-align: 0px"/> with the volume-averaged mixture value of the
electrical conductivity. Similarly, the Joule heat source in solid is</p>
<div class="math" id="equation-jouleheatingsourcesolid">
<p><span class="eqno">(83)<a class="headerlink" href="#equation-jouleheatingsourcesolid" title="Permalink to this equation">¶</a></span><img src="_images/math/eae5dbd58fb6f23d7755e8827462947622948b2c.png" alt="Q_{Joule solid} = (1 - VF) \cdot \kappa_{solid}|\mathbf{E}|^{2}"/></p>
</div><p id="electricfieldtechnotes">More details are given in Flow Science Technical Notes #52, #56, #69 and #70 on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>.</p>
</div>
<div class="section" id="electro-osmosis">
<span id="electroosmosistheoryth"></span><span id="index-93"></span><h4>Electro-osmosis<a class="headerlink" href="#electro-osmosis" title="Permalink to this headline">¶</a></h4>
<p>Generally, most substances such as silica and glass will acquire a surface
electric charge when brought into contact with an aqueous (polar) medium
(electrolyte solution), as shown in the figure below.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/surface-electric-charge.png"><img alt="Surface electric charge when brought into contact with an aqueous (polar) medium (electrolyte solution)" src="_images/surface-electric-charge.png" style="width: 3.125in;" /></a>
</div></blockquote>
<p>A layer called the electric double layer (EDL) is formed close to the charged
surface in which there is an excess of counter-ions over co-ions to neutralize
the surface charge. There are more counter-ions than co-ions in the region
near the fluid/solid interface. The electric potential created due to the EDL
is called the <img class="math" src="_images/math/1450e4534424fdc2778dabd4d38603f628f898c1.png" alt="\xi -" style="vertical-align: -4px"/>potential and is assumed to be imposed at the
solid surface. The <img class="math" src="_images/math/1450e4534424fdc2778dabd4d38603f628f898c1.png" alt="\xi -" style="vertical-align: -4px"/>potential is a property of the solid-liquid
pair and can be measured experimentally. The thickness of the EDL is indicated
by the following parameter, called the Debye shielding distance or Debye
length.</p>
<div class="math" id="equation-debyeshieldingdistance">
<p><span class="eqno">(84)<a class="headerlink" href="#equation-debyeshieldingdistance" title="Permalink to this equation">¶</a></span><img src="_images/math/15f3dc281a3e19b45576e5d7721b8ea2c0ef5db8.png" alt="{\lambda _D} = {\left( {\frac{{\varepsilon RT}}{{2{F^2}{z^2}{c_0}}}} \right)^{\frac{1}{2}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/8d43774b9306502f07b6c7deaa6595cc0702fffd.png" alt="\varepsilon" style="vertical-align: 0px"/> = liquid permittivity</li>
<li><img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> = gas constant</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> = temperature</li>
<li><img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> = Faraday’s constant</li>
<li><img class="math" src="_images/math/df3cac5e0887fb66bb456c30659e38cf12901d4e.png" alt="c_0" style="vertical-align: -3px"/> = ion concentration</li>
<li><img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> = valence</li>
</ul>
<p>More details on EDL and related physics can be found in <a class="reference internal" href="zbibliography.html#probstein-1994" id="id11">[Pro94]</a>.</p>
<p>Electro-osmotic flow or electro-osmosis refers to the fluid motion that occurs
when an electric field is applied to an electrolyte solution in the vicinity of
a charged surface. The process can be described by the following equations</p>
<div class="math" id="equation-electroosmosis1">
<p><span class="eqno">(85)<a class="headerlink" href="#equation-electroosmosis1" title="Permalink to this equation">¶</a></span><img src="_images/math/87a05932a3b157297971680acbf8a2d640ef19d4.png" alt="{\mathbf{F}} = {\rho _E}{\mathbf{E}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-electoosmosis2">
<p><span class="eqno">(86)<a class="headerlink" href="#equation-electoosmosis2" title="Permalink to this equation">¶</a></span><img src="_images/math/ec363de6df05f6cf6f952ef175f653f3761cfc40.png" alt="{\rho _E} =  - 2F{c_0}\sinh (\frac{{F\psi }}{{RT}})"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-electroosmosis3">
<p><span class="eqno">(87)<a class="headerlink" href="#equation-electroosmosis3" title="Permalink to this equation">¶</a></span><img src="_images/math/38e960e4bc9f31cc590c838707fe627f665e9bbd.png" alt="{\nabla ^2}\psi  = \frac{{\rho E}}{\varepsilon }"/></p>
</div><p>where <img class="math" src="_images/math/22e7bbdc5bdeef74134a5feb0a44f7269c104e83.png" alt="\psi" style="vertical-align: -4px"/> is the <img class="math" src="_images/math/1450e4534424fdc2778dabd4d38603f628f898c1.png" alt="\xi -" style="vertical-align: -4px"/>potential. An insulation-like boundary
condition is imposed for the <img class="math" src="_images/math/1450e4534424fdc2778dabd4d38603f628f898c1.png" alt="\xi -" style="vertical-align: -4px"/>potential on all mesh boundaries
with a symmetry condition. On solid (obstacle) surfaces, the <img class="math" src="_images/math/1450e4534424fdc2778dabd4d38603f628f898c1.png" alt="\xi -" style="vertical-align: -4px"/>potential is imposed. Here Boltzmann charge density distribution for liquid with
single valence is assumed. But the user can easily provide other different
charge density distributions in two simple functions named <strong class="program">psi</strong> and
<strong class="program">dfdpfi</strong> released to users. How to do this customization is described in
these two functions.</p>
<p>Please refer to <a class="reference internal" href="model-reference.html#electroosmosismr"><span class="std std-ref">Electro-osmosis</span></a> in Model Reference to
get related information on how to use the model.</p>
</div>
<div class="section" id="particle-movement-and-fluid-flow-due-to-electric-field">
<span id="particlemovementth"></span><span id="index-94"></span><h4>Particle Movement and Fluid Flow Due to Electric Field<a class="headerlink" href="#particle-movement-and-fluid-flow-due-to-electric-field" title="Permalink to this headline">¶</a></h4>
<p>An electric charge or charge dipoles can be carried by molecules, small
droplets, and particles which are called charge, or charge dipole carriers, or
mass particles in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. If the charge of a mass particle, <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, is
<img class="math" src="_images/math/6756690422603c9d94fd3939e7394df2c62a5ecf.png" alt="e_i" style="vertical-align: -3px"/>, the electric force (called coulomb force) acting on this particle
is</p>
<div class="math" id="equation-coulombforce">
<p><span class="eqno">(88)<a class="headerlink" href="#equation-coulombforce" title="Permalink to this equation">¶</a></span><img src="_images/math/0d9c57c11529132681330b86bf3d7bf5d674d5dd.png" alt="{{\mathbf{f}}_i} = {e_i}{\mathbf{E}}"/></p>
</div><p>where <img class="math" src="_images/math/e2d1238eea938cf82f0d947a07e598edeca09dff.png" alt="{\mathbf{E}}" style="vertical-align: 0px"/> is the electric field intensity and its calculation is
described above. If a mass particle, <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, carries charge dipoles and the
corresponding dipole moment is <img class="math" src="_images/math/7281c89ea4ceb96d1b1b2eff3d868154fe1bb032.png" alt="p_i" style="vertical-align: -4px"/>, the electric force (called
polarization force) imposed on this mass particle is</p>
<div class="math" id="equation-polarizationforce">
<p><span class="eqno">(89)<a class="headerlink" href="#equation-polarizationforce" title="Permalink to this equation">¶</a></span><img src="_images/math/094322f342c3fc1681801bdee83e4f6dce016a16.png" alt="{{\mathbf{f}}_i} = ({{\mathbf{p}}_i} \cdot \nabla ){\mathbf{E}}"/></p>
</div><p>If all energy losses in the carriers are neglected, the dipole moment is
calculated by</p>
<div class="math" id="equation-dipolemoment">
<p><span class="eqno">(90)<a class="headerlink" href="#equation-dipolemoment" title="Permalink to this equation">¶</a></span><img src="_images/math/29d139b96a113cdfef5334fc6af5b747efbaf33c.png" alt="{{\mathbf{p}}_i} = 4\pi {\varepsilon _0}r_p^3K_f\left( {\frac{{{K_p} - K_f}}{{{K_p} + 2K_f}}} \right){\mathbf{E}}"/></p>
</div><p>where <img class="math" src="_images/math/f260cf8d7d301afbe8939298464f1835db53f316.png" alt="K_p" style="vertical-align: -6px"/> is the particle dielectric constant, <img class="math" src="_images/math/71f513ae2bc4f5ef905de9e6fa90fdab8c59c001.png" alt="K_f" style="vertical-align: -6px"/> is the
fluid dielectric constant, <img class="math" src="_images/math/3c7d8804e899cb07dfc45f582ca52f7b313a422b.png" alt="r_p" style="vertical-align: -6px"/> is the particle radius and <img class="math" src="_images/math/a03d9ddd4e1cfdb44a6e9b3183bb5e348e98a638.png" alt="e_0" style="vertical-align: -3px"/>
is the permittivity of vacuum. Then, the electric force imposed on mass
particle, <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, carrying the charge dipoles can be cast into</p>
<div class="math" id="equation-electricforceimposedonmassparticlei">
<p><span class="eqno">(91)<a class="headerlink" href="#equation-electricforceimposedonmassparticlei" title="Permalink to this equation">¶</a></span><img src="_images/math/ae4e4e4b2016ab046ee785246cce0dfe70864bf5.png" alt="{{\mathbf{f}}_i} = 2\pi {\varepsilon _0}r_p^3K_f\left( {\frac{{{K_p} - K_f}}{{{K_p} + 2K_f}}} \right)\nabla {E^2}"/></p>
</div><p>Instead of paying attention to the carriers mentioned above, we consider fluid
where these charges or charge dipole carriers are distributed. According to
Newton’s law, the fluid will experience some body forces due to existence of
charge or charge dipoles. The body force due to free charge is</p>
<div class="math" id="equation-bodyforceduetofreecharge">
<p><span class="eqno">(92)<a class="headerlink" href="#equation-bodyforceduetofreecharge" title="Permalink to this equation">¶</a></span><img src="_images/math/b197f08fa99ca00dbd5c136e622ff03f1441f160.png" alt="{\mathbf{F}} =  - {\rho _e}{\mathbf{E}}"/></p>
</div><p>where <img class="math" src="_images/math/3d888ddb2443e6da38df14a509870ab19f40bd8d.png" alt="\rho _e" style="vertical-align: -4px"/> is the free charge density. The body force due to charge
dipoles is</p>
<div class="math" id="equation-bodyforceduetochargedipoles">
<p><span class="eqno">(93)<a class="headerlink" href="#equation-bodyforceduetochargedipoles" title="Permalink to this equation">¶</a></span><img src="_images/math/6543755e2c38ff7dcc78cb8c3d621be8cc4428b2.png" alt="{\mathbf{F}} = ({\mathbf{P}} \cdot \nabla ){\mathbf{E}}"/></p>
</div><p>where <img class="math" src="_images/math/5aae2347d74e594801d4ade42c55cf4332849f83.png" alt="{\mathbf{P}}" style="vertical-align: 0px"/> is the density of the dipole moment. For dilute
dipoles in fluid, this density can be calculated by</p>
<div class="math" id="equation-dilutedipolesinfluid">
<p><span class="eqno">(94)<a class="headerlink" href="#equation-dilutedipolesinfluid" title="Permalink to this equation">¶</a></span><img src="_images/math/0d1e5ffc73c8725e90af99ad36502a2668503bab.png" alt="{\mathbf{P}} = {\varepsilon _0}(K_f - 1){\mathbf{E}}"/></p>
</div><p>The body force is then calculated by</p>
<div class="math" id="equation-bodyforce">
<p><span class="eqno">(95)<a class="headerlink" href="#equation-bodyforce" title="Permalink to this equation">¶</a></span><img src="_images/math/4e1bf1233d1fbe76b894447f9a68477530517e79.png" alt="{\mathbf{F}} = \frac{1}{2}{\varepsilon _0}(K_f - 1)\nabla {E^2}"/></p>
</div><p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, users can provide a charge density distribution. This distributed
charge density is defined using the <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> scalar variable having index
<span class="target" id="index-95"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IECHRG</span></code> (a <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> input parameter).</p>
<p>Movement of particles carrying induced charge dipoles due to polarization is
called particle Dielectrophoresis (DEP) while fluid flow due to existence of
charge dipoles from polarization is called liquid Dielectrophoresis.</p>
<p>With the aforementioned equations included in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, users can simulate both
particle and liquid Dielectrophoresis. Please refer to
<a class="reference internal" href="model-reference.html#dielectrophoresisrefmr"><span class="std std-ref">Dielectrophoresis</span></a> to get related information on how to use the
models.</p>
<span class="target" id="index-96"></span></div>
</div>
<div class="section" id="high-concentration-granular-media-model">
<span id="highconcentrationgranularmediamodelth"></span><span id="index-97"></span><h3>High Concentration Granular Media Model<a class="headerlink" href="#high-concentration-granular-media-model" title="Permalink to this headline">¶</a></h3>
<p>The designation of high concentration granular flow here means the volume
fraction of the granular material is 50% or greater. At high concentrations a
strong coupling exists between the solid particles and surrounding fluid so their
mixture can be well approximated as a single, composite fluid. This mixture is
treated as an incompressible fluid that may contain free surfaces separating it
from regions of pure gas. Two-phase effects within the mixture resulting from
differences in the velocities of the two materials are accounted for using a
Drift-Flux approximation.</p>
<p>There are two versions of the granular flow model. In one version the continuous fluid
surrounding the solid particulates is a gas, while in the other the continuous fluid is
a liquid in which case the mixture is referred to as a <em>slurry</em>.</p>
<p>The composite fluid, in general, has a non-uniform density. Density of the fluid
mixture cannot change with the bulk mixture flow because of the assumption of
incompressibility. However, density variations do develop because of the
relative flow between solid and gas within the mixture as described by the
Drift-Flux model.</p>
<p>Solid packing requires the removal of fluid displaced when the solid particles are
squeezed together. In the gas/granular mixture model this loss of mixture volume is
treated as a loss of gas at the free surface of the mixture. Gas may escape to the surrounding
void at a free surface because of the relative motion between grains and gas. All
removed gas is transferred to an adjacent gas bubble. In the liquid/granular mixture
model the compaction of solid material can result in regions of pure liquid,
having free surface boundaries with void.</p>
<p>Discrete solids can only be packed to a specified close packing limit whose
density is less than the density of the pure solid. A typical value for the
solid volume fraction of close packed spherical particles, of uniform size, is
<img class="math" src="_images/math/e2efb4482a4d74b667a30b4cc06892d67d791c6d.png" alt="{f_s}^{\rm{max}} = 0.63" style="vertical-align: -4px"/>. In the Drift-Flux model an option is
available that defines the maximum solid fraction that can occur. This limit is
imposed by forcing the drift velocity to zero when the limiting volume fraction
is reached. This treatment is similar to the limiting of the drift-velocity by
the Richardson-Zaki correlation, which is an empirical accounting for
particle-particle interactions occurring at higher volume fractions of dispersed
material.</p>
<p>Shear stress in granular materials at high concentrations is well known to be
much larger than the viscous shear stress of the fluid carrying the dispersed
solid. Extensive work, beginning with the 1941 work of <a class="reference internal" href="zbibliography.html#bagnold-1941" id="id12">[Bag05]</a> has been
summarized and further extended to a larger range of experimental conditions by
<a class="reference internal" href="zbibliography.html#mih-1999" id="id13">[Mih99]</a>. At high concentrations the principal contribution to the shear
stress arises from impact forces, or collisions, between grains. A second, and
generally, smaller contribution arises from the distributed solid affecting the
fluid. Mih’s expression for the effective dynamic viscosity, adapted from
Equation (39) in <a class="reference internal" href="zbibliography.html#mih-1999" id="id14">[Mih99]</a>, is,</p>
<div class="math" id="equation-effectiveviscositygranular">
<p><span class="eqno">(96)<a class="headerlink" href="#equation-effectiveviscositygranular" title="Permalink to this equation">¶</a></span><img src="_images/math/0e7ec4877871969f4bf5d21dece153bab88072cb.png" alt="{\mu _{\rm{eff}}} = 7.8\mu \left( {\frac{{{\lambda ^2}}}{{1 + \lambda }}} \right) + {\rho _s}\left( {\frac{{0.015}}{{1 + 0.5\rho /{\rho _s}}}} \right)\left( {\frac{{1 + e}}{{{{\left( {1 - e} \right)}^{0.5}}}}} \right){\left( {\lambda d} \right)^2}\left| {\frac{{du}}{{dy}}} \right|"/></p>
</div><p>Here:</p>
<ul class="simple">
<li><img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> and <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> are the continuous fluid viscosity and density,</li>
<li><img class="math" src="_images/math/d5c2f29ca6f35099e3db11f5e15f2634d163f8ef.png" alt="\rho _s" style="vertical-align: -4px"/> is the sand density,</li>
<li><img class="math" src="_images/math/a7228df3b7d8f5ae91504d95e1bf39e4323d0a90.png" alt="e" style="vertical-align: 0px"/> is the coefficient of restitution associated with grain impacts,</li>
<li><img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is the grain diameter and</li>
<li><img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> is a function of the maximum solid volume fraction <img class="math" src="_images/math/e2efb4482a4d74b667a30b4cc06892d67d791c6d.png" alt="{f_s}^{\rm{max}} = 0.63" style="vertical-align: -4px"/> divided by the solid volume fraction <img class="math" src="_images/math/36434a9974445ce37530db1b9e87b6e3e917181e.png" alt="f_s" style="vertical-align: -4px"/>,</li>
</ul>
<div class="math" id="equation-packingeffectiveness">
<p><span class="eqno">(97)<a class="headerlink" href="#equation-packingeffectiveness" title="Permalink to this equation">¶</a></span><img src="_images/math/12710f84e0f468133f506f6fc0a8034190e14df2.png" alt="\lambda  = \frac{1}{{{{\left( {1.032{{f_s^{\text{max}}} / {f_s}}} \right)}^{1/3}} - 1}}"/></p>
</div><p>Physically, <img class="math" src="_images/math/69abd82bdfa9892b575d5af133056765b3f1fecb.png" alt="\lambda = d / S" style="vertical-align: -5px"/> where <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> is defined as the average
distance between grain centers minus their diameter <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>. When the grain
touch, <em>i.e.</em>, are packed, S=0 and <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> becomes infinite.</p>
<p>For our purposes, the simple shear rate <img class="math" src="_images/math/b9480a621726c95f16eddc5861ef81b3d8e8f06d.png" alt="{du}/{dy}" style="vertical-align: -5px"/> is replaced by the
magnitude of the rate of strain <img class="math" src="_images/math/992f70236542777c373e18ea21c43911c1367e5e.png" alt="e_{ij}" style="vertical-align: -6px"/> and a typical coefficient of restitution for
sand of 0.7 is assumed as a good general value. With these changes, Eq. <a class="reference internal" href="#equation-effectiveviscositygranular">(96)</a>
is reduced to</p>
<div class="math" id="equation-shearthickeningviscositygranular">
<p><span class="eqno">(98)<a class="headerlink" href="#equation-shearthickeningviscositygranular" title="Permalink to this equation">¶</a></span><img src="_images/math/a86d3152adfc58f72426fdc1bed36499bd18cbdc.png" alt="{\mu _{\rm{eff}}} = 7.8\mu \left( {\frac{{{\lambda ^2}}}{{1 + \lambda }}} \right) + 0.066{\rho _s}{\left( {\lambda d} \right)^2}\left| {{e_{ij}}} \right|."/></p>
</div><p>This expression is a “shear thickening” viscosity. The thickening character
arises from the impact mechanism between grains, a process referred to as
saltation. That is, fast moving grains flowing over a bed of settled or slow
moving grains will strike one another causing the slow moving grains to be
knocked upwards into the moving stream where they absorb momentum from the
stream through further collisions.</p>
<p>The impact viscosity term (the second term in Eq. <a class="reference internal" href="#equation-shearthickeningviscositygranular">(98)</a>) has the generic form of a
Large-Eddy-Simulation (LES) viscosity. Since the empirically derived expression in Eq.
<a class="reference internal" href="#equation-shearthickeningviscositygranular">(98)</a> involves turbulent flow conditions it is
not necessary (and perhaps not consistent) to use a turbulence transport model
with the granular flow model.</p>
<p>An important element in modeling two-phase flow of fluid/granular mixture is to have a
mechanism for sand to pack and resist motion under applied pressures and body
forces. A type of flow resistance model is used for this purpose that is based
on observations of blowing sand with air. As granular material packs to a density where
individual grains begin to touch one another, it becomes more difficult for the
mixture to flow. This state is sometimes referred to as one of
mechanical jamming and has a typical volume fraction of <img class="math" src="_images/math/32ff30f37e51f5470ee80cbeb77824ddb72c40ff.png" alt="{f_s}^{\rm{jam}} =
0.61" style="vertical-align: -4px"/>. At still higher solid densities, corresponding to solid packing, grains
remain in contact with their neighbors and are not able to flow at all.</p>
<p>According to Bagnold, grains that have settled and packed on a bed can
only be dislodged or knocked up into a region of flowing sand if the flowing
sand has a velocity that exceeds a threshold value, <img class="math" src="_images/math/d581a778f92806945f606a4ee9f421423d68ffbb.png" alt="u_{\rm{thrs}}" style="vertical-align: -3px"/>. Based on empirical
studies and an approximate theory, which includes the magnitude of the gravity
<img class="math" src="_images/math/71cab12214c636268195b8fecc4d43fbe6089abf.png" alt="\textbf g" style="vertical-align: -4px"/> and grain diameter <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>, the threshold velocity is</p>
<div class="math" id="equation-thresholdvelocity">
<p><span class="eqno">(99)<a class="headerlink" href="#equation-thresholdvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/6b832edc94b8801384c4b6eea7f3b8c0b6cf5265.png" alt="{u_{\rm{thrs}}} = 1.41{C_{\rm{drg}}}\sqrt {d\left| \textbf {g} \right|{{\left( {{\rho _s} - {\rho _a}} \right)}/{{\rho _a}}}}"/></p>
</div><p>where <img class="math" src="_images/math/7514f1b03b6ee9bcbee969791a8ef7ded2e0a69a.png" alt="C_{\rm{drg}}" style="vertical-align: -6px"/> is equal to 1.0. The inclusion of <img class="math" src="_images/math/7514f1b03b6ee9bcbee969791a8ef7ded2e0a69a.png" alt="C_{\rm{drg}}" style="vertical-align: -6px"/> in this
expression is to allow for future adjustment to the threshold velocity to
possibly account for cohesion effects between grains.</p>
<p>The packing resistance in a mesh element containing fluid is assumed to be
zero if the fluid velocity in the element is larger than this threshold value
or if the volume fraction of the solid material is less than that necessary
for mechanical jamming.  For volume fractions larger than the jamming value
and velocities less than the threshold value, a flow resistance term is added to the
right side of the fluid momentum equation as a negative acceleration given by</p>
<div class="math" id="equation-flowresistancenegativeacceleration">
<p><span class="eqno">(100)<a class="headerlink" href="#equation-flowresistancenegativeacceleration" title="Permalink to this equation">¶</a></span><img src="_images/math/b0e9a7b60536eabba91e42e041a202ebf4b1a91d.png" alt="- {S_{\rm{drg}}}\sqrt {\frac{{\left| g \right|}}{{\,4d}}} \left( {\frac{{{u_{\rm{thrs}}} - \left| {\vec u} \right|}}{{{u_{\rm{thrs}}}}}} \right)\left( {\frac{{{f_s} - f_s^{\rm{jam}}}}{{f_s^{\rm{max}} - f_s^{\rm{jam}}}}} \right)\vec u"/></p>
</div><p>where <img class="math" src="_images/math/0460737c4971ca988ace16a58013727ecaf3eeb9.png" alt="S_{\rm{drg}}" style="vertical-align: -6px"/> is a non-dimensional coefficient of order unity. This
resistance is proportional to the flow velocity in excess of the threshold speed
and also proportional to the volume fraction of sand.</p>
<p>When the volume fraction of solid material reaches <img class="math" src="_images/math/7459c2c3a9dd95b922407bdf3fa431e83b891856.png" alt="{f_s}^{\rm{max}}" style="vertical-align: -4px"/>,
the flow velocity is set to zero and the material is
considered to be fully packed and immobile. An exception to this rule is in surface elements
having a slope greater than an <strong>angle of repose</strong> defined as the angle between
the inward surface normal and the direction of the body force, <em>e.g.</em>, gravity.
In such elements there is no flow resistance.</p>
<p>There are exceptions to the angle of repose and close packing limits that give
the present model more realism for granular flow. One exception is the inclusion
of an <strong>friction angle</strong> chosen as 2 degrees larger than the angle of repose.
When a surface is packed, and at rest, it cannot flow until the surface slope is
greater than the friction angle, but then it will continue to flow only as long
at the slope remains greater than the angle of repose. The friction angle acts
as a kind of static friction that must be overcome before flow can occur. A
similar “static friction” concept is used in the interior of the composite fluid
to unpack a previously packed region.</p>
<p>At a solid wall boundary where granular material may be falling (drifting) away
from the boundary resulting in a solid volume fraction of less than 50%. In the case
gas/granular mixture, a
special treatment is necessary. In this case there is initially no free surface
so one must be created by a kind of “cavitation” process. When a solid fraction
less than 50% is found at a location that is not identified as a free surface,
the pressure at that grid element location is allowed to relax toward the
external gas pressure and the grid element is flagged as a special element in
which the pressure is defined and incompressibility is not enforced. This action
allows the element to open up and become a new pure gas region.</p>
<p>The maximum packing volume fraction <img class="math" src="_images/math/7459c2c3a9dd95b922407bdf3fa431e83b891856.png" alt="{f_s}^{\rm{max}}" style="vertical-align: -4px"/> is an input
variable with the default value of 0.63, that can be changed by the user. The volume
fraction of jamming, <img class="math" src="_images/math/3dc64f362bd30fa90db4d87292260d4967a87f0e.png" alt="{f_s}^{\rm{jam}}" style="vertical-align: -4px"/>, defaults to 0.61 and is also an input
parameter.</p>
<p>The granular flow model described here has some limitations, such as not
allowing for a detailed flow of fluid through packed solids. Nevertheless, it
produces useful results with many realistic features. For example, in
applications to the making of sand cores for metal casting, very good
qualitative agreement has been obtained with experimental data.</p>
<span class="target" id="index-98"></span><div class="section" id="sand-core-blowing-model">
<span id="sandcoreblowingmodelth"></span><span id="index-99"></span><h4>Sand Core Blowing Model<a class="headerlink" href="#sand-core-blowing-model" title="Permalink to this headline">¶</a></h4>
<p>The generation of sand cores for metal casting applications is typically done by
blowing a sand/air mixture into a box containing a cavity with the desired shape
of the core. Multiple air vents are usually provided in the box in an effort to
achieve a uniform sand fill over the entire volume of the core. These vents are
also used in many cases to allow hot air or a catalyst gas to be blown through
the sand to affect a thermal or chemical cure of a bonding agent coated on the
sand particles.</p>
<p>The sand core model is an application of the model for granular flow
supplemented with specially defined air vents. Output from the model includes
not only a history of the filling pattern within a core box, taking into account the
location and size of the air vents, but also provides information about density
variations that may exist within the finished core.</p>
<p>Details of the basic flow model can be found in the description of the
<a class="reference internal" href="#highconcentrationgranularmediamodelth"><span class="std std-ref">High Concentration Granular Media Model</span></a>. Vents necessary for sand core blowing are
of two types; regular vents that directly exchange air between pockets of
air in a die and air external to the die, and venting that is the result of an
indirect air flow from the pockets through sand to vents that have been covered
over by sand. The latter venting is referred to as “global venting.”</p>
<p>Regular vents are similar to valves as both are mechanisms for exchanging gas
between pure gas regions (bubbles) within a computational grid and pressure
regions external to the grid. A vent is characterized by a location, flow
area, <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/>, an external pressure, <img class="math" src="_images/math/f8135745e09b9621e0ac33a2394440061ac18fe9.png" alt="P_{\rm{ext}}" style="vertical-align: -3px"/>, and a vent pressure (valve)
coefficient, <img class="math" src="_images/math/cd02e086d13e2c2b9fe9c812aa7333dbb60c98e6.png" alt="V_c" style="vertical-align: -3px"/>. If a pure gas region encompasses a vent it will
either gain or lose gas depending on the pressure difference. The volume flow
rate through a vent, <img class="math" src="_images/math/528fd3bcb4ce4f7ece76f514651a368396d8ded7.png" alt="Q_v" style="vertical-align: -4px"/>, is defined as,</p>
<div class="math" id="equation-volumeflowratethroughvent">
<p><span class="eqno">(101)<a class="headerlink" href="#equation-volumeflowratethroughvent" title="Permalink to this equation">¶</a></span><img src="_images/math/5a5f04d7e92ab476663b32cd4d0e6bcc898f0584.png" alt="Q_v = V_c \cdot A \cdot \sqrt {\frac{{2\left( p - P_{\rm{ext}} \right)}}{\rho }}"/></p>
</div><p>The square root factor is a Bernoulli approximation for the flow velocity
passing through the vent because of a pressure drop. The variables <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> and
<img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> are the pressure and density of the gas adjacent to the vent. For
simplicity this is rewritten as,</p>
<div class="math" id="equation-volumeflowratethroughventsimplified">
<p><span class="eqno">(102)<a class="headerlink" href="#equation-volumeflowratethroughventsimplified" title="Permalink to this equation">¶</a></span><img src="_images/math/29e38214202130b5f11d5c95c2a5f951b09b4f7a.png" alt="Q_v = V_{c2} \cdot \sqrt {p - P_{\rm{ext}}}"/></p>
</div><p>where the vent coefficient, vent flow area the factor of 2 and the gas density
<img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> under the root sign have all been combined into the vent pressure (valve) coefficient
<img class="math" src="_images/math/742118652757641a275596a5453ae5ba24f799f5.png" alt="V_{c2}" style="vertical-align: -3px"/>.</p>
<p>For typical sand core blowing applications, sand screens are placed over vent
channels having openings that are holes or slots with sharp edges. A reasonable
estimate for the flow loss through these openings is <img class="math" src="_images/math/45c3b3c7b271d4c77893160404fd6017de92081d.png" alt="\frac{1}{2}" style="vertical-align: -6px"/>. Thus,
the vent coefficient is given by,</p>
<div class="math" id="equation-ventcoefficient">
<p><span class="eqno">(103)<a class="headerlink" href="#equation-ventcoefficient" title="Permalink to this equation">¶</a></span><img src="_images/math/7cf856daf20c4eb68f8c23a41d695dca666b35b4.png" alt="V_{c2} = A \sqrt {\frac{1}{{2\rho }}}"/></p>
</div><p>where <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is the actual open flow area of the vent (e.g., the screen).</p>
<p>Any number of vents can be defined. If the mixture fluid fraction in a
computational grid cell containing a vent location is greater than 0.5 it is
assumed that the vent is blocked by the fluid and no further gas flow is allowed
through the vent.</p>
<p>In sand core blowing even packed sand is porous to the flow of gas. A simple
representation of this gas flow that allows all air bubbles in a core box to be
vented whether or not they contain a vent is referred to as a global vent. The
global vent has the same formulation as an individual vent except that the
external pressure for the global vent <img class="math" src="_images/math/6f3f8c6a32ca716ec12c3a73dd80c868fb41d1d4.png" alt="P_g" style="vertical-align: -6px"/> is
the <em>average</em> of all the regular <img class="math" src="_images/math/f8135745e09b9621e0ac33a2394440061ac18fe9.png" alt="P_{\rm{ext}}" style="vertical-align: -3px"/> values and the global vent
coefficient <img class="math" src="_images/math/3026829a9c119a15c92165bb26174ae6851ca39e.png" alt="V_g" style="vertical-align: -6px"/> is the <em>sum</em> of all the regular
<img class="math" src="_images/math/742118652757641a275596a5453ae5ba24f799f5.png" alt="V_{c2}" style="vertical-align: -3px"/> values. In addition, the flow coefficient of the global vent is
multiplied by a factor <img class="math" src="_images/math/3026829a9c119a15c92165bb26174ae6851ca39e.png" alt="V_g" style="vertical-align: -6px"/> that accounts for the average flow
losses through sand plus the reduction in area of the vents because of blockage by
sand.</p>
<p>A simple estimate can be made for the global vent coefficient multiplier
<img class="math" src="_images/math/3026829a9c119a15c92165bb26174ae6851ca39e.png" alt="V_g" style="vertical-align: -6px"/>. In a standard vent the flow velocity passing through the vent is
estimated using a Bernoulli approximation together with a flow loss factor. For
the global vent the air must flow through the porous sand before escaping through the
actual vents. We shall assume that the
permeability of the sand is dominated by form losses, an assumption that
allows a more direct comparison with the Bernoulli expression for a normal vent.
Using this assumption the air velocity passing through the sand to the vents can
be estimated by the expression,</p>
<div class="math" id="equation-airvelocitypassingthroughsandtovents">
<p><span class="eqno">(104)<a class="headerlink" href="#equation-airvelocitypassingthroughsandtovents" title="Permalink to this equation">¶</a></span><img src="_images/math/9f5b70f7ba93b0f3e0eee02e16f0f6441556aab7.png" alt="\left| u \right| = {\left( {\frac{{d{\left( {1 - f_s^{\rm{max}}} \right)}^2}}{6f_s^{\rm{max}}L}} \right)^{1/2}}\sqrt {\frac{2\left( {p - P_g} \right)}{\rho}}"/></p>
</div><p>In this expression <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is the air pressure in the die, <img class="math" src="_images/math/6f3f8c6a32ca716ec12c3a73dd80c868fb41d1d4.png" alt="P_g" style="vertical-align: -6px"/> is
the external pressure, <img class="math" src="_images/math/fc0d30f966ba81e75bb6d4da4d51381a0f5eee2f.png" alt="{\rho}" style="vertical-align: -4px"/> is the density of air, <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is the
diameter of the sand grains, <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> is the average distance between the air
pocket and the vents and <img class="math" src="_images/math/7459c2c3a9dd95b922407bdf3fa431e83b891856.png" alt="{f_s}^{\rm{max}}" style="vertical-align: -4px"/> is the volume fraction of
fully packed sand. The factors involving the packed solid fraction account for
the porosity in the sand. The volume of air vented through this global vent
per unit time, <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/>, is the product of the number of normal vents,
<img class="math" src="_images/math/de12bb61efe42ed0ec491a8a289813a95d5a5862.png" alt="N_v" style="vertical-align: -3px"/>, times the vent area, <img class="math" src="_images/math/0591b4c629ad5262c4013b19b4a4a5184aeeb5fb.png" alt="A_v" style="vertical-align: -3px"/>, reduced by sand blockage and
times the above velocity,</p>
<div class="math" id="equation-volumeflowrateopenvents">
<p><span class="eqno">(105)<a class="headerlink" href="#equation-volumeflowrateopenvents" title="Permalink to this equation">¶</a></span><img src="_images/math/0d8fd4f9ff3750c5b753dcaea2c316b6f6de2e5d.png" alt="Q = N_v{A_v\left( {1 - f_s^{\rm{max}}} \right)\left| u \right|}"/></p>
</div><p>Comparing this rate with a normal vent rate, Eqs.
<a class="reference internal" href="#equation-volumeflowratethroughventsimplified">(102)</a> and <a class="reference internal" href="#equation-ventcoefficient">(103)</a>, gives the
effective additional coefficient associated with flow through sand that
must multiply the sum of the normal vent pressure (valve) coefficients,</p>
<div class="math" id="equation-effectiveadditionallosscoefficient">
<p><span class="eqno">(106)<a class="headerlink" href="#equation-effectiveadditionallosscoefficient" title="Permalink to this equation">¶</a></span><img src="_images/math/bcf9e82aa0a91eabab875aad8cf1bea7d889a1f4.png" alt="V_g = {\left( {\frac{{2{{\left( {1 - f_s^{\rm{max}}} \right)}^4}}}{{3f_s^{\rm{max}}}}} \right)^{1/2}}{\left( {\frac{d}{L}} \right)^{1/2}}"/></p>
</div><p>For a maximum sand packing fraction of <img class="math" src="_images/math/e2efb4482a4d74b667a30b4cc06892d67d791c6d.png" alt="{f_s}^{\rm{max}} = 0.63" style="vertical-align: -4px"/>, a nominal
grain diameter of 0.02 cm and an estimate of <img class="math" src="_images/math/079812e4a2e3855f3caf4b9b88562e492984df67.png" alt="L = 1.0" style="vertical-align: 0px"/> <em>cm</em> this expression
gives <img class="math" src="_images/math/6514fe217b690dd35648616245a637a600be8bf4.png" alt="V_g = 0.02" style="vertical-align: -6px"/>. This value has been found computationally to give reasonable
results.</p>
<span class="target" id="index-100"></span></div>
<div class="section" id="slurry-model">
<span id="slurrymodelth"></span><span id="index-101"></span><h4>Slurry Model<a class="headerlink" href="#slurry-model" title="Permalink to this headline">¶</a></h4>
<p>A mixture of solid particulates and liquid is often referred to as a slurry. Slurries may be encountered
in manufacturing processes and occur naturally in debris flows in mountain canyons following heavy rains.
An important feature in a slurry - because of the relatively small difference in densities between the carrier
fluid and the solid - is a <em>dispersive</em> pressure that arises from the many collisions of particles in shear flow that tend
to knock them apart. Under a sufficiently large shear stress the dispersive pressure can prevent the particles from
settling and packing. The <em>friction</em> angle <img class="math" src="_images/math/8dab0df2ff557458fe8a76de28326d7484d985ba.png" alt="\Theta_{friction}" style="vertical-align: -6px"/> connects the tangential and normal stresses occurring in
particle collisions. Typically this angle is on the order of 2 to 8 degrees larger than the angle of repose.
A larger friction angle reduces the dispersive pressure.</p>
<p><a class="reference internal" href="zbibliography.html#bagnold-1941" id="id15">[Bag05]</a> introduced the notion of dispersive pressure in connection with the flow of sand and air.
At high solid fraction concentrations, the principal viscous mechanism in a solid/fluid mixture arises from collisions
between grains, which are very effective in transferring tangential momentum in a shearing flow.  When particle collide,
however, they bounce off one another and in addition to exchanging tangential momentum also tend to move away from each
other in a direction normal to the shear. This tendency for grains to move apart and opening up a larger space between
them is also referred to as Reynolds dilatation when it occurs during an initial application of a shear flow.
Bagnold recognized that in general a collision-generated shear stress should always have a corresponding normal stress,
which he called the dispersive pressure, because it tends to disperse the solid grains. The relation between the two is expressed simply as,</p>
<div class="math" id="equation-dispersivepressure">
<p><span class="eqno">(107)<a class="headerlink" href="#equation-dispersivepressure" title="Permalink to this equation">¶</a></span><img src="_images/math/c2d7b3d0fb8db08a8180d3453969418f3beca618.png" alt="{\tau} = {tan(\Theta_{friction})P_{dispersive}}"/></p>
</div><p>where <img class="math" src="_images/math/79aedd36af08713ce51192cbfb62fb1531326f1a.png" alt="\tau" style="vertical-align: 0px"/> is the tangential collision stress and <img class="math" src="_images/math/342f37e686742c78a3d8fbc4b90389ac8e76487e.png" alt="P_{dispersive}" style="vertical-align: -6px"/> the corresponding dispersive pressure, or normal stress.
The friction angle <img class="math" src="_images/math/8dab0df2ff557458fe8a76de28326d7484d985ba.png" alt="\Theta_{friction}" style="vertical-align: -6px"/> is a property of the granular material that is associated with frictional
stresses acting between colliding grains. This angle is generally larger when the grains are surrounded by liquid than by
a gas, because of the additional fluid viscosity influences.</p>
<span class="target" id="index-102"></span></div>
</div>
<div class="section" id="elasto-visco-plastic-and-viscoelastic-model">
<span id="viscoelasticstressmodelth"></span><span id="index-103"></span><h3>Elasto-visco-plastic and Viscoelastic Model<a class="headerlink" href="#elasto-visco-plastic-and-viscoelastic-model" title="Permalink to this headline">¶</a></h3>
<p>For some materials, there is an additional stress in the total state of stress
aside from pressure and viscosity: the elastic stress. Whilst viscous stress
is a function of the <strong>strain rate</strong> of the material, the elastic stress is a
function of the local total <strong>strain</strong> of the material. Such materials include
Bingham fluids, where the elastic stress grows until a yielding limit, and
then the material behaves like a viscous liquid, and viscoelastic materials,
where the amount of viscous and elastic stresses varying constantly within the
material depending on the local rate of strain. Examples of a Bingham fluid
are solid-filled suspensions, like toothpaste, where the solid particles
“lock” together under low strain, and when this binding breaks, will flow as a
liquid. Polymer melts and solutions are examples of viscoelastic fluids, where
the long molecules of the polymer become entangled and resist deformation when
rapidly sheared, yet can easily slide past one another when shearing is slow.</p>
<p>Since the viscous stress is solely based on the instantaneous strain rate at
every point in the domain at a particular point in time, and thus need not be
stored in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> during the course of the simulation, the elastic stress must
be stored since the history over time of a material point needs to be known to
compute the current state of elastic stress. Furthermore, because most
materials are isotropic in nature, the Cauchy stress is symmetric, so there
are 6 unique components of the elastic stress tensor. By default, these are
stored as advecting quantities, so the elastic stress is advected along with
the flow of the material through the domain. For simulations where minimal
flow is expected, the advection of elastic stress can be turned off.</p>
<p>Only the deviatoric part of the elastic stress is stored; the isotropic part
is merely the pressure, and is solved via the enforcement of the continuity
equation as with any viscous liquid in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The deviatoric part is the elastic
stress associated with shearing and stretching of the material. The isotropic
part of stress is solved much like pressure for (nearly) incompressible
materials; it is solved implicitly for all cases to avoid the small time steps
associated with the high bulk modulus of most materials. The deviatoric part
of stress is solved separately, either implicitly or explicitly, by activation
of the <span class="guilabel">Elastic stress</span> solver.</p>
<div class="section" id="model-formulation">
<span id="modelformulationth"></span><span id="index-104"></span><h4>Model Formulation<a class="headerlink" href="#model-formulation" title="Permalink to this headline">¶</a></h4>
<p>The incremental elastic stress model incorporated into <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> computes the
elastic stress using linear Hookean theory. Although this simple constitutive
equation predicts linear responses to stress, implementation as an
<em>incremental</em> model allows the prediction of highly nonlinear responses
because the response within each small time step can be well approximated as
linear, since the incremental strain during each time step is small.</p>
<p>The relationship between elastic stress, viscous stress and yielding depends
on the model chosen.</p>
<p>For the <span class="guilabel">Elasto-viscoplastic model</span>, the figure below shows
pictorially how the total stress is a summation of the viscous stress and the
elastic stress, along with the slip due to the yield stress limit. Thus the
model predicts that the total state of stress is a summation of the viscous
stress and the elastic stress, represented by the dashpot and spring,
respectively. Suppose a rod of this material, as described by this model,
undergoes a fixed amount of strain, imposed over a very short time. This model
would predict a corresponding rise in elastic stress that is linearly
proportional to the strain. Also, during the short time of the strain
imposition, the viscous stress would become significant, only to fall to zero
the instant the imposed strain ceases. If further strain were to be imposed to
a point such that the elastic stress surpasses the yield stress, the material
would yield and begin to flow as a liquid.</p>
<div class="figure" id="id110">
<span id="pictorialviewofviscoplasticmodel"></span><a class="reference internal image-reference" href="_images/Pictorial-view-of-viscoplastic-model.png"><img alt="Pictorial view of Elasto-viscoplastic model, showing the relationship between the elastic and viscous stresses." src="_images/Pictorial-view-of-viscoplastic-model.png" style="width: 3.125in;" /></a>
<p class="caption"><span class="caption-text">Figure 1: Pictorial view of Elasto-viscoplastic model, showing the relationship between the elastic and viscous stresses.</span></p>
</div>
<p>If a viscoelastic model (either the <span class="guilabel">Oldroyd-B model</span> or the
<span class="guilabel">Giesekus</span> model) is selected, the pictorial relationship between
viscous and elastic stresses are shown in the figure below. Note that the
spring and dashpot are in series in this model, meaning that the total state
of forces at any point in the material is the same for both the viscous and
elastic stress. However, the strain and strain-rate can be very different. A
rod of this material that is quickly stretched would have a large viscous
stress because the strain rate is large due to the rapid movement. The elastic
stress would be equally large, and so the material would have a solid-like
behavior. If the same total strain were to be applied over a very long period
of time, the resulting strain-rate would be very small, and thus the viscous
forces would also be very small. Likewise, the elastic forces must be very
small, even if the total strain is very large. In this scenario, the material
would appear very much like a viscous liquid.</p>
<div class="figure" id="id111">
<span id="pictorialviewofviscoelastmodel"></span><a class="reference internal image-reference" href="_images/Pictorial-view-of-viscoelastic-model.png"><img alt="Pictorial view of viscoelastic model, showing the relationship between the elastic and viscous stresses." src="_images/Pictorial-view-of-viscoelastic-model.png" style="width: 3.125in;" /></a>
<p class="caption"><span class="caption-text">Figure 2: Pictorial view of viscoelastic model, showing the relationship between the
elastic and viscous stresses.</span></p>
</div>
<p>Models to relate the strain and strain rate to the total state of stress are
constitutive equations, and in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> there are 3 choices (along with the
standard assumption of no elastic forces at all).</p>
<p>The total state of stress, which is needed for the solution of the Navier-Stokes system of equations, is:</p>
<div class="math" id="equation-totalstateofstress">
<p><span class="eqno">(108)<a class="headerlink" href="#equation-totalstateofstress" title="Permalink to this equation">¶</a></span><img src="_images/math/8b8cee8c61d2c8f2b7a87eecad1a3ecd65ef6524.png" alt="{\boldsymbol \sigma } = -p {\mathbf{I}}+ {{\boldsymbol \tau }_V} + {{\boldsymbol \tau }_E}"/></p>
</div><p>where <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is the local pressure, <img class="math" src="_images/math/49115f04df297f6dc58ed3d09750ca9fb36f187a.png" alt="{{\boldsymbol \tau }_V}" style="vertical-align: -3px"/> is the
deviatoric part of the viscous stress and <img class="math" src="_images/math/455ac34d0f58ce6410e179e3d7fcd5c1a546d46d.png" alt="{{\boldsymbol \tau }_E}" style="vertical-align: -3px"/> is the
deviatoric part of the elastic stress. <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> and <img class="math" src="_images/math/49115f04df297f6dc58ed3d09750ca9fb36f187a.png" alt="{{\boldsymbol \tau }_V}" style="vertical-align: -3px"/>
are already taken care of with existing models; the goal of this model
is to compute <img class="math" src="_images/math/455ac34d0f58ce6410e179e3d7fcd5c1a546d46d.png" alt="{{\boldsymbol \tau }_E}" style="vertical-align: -3px"/>.</p>
</div>
<div class="section" id="elasto-viscoplastic-model">
<h4>Elasto-viscoplastic model<a class="headerlink" href="#elasto-viscoplastic-model" title="Permalink to this headline">¶</a></h4>
<p>For the <span class="guilabel">Elasto-viscoplastic</span> model, we use the Hookean assumption
of small deformations between each time step and thus the incremental stress
(the change from one computational cycle to the next) is related to the
incremental strain as:</p>
<div class="math" id="equation-stateofstresselasticmodel">
<p><span class="eqno">(109)<a class="headerlink" href="#equation-stateofstresselasticmodel" title="Permalink to this equation">¶</a></span><img src="_images/math/2858e4993ab1c3b586464a6f2ef3d6381bc3b268.png" alt="{{\boldsymbol \tau }_E} = \left( {K - \tfrac{2}{3}G} \right)e{\mathbf{I}} + 2G{\mathbf{E}} - 3\alpha K\left( {\Delta T } \right){\mathbf{I}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/455ac34d0f58ce6410e179e3d7fcd5c1a546d46d.png" alt="{{\boldsymbol \tau }_E}" style="vertical-align: -3px"/> is the elastic stress tensor,</li>
<li><img class="math" src="_images/math/e2d1238eea938cf82f0d947a07e598edeca09dff.png" alt="{\mathbf{E}}" style="vertical-align: 0px"/> is the strain tensor,</li>
<li><img class="math" src="_images/math/e6f1c7aea426f68a05e2a9acbf879070239efca5.png" alt="{\mathbf{I}}" style="vertical-align: 0px"/> is the unit isotropic tensor,</li>
<li><img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> is the shear modulus,</li>
<li><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is the bulk modulus,</li>
<li><img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> is the linear thermal expansion coefficient,</li>
<li><img class="math" src="_images/math/bd1a16d74c008a154b195f2629949cf9380b1a06.png" alt="{\Delta T }" style="vertical-align: 0px"/> is the local temperature increment, and</li>
<li><img class="math" src="_images/math/a7228df3b7d8f5ae91504d95e1bf39e4323d0a90.png" alt="e" style="vertical-align: 0px"/> is the volume strain; this characterizes the isotropic expansion or contraction of the material and is equal to the trace of strain</li>
</ul>
<div class="math" id="equation-traceofstrain">
<p><span class="eqno">(110)<a class="headerlink" href="#equation-traceofstrain" title="Permalink to this equation">¶</a></span><img src="_images/math/a428551e14226d8e7f8055c062a79c77d2f93535.png" alt="{\mathrm{tr}} \left( {\mathbf{E}} \right) ."/></p>
</div><p>Although Eq. <a class="reference internal" href="#equation-stateofstresselasticmodel">(109)</a> is a linear model, if computed
incrementally over small enough time periods such that each incremental
deformation is small enough to obey the linear assumptions, non-linear
processes can be predicted. Eq. <a class="reference internal" href="#equation-stateofstresselasticmodel">(109)</a> can be written
for both the <em>deviatoric</em> and isotropic parts of <img class="math" src="_images/math/455ac34d0f58ce6410e179e3d7fcd5c1a546d46d.png" alt="{{\boldsymbol \tau }_E}" style="vertical-align: -3px"/>
(by definition, <img class="math" src="_images/math/455ac34d0f58ce6410e179e3d7fcd5c1a546d46d.png" alt="{{\boldsymbol \tau }_E}" style="vertical-align: -3px"/> is symmetric). The deviatoric
part is</p>
<div class="math" id="equation-deviatoricstress">
<p><span class="eqno">(111)<a class="headerlink" href="#equation-deviatoricstress" title="Permalink to this equation">¶</a></span><img src="_images/math/369d05cd55a9101ccf5a996575b76f0cf3763e04.png" alt="{{\boldsymbol \tau '}_E} = 2 G {\mathbf{E '}}"/></p>
</div><p>where <img class="math" src="_images/math/149ec959745820299a25e5a6afbbd5d774743a95.png" alt="{{\boldsymbol \tau '}_E}" style="vertical-align: -3px"/> is the deviatoric part of the elastic
stress, <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> is the shear modulus, and <img class="math" src="_images/math/a62c992ee0908a08a29e39b34f966f5968d91659.png" alt="{\mathbf{E '}}" style="vertical-align: 0px"/> is
the deviatoric part of incremental strain:</p>
<div class="math" id="equation-straintensor3d">
<p><span class="eqno">(112)<a class="headerlink" href="#equation-straintensor3d" title="Permalink to this equation">¶</a></span><img src="_images/math/eff7bc163bf302053e07d8143514928ada7acb8a.png" alt="{\mathbf{E'}} = \Delta t \left\{ {\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}} \left[ {\nabla {\mathbf{u}} + {{\left( {\nabla {\mathbf{u}}} \right)}^T}} \right] - {\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 3$}} \left( \nabla \cdot {\mathbf{u}} \right) {\mathbf{I}} \right\}"/></p>
</div><p>where <img class="math" src="_images/math/6fc2246a49aa724f89b1f4398b0e0de337ce105a.png" alt="{\mathbf{u}}" style="vertical-align: 0px"/> is the local material velocity (as computed in
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span>), and <img class="math" src="_images/math/3c948ff5172f0e264c801a383ea1b7de4fa84266.png" alt="\Delta t" style="vertical-align: 0px"/> is the time step.</p>
<p>The isotropic part of Eq. <a class="reference internal" href="#equation-stateofstresselasticmodel">(109)</a> is</p>
<div class="math" id="equation-isotropictraceofstrain">
<p><span class="eqno">(113)<a class="headerlink" href="#equation-isotropictraceofstrain" title="Permalink to this equation">¶</a></span><img src="_images/math/2d1c8b20dbbce4b6532f537ab4ee384f67a61e39.png" alt="p =  - Ke + 3\alpha K\left( {\Delta T} \right)"/></p>
</div><p>where <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is negative of the mean isotropic stress, or “pressure,” and is
equal to <img class="math" src="_images/math/c34493bba30b066e72fc353b6d110fdd3a20e026.png" alt="- {\mathrm{tr}}\left( {\tau _{\text{E}}} \right)/{\text{3}}" style="vertical-align: -5px"/>.</p>
<p>We can write <a class="reference internal" href="#equation-deviatoricstress">(111)</a> as a differential equation:</p>
<div class="math" id="equation-diffequation">
<p><span class="eqno">(114)<a class="headerlink" href="#equation-diffequation" title="Permalink to this equation">¶</a></span><img src="_images/math/f32cc2dcb4b966569fbb28da571adfc183ac2ba2.png" alt="\underbrace{\frac{\partial {\boldsymbol \tau '}_E}{\partial t}}_{\substack{\textrm{Change in stress} \\ \textrm{at fixed point in space}}}
+ \underbrace{\nabla \cdot \left( {\mathbf u} {\boldsymbol \tau '}_E \right)}_{\substack{\textrm{Change in stress}\\ \textrm{due to movement}\\ \textrm{of material}}}
= \underbrace{2G {\mathbf{D'}} \left( {x, t} \right) }_{ \substack{\textrm{Change in stress}\\ \textrm{due to stretching}\\ \textrm{or shearing}}}
+ \underbrace{{\boldsymbol \tau '}_E \cdot {\mathbf{W}} + {\mathbf{W}}^{ \mathbf{T}} \cdot {\boldsymbol \tau '}_E}_{ \substack{\textrm{change in stress due to}\\ \textrm{solid-body rotation}}}"/></p>
</div><p>where <img class="math" src="_images/math/3479bba22b07d7b2abd334c22ac6a264bfed1301.png" alt="{\mathbf{D'}}" style="vertical-align: 0px"/> is the deviatoric part of the strain <em>rate</em>
tensor. In three dimensions, it is</p>
<div class="math" id="equation-strainratetensor3d">
<p><span class="eqno">(115)<a class="headerlink" href="#equation-strainratetensor3d" title="Permalink to this equation">¶</a></span><img src="_images/math/cd6e0110601d4712c2fa78d60a003ced31d91e5f.png" alt="{\mathbf{ D'}} = {\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}\left[ {\nabla {\mathbf{u}} + {{\left( {\nabla {\mathbf{u}}} \right)}^T}} \right] - {\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 3$}} \left( \nabla \cdot {\mathbf{u}} \right){\mathbf{I}}"/></p>
</div><p>and <img class="math" src="_images/math/b01d8edcf1ce7a269322fd8d636904a692cbf566.png" alt="{\mathbf{W}}" style="vertical-align: 0px"/> is the <em>vorticity</em> tensor:</p>
<div class="math" id="equation-vorticitytensor">
<p><span class="eqno">(116)<a class="headerlink" href="#equation-vorticitytensor" title="Permalink to this equation">¶</a></span><img src="_images/math/bc01e404d1f6d2e907e5050e0c1b21a2ce4cd234.png" alt="{\mathbf W} = \frac{1}{2} \left[ {\nabla {\mathbf{u}} - {{\left( {\nabla {\mathbf{u}}} \right)}^T}} \right] ."/></p>
</div><p>We note that the elasto-viscoplastic and viscoelastic model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> applies only to incompressible fluids.
Therefore, <img class="math" src="_images/math/9f63d8d88b15f228bc8f774d297672e58c6b8d30.png" alt="\left( \nabla \cdot {\mathbf{u}} \right)" style="vertical-align: -5px"/> in Eqs. <a class="reference internal" href="#equation-straintensor3d">(112)</a> and <a class="reference internal" href="#equation-strainratetensor3d">(115)</a> vanishes.
Equation <a class="reference internal" href="#equation-diffequation">(114)</a> is solved by using scalar arrays to store the
components of the elastic stress tensor; these components are already advected
with the motion of the material, and the incremental strain is added to the
stress tensor components at each time step. Similarly, Eq.
<a class="reference internal" href="#equation-isotropictraceofstrain">(113)</a> can be rewritten as</p>
<div class="math" id="equation-incrementalstrainaddedtostresstensor">
<p><span class="eqno">(117)<a class="headerlink" href="#equation-incrementalstrainaddedtostresstensor" title="Permalink to this equation">¶</a></span><img src="_images/math/0b2930351989a12ec4420ad48ac298a5e47e8c42.png" alt="\frac{{\partial p}}{{\partial t}} + \nabla  \cdot \left( {{\mathbf{u}}p} \right) =  - K\dot e + 3\alpha K\left[ {\frac{{\partial T}}{{\partial t}} + \nabla  \cdot \left( {{\mathbf{u}}T} \right)} \right]"/></p>
</div><p>The advection term in Eq. <a class="reference internal" href="#equation-incrementalstrainaddedtostresstensor">(117)</a> (second
term on left side) is assumed to be small, relative to the time derivative of
<img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> because pressure waves, especially within solids, move far faster than
the material advects (in all subsonic simulations). Therefore, this term is
assumed to be zero.</p>
<p>The current value of stress is a function of the past history of a material
element. Material that enters the domain has a null state of stress, unless
specified otherwise at the domain boundaries. Also, the initial condition at the
beginning of the simulation has a null state of stress, unless specified
otherwise by the initial conditions.</p>
<p>In order to predict yielding effects, the Mises yield condition is used. This
condition is</p>
<div class="math" id="equation-misesyieldcondition">
<p><span class="eqno">(118)<a class="headerlink" href="#equation-misesyieldcondition" title="Permalink to this equation">¶</a></span><img src="_images/math/0af0309a21580b1a606fa8aef59efa864734adf1.png" alt="I{I_{{\boldsymbol \tau '}_{\mathbf E}}} = \frac{Y^2}{3}"/></p>
</div><p>where <img class="math" src="_images/math/0d77100a9b666bf63c28b79a44b5c6ed94ebb414.png" alt="I{I_{{\boldsymbol \tau '}_{\mathbf E}}}" style="vertical-align: -5px"/> is the second invariant
of the deviatoric part of the elastic stress tensor and <img class="math" src="_images/math/2baf7cf7dc3371befb37812a8b64e9ea70d4c874.png" alt="Y" style="vertical-align: 0px"/> is the yield
stress limit, a  user-defined parameter. In regions of the material where the
elastic stress (measured by <img class="math" src="_images/math/0d77100a9b666bf63c28b79a44b5c6ed94ebb414.png" alt="I{I_{{\boldsymbol \tau '}_{\mathbf E}}}" style="vertical-align: -5px"/>)
exceeds the yield criterion, the elastic stress is relaxed such that the
condition in Eq. <a class="reference internal" href="#equation-misesyieldcondition">(118)</a> is met:</p>
<div class="math" id="equation-yieldlimitedelastictensor">
<p><span class="eqno">(119)<a class="headerlink" href="#equation-yieldlimitedelastictensor" title="Permalink to this equation">¶</a></span><img src="_images/math/1c4618bc3b8dd78db0a5aff5e9321c4959462f69.png" alt="{\boldsymbol \tau '^{^*}}_{\mathbf E} = \sqrt{\frac{2Y^2}{3I{I_{{\boldsymbol \tau '}_{\mathbf E}}} } {\boldsymbol \tau '}_{\mathbf E} }"/></p>
</div><p>where <img class="math" src="_images/math/c2d07f98e243301e749b211883d1fa39f9914a0c.png" alt="{\boldsymbol \tau '^{^*}}_{\mathbf E}" style="vertical-align: -3px"/> is the yield-limited
elastic stress tensor; it is this tensor that is applied to the Navier-Stokes
equations for the momentum balance of the fluid.</p>
</div>
<div class="section" id="viscoelastic-models">
<h4>Viscoelastic models<a class="headerlink" href="#viscoelastic-models" title="Permalink to this headline">¶</a></h4>
<p>For viscoelastic materials, there is a continual balance between viscous and
elastic forces within the fluid, and so a different constitutive model is
needed. Instead of Eq. <a class="reference internal" href="#equation-stateofstresselasticmodel">(109)</a> along with the
yielding condition of Eq. <a class="reference internal" href="#equation-misesyieldcondition">(118)</a>, the constitutive
equation to define <img class="math" src="_images/math/0e1e011dccd2c9be5bd0e1469ce31038a3ce16e7.png" alt="{\boldsymbol \tau '}_{\mathbf E}" style="vertical-align: -3px"/> for the
<strong>Oldroyd-B model</strong> is:</p>
<div class="math" id="equation-viscoelasticconstitutive">
<p><span class="eqno">(120)<a class="headerlink" href="#equation-viscoelasticconstitutive" title="Permalink to this equation">¶</a></span><img src="_images/math/e09707c2b6775f90c54382a7dfede5a3fafa0f6a.png" alt="\lambda \overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}
+ {\boldsymbol \tau '}_{\mathbf E}
= 2 \eta {\mathbf D'}"/></p>
</div><p>where <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> is the <em>relaxation time</em> and <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> is the
<em>elastic viscosity</em>. <img class="math" src="_images/math/d7b6efc3ab0a0559bbc94740670c6221fa6fa826.png" alt="\overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}" style="vertical-align: -3px"/> is
the <em>upper-convected derivative</em> of <img class="math" src="_images/math/0e1e011dccd2c9be5bd0e1469ce31038a3ce16e7.png" alt="{\boldsymbol \tau '}_{\mathbf E}" style="vertical-align: -3px"/>, written as</p>
<div class="math" id="equation-upperconvectedderivative">
<p><span class="eqno">(121)<a class="headerlink" href="#equation-upperconvectedderivative" title="Permalink to this equation">¶</a></span><img src="_images/math/589fabe865f14396162025433524a935426c013c.png" alt="\overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}
= \frac{\partial {\boldsymbol \tau '}_{\mathbf E}}{\partial t}
+ {\mathbf u} \cdot \nabla {\boldsymbol \tau '}_{\mathbf E}
- \left (\nabla{\mathbf u}  \right )^T \cdot {\boldsymbol \tau '}_{\mathbf E}
- {\boldsymbol \tau '}_{\mathbf E} \cdot \nabla{\mathbf u}"/></p>
</div><p>Alternatively, <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> can be defined as <img class="math" src="_images/math/f15b5d099b333a79ab89b88ff8731d43fcc35f80.png" alt="G \lambda" style="vertical-align: -1px"/>, where
<img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> is the shear modulus of the solid-like behavior of the material.
Therefore,</p>
<div class="math" id="equation-viscoelasticconstitutive2">
<p><span class="eqno">(122)<a class="headerlink" href="#equation-viscoelasticconstitutive2" title="Permalink to this equation">¶</a></span><img src="_images/math/28860f1115f7d5ab68baddf3b12f6708917f2ef2.png" alt="\overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}
= 2 G {\mathbf D'}
- \frac{1}{\lambda} {\boldsymbol \tau '}_{\mathbf E}"/></p>
</div><p>Large values of the relaxation time, <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/>, mean that the last term in Eq. <a class="reference internal" href="#equation-viscoelasticconstitutive2">(122)</a> is
small, and the elastic stress relaxes slowly. For small <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/>, the
term is large, and the elastic stress relaxes very quickly.</p>
<p>Similarly, for the <strong>Giesekus</strong> model, there is an additional nonlinear term added to Eq. <a class="reference internal" href="#equation-viscoelasticconstitutive">(120)</a>:</p>
<div class="math" id="equation-viscoelasticconstitutivegiesekus">
<p><span class="eqno">(123)<a class="headerlink" href="#equation-viscoelasticconstitutivegiesekus" title="Permalink to this equation">¶</a></span><img src="_images/math/1b9ff9f34dcf853fa210365cf824e6fecf200585.png" alt="\lambda \overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}
+ {\boldsymbol \tau '}_{\mathbf E}
+ \alpha \frac{\lambda}{\eta} {\boldsymbol \tau '}_{\mathbf E} \cdot {\boldsymbol \tau '}_{\mathbf E}
= 2 \eta {\mathbf D'}"/></p>
</div><p>where <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> is the the <em>dimensionless mobility factor</em>. This factor
provides an additional fitting parameter for the viscoelastic behavior of the
material. The other parameters have the same meaning as for the <em>Oldroyd-B</em> model.</p>
<p>Rearranging Eq. <a class="reference internal" href="#equation-viscoelasticconstitutivegiesekus">(123)</a>, we get:</p>
<div class="math" id="equation-viscoelasticconstitutivegiesekus2">
<p><span class="eqno">(124)<a class="headerlink" href="#equation-viscoelasticconstitutivegiesekus2" title="Permalink to this equation">¶</a></span><img src="_images/math/fff55c6b34d246f97783a283b6c2622fd60bcb20.png" alt="\overset{\nabla}{{\boldsymbol \tau '}_{\mathbf E}}
= 2 G {\mathbf D'}
- \frac{1}{\lambda} {\boldsymbol \tau '}_{\mathbf E}
- \frac{\alpha}{\lambda G} {\boldsymbol \tau '}_{\mathbf E} \cdot {\boldsymbol \tau '}_{\mathbf E}"/></p>
</div><p>With both the <em>Oldroyd-B</em> and <em>Giesekus</em> models, the constitutive equations
<a class="reference internal" href="#equation-viscoelasticconstitutive2">(122)</a> and <a class="reference internal" href="#equation-viscoelasticconstitutivegiesekus2">(124)</a>
are solved using <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>’s scalar advection model, and the additions terms in
<a class="reference internal" href="#equation-diffequation">(114)</a>, <a class="reference internal" href="#equation-viscoelasticconstitutive2">(122)</a>, or
<a class="reference internal" href="#equation-viscoelasticconstitutivegiesekus2">(124)</a> (depending on model chosen) are solved
implicitly or explicitly. The next section describes this in more detail.</p>
</div>
<div class="section" id="solution-method">
<span id="solutionmethodth"></span><span id="index-105"></span><h4>Solution Method<a class="headerlink" href="#solution-method" title="Permalink to this headline">¶</a></h4>
<p>The solution of the strain rate tensor, <img class="math" src="_images/math/335bba94cecbb314c6cb4ae6011ebb9513bbc183.png" alt="\mathbf{\dot E}" style="vertical-align: 0px"/>, is similar to
that used in the viscous stress algorithm. The normal components of
<img class="math" src="_images/math/335bba94cecbb314c6cb4ae6011ebb9513bbc183.png" alt="\mathbf{\dot E}" style="vertical-align: 0px"/> are computed at the cell center, while the shear components
are calculated at the cell edges. The figure below shows a typical computational
cell and the stress component calculation locations. The shear components are
computed on the cell edges for computational convenience and numerical
stability.</p>
<div class="figure align-center" id="id112">
<span id="computationalcellstrainratetensor"></span><a class="reference internal image-reference" href="_images/computational-cell-strain-rate-tensor.jpg"><img alt="Computational cell showing locations of components of strain rate tensor" src="_images/computational-cell-strain-rate-tensor.jpg" style="width: 2.6in;" /></a>
<p class="caption"><span class="caption-text">Figure 3: Computational cell showing locations of components of strain rate tensor</span></p>
</div>
<p>At free-surfaces, the external fluid is presumed to be a gas vapor which exerts
negligible stress on the fluid surface. Therefore, <img class="math" src="_images/math/fd9c5ab3d43f5fa00bbe61f677b5a98cac4bc873.png" alt="{\bf{n}} \cdot
{{\boldsymbol\tau}_E'} = 0" style="vertical-align: -5px"/> at such interfaces. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the principal
directions in which free-surfaces and the status of neighboring cells are known.
From this information, the appropriate components of
<img class="math" src="_images/math/e8e9ecb29e05c454fb4eeb45f6387b4ac72e894c.png" alt="{{\boldsymbol\tau}_E'}" style="vertical-align: -5px"/> are set to zero at free-surface to ensure that
the aforementioned condition is met. At interfaces with solid walls or
obstacles, the fluid velocity in the cell neighboring the wall (or obstacle) and
the velocity of the wall (or obstacle) are used to compute the strain rate using
Eq. <a class="reference internal" href="#equation-strainratetensor3d">(115)</a>.</p>
<p>If the explicit method is chosen, the elastic stress is updated with Eq.
<a class="reference internal" href="#equation-diffequation">(114)</a>, <a class="reference internal" href="#equation-viscoelasticconstitutive2">(122)</a> or
<a class="reference internal" href="#equation-viscoelasticconstitutivegiesekus2">(124)</a> using information from the previous
time step, and the resulting value of <img class="math" src="_images/math/0e1e011dccd2c9be5bd0e1469ce31038a3ce16e7.png" alt="{\boldsymbol \tau '}_{\mathbf E}" style="vertical-align: -3px"/>
is used in Eq. <a class="reference internal" href="#equation-momentumconservation">(9)</a> (as additional terms to the <em>viscous
accelerations</em>) to compute the new velocity for the current time step.</p>
<p>This method has the advantage of simplicity and rapid computation during each
time step. However, for materials whose elastic effects dominate other effects,
the numerical stability limit can be very small. Therefore, the <em>implicit method</em>
can be selected to eliminate this time-step limit for such problems. The
disadvantages of this method are that the computational effort required during
each time step is much greater and it can dampen out oscillations that may
physically occur.</p>
<p>If the implicit algorithm is chosen, a prediction of the velocity is computed
in the same way as the explicit method. However, the velocity is updated based
on the remainder of the momentum equation (the differences between the
explicit approximation, and the approximation using the most up-to-date
velocity), along with the equation of isotropic stress Eq.
<a class="reference internal" href="#equation-incrementalstrainaddedtostresstensor">(117)</a>:</p>
<div class="math" id="equation-implicitpredictionofvelocity">
<p><span class="eqno">(125)<a class="headerlink" href="#equation-implicitpredictionofvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/934d999b5ffff7912444283b1fef3b0b1e3a3873.png" alt="\delta {\mathbf{u}} = \frac{{\Delta t}}{\rho }\left[ { - \nabla \left( {\delta P} \right) + \nabla  \cdot \left( {\delta {\boldsymbol \tau '}_{\mathbf E} } \right)} \right]"/></p>
</div><p>where the value of <img class="math" src="_images/math/0e1e011dccd2c9be5bd0e1469ce31038a3ce16e7.png" alt="{\boldsymbol \tau '}_{\mathbf E}" style="vertical-align: -3px"/> is the most up-to-date value.</p>
<p>The method used to solve Eq. <a class="reference internal" href="#equation-implicitpredictionofvelocity">(125)</a> is the Jacobi
method; in this method, all of the updated elastic stress tensor components
throughout the domain are solved based on the velocity computed from the
previous iteration; components from neighboring recently computed cells are not
included until the next iteration. This is repeated until the change in velocity
from one iteration to the next is smaller than a preset tolerance. If desired,
this method can be used in conjunction with the Jacobi implicit viscous stress
method for materials whose viscous effects are also very large. Currently, the
implicit elastic stress model cannot be used with the <abbr title="Alternating Direction Implicit">ADI</abbr> or <abbr title="Generalized Minimum Residual Solver">GMRES</abbr>
implicit viscous stress algorithms.</p>
<p>The pressure, <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/>, is computed separately, using Eq.
<a class="reference internal" href="#equation-incrementalstrainaddedtostresstensor">(117)</a>, and the solution algorithm is
exactly the same as that for liquid pressure. The pressure and velocity
components are updated for each iteration until the residual of Eq.
<a class="reference internal" href="#equation-incrementalstrainaddedtostresstensor">(117)</a> falls below a preset tolerance. The
numerical method can be <abbr title="Successive Over Relaxation">SOR</abbr>, <abbr title="Alternating Direction Implicit">ADI</abbr>, or <abbr title="Generalized Minimum Residual Solver">GMRES</abbr>. The <abbr title="Successive Over Relaxation">SOR</abbr> algorithm is
very similar to the aforementioned Jacobi method, except that the most
up-to-date values, including neighbor values computed in the current iteration, are
used. The <abbr title="Alternating Direction Implicit">ADI</abbr> algorithm solves
simultaneously an entire row of cells in the direction chosen, while the
<abbr title="Generalized Minimum Residual Solver">GMRES</abbr> algorithm solves the fully
coupled system of equations.</p>
</div>
<div class="section" id="computation-of-parameters">
<span id="elasticmodulusth"></span><span id="index-106"></span><h4>Computation of parameters<a class="headerlink" href="#computation-of-parameters" title="Permalink to this headline">¶</a></h4>
<p>The shear modulus <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/>, the yield stress limit <img class="math" src="_images/math/2baf7cf7dc3371befb37812a8b64e9ea70d4c874.png" alt="Y" style="vertical-align: 0px"/>, relaxation
time <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> and the mobility factor <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> can be defined on
both fluid 1 and fluid 2. Additionally, tabular temperature-dependent data can
be provided.</p>
<p>When two viscoelastic fluids occupy a computational cell, the parameter used
in that cell is a weighted linear interpolation of the properties of the two
fluids. For tabular temperature-dependent data, a piecewise linear
interpolation is assumed between data points, as with any other
temperature-dependent quantities in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>.</p>
<span class="target" id="index-107"></span></div>
</div>
<div class="section" id="elastic-membrane-and-elastic-wall-model">
<span id="elasticmembraneandelasticwallmodelth"></span><span id="index-108"></span><h3>Elastic Membrane and Elastic Wall Model<a class="headerlink" href="#elastic-membrane-and-elastic-wall-model" title="Permalink to this headline">¶</a></h3>
<p>A limited Fluid-Structure Interaction (FSI) capability is available in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
with the elastic membrane and wall model. In this model, deformation of an
elastic membrane or an elastic wall impacts the adjacent fluid flow, while fluid
pressure, in turn, affects the deformation. These interactions are described in
the code in a fully coupled fashion.</p>
<p>The main limitation of the model is that the deformation is assumed to be small,
i.e., for each membrane and elastic wall, its deflection is much smaller than
its size. This allows useful simplifications for the model. The geometries of
membranes and elastic walls are thus assumed to be time-invariant throughout
calculation, while effects of their deformation on fluid flow are described with
volume source or sink distributed on the fluid-structure interface. With the
further assumption that the pressure force is uniformly distributed on the
membrane surface, analytical solutions rather than structural analysis
algorithms are used to determine membrane deformation for a better computational
efficiency.</p>
<div class="section" id="elastic-membrane">
<span id="elasticmembranetheoryth"></span><span id="index-109"></span><h4>Elastic Membrane<a class="headerlink" href="#elastic-membrane" title="Permalink to this headline">¶</a></h4>
<p>An elastic membrane in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is a rectangular or circular thin plate which
undergoes a small elastic deformation under action of external forces. Its
thickness and material properties are assumed to be uniform. Its edge can be
either simply supported or clamped. By simply supported edge we mean an edge
with both zero deflection and zero net force moment. At a clamped edge, however,
both deflection and its first order derivatives are zero, but the force moment
is generally non-zero. In any case, the model requires that a membrane has the
same condition all along its edges. There is no restriction on location of a
membrane in the mesh grid, but the membrane’s surface must be perpendicular to
x, y, or z axis.</p>
<p>The model considers two external forces acting on the membrane: the hydraulic
pressure force and an actuator force. The hydraulic pressure force is obtained
by integration of pressure over both sides of the membrane. It is then converted
into a uniformly distributed force over the whole membrane.</p>
<p>An actuator force is present in many applications such as micro-pump flow and
inkjet droplet formation. One example is about a piezoelectric actuator attached
on a membrane. When an electric voltage is applied, the piezoelectric actuator
exerts a force on the membrane in the surface normal direction, which is the so
called actuator force. Users can prescribe the actuator force either as a
sinusoidal or piecewise linear function of time. In the model, the actuator is
always assumed to be centered on one side of the membrane, and the shape (but
not necessarily the size) of the contact area of the actuator with the membrane
is the same as that of the membrane. In other words, both membrane and the
actuator must be either rectangular or circular and have the same symmetric
axis. Because the actuator itself usually has much lower rigidity than the
membrane, it is further assumed the actuator force always acts uniformly over
the contact area. If a zero contact area is given, then the actuator force is
treated as a concentrated force at the membrane’s center.</p>
<p>To achieve a better computational efficiency, analytical solutions rather than
structural analysis algorithms are used for the deflection calculation. At any
point in time the membrane is assumed to be in an equilibrium state, defined by
balance of the hydraulic force, actuator force and the membrane’s rigidity.
Analytical solutions are obtained by solving the equilibrium equation for a thin
plate with small deformation,</p>
<div class="math" id="equation-deflectioncalculation">
<p><span class="eqno">(126)<a class="headerlink" href="#equation-deflectioncalculation" title="Permalink to this equation">¶</a></span><img src="_images/math/48098faa8a8b115890cbf6426e5aa479c2389db9.png" alt="{\nabla ^2}{\nabla ^2}w = \frac{f}{D}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is deflection,</li>
<li><img class="math" src="_images/math/3daf2576f9b26b234f68a5e23fcd520c09823740.png" alt="f" style="vertical-align: -4px"/> is the net external force per unit area on the membrane,</li>
<li><img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is flexural rigidity,</li>
</ul>
<div class="math" id="equation-flexuralrigidity">
<p><span class="eqno">(127)<a class="headerlink" href="#equation-flexuralrigidity" title="Permalink to this equation">¶</a></span><img src="_images/math/ab5bf9ba6802a783bf040ed77547efedb76c5217.png" alt="D = \frac{E{h^3}}{12\,(1 - {\nu ^2})}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/4e731d960c926d2bc9f78ff625d5a695416429ae.png" alt="E" style="vertical-align: 0px"/> is Young’s modulus,</li>
<li><img class="math" src="_images/math/6f0271089ab36d5f12ee5fe3eef8d89debc5529f.png" alt="\nu" style="vertical-align: 0px"/> is Poisson’s ratio, and</li>
<li><img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> is the membrane’s thickness.</li>
</ul>
<p>Consider a rectangular membrane with its surface perpendicular to the z axis. In
a Cartesian coordinate system Eq. <a class="reference internal" href="#equation-deflectioncalculation">(126)</a> is then written as</p>
<div class="math" id="equation-rectangularmembranesurfaceperfendiculartozaxis">
<p><span class="eqno">(128)<a class="headerlink" href="#equation-rectangularmembranesurfaceperfendiculartozaxis" title="Permalink to this equation">¶</a></span><img src="_images/math/0d8209e844a59f087bb1a60defbf3b6149cf2527.png" alt="\frac{{{\partial ^4}w}}{{\partial {x^4}}} + 2\frac{{{\partial ^4}w}}{{\partial {x^2}\partial {y^2}}} + \frac{{{\partial ^4}w}}{{\partial {y^4}}} = \frac{f}{D}"/></p>
</div><p>For convenience, we place the coordinates’ origin at the membrane center. Let
<img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> and <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> represent the membrane’s lengths in x and y directions,
respectively. The boundary conditions for the membrane with the simply supported
edges are</p>
<div class="math" id="equation-boundaryconditionsmembranesimplysupportededges">
<p><span class="eqno">(129)<a class="headerlink" href="#equation-boundaryconditionsmembranesimplysupportededges" title="Permalink to this equation">¶</a></span><img src="_images/math/5670194b567ca5dcf2128cd94e4303ce007f4c02.png" alt="\begin{gathered}
  w = 0 \quad \text{    and    } \quad \frac{{\partial ^2}w}{\partial {x^2}} = 0 \quad \text{    for    } \quad x =  \pm \frac{a}{2} \\
  \\
  w = 0 \quad \text{    and    } \quad  \frac{{\partial ^2}w}{\partial {y^2}} = 0 \quad \text{    for    } \quad y =  \pm \frac{b}{2} \\
  \end{gathered}"/></p>
</div><p>If the membrane has clamped edges, the boundary conditions are</p>
<div class="math" id="equation-boundaryconditionsmembraneclampededges">
<p><span class="eqno">(130)<a class="headerlink" href="#equation-boundaryconditionsmembraneclampededges" title="Permalink to this equation">¶</a></span><img src="_images/math/f749a3594959721447ded2ceb916a44131a73f5b.png" alt="\begin{gathered}
  w = 0 \quad \text{    and    } \quad \frac{\partial w}{\partial x} = 0 \quad \text{    for    } \quad x =  \pm \frac{a}{2} \\
  \\
  w = 0 \quad \text{    and    } \quad  \frac{\partial w}{\partial y} = 0 \quad \text{    for    } \quad y =  \pm \frac{b}{2} \\
  \end{gathered}"/></p>
</div><p>For a circular membrane, it is convenient to write Eq.
<a class="reference internal" href="#equation-deflectioncalculation">(126)</a> in a cylindrical coordinate system with its origin
located at the membrane’s center,</p>
<div class="math" id="equation-boundaryconditionscircularmembrane">
<p><span class="eqno">(131)<a class="headerlink" href="#equation-boundaryconditionscircularmembrane" title="Permalink to this equation">¶</a></span><img src="_images/math/0ad040655e52afdea64d7e819c428f4307fe6ce4.png" alt="\frac{1}{r}\frac{d}{{dr}}\left\{ {r\frac{d}{{dr}}\left[ {\frac{1}{r}\frac{d}{{dr}}\left( {r\frac{{dw}}{{dr}}} \right)} \right]} \right\} = \frac{f}{D}"/></p>
</div><p>With <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> denoting the membrane’s radius, the boundary condition for the simply
supported edge is</p>
<div class="math" id="equation-membranesradiussimplysupportededge">
<p><span class="eqno">(132)<a class="headerlink" href="#equation-membranesradiussimplysupportededge" title="Permalink to this equation">¶</a></span><img src="_images/math/5accbf1e50f7447363492be4b4367d6b639a861e.png" alt="w = 0 \quad \text{    and    } \quad \frac{{{\partial ^2}w}}{{\partial {r^2}}} = 0 \quad \text{    for    } \quad r = a"/></p>
</div><p>For the clamped edge, the boundary condition is</p>
<div class="math" id="equation-membranesradiusclampededge">
<p><span class="eqno">(133)<a class="headerlink" href="#equation-membranesradiusclampededge" title="Permalink to this equation">¶</a></span><img src="_images/math/006890eeacd054b8ccdfbdbc088ebaef2b71326d.png" alt="w = 0 \quad \text{    and    } \quad \frac{\partial w}{\partial r} = 0 \quad \text{    for    } \quad r = a"/></p>
</div><p>All the analytical solutions for the membrane’s deflection used in the model
satisfy the above equations. Some of these solutions are found in Timoshenko
(1959), while the others are derived from Timoshenko’s solutions using the
supposition method. Please refer to Flow Science Technical Note #79 on the
users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a> for the details of these solutions.</p>
<p>To account for effects of the membrane motion on fluid flow, the continuity
equation is modified with a volume source (or sink) term <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> added to its
right hand side,</p>
<div class="math" id="equation-continuityequationmodifiedvolumesource">
<p><span class="eqno">(134)<a class="headerlink" href="#equation-continuityequationmodifiedvolumesource" title="Permalink to this equation">¶</a></span><img src="_images/math/48e14584f76800022ac10bc7ac9843b0ed0fa4a7.png" alt="\frac{{{V_f}}}{\rho }\frac{{\partial \rho }}{{\partial \,t}} + \frac{1}{\rho }\nabla  \cdot (\rho \,\vec uA) = S"/></p>
</div><p>In a computation control volume, or mesh cell,</p>
<div class="math" id="equation-continuityequationcomputationcontrolvolumeormeshcell">
<p><span class="eqno">(135)<a class="headerlink" href="#equation-continuityequationcomputationcontrolvolumeormeshcell" title="Permalink to this equation">¶</a></span><img src="_images/math/5d71dacad31dfff6c42e6ed416a75603945f8c4d.png" alt="S = \frac{S_{\rm{mb}}}{V_{\rm{cell}}}\, {\vec V_{\rm{mb}}} \cdot \vec n"/></p>
</div><p>where <img class="math" src="_images/math/0725e8b7999c42bd54549dc058dafc4413cf2f0c.png" alt="V_{\rm{cell}}" style="vertical-align: -3px"/> is the cell volume, <img class="math" src="_images/math/7ff00438547d6afe69f6616bb6de9d8ec7030cb6.png" alt="S_{\rm{mb}}" style="vertical-align: -3px"/>,
<img class="math" src="_images/math/0834097464581348dba23e7f0f126256bbf5faf6.png" alt="\vec n" style="vertical-align: 0px"/> and <img class="math" src="_images/math/ca6f4f77d78e5d46d3a05437e976d2901692af81.png" alt="{\vec V_{\rm{mb}}}" style="vertical-align: -3px"/> are respectively surface area,
unit outer normal vector and velocity of the membrane surface in the mesh
cell. <img class="math" src="_images/math/ca6f4f77d78e5d46d3a05437e976d2901692af81.png" alt="{\vec V_{\rm{mb}}}" style="vertical-align: -3px"/> is obtained from the rate of deflection
change. The transport equation for the VOF function is also modified with a
source term <img class="math" src="_images/math/57764be01c4af9deb393db0086460871dc9cb7f9.png" alt="FS" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-sourcetermfs">
<p><span class="eqno">(136)<a class="headerlink" href="#equation-sourcetermfs" title="Permalink to this equation">¶</a></span><img src="_images/math/31eb45667fd14788e905bdbeb4b615d63dfa5172.png" alt="{V_f}\frac{\partial F}{\partial \,t} + \nabla  \cdot (F\vec u{A_f}) = FS"/></p>
</div><p>Other transport equations for momentum, energy, turbulence and scalars remain
unchanged because in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> these equations are used in their non-conservative
forms. When they are derived from their conservation forms with consideration of
the continuity equation, the source terms due to membrane motion are canceled
out.</p>
</div>
<div class="section" id="elastic-wall">
<span id="elasticwalltheoryth"></span><span id="index-110"></span><h4>Elastic Wall<a class="headerlink" href="#elastic-wall" title="Permalink to this headline">¶</a></h4>
<p>An elastic wall in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is an elastic object of arbitrary shape, and its
surface deformation is small and proportional to hydraulic pressure, namely</p>
<div class="math" id="equation-elasticwallsurfacedeformation">
<p><span class="eqno">(137)<a class="headerlink" href="#equation-elasticwallsurfacedeformation" title="Permalink to this equation">¶</a></span><img src="_images/math/b0121b75cf944e9f086e01d3e103f166f0aa3a3c.png" alt="w =  - \frac{{(p - {p_{\rm{ref}})}}}{K}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is local deflection in surface normal direction,</li>
<li><img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> is local pressure,</li>
<li><img class="math" src="_images/math/9057d7e3e84157e35087747c511382d142e4c4e9.png" alt="p_{\rm{\rm{ref}}}" style="vertical-align: -4px"/> is a reference pressure,</li>
<li><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is coefficient of rigidity per unit area.</li>
</ul>
<p>Such kind of elastic deformation occurs if the Poisson’s ratio for the wall
material is zero, which means the normal stress causes no lateral strain. It is
a good approximation for elastic wall deformation if the Poisson’s ratio is not
zero but small. With the lateral strain term neglected, the Hooke’s law is
reduced to</p>
<div class="math" id="equation-hookeslawlateralstraintermneglected">
<p><span class="eqno">(138)<a class="headerlink" href="#equation-hookeslawlateralstraintermneglected" title="Permalink to this equation">¶</a></span><img src="_images/math/1d73eebb516d6863dba8b6b75c2791707b65d83b.png" alt="\varepsilon  = \frac{\sigma }{E}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/8d43774b9306502f07b6c7deaa6595cc0702fffd.png" alt="\varepsilon" style="vertical-align: 0px"/> is the strain,</li>
<li><img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> is the normal stress, and</li>
<li><img class="math" src="_images/math/4e731d960c926d2bc9f78ff625d5a695416429ae.png" alt="E" style="vertical-align: 0px"/> is Young’s modulus.</li>
</ul>
<p><img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> in Eq. <a class="reference internal" href="#equation-elasticwallsurfacedeformation">(137)</a> is a user-prescribed
parameter. To determine the value of <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/>, consider a plate at
equilibrium with one side fixed and the other side under a normal force.
Assume the Poisson’s ratio is negligible and the normal stress is <img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> at a
location on its surface. From force balance, the normal stress inside the
plate has the same value <img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> along the vertical line through that
location. Denote the plate’s thickness as <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> and the deflection as
<img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>. The strain is then <img class="math" src="_images/math/80d3750ab5669cb842e4046e1b59e928a606b18b.png" alt="w/h" style="vertical-align: -5px"/>, and the Hooke’s law in Eq.
<a class="reference internal" href="#equation-hookeslawlateralstraintermneglected">(138)</a> gives</p>
<div class="math" id="equation-hookeslawstrain">
<p><span class="eqno">(139)<a class="headerlink" href="#equation-hookeslawstrain" title="Permalink to this equation">¶</a></span><img src="_images/math/253e1ce9475a9dc93b2e81e930aac0a4c19882dd.png" alt="w = \frac{\sigma }{E/h}"/></p>
</div><p>It indicates that in this case <img class="math" src="_images/math/22d3a6b7e80e7b5185c31bde0732830255e16912.png" alt="K = \frac{E}{h}" style="vertical-align: -6px"/>. In general,
<img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> can be estimated as</p>
<div class="math" id="equation-elasticwalluserprescribedparameterk">
<p><span class="eqno">(140)<a class="headerlink" href="#equation-elasticwalluserprescribedparameterk" title="Permalink to this equation">¶</a></span><img src="_images/math/44dfa65ee4c62c33216497b82241b9ae54fbfae5.png" alt="K = \frac{E}{L}"/></p>
</div><p>where <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> is a length scale comparable to the depth of the elastic wall.
It may also be obtained from other means such as experimental measurement or
full structural analysis.</p>
<p>Effects of the elastic wall motion on fluid flow are described by adding a
volume source (or sink) at the wall surface. The continuity and the transport
equations for VOF are modified in the same way as described in the section for
elastic membranes.</p>
</div>
<div class="section" id="model-limitations">
<span id="modellimitationsth"></span><h4>Model Limitations<a class="headerlink" href="#model-limitations" title="Permalink to this headline">¶</a></h4>
<p>The model allows for multiple elastic membrane and elastic wall objects with
different shape, size, orientation and physical quantities. It is compatible
with most other models of <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. For example, heat transfer across membranes and
elastic walls can be included. However, restrictions and limitations exist.</p>
<p>The model requires that both elastic membranes and elastic walls have <em>small</em>
deflections. A small deflection for a membrane means the deflection is less than
the membrane’s size. For an elastic wall, its deformation needs to be small
compared to the computational cell size. This assumption allows us to ignore the
actual change in the position of the deforming surfaces. In other words, the
shape of the membranes and deforming walls are fixed throughout the
calculations, as defined by their initial setup. As shown above, effects of
surface deformation on fluid motion are modeled through the fluid source
distribution on the deforming surface. When computational results are displayed,
deformation can be visualized by plotting the contours of <em>deflection</em>. It is
also noted that an elastic membrane/wall cannot be porous or a moving object at
the same time. If a moving object collides with a membrane or elastic wall, the
latter is treated as a non-moving rigid object in collision simulation, thus the
impact will only affect motion of the moving object.</p>
<span class="target" id="index-111"></span></div>
</div>
<div class="section" id="fan-and-impeller-model">
<span id="fanandimpellermodelth"></span><span id="index-112"></span><h3>Fan and Impeller Model<a class="headerlink" href="#fan-and-impeller-model" title="Permalink to this headline">¶</a></h3>
<p>The fan and impeller model used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be used when the rotation rate of
the blades is such that many revolutions are required before a steady flow is
established in the fluid.</p>
<p>This model induces both swirl and axial velocity components. The definition of a
fan or impeller is done in terms of a “phantom” obstacle that defines a region
but does not have any real obstacle blockage effects. Generally, these obstacles
are assumed to be right-circular cylinders of outer radius <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/>, inner
radius <img class="math" src="_images/math/d77e09b1ac0f59812794adc2b8da7f9a192d32bc.png" alt="r" style="vertical-align: 0px"/> and thickness <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/>, which defines the region swept out by
the rotating blades.</p>
<p>Aside from the geometry, the remaining parameters that determine the performance
of a fan or impeller are its rotation rate <img class="math" src="_images/math/68412866082f6b8a92897f1032b0a90368ae5d12.png" alt="S_d" style="vertical-align: -3px"/>, an accommodation
coefficient <img class="math" src="_images/math/9bbde2affc95e6328b85b66e9da618f2ad0212a8.png" alt="A_d" style="vertical-align: -3px"/> that controls how effective the blades are in setting
fluid into motion, and a coefficient <img class="math" src="_images/math/c3057df9f2bebf10315af3944c134901ae7a7b27.png" alt="B_d" style="vertical-align: -3px"/> that controls the amount of
axial flow induced.</p>
<p>It is best to determine the values of <img class="math" src="_images/math/9bbde2affc95e6328b85b66e9da618f2ad0212a8.png" alt="A_d" style="vertical-align: -3px"/> and <img class="math" src="_images/math/c3057df9f2bebf10315af3944c134901ae7a7b27.png" alt="B_d" style="vertical-align: -3px"/> from empirical
data because the performance of a fan or impeller depends on details of the
blade sizes and shapes and on the number of blades. The manufacturers of these
devices often characterize them by so called “performance curves,” which are
plots of pressure drop across the device versus the average flow rate passing
through it. The figure below shows a typical (made up) example of a performance
curve.</p>
<div class="figure" id="id113">
<span id="typicalexampleofperformancecurve"></span><a class="reference internal image-reference" href="_images/typical-example-of-performance-curve.png"><img alt="Typical performance curve (solid line) and |prod| approximation (dashed)" src="_images/typical-example-of-performance-curve.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 4: Typical performance curve (solid line) and <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> approximation (dashed)</span></p>
</div>
<p>A performance curve for the model used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be derived by relating the
rotating momentum source to an equivalent pressure drop across the thickness of
the device and averaging the flow rate over the entire cross section. The result
is:</p>
<div class="math" id="equation-performancecurveequation">
<p><span class="eqno">(141)<a class="headerlink" href="#equation-performancecurveequation" title="Permalink to this equation">¶</a></span><img src="_images/math/ed5b42cd6b7e8950f7e8f7b2f515923fd9b2a738.png" alt="\Delta p = \rho L{A_d}\left( {\frac{2}{3}{S_d}{B_d}R\left( {1 - \frac{{{r^3}}}{{{R^3}}}} \right) - \frac{Q}{{\pi {R^2}}}} \right)"/></p>
</div><p>In this expression <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the fluid density and <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> is the net flow
rate. This relationship gives a linear performance curve with y-intercept
<img class="math" src="_images/math/39781161f79a096d63d157b0d5d6b07d41263315.png" alt="\Delta \rho _0" style="vertical-align: -4px"/> and x-intercept <img class="math" src="_images/math/cd8bb043c56d13af3ff12806dbe20b23916b2a47.png" alt="Q_0" style="vertical-align: -4px"/> in the above figure given
by:</p>
<div class="math" id="equation-linearperformancecurve">
<p><span class="eqno">(142)<a class="headerlink" href="#equation-linearperformancecurve" title="Permalink to this equation">¶</a></span><img src="_images/math/0a043beee400cfb5e821b4ca7599e08060ee3aa8.png" alt="\Delta {p_0} = \rho L\left( {\frac{{{Q_0}}}{{\pi {R^2}}}} \right){A_d}, \quad {Q_0} = \frac{2}{3}\pi \left( {{R^3} - {r^3}} \right){S_d}{B_d}"/></p>
</div><p>Using these relations and a given rotation rate <span class="target" id="index-113"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OSPIN</span></code> <img class="math" src="_images/math/6f9edc2ccf6f3283e2f21685e3737e25289bea93.png" alt="= S_d" style="vertical-align: -3px"/>, the
<span class="target" id="index-114"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OADRG</span></code> <img class="math" src="_images/math/bd32ac9827fd1e14f9e0d43a8cc75492d3e6527f.png" alt="= A_d" style="vertical-align: -3px"/>, and <span class="target" id="index-115"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OBDRG</span></code> <img class="math" src="_images/math/29b1eb98d62fbabf4c2a05a6be881c9a1740d4c0.png" alt="= B_d" style="vertical-align: -3px"/> parameters can be computed to give
a linear approximation to any desired performance curve.</p>
<span class="target" id="index-116"></span></div>
<div class="section" id="fluid-structure-interaction-fsi-and-thermal-stress-evolution-tse-models">
<span id="fsitsemodelsth"></span><span id="index-117"></span><h3>Fluid-Structure Interaction (FSI) and Thermal Stress Evolution (TSE) Models<a class="headerlink" href="#fluid-structure-interaction-fsi-and-thermal-stress-evolution-tse-models" title="Permalink to this headline">¶</a></h3>
<p>The Fluid-Structure Interaction (FSI) and Thermal Stress Evolution (TSE)
models are based on the same approach: solving the fully coupled solid
dynamics and fluid flow within <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The former solves elastic stresses
within solid components, while the latter solves them within solidified fluid
regions.</p>
<p>The approach used for this model is unlike any other module in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The
original structured finite-difference mesh used for the fluid and heat transfer
computations is <strong>not</strong> used with this module. Instead, a conforming and
unstructured finite element (FE) grid is used which deforms along with the
solid. This is because solving the solid mechanics equations is far more
convenient and accurate with a conforming FE mesh than with a non-conforming
finite difference mesh.</p>
<p>The standard <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> mesh is used to generate the new finite-element (FE) mesh
for solid components (for FSI) or solidified fluid regions (for TSE).
Throughout the bulk of the solid regions, the standard hexahedral mesh is used
without alteration (when the <span class="guilabel">Hexahedron</span> option is selected), and
by splitting the standard mesh into 5 tetrahedrons (when the
<span class="guilabel">Tetrahedron</span> option is selected). At the boundaries of the solid
regions, the nearest node points are moved onto the surface of the solid region
along the normal to the surface.</p>
<p>For the <span class="guilabel">Hexahedron</span> option, nearby nodes can be eliminated or
merged with neighbors. The figure below shows a simplified two-dimensional
example of this process. Therefore, the creation of the FE mesh is completely
automatic and requires no additional input from the user. Elements away from
the interface always have 8 nodes. Due to the merging of nodes near the solid
interface, elements at the surface can have 7, 6, 5, or even 4 nodes.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/fsi-tse-merging-of-nodes.png"><img alt="node merged with neighbor" src="_images/fsi-tse-merging-of-nodes.png" style="width: 4.1in;" /></a>
</div></blockquote>
<p>For the <span class="guilabel">Tetrahedron</span> option, all elements that are generated will
have 4 nodes, and thus provide a more uniform algorithm throughout the domain
of the solid region, although the element sizes can vary adjacent to the
boundary.</p>
<p>In Model Reference sections <a class="reference internal" href="model-reference.html#fsitsemr"><span class="std std-ref">Fluid-Structure Interaction (FSI)</span></a> and
<a class="reference internal" href="model-reference.html#tsesolidifiedfluidregion"><span class="std std-ref">Thermal Stress Evolution (TSE) in Solidified Fluid Regions</span></a>, there are discussions on how to control the
resolution of the finite element meshes.</p>
<div class="section" id="equation-of-motion-and-stress">
<span id="equationofmotionandstressth"></span><span id="index-118"></span><h4>Equation of Motion and Stress<a class="headerlink" href="#equation-of-motion-and-stress" title="Permalink to this headline">¶</a></h4>
<p>The FSI and TSE models solve the standard equation of motion in solid regions
(solidified fluid for the TSE model, and solid components for the FSI model:</p>
<div class="math" id="equation-standardeqmotioninsolidregionsfsi">
<p><span class="eqno">(143)<a class="headerlink" href="#equation-standardeqmotioninsolidregionsfsi" title="Permalink to this equation">¶</a></span><img src="_images/math/d11ecf4ce055a5ceb98c0f8e5052ee5fd3a01bfd.png" alt="\underbrace{ \rho \frac{{{d^2}{\mathbf{x}}}}{{d{t^2}}} }_{ \substack{\textrm{Net force on material} \\ \textrm{due to acceleration}}}
= \underbrace{ \nabla  \cdot {\boldsymbol \sigma } }_{ \substack{\textrm{Force due to local} \\ \textrm{stress gradients}}}
+ \underbrace{ \rho {\mathbf{b}} }_{ \substack{ \textrm{Body forces}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the density of the material,</li>
<li><img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/> is time,</li>
<li><img class="math" src="_images/math/07b83dbe9dfd30a1a36373fe2bf8df2c797db138.png" alt="\mathbf{x}" style="vertical-align: 0px"/> is the coordinate of a point in the material,</li>
<li><img class="math" src="_images/math/0aa3bab7a1a746487896cf40c8db95c2b09941bd.png" alt="{\boldsymbol \sigma}" style="vertical-align: 0px"/> is the Cauchy stress tensor, and</li>
<li><img class="math" src="_images/math/1b421b9472f411420a50a9e4a358fde4f8de23f5.png" alt="\mathbf{b}" style="vertical-align: 0px"/> is the body force vector.</li>
</ul>
<p>The Cauchy stress tensor is a measure of the state of stress in the material.
For elastic solids, it is related to the strain of the material, as well as
thermal and other internal stresses. The strain is the amount of physical
deformation undergone by the material, and is also a tensor.</p>
<p>The approach used in this work is based on small, incremental deformations. That
is, from one time step to the next, the strain increment is computed:</p>
<div class="math" id="equation-strainincrement">
<p><span class="eqno">(144)<a class="headerlink" href="#equation-strainincrement" title="Permalink to this equation">¶</a></span><img src="_images/math/12e6384ad4932e8a45a05682799c4361852a2904.png" alt="{\mathbf{E}} = \frac{1}{2}\left\{ {{{\left[ {\nabla \left( {\delta {\mathbf{x}}} \right)} \right]}^T} + \nabla \left( {\delta {\mathbf{x}}} \right)} \right\} = \frac{1}{2}\left[ {\frac{{\partial {{\left( {\delta x} \right)}_i}}}{{\partial x_j^n}} + \frac{{\partial {{\left( {\delta x} \right)}_j}}}{{\partial x_j^n}}} \right]{{\mathbf{e}}_i}{{\mathbf{e}}_j}"/></p>
</div><p>Here <img class="math" src="_images/math/ee9f50e14a719d7143568e23be5877fb3ac08b68.png" alt="\mathbf{E}" style="vertical-align: 0px"/> is the strain increment, the subscripts <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/> refer to the Cartesian coordinate directions (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>,<img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>,<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>), and <img class="math" src="_images/math/15d6a5716c2a7f54a18ab2186ff619f63e96c724.png" alt="{{\mathbf{e}}_i}" style="vertical-align: -3px"/> refer to the unit normal
vectors in <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>. <img class="math" src="_images/math/bd496ac5b1abe170b74eb49a67332c680d06d823.png" alt="\delta {\mathbf{x}}" style="vertical-align: 0px"/>
refers to the displacement vector, and is equal to:</p>
<div class="math" id="equation-displacementvector">
<p><span class="eqno">(145)<a class="headerlink" href="#equation-displacementvector" title="Permalink to this equation">¶</a></span><img src="_images/math/2090b00586dea9045ad6a34431a9b876230e6e09.png" alt="\delta {\mathbf{x}} = \mathbf{x^{n+1}} - \mathbf{x^{n}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/0b8087f4a4681cc2f3dd95d0a8c35ed9e8b06cfa.png" alt="\mathbf{x^{n}}" style="vertical-align: 0px"/> is the position of a material point in the previously computed time cycle, and</li>
<li><img class="math" src="_images/math/481ecfcb7b1057c453ac23a6275725b1dd2d60f5.png" alt="\mathbf{x^{n+1}}" style="vertical-align: 0px"/> is the position of the same point in the current time cycle.</li>
</ul>
<p>The Cauchy stress tensor for the current time-level, <img class="math" src="_images/math/7eac53247bd885fd1aaa0b2413ba3fb7da5cffd4.png" alt="{\boldsymbol
\sigma ^{n+1}}" style="vertical-align: 0px"/>, is computed from the linear Hookean model for each time-step
increment, and is:</p>
<div class="math" id="equation-cauchystresstensor">
<p><span class="eqno">(146)<a class="headerlink" href="#equation-cauchystresstensor" title="Permalink to this equation">¶</a></span><img src="_images/math/a9885cfaba0aee6f69b700394d347886d397d6a6.png" alt="{ \boldsymbol \sigma^{n+1} }
= { \boldsymbol \sigma^n }
+ \left( {K - \frac{2}{3}G} \right) tr \left( { \mathbf{E} } \right)
+ 2G{ \mathbf{E} }."/></p>
</div><p>Here again, the <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> and <img class="math" src="_images/math/b58a6e67def83a6a714de5895b3b56c336397c23.png" alt="n+1" style="vertical-align: -2px"/> superscripts refer to the previous and
current time cycles. <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> and <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> are the bulk and shear moduli,
respectively, <img class="math" src="_images/math/14b713792ae950b99d3bd1524a97b616a21b2a2a.png" alt="tr \left( { \mathbf E } \right)" style="vertical-align: -5px"/> refers to the trace of
the strain tensor <img class="math" src="_images/math/d753e33fcc94706f71b91e67ddaadda3f1714a43.png" alt="{\mathbf E }" style="vertical-align: 0px"/> and is the sum of its diagonal
components. The bulk modulus <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is a user-defined parameter that
describes the material resistance to isotropic expansion or contraction. The
shear modulus <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> describes the material resistance to shearing.</p>
<p>The bulk and shear moduli, <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> and <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/>, are either specified
directly or can be obtained from specifying the Young’s modulus (<img class="math" src="_images/math/4e731d960c926d2bc9f78ff625d5a695416429ae.png" alt="E" style="vertical-align: 0px"/>)
and the Poisson’s ratio (<img class="math" src="_images/math/6f0271089ab36d5f12ee5fe3eef8d89debc5529f.png" alt="\nu" style="vertical-align: 0px"/>).The model works with any combination of two out
of four elastic properties. The relationships are:</p>
<div class="math" id="equation-bulkandshearmodulikandg">
<p><span class="eqno">(147)<a class="headerlink" href="#equation-bulkandshearmodulikandg" title="Permalink to this equation">¶</a></span><img src="_images/math/9ce7bfb65c6bfc3e1a0a218d6e2d312caf7ebbb7.png" alt="{K = \frac{E}{{3\left(1 - 2\nu \right)}}} {\quad \text{and} \quad } {G = \frac{E}{{2\left(1 + \nu \right)}}}"/></p>
</div><p>Note that when the Poisson’s ratio approaches <img class="math" src="_images/math/382986b563c4866b877e4543475de9da0be442dc.png" alt="\frac {1}{2}" style="vertical-align: -6px"/>, then
<img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> approaches infinity, meaning that the material approaches the
incompressible limit. All of these properties can be defined as tabular
functions of temperature.</p>
<p>The acceleration term in Eq. <a class="reference internal" href="#equation-standardeqmotioninsolidregionsfsi">(143)</a> is solved
from the positions of the points at different times. Therefore,</p>
<div class="math" id="equation-accelerationterm">
<p><span class="eqno">(148)<a class="headerlink" href="#equation-accelerationterm" title="Permalink to this equation">¶</a></span><img src="_images/math/18e44ced92173b47eda8e2c042de100cdb7917b6.png" alt="\rho \frac{{{d^2}{\mathbf{x}}}}{{d{t^2}}} = \rho \left( {\frac{{{{\mathbf{x}}^{{\mathbf{n}} + {\mathbf{1}}}} - 2{{\mathbf{x}}^{\mathbf{n}}} + {{\mathbf{x}}^{{\mathbf{n}} - {\mathbf{1}}}}}}{{\Delta {t^{n + 1}}\Delta {t^n}}}} \right)"/></p>
</div></div>
<div class="section" id="finite-element-method-fem">
<span id="finiteelementmethodth"></span><span id="index-119"></span><h4>Finite Element Method (FEM)<a class="headerlink" href="#finite-element-method-fem" title="Permalink to this headline">¶</a></h4>
<p>Equation <a class="reference internal" href="#equation-standardeqmotioninsolidregionsfsi">(143)</a> comprises a three-dimensional
partial differential equation, solved during each time-step, whose unknowns are
<img class="math" src="_images/math/2656b4cd10954f91e264512788e24f70fa6669ad.png" alt="{\mathbf x^{n+1}}" style="vertical-align: 0px"/> (<img class="math" src="_images/math/391b1323246fec00fd85b5fb998aecae021825e4.png" alt="{\boldsymbol \sigma ^{n+1}}" style="vertical-align: 0px"/> are computed
directly from <img class="math" src="_images/math/2656b4cd10954f91e264512788e24f70fa6669ad.png" alt="{\mathbf x^{n+1}}" style="vertical-align: 0px"/> and earlier time level values of
<img class="math" src="_images/math/0aa3bab7a1a746487896cf40c8db95c2b09941bd.png" alt="{\boldsymbol \sigma}" style="vertical-align: 0px"/> in Eq. <a class="reference internal" href="#equation-cauchystresstensor">(146)</a>). The finite element
method (FEM) uses the method of weighted residuals to solve Eq.
<a class="reference internal" href="#equation-standardeqmotioninsolidregionsfsi">(143)</a>. The weighted residual form of Eq.
<a class="reference internal" href="#equation-standardeqmotioninsolidregionsfsi">(143)</a> is:</p>
<div class="math" id="equation-weightedresidualform">
<p><span class="eqno">(149)<a class="headerlink" href="#equation-weightedresidualform" title="Permalink to this equation">¶</a></span><img src="_images/math/084babcf5f42ab86f9b386af82a6b109591da91b.png" alt="0 = \int\limits_\Omega  {\Psi \left[ \nabla  \cdot { \boldsymbol \sigma^{n+1}}
+ \rho {\mathbf b }
- \rho \left( \frac{ {\mathbf x^{n+1} } - 2{ \mathbf{x^n} } + { \mathbf x^{n-1} } }{ \Delta t^{n + 1} \Delta t^n } \right) \right] } d\Omega ."/></p>
</div><p>Here, <img class="math" src="_images/math/a1f36f7c1524752ba9875708f4a7f088bdd5a16d.png" alt="\Psi" style="vertical-align: 0px"/> represents the weighting function, and
<img class="math" src="_images/math/96afe65f8acb26e7f10e78d2b5204fbcf217343d.png" alt="\mathbf{\Omega}" style="vertical-align: 0px"/> the domain. To keep the order of derivatives to a
minimum in the formulation, the following identity is used:</p>
<div class="math" id="equation-identitykeepingderivativestominimum">
<p><span class="eqno">(150)<a class="headerlink" href="#equation-identitykeepingderivativestominimum" title="Permalink to this equation">¶</a></span><img src="_images/math/477c14a02eabc79a87d609c301d483f0dabf13c2.png" alt="\nabla  \cdot \left( \Psi { \boldsymbol \sigma^{n+1} } \right)
= \Psi \nabla  \cdot {\boldsymbol \sigma^{n+1} }
+ \nabla \Psi  \cdot {\boldsymbol \sigma^{n+1}}"/></p>
</div><p>With Eq. <a class="reference internal" href="#equation-identitykeepingderivativestominimum">(150)</a>, Eq.
<a class="reference internal" href="#equation-weightedresidualform">(149)</a> then becomes:</p>
<div class="math" id="equation-greenstheorem">
<p><span class="eqno">(151)<a class="headerlink" href="#equation-greenstheorem" title="Permalink to this equation">¶</a></span><img src="_images/math/fb5db95e4e7f7cdcca249012645a56cc17853a71.png" alt="0 = \int\limits_\Omega  {
\left[ \nabla \Psi  \cdot {\boldsymbol \sigma^{n+1}}
- \Psi \rho {\mathbf{b}}
+ \Psi \rho \left( \frac{ {\mathbf x^{n+1}} - 2 {\mathbf x^n} + {\mathbf x^{n-1}}}{\Delta t^{n + 1} \Delta t^n}
\right) \right] } d\Omega
- \int\limits_\Omega  {\nabla  \cdot \left( \Psi { \boldsymbol \sigma^{n+1}}
\right)} d\Omega"/></p>
</div><p>From Green’s theorem, the last term on the right hand side of Eq.
<a class="reference internal" href="#equation-greenstheorem">(151)</a> can be converted to a surface integral:</p>
<div class="math" id="equation-greenstheoremconvertedsurfaceintegral">
<p><span class="eqno">(152)<a class="headerlink" href="#equation-greenstheoremconvertedsurfaceintegral" title="Permalink to this equation">¶</a></span><img src="_images/math/fdb8fdd1b3d6349da0783a9346f70fc52c4c4238.png" alt="0 = \int\limits_\Omega  {
\left[ \nabla \Psi  \cdot {\boldsymbol \sigma^{n+1}}
- \Psi \rho {\mathbf{b}}
+ \Psi \rho \left( \frac{ {\mathbf x^{n+1}} - 2 {\mathbf x^n} + {\mathbf x^{n-1}}}{\Delta t^{n + 1} \Delta t^n}
\right) \right] } d\Omega
- \oint { {\mathbf n}  \cdot \left( \Psi { \boldsymbol \sigma^{n+1}}
\right)} d\Gamma"/></p>
</div><p>Here <img class="math" src="_images/math/8f498388aa00364478a7009ed2e050423d7a0154.png" alt="\mathbf{n}" style="vertical-align: 0px"/> is the outward pointing normal on the surface of the
domain <img class="math" src="_images/math/96afe65f8acb26e7f10e78d2b5204fbcf217343d.png" alt="\mathbf{\Omega}" style="vertical-align: 0px"/>. <img class="math" src="_images/math/d0239ceee7c5345d71af079d5980e2d162630b68.png" alt="\mathbf{d\Gamma}" style="vertical-align: 0px"/> is the area of a
infinitesimal portion of the solid region interface. The superscripts
<img class="math" src="_images/math/e61fef48cb5d01a79ba9a4034b11558c7c38a8ba.png" alt="n-1" style="vertical-align: 0px"/>, <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>, and <img class="math" src="_images/math/b58a6e67def83a6a714de5895b3b56c336397c23.png" alt="n+1" style="vertical-align: -2px"/> refer to the time-level of each
variable. The last term on the right-hand side is non-zero only at the interface
of the domain. The weighting function <img class="math" src="_images/math/df97ae0220cb089b7ea5b84bb401ffff5d6c02da.png" alt="\mathbf{\Psi}" style="vertical-align: 0px"/> is comprised of a
series of basis functions, which are defined as non-zero only around the node
point they correspond to and are zero at all other nodes. Therefore,</p>
<div class="math" id="equation-weightedfunction">
<p><span class="eqno">(153)<a class="headerlink" href="#equation-weightedfunction" title="Permalink to this equation">¶</a></span><img src="_images/math/a5d309aa0df2f5d73550908396f1466ab71a2dde.png" alt="\Psi \left( {\mathbf{x}} \right) = \sum\limits_{i = 1}^{\rm{nnodes}} {{\psi _i}}"/></p>
</div><p>Here:</p>
<ul>
<li><p class="first"><img class="math" src="_images/math/d78151d9e9f9226f6f2757fe63ad0a323d34d67b.png" alt="{\rm{nnodes}}" style="vertical-align: 0px"/> is the total number of nodes present in the mesh,</p>
</li>
<li><p class="first"><img class="math" src="_images/math/23d5a5afcf1090f36ae511533ad073678271f6e9.png" alt="{\mathbf{x}}" style="vertical-align: 0px"/> is the position in physical coordinates, and</p>
</li>
<li><p class="first"><img class="math" src="_images/math/97765ca90cd692085784b8dcf10b9279c0b1c6dd.png" alt="\psi _i" style="vertical-align: -4px"/> are the local basis functions defined in the vicinity of node number <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>. The basis functions are continuous, and their first derivative exists but is not continuous.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/theory-nodes.png"><img alt="Nodes" src="_images/theory-nodes.png" style="width: 4.1in;" /></a>
</div></blockquote>
</li>
</ul>
<p>The concept of the element helps when thinking about the basis functions
<img class="math" src="_images/math/152a9a9453f58b0313102171dd8e6add6aa62b5b.png" alt="\phi _i" style="vertical-align: -4px"/>. An <em>element</em> is a small volume of the domain whose vertices
correspond to the nodes. The figure above shows the 8 nodes within a standard
hexahedral element. For tetrahedral elements, the picture is similar but there
are 4 nodes with vertices at (0,0,0), (1,0,0), (0,1,0) and (0,0,1). The basis
functions <img class="math" src="_images/math/63437de0b84115d751d3d36833ae0b60665f5148.png" alt="\psi_i" style="vertical-align: -4px"/> corresponding to these nodes are all non-zero within
this space. The basis functions for nodes which are not part of the current
element are all zero. Therefore, considering Eq. <a class="reference internal" href="#equation-weightedfunction">(153)</a>, when
Eq. <a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegral">(152)</a> is re-written, the result:</p>
<div class="math" id="equation-greenstheoremconvertedsurfaceintegralrewritten">
<p><span class="eqno">(154)<a class="headerlink" href="#equation-greenstheoremconvertedsurfaceintegralrewritten" title="Permalink to this equation">¶</a></span><img src="_images/math/ab9c3d53ba66d18191e76888e0dd1d50c102d743.png" alt="0 = \sum\limits_{k = 1}^{\rm{nnodes}}
{\int\limits_\Omega
{\left[ {\nabla {\psi _k} \cdot {\boldsymbol \sigma^{n+1} }
- \psi_k \rho {\mathbf b}
+ \psi_k \rho \left( \frac{ {\mathbf x^{n+1}} - 2{\mathbf x^n } + {\mathbf x^{n-1}}}{ \Delta t^{n + 1} \Delta t^n}
\right)} \right]} d\Omega }
- \sum\limits_{k = 1}^{\rm{nnodes}} {\oint \psi_k
\left( {\mathbf n} \cdot {\boldsymbol \sigma^{n+1}} \right)} d\Gamma"/></p>
</div><p>is a series of terms, of which only a few are non-zero within a particular
element. Then, Eq. <a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegralrewritten">(154)</a> is
assembled element-by-element. Because the <img class="math" src="_images/math/4c32950c0a2bc5b59cf3b0d73fd2445ccf4af18c.png" alt="\psi_k" style="vertical-align: -4px"/> in Eq.
<a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegralrewritten">(154)</a> are non-zero only in the
elements shared by node <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>, Eq.
<a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegralrewritten">(154)</a> is in fact a set of
<img class="math" src="_images/math/d78151d9e9f9226f6f2757fe63ad0a323d34d67b.png" alt="{\rm{nnodes}}" style="vertical-align: 0px"/> equations, one for each node. Furthermore, because there
are three Cartesian directions, there are a total of 3<img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/><img class="math" src="_images/math/d78151d9e9f9226f6f2757fe63ad0a323d34d67b.png" alt="{\rm{nnodes}}" style="vertical-align: 0px"/> scalar equations.</p>
<p>The individual basis functions, <img class="math" src="_images/math/4c32950c0a2bc5b59cf3b0d73fd2445ccf4af18c.png" alt="\psi_k" style="vertical-align: -4px"/>, are repeated for each element.
Within each element, these basis functions are computed using the computational
coordinates of each element (<img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/>,<img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/>,<img class="math" src="_images/math/641ac646152ce966fe12cc9c69c275954b47ab83.png" alt="\zeta" style="vertical-align: -4px"/>), regardless of the element
orientation. For hexahedral elements, they are:</p>
<div class="math" id="equation-individualbasisfunctionseachelement">
<p><span class="eqno">(155)<a class="headerlink" href="#equation-individualbasisfunctionseachelement" title="Permalink to this equation">¶</a></span><img src="_images/math/b27af6cc145c67dbe6e586c1056e7329e2320be2.png" alt="\begin{gathered}
{\psi _1} = \tfrac{1}{8}(1 - \xi )(1 - \eta )(1 - \zeta ) \hfill \\
{\psi _2} = \tfrac{1}{8}\xi (1 - \eta )(1 - \zeta ) \hfill \\
{\psi _3} = \tfrac{1}{8}(1 - \xi )\eta (1 - \zeta ) \hfill \\
{\psi _4} = \tfrac{1}{8}\xi \eta (1 - \zeta ) \hfill \\
{\psi _5} = \tfrac{1}{8}(1 - \xi )(1 - \eta )\zeta  \hfill \\
{\psi _6} = \tfrac{1}{8}\xi (1 - \eta )\zeta  \hfill \\
{\psi _7} = \tfrac{1}{8}(1 - \xi )\eta \zeta  \hfill \\
{\psi _8} = \tfrac{1}{8}\xi \eta \zeta  \hfill \\
\end{gathered}"/></p>
</div><p>For tetrahedral elements, they are:</p>
<div class="math" id="equation-individualbasisfunctionseachelementtet">
<p><span class="eqno">(156)<a class="headerlink" href="#equation-individualbasisfunctionseachelementtet" title="Permalink to this equation">¶</a></span><img src="_images/math/54a23d56c4f540f19ebb72c664a91a02572aea02.png" alt="\begin{gathered}
{\psi _1} = 1 - \xi - \eta - \zeta \hfill \\
{\psi _2} = \xi \hfill \\
{\psi _3} = \eta \hfill \\
{\psi _4} = \zeta \hfill \\
\end{gathered}"/></p>
</div><p>Here the subscript refers to the local (i.e., element-level) node. Note that
each basis function is equal to 1 at its local node, and 0 at all other nodes.
The basis functions are used as both the weighting function for the weighted
residual equation, as well as representing the position and displacement:</p>
<div class="math" id="equation-positionofpointinphysicaldomain">
<p><span class="eqno">(157)<a class="headerlink" href="#equation-positionofpointinphysicaldomain" title="Permalink to this equation">¶</a></span><img src="_images/math/30dcdd1d7043abc689cc36ae748a391a41d44654.png" alt="{\mathbf{x}} = \sum\limits_{k = 1}^{\rm{nnodes}} {{{\mathbf{x}}_{\mathbf{k}}}{\psi _k}} \text {.}"/></p>
</div><p>Here:</p>
<ul class="simple">
<li><img class="math" src="_images/math/07b83dbe9dfd30a1a36373fe2bf8df2c797db138.png" alt="\mathbf{x}" style="vertical-align: 0px"/> refers to the position of a point in the physical domain, and</li>
<li><img class="math" src="_images/math/acf3c9ac1184da70c6666ce78b211de481a99e39.png" alt="\mathbf{x_k}" style="vertical-align: -3px"/> refers to the value of the positions stored at each global node <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>, and</li>
<li><img class="math" src="_images/math/a6e70a6a9254abc86436d1d203efe8f0265cac6f.png" alt="\phi _k" style="vertical-align: -4px"/> is the basis function at node <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>.</li>
</ul>
<p>Note that although Eq. <a class="reference internal" href="#equation-positionofpointinphysicaldomain">(157)</a> is written in
general form for a point anywhere in the domain, it can be used within an
individual element considering only nodes within the local element. This is
because the values of <img class="math" src="_images/math/a6e70a6a9254abc86436d1d203efe8f0265cac6f.png" alt="\phi _k" style="vertical-align: -4px"/> for all nodes outside of the element are
zero by definition.</p>
<p>With Eq. <a class="reference internal" href="#equation-positionofpointinphysicaldomain">(157)</a>, Eq.
<a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegralrewritten">(154)</a> can be written as a
series of 3<img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/><img class="math" src="_images/math/d78151d9e9f9226f6f2757fe63ad0a323d34d67b.png" alt="{\rm{nnodes}}" style="vertical-align: 0px"/> scalar equations with 3<img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/><img class="math" src="_images/math/d78151d9e9f9226f6f2757fe63ad0a323d34d67b.png" alt="{\rm{nnodes}}" style="vertical-align: 0px"/> unknowns: the three coordinates of the
position <img class="math" src="_images/math/3bc12aeebadde4391cc55c5e84091fd37e93b569.png" alt="\mathbf{x_{k}}" style="vertical-align: -3px"/> at each node. The integral is solved
numerically with the method of Gaussian quadrature and the resulting system of
linear equations is solved iteratively with a generalized minimum residual
(GMRES) solver, similar to the one used to solve the coupled momentum and
continuity equations in the fluid.</p>
</div>
<div class="section" id="boundary-conditions-on-solid-regions">
<span id="boundaryconditionsonsolidregionsth"></span><span id="index-120"></span><h4>Boundary Conditions on Solid Regions<a class="headerlink" href="#boundary-conditions-on-solid-regions" title="Permalink to this headline">¶</a></h4>
<p>The fluid-structure interaction and thermal stress evolution models
automatically determine the boundary conditions on each element face of the
solid component.</p>
<p>Where such faces contact fluid regions, the local fluid pressure determines the
traction (<img class="math" src="_images/math/8d37aa5f71a20bbf68805402ca628a61fd720ee0.png" alt="{\mathbf{n}} \cdot {{\mathbf{\sigma }}^{{\mathbf{n}} +
{\mathbf{1}}}}" style="vertical-align: 0px"/>) in Eq. <a class="reference internal" href="#equation-greenstheoremconvertedsurfaceintegralrewritten">(154)</a>.
Therefore,</p>
<div class="math" id="equation-boundaryconditionsonsolidregions">
<p><span class="eqno">(158)<a class="headerlink" href="#equation-boundaryconditionsonsolidregions" title="Permalink to this equation">¶</a></span><img src="_images/math/66db8eb9bb9d1ed9a9b7ad34c42f851da52eda6b.png" alt="{\mathbf{n}} \cdot {{\mathbf{\sigma }}^{{\mathbf{n}} + {\mathbf{1}}}} =  - {\mathbf{n}}{p_{\rm{fluid}}}"/></p>
</div><p>The negative sign is present because in the convention of solid stresses,
compression is negative.</p>
<p>Where the boundary faces are adjacent to the (fluid) domain boundary, the
boundary type determines the condition to impose on the solid. Adjacent to wall
boundaries, the solid regions are fixed; i.e., the nodes are attached to the
boundary and cannot move. At symmetry boundaries, the nodes can slide freely
along the boundary, but cannot penetrate nor pull away. At other boundaries, the
pressure in the neighboring boundary cell is used to compute the traction, based
on Eq. <a class="reference internal" href="#equation-boundaryconditionsonsolidregions">(158)</a>.</p>
<p>For FSI components, when the default coupling option (<span class="guilabel">No
coupling</span>) is selected, wherever a FSI component is in contact with another
component (standard or FSI), the interface is always assumed to be fixed;
i.e., the nodes at the interface do not move during the course of the
simulation.</p>
<p>When the <span class="guilabel">Partial</span> coupling option is selected between two neighboring
components, there is a transfer of stress across the boundary between these
components where they are in contact. Normal compressive stresses are fully
transferred, while normal tensile forces are not (i.e., partially coupled
components can freely pull apart), and tangential forces are partially
transferred, depending on the user-specified friction coefficient.</p>
<p>When the <span class="guilabel">Full</span> coupling option is selected between two neighboring
components, the meshes of the two components are actually fused together where
they are in contact, and there is always a complete transfer of stresses
between the two components.</p>
<p>When a solidified fluid region is in contact with another component (standard
or FSI), the solidified fluid region can pull away freely and form a gap. When
the heat transport properties of the gas in the gap are supplied (gas
conductivity and/or emissivity), the heat transfer coefficient is
automatically computed in the gap (wider gaps will reduce heat transport).
When the neighboring components (FSI or non-FSI) are specified to be
<span class="guilabel">Constraining</span>, and the solidified fluid region pushes into a
component, a restraining force is applied to the solidified fluid region to
prevent interference into the component. Alternatively, if the component is
chosen to be a <span class="guilabel">Non-constraining</span> component, then only a minimal
force is applied to maintain the position of the solidified region. This is
useful to simulate thermal stress development in sand molds.</p>
<p>Additionally, where solidified fluid regions are in contact with neighboring
FSI components, the coupling between the two can be coupled, just as between
two FSI components. In this case, there is a partial transfer of stress across
the boundary between the TSE region and the FSI component: normal compressive
stresses are transferred (interference cannot occur), while normal tensile
stresses are not, and tangential stresses are partially transferred, depending
on the <span class="guilabel">Friction coefficient</span> specified.</p>
<span class="target" id="index-121"></span></div>
<div class="section" id="solidified-non-solidified-coupling">
<span id="solidified-to-nonsolidified-coupling-tse"></span><span id="index-122"></span><h4>Solidified/non-Solidified Coupling<a class="headerlink" href="#solidified-non-solidified-coupling" title="Permalink to this headline">¶</a></h4>
<p>The pressure from liquid/void can be applied as a normal force at the
solidification front in order to prevent large displacements of the interface.
A web of springs applied at nodal locations maintains the position of the
interface. The springs are weak enough not to affect the stresses but strong
enough to maintain stability.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/solid_non_solidified_coupling.png"><img alt="solid to non-solidified coupling" src="_images/solid_non_solidified_coupling.png" style="width: 6.68in;" /></a>
</div></blockquote>
</div>
<div class="section" id="yielding-model">
<span id="fsi-tse-yielding-theory"></span><span id="index-123"></span><h4>Yielding model<a class="headerlink" href="#yielding-model" title="Permalink to this headline">¶</a></h4>
<p>Metal plasticity as illustrated in the hypothetical uniaxial tensile stress-strain curve shown below:</p>
<img alt="Stress-strain curve" class="align-center" src="_images/yield-curve.png" />
<p>This image shows three main features corresponding to the numbers in the figure.</p>
<ol class="arabic simple">
<li>A linear elastic range where stress is proportional to strain and elastic deformations occur (Hooke’s law).</li>
<li>The yield point beyond which plastic deformations begin to occur. This is the maximum stress that a
material can withstand before permanent plastic deformations begin.</li>
<li>The ultimate strength, i.e. the maximum stress that a material can withstand while being stretched before breaking.</li>
</ol>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the behavior of a material from yield point is modeled using the Prandl-Reuss equations
of perfect plasticity following the discussion in <a class="reference internal" href="zbibliography.html#simo-hughes-1998" id="id16">[SH98]</a>. This model assumes:</p>
<ul class="simple">
<li>a linear isotropic linear response,</li>
<li>the Huber-von Mises yield condition: <img class="math" src="_images/math/57a1ffbc21b5216a66456a1da537a7662e235217.png" alt="f\left(\sigma\right)=\sqrt{{\|} \sigma^2 {\|}-\frac{1}{3}tr\left[\sigma^2\right]}-R" style="vertical-align: -11px"/>, where <img class="math" src="_images/math/b854fc16713fc5f188742f717627258e3de6efe5.png" alt="R=\sqrt{\frac{2}{3}}\sigma_Y" style="vertical-align: -11px"/> is the radius of the yield surface and <img class="math" src="_images/math/c160c5d81cad010167e78bed782102e8b607b0b5.png" alt="\sigma_Y" style="vertical-align: -3px"/> is the flow stress.</li>
<li>the associative Levy-Saint Venant flow rule,</li>
<li>and no hardening.</li>
</ul>
<p>From these assumptions the plastic-strain rate is given by the evolutionary equation:</p>
<div class="math">
<p><img src="_images/math/d2cd66a4503d352ee7582c7b577717cffbabc614.png" alt="{\dot{\varepsilon}}^p = \gamma\nabla f\left(\sigma\right) = \gamma \frac{\sigma-\frac{1}{3}\left(tr\left[\sigma\right]\right)\mathbf{1}}{\sqrt{{\|}\sigma{\|}^2-\frac{1}{3}\left(tr\left[\sigma\right]\right)^2}} = \gamma \frac{dev\left[\sigma\right]}{{\|} dev\left[\sigma\right]{\|}}"/></p>
</div><p>where <img class="math" src="_images/math/df29cecadd60bc2e1ec4cff5db98e2e2ac7fd200.png" alt="dev\left[\cdot\right]=\left(\cdot\right)-\frac{1}{3}\left(tr\left[\cdot\right]\right)\mathbf{1}" style="vertical-align: -6px"/>
denotes the deviator of the indicated argument, <img class="math" src="_images/math/0977526cca02894a18d63c23372fb922b5bf59eb.png" alt="\left(\cdot\right)" style="vertical-align: -5px"/>.  The stress increment from the
strain is computed for every cycle and the Von Mises stress is compared to the
user defined yield stress condition. If the difference between the two is
positive then plastic yielding occurs. The magnitude of the plastic strain is
computed accordingly and the  incremental plastic strain is computed and
stored for a given cycle. This computation is done for every element in the
finite-element mesh as they exceed the yield strength.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The user defined yield stress can be tabular or a constant value.</p>
</div>
<span class="target" id="index-124"></span><span class="target" id="index-125"></span></div>
</div>
<div class="section" id="general-moving-objects-model">
<span id="gmomodelth"></span><span id="index-126"></span><h3>General Moving Objects Model<a class="headerlink" href="#general-moving-objects-model" title="Permalink to this headline">¶</a></h3>
<p>A general moving object (GMO) is a rigid body under any type of physical
motion which is either dynamically coupled with fluid flow or user-prescribed.
It can move with six degrees of freedom (DOF) or rotate about a fixed point or
a fixed axis. The GMO model allows users to have multiple moving objects in
one problem, and each moving object can have any independently defined type of
motion. GMO components can be of a mixed motion type, namely have
translational and/or rotational velocities that are coupled in some coordinate
directions and prescribed in the other directions. A body-fixed reference
system (“body system”), defined for each moving object, and the space
reference system (“space system”) are employed. At each time step, the
hydraulic force and torque due to pressure and shear stress are calculated,
and equations of motion are solved for the moving objects under coupled motion
with consideration of hydraulic, gravitational, spring, mooring line tension and control forces and
torques. Non-inertial force and torque are also considered if the space system
is non-inertial. Area and volume fractions are recalculated at each time step
based on updated object locations and orientations. Source terms are added in
the continuity equation and the VOF transport equation to account for the
effect of moving objects to displace fluid. The tangential velocity of the
moving object boundaries is introduced into shear stress terms in the momentum
equation. Two numerical options for the coupling of fluid flow and GMO motion
are available: an explicit and an implicit method. In the former, fluid and
GMO motions of each time step are calculated using the force and velocity data
from the previous time step. In the implicit method these are calculated
iteratively. The explicit method only works for problems of heavy objects
(i.e., object density is larger than that of fluid) and problems with small
added mass. The implicit method, however, works for all kinds of problems and
is the recommended numerical method.</p>
<p>The GMO model also includes the capability to simulate rigid body collisions.
Collisions are assumed to be instantaneous. They are allowed to occur between
rigid bodies (one of which must be moving) and between rigid bodies and
wall/symmetry boundaries of the computational domain. The collision model has
two parts: collision detection and collision integration. At each time step,
once a collision is detected, a set of impact equations are integrated.
Depending on the value of Stronge’s restitution coefficient, a collision can
be perfectly elastic, partially elastic or completely plastic. Friction at the
point of contact is also allowed to exist during collision. There can be
relative sliding between two colliding bodies at their contact point and the
speed and direction of sliding can vary throughout the collision process. If
the sliding stops before completion of the collision, the two bodies can
either resume sliding immediately or keep sticking till their separation.
Continuous contact between moving objects, such as sliding, rolling and
resting of one body on the other, is modeled through a series of rapid and
low-amplitude collisions called micro-collisions. The GMO model works in both
Cartesian and cylindrical coordinate systems and is compatible with most
physical models and numerical methods. See Flow Science Technical
Notes #75 and #76 on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a> for more
details.</p>
<div class="section" id="equations-of-motion-for-rigid-body">
<span id="equationofmotionforrigidbodyth"></span><span id="index-127"></span><h4>Equations of Motion for Rigid Body<a class="headerlink" href="#equations-of-motion-for-rigid-body" title="Permalink to this headline">¶</a></h4>
<p>For convenience of computation, a body system (<img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/>,
<img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/>) is set up for each moving object with its coordinate axes parallel
to those of the space system at time t=0. If an object motion has six DOF, the
origin of the body system is set at the object mass center <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/>. The body
system is fixed on the moving object and experiences the same translation and
rotation as the moving object. Coordinate transformation between the space
system (x, y, z) and the body system (x’, y’, z’) is</p>
<div class="math" id="equation-coordinatetransformationbetwspacesysbodysys">
<p><span class="eqno">(159)<a class="headerlink" href="#equation-coordinatetransformationbetwspacesysbodysys" title="Permalink to this equation">¶</a></span><img src="_images/math/635f9782eb3e35202969018241b054db8fd0b020.png" alt="{{\mathbf{x}}_s} = \left[ R \right] \cdot {{\mathbf{x}}_b} + {{\mathbf{x}}_G}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/4d5b26314485912f367a725c8db9c52e80f138d5.png" alt="{{\mathbf{x}}_s}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/d9f7820aea12e399468084333166505b19a632b1.png" alt="{{\mathbf{x}}_b}" style="vertical-align: -3px"/> are position vectors of a point in space and body systems, respectively,</li>
<li><img class="math" src="_images/math/2ac474f0da210a4108af9e462aaea3db2ec16ad5.png" alt="{{\mathbf{x}}_G}" style="vertical-align: -3px"/> is position vector of mass center in space system, and</li>
<li><img class="math" src="_images/math/9ee5d3b85a3fc0dce24c77586dc219126477f0f3.png" alt="\left[ R \right]" style="vertical-align: -5px"/> is an orthogonal coordinate transformation tensor,</li>
</ul>
<div class="math" id="equation-orthogonalcoordinatetransformationtensor">
<p><span class="eqno">(160)<a class="headerlink" href="#equation-orthogonalcoordinatetransformationtensor" title="Permalink to this equation">¶</a></span><img src="_images/math/97bfe7fad65ba1e07a6bb82ebe14a524206e9e20.png" alt="[R] = \left[ \begin{gathered}
{R_{11}}\,\,{R_{12}}\,\,{R_{13}} \hfill \\
{R_{21}}\,\,{R_{22}}\,\,{R_{23}} \hfill \\
{R_{31}}\,\,{R_{32}}\,\,{R_{33}} \hfill \\
\end{gathered}  \right]"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/12a60caff6624ed9895963c4fcbfbf2f1c55bf32.png" alt="R_{ij} R{jk} = \delta _{ik}" style="vertical-align: -6px"/>, and</li>
<li><img class="math" src="_images/math/6230aa5e2618243485bb7c14e2ff53e22ef96a63.png" alt="\delta _{ik}" style="vertical-align: -3px"/> is the Kronecker <img class="math" src="_images/math/f6522a2a7b3c4a689a3e8919cb39e66260a51e83.png" alt="\delta" style="vertical-align: 0px"/> symbol.</li>
</ul>
<p>It is a property of <img class="math" src="_images/math/9ee5d3b85a3fc0dce24c77586dc219126477f0f3.png" alt="\left[ R \right]" style="vertical-align: -5px"/> that its inverse and transposed
matrices are identical. For a space vector A, transformation between space and
body systems is</p>
<div class="math" id="equation-spacevectoratransformationbetwspacebody">
<p><span class="eqno">(161)<a class="headerlink" href="#equation-spacevectoratransformationbetwspacebody" title="Permalink to this equation">¶</a></span><img src="_images/math/acb4d5e3cbb9052ee9681fbe224f20acd064aeba.png" alt="{{\mathbf{A}}_s} = [R] \cdot {{\mathbf{A}}_b}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/6a1d46c7225984149620fca64b9279a393cd4a28.png" alt="{{\mathbf{A}}_s}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/c180f442849fac8e01b6528a2172f7910bf20cdb.png" alt="{{\mathbf{A}}_b}" style="vertical-align: -3px"/> denote expressions of <img class="math" src="_images/math/62d246e12fc7c5752d1d94632c51236c7d3033ef.png" alt="\mathbf {A}" style="vertical-align: 0px"/> in space and body systems, respectively.</li>
<li><img class="math" src="_images/math/9ee5d3b85a3fc0dce24c77586dc219126477f0f3.png" alt="\left[ R \right]" style="vertical-align: -5px"/> is calculated by solving</li>
</ul>
<div class="math" id="equation-spaceandbodysystemsrcalculation">
<p><span class="eqno">(162)<a class="headerlink" href="#equation-spaceandbodysystemsrcalculation" title="Permalink to this equation">¶</a></span><img src="_images/math/be0814f15e6e5ce5039a6eed62fd44e1a6122724.png" alt="\frac{{d[R]}}{{dt}} = [\Omega ] \cdot [R]"/></p>
</div><p>where</p>
<div class="math" id="equation-objectsangularvelocityinspacesystem">
<p><span class="eqno">(163)<a class="headerlink" href="#equation-objectsangularvelocityinspacesystem" title="Permalink to this equation">¶</a></span><img src="_images/math/743eb2931b0cef9d1a38d0b1f2cc974a7579b51c.png" alt="[\Omega ] = \left[ \begin{gathered}
\,\,\,\,0\,\,\,\, - {\Omega _z}\,\,\,\,\,{\Omega _y} \hfill \\
\,\,\,\,{\Omega _z}\,\,\,\,\,0\,\,\,\, - {\Omega _x} \hfill \\
- {\Omega _y}\,\,\,\,{\Omega _x}\,\,\,\,\,\,0 \hfill \\
\end{gathered}  \right]"/></p>
</div><p><img class="math" src="_images/math/cf1447cca9714721497547028aa362e1b64d151f.png" alt="\Omega _x" style="vertical-align: -3px"/>, <img class="math" src="_images/math/f7e95b3a42b089fb8f73ac50d2431aba4793384f.png" alt="\Omega _y" style="vertical-align: -6px"/> and <img class="math" src="_images/math/50d401bd1a5c0c70b3e794e86e87a6a018aa47bd.png" alt="\Omega _z" style="vertical-align: -3px"/> are <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> components, respectively, of the object’s angular
velocity in space system.</p>
<p>According to kinematics, general motion of a rigid body can be divided into a
translational motion and a rotational motion. Velocity of any point on a rigid
body is equal to the velocity of an arbitrarily selected base point on the
object plus velocity due to rotation about the base point. It is convenient to
select the object mass center as the base point for an object with six-DOF
motion. Denoting <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> as any point on the object, its velocity is related
to the mass center velocity <img class="math" src="_images/math/bb2016c1e61679d1a62ad728f0ab9934ca6ab098.png" alt="\mathbf{V}_G" style="vertical-align: -3px"/> and angular velocity
<img class="math" src="_images/math/73723b0d9a4dca1e75c95c0877aca2d6de6bd43d.png" alt="\mathbf{\omega}" style="vertical-align: 0px"/> of the rigid body by</p>
<div class="math" id="equation-velocityofanypoint">
<p><span class="eqno">(164)<a class="headerlink" href="#equation-velocityofanypoint" title="Permalink to this equation">¶</a></span><img src="_images/math/c8146ea05aab44cbb2c8975b5a3cabda3d2d61b0.png" alt="{{\mathbf{V}}_P} = {{\mathbf{V}}_G} + \mathbf{\omega}  \times \mathbf{r}_{P/G}"/></p>
</div><p>where <img class="math" src="_images/math/d1b7ac2df87793e3c307dd4f4546e817e160b6ed.png" alt="\mathbf{r}_{P/G}" style="vertical-align: -6px"/> is the distance vector from <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/> to <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/>. The
first term on the right-hand side of Eq.
<a class="reference internal" href="#equation-velocityofanypoint">(164)</a> represents translation of the mass
center, and the second term represents rotation about the mass center. It is
noted that <img class="math" src="_images/math/73723b0d9a4dca1e75c95c0877aca2d6de6bd43d.png" alt="\mathbf{\omega}" style="vertical-align: 0px"/> is a property of the moving object and
independent of the choice of the base point. Equations of motion governing the
two separate motions are</p>
<div class="math" id="equation-motiongoverningtotalforce">
<p><span class="eqno">(165)<a class="headerlink" href="#equation-motiongoverningtotalforce" title="Permalink to this equation">¶</a></span><img src="_images/math/b5ff17980e02d1047fb90f5f9c2676dc792105ac.png" alt="{\mathbf{F}} = m\frac{{d{{\mathbf{V}}_G}}}{{dt}}"/></p>
</div><p>and</p>
<div class="math" id="equation-motiongoverningtotaltorqueaboutg">
<p><span class="eqno">(166)<a class="headerlink" href="#equation-motiongoverningtotaltorqueaboutg" title="Permalink to this equation">¶</a></span><img src="_images/math/a6e88db1d28072b3d66f72cce77c642460ec0ca5.png" alt="{{\mathbf{T}}_G} = [J] \cdot \frac{{d\omega }}{{dt}} + \mathbf{\omega}  \times \left( {[J] \cdot \mathbf{\omega} } \right)"/></p>
</div><p>respectively, where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/3b645a331fb2ba15a4bcb0d61729503ddb3b2f09.png" alt="\mathbf{F}" style="vertical-align: 0px"/> is the total force,</li>
<li><img class="math" src="_images/math/1037a8f4215555e3efa2949f5393050807b5b344.png" alt="m" style="vertical-align: 0px"/> is rigid body mass,</li>
<li><img class="math" src="_images/math/5069ab126945ebf4e8caaf74107199ee66b7be9c.png" alt="\mathbf{T_{G}}" style="vertical-align: -3px"/> is the total torque about <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/>,</li>
<li><img class="math" src="_images/math/3b1daff111514b8014803597424129d856cea18e.png" alt="[J]" style="vertical-align: -5px"/> is moment of inertia tensor in the body system (“inertia tensor”),</li>
</ul>
<div class="math" id="equation-momentofinertiatensorinbodysystem">
<p><span class="eqno">(167)<a class="headerlink" href="#equation-momentofinertiatensorinbodysystem" title="Permalink to this equation">¶</a></span><img src="_images/math/daa98d663f87e998c95ddd34f4f8987f2696c928.png" alt="[J] = \left[ \begin{gathered}
{J_{11}}\,\,\,\,{J_{12}}\,\,\,{J_{13}} \hfill \\
{J_{21}}\,\,\,{J_{22}}\,\,\,{J_{23}} \hfill \\
{J_{31}}\,\,\,{J_{32}}\,\,\,\,{J_{33}}\, \hfill \\
\end{gathered}  \right]"/></p>
</div><p>The elements <img class="math" src="_images/math/d140d868ce7dc7c26fecadf973f73fc627b1e0b0.png" alt="J_{11}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/73a36ebf683921b8b05e6b232ff44b88c91ecbc5.png" alt="J_{22}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/09b6c5a2deb9d574a19024973c796572dbedc4f4.png" alt="J_{33}" style="vertical-align: -3px"/> are moments of
inertia while the other elements products of inertia,</p>
<div class="math" id="equation-momentsofinertiaj11">
<p><span class="eqno">(168)<a class="headerlink" href="#equation-momentsofinertiaj11" title="Permalink to this equation">¶</a></span><img src="_images/math/a62d359d953f228d401e6ffd377220c84e523298.png" alt="{J_{11}} = \int {(y{'^2} + z{'^2})\,dm} ,{\text{ }}{J_{22}} = \int {(x{'^2} + z{'^2})\,dm} ,{\text{ }}{J_{33}} = \int {(x{'^2} + y{'^2})\,dm}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-momentsofinertiaj22">
<p><span class="eqno">(169)<a class="headerlink" href="#equation-momentsofinertiaj22" title="Permalink to this equation">¶</a></span><img src="_images/math/6531fa9c3029610451a28fa45a8c002d97bd4d22.png" alt="{J_{12}} = {J_{21}} =  - \int {x'y'\,} dm,{\text{ }}{J_{13}} = {J_{31}} =  - \int {x'z'\,} dm,{\text{ }}{J_{23}} = {J_{32}} =  - \int {y'z'\,} dm"/></p>
</div><p>If the <img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/> and <img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/> coordinate axes coincide with the
principle axes of the object, products of inertia vanish. To simplify
calculation, Eqs. <a class="reference internal" href="#equation-motiongoverningtotalforce">(165)</a> and
<a class="reference internal" href="#equation-motiongoverningtotaltorqueaboutg">(166)</a> are solved in space and body systems,
respectively. The total force and the total torque may include hydraulic,
gravitational, spring, non-inertial and control forces and torques.</p>
<p>If an object’s motion is about a fixed point, it has three DOF. It is convenient
that the body system is set up with its origin located at the fixed point. The
coordinate axes of the body system, as described previously, are parallel to
those of the space system at t=0. Let <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> denote the fixed point and <img class="math" src="_images/math/259cb7a3b7648e9e4a3b3e5d527fbba8d11bb8e3.png" alt="x_C" style="vertical-align: -3px"/>
its position vector in space system, coordinate transformation between space and
body systems can be performed using Eq.
<a class="reference internal" href="#equation-coordinatetransformationbetwspacesysbodysys">(159)</a> with substitution of
<img class="math" src="_images/math/6b49a523e4904b48131c5ba89a7ca970f5fe417d.png" alt="\mathbf{x_{G}}" style="vertical-align: -3px"/> by <img class="math" src="_images/math/376dab00a25284ee029df72d4f12d2d81d600080.png" alt="\mathbf{x_{C}}" style="vertical-align: -3px"/>. For any point <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> on
rigid body, its motion is 3-D rotation about the fixed point and its velocity is
written</p>
<div class="math" id="equation-3drotationaboutfixedpointanditsvelocity">
<p><span class="eqno">(170)<a class="headerlink" href="#equation-3drotationaboutfixedpointanditsvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/28287fe768ada4844300af634a57aa8c335d7aa7.png" alt="{\mathbf{V}}_P = \omega  \times {{\mathbf{r}}_{P/C}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/97e36fd32ba7f9ac7edac59acca524a06a2e9130.png" alt="{{\mathbf{r}}_{P/C}}" style="vertical-align: -6px"/> denotes distance from <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> to <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/>, and</li>
<li><img class="math" src="_images/math/73723b0d9a4dca1e75c95c0877aca2d6de6bd43d.png" alt="\mathbf{\omega}" style="vertical-align: 0px"/> is obtained by solving Eq. <a class="reference internal" href="#equation-motiongoverningtotaltorqueaboutg">(166)</a> in the body system with <img class="math" src="_images/math/3b1daff111514b8014803597424129d856cea18e.png" alt="[J]" style="vertical-align: -5px"/> in respect to <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/>.</li>
</ul>
<p>Rotation about a fixed axis is a planar motion, which has one DOF only. In this
case, it is required that the rotation axis be parallel to one of the space
coordinate axes. The body system is set up with one of its three coordinate axes
coinciding with the rotation axis and the other two parallel to those of space
system. Two of the three coordinates of the body system origin are thus the same
as those of the rotation axis, and the third coordinate is set zero. For
example, if the rotation axis is parallel to <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> and the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> coordinates of the rotation axis are <img class="math" src="_images/math/39b0b9fc4a7fe25bde494dad106ba2446cd0dc62.png" alt="x_0" style="vertical-align: -3px"/> and <img class="math" src="_images/math/b84ada1ad1202b3260d350cca75f7efa417df01e.png" alt="z_0" style="vertical-align: -3px"/>,
respectively, then the body system (<img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/>, <img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/>) are
set up with the <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/> axis coinciding with the rotational axis while <img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/> and</p>
<p><img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/> parallel to <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>, respectively, and the body
system origin is set at (<img class="math" src="_images/math/39b0b9fc4a7fe25bde494dad106ba2446cd0dc62.png" alt="x_0" style="vertical-align: -3px"/>, <img class="math" src="_images/math/ec0490d9a18af1b6dcc31df2562df59dea3b3bd6.png" alt="0" style="vertical-align: 0px"/>, <img class="math" src="_images/math/b84ada1ad1202b3260d350cca75f7efa417df01e.png" alt="z_0" style="vertical-align: -3px"/>). Angular
velocity of the rotating body has one non-zero component only and can be
calculated by solving the corresponding component of Eq. <a class="reference internal" href="#equation-motiongoverningtotaltorqueaboutg">(166)</a>, or,</p>
<div class="math" id="equation-angularvelocityofrotatingbody">
<p><span class="eqno">(171)<a class="headerlink" href="#equation-angularvelocityofrotatingbody" title="Permalink to this equation">¶</a></span><img src="_images/math/97191fe36b8dec436520d81d91fba39fcadc2b4e.png" alt="T = J\dot \omega"/></p>
</div><p>where <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/>, <img class="math" src="_images/math/b64db90c456c64f90e29b5ddda0aeb36783b580b.png" alt="J" style="vertical-align: 0px"/> and <img class="math" src="_images/math/2b25beebb5fab89d9a71077bda34bd951f6baf06.png" alt="\dot \omega" style="vertical-align: 0px"/> are total torque, moment of
inertia and angular acceleration about the fixed axis in body system. Equation
<a class="reference internal" href="#equation-3drotationaboutfixedpointanditsvelocity">(170)</a> is used to calculate the velocity
of any point <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> on the rigid body with <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> representing any point
at the rotation axis.</p>
</div>
<div class="section" id="source-terms-in-conservation-equations">
<span id="sourcetermsconservationequationsth"></span><span id="index-128"></span><h4>Source Terms in Conservation Equations<a class="headerlink" href="#source-terms-in-conservation-equations" title="Permalink to this headline">¶</a></h4>
<p>The general form of the continuity equation based on the FAVOR<sup>TM</sup> method is</p>
<div class="math" id="equation-continuityequationgeneralform">
<p><span class="eqno">(172)<a class="headerlink" href="#equation-continuityequationgeneralform" title="Permalink to this equation">¶</a></span><img src="_images/math/102a48e2ab67a0318646cd6aba0d1ea322ca0916.png" alt="\frac{\partial }{{\partial \,t}}(\rho \,{V_f}) + \nabla  \cdot (\rho \,{\mathbf{u}}\,\mathbf{A}) = {S_m}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/b3a50c6eb1aff78fe3d1c11349aab51165c5f5c1.png" alt="S_m" style="vertical-align: -3px"/> is a physical mass source term of fluid,</li>
<li><img class="math" src="_images/math/8011acfe3bd0a9eac603ad36403ae8aa4005dae0.png" alt="V_f" style="vertical-align: -6px"/> and <img class="math" src="_images/math/07792a30c203ce0183a4689b8f0363ea71dee912.png" alt="\mathbf{A}" style="vertical-align: 0px"/> are volume and area fractions, respectively.</li>
</ul>
<p>In contrast to stationary obstacle problems, <img class="math" src="_images/math/8011acfe3bd0a9eac603ad36403ae8aa4005dae0.png" alt="V_f" style="vertical-align: -6px"/> and <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> vary with
time in moving object problems, thus their effects on fluid flow must be
considered. Equation <a class="reference internal" href="#equation-continuityequationgeneralform">(172)</a> can be rewritten</p>
<div class="math" id="equation-continuityequationmovingobjects">
<p><span class="eqno">(173)<a class="headerlink" href="#equation-continuityequationmovingobjects" title="Permalink to this equation">¶</a></span><img src="_images/math/fc1de073d40c665f44c644df63aeb3ea99c6ad5d.png" alt="\frac{{{V_f}}}{\rho }\frac{{\partial \rho }}{{\partial t}} + \frac{1}{\rho }\nabla  \cdot \left( {\rho \,{\mathbf{u}}\,\mathbf{A}} \right) =  - \frac{{\partial {V_f}}}{{\partial t}} + \frac{{{S_m}}}{\rho }."/></p>
</div><p>For incompressible flow, it is reduced to</p>
<div class="math" id="equation-continuityequationincompressibleflow">
<p><span class="eqno">(174)<a class="headerlink" href="#equation-continuityequationincompressibleflow" title="Permalink to this equation">¶</a></span><img src="_images/math/837360a5305d36f7976b087b9e83b8d72cf59a08.png" alt="\nabla  \cdot \left( {{\mathbf{u}}\,\mathbf{A}} \right) =  - \frac{{\partial {V_f}}}{{\partial t}} + \frac{{{S_m}}}{\rho }."/></p>
</div><p>Comparing with the continuity equation for stationary obstacle problems, it is
seen that <img class="math" src="_images/math/98f829d9ba084c73b2b92b26a218d3e9ec8f1a71.png" alt="- \frac{{\partial {V_f}}}{{\partial \,t}}" style="vertical-align: -6px"/> is equivalent to an
additional volume source term. When using the control volume method, this source
term exists only in mesh cells around the moving object boundary. The term
<img class="math" src="_images/math/98f829d9ba084c73b2b92b26a218d3e9ec8f1a71.png" alt="- \frac{{\partial {V_f}}}{{\partial \,t}}" style="vertical-align: -6px"/> is calculated using</p>
<div class="math" id="equation-additionalvolumesourcetermmovingobjectboundary">
<p><span class="eqno">(175)<a class="headerlink" href="#equation-additionalvolumesourcetermmovingobjectboundary" title="Permalink to this equation">¶</a></span><img src="_images/math/9722acd280c81f8572eb9f2eeac0c505fefee742.png" alt="- \frac{{\partial {V_f}}}{{\partial \,t}} = \frac{{{S_{\rm{obj}}}\,}}{{{V_{\rm{cell}}}}}\,{{\mathbf{V}}_{\rm{obj}}} \cdot {\mathbf{n}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/0725e8b7999c42bd54549dc058dafc4413cf2f0c.png" alt="V_{\rm{cell}}" style="vertical-align: -3px"/> is volume of a mesh cell,</li>
<li><img class="math" src="_images/math/3d586d51adb1781907fba619adde860cfb971266.png" alt="S_{\rm{obj}}" style="vertical-align: -6px"/> , <img class="math" src="_images/math/c5fc1ba077194ae7d8122494476991175133fc80.png" alt="{\mathbf n}" style="vertical-align: 0px"/> and <img class="math" src="_images/math/7e72246e85ee77ded7cb14a18d33ff4cd7971005.png" alt="\mathbf{V}_{\rm{obj}}" style="vertical-align: -6px"/> are respectively surface area, unit normal vector and velocity of the moving object in the mesh cell.</li>
</ul>
<p>Equation <a class="reference internal" href="#equation-additionalvolumesourcetermmovingobjectboundary">(175)</a> has a good mass
conservation property because the net generation of fluid mass over all mesh
cells around the moving object boundary is close to zero. It is also exact in
time and there are no major difficulties to calculate it.</p>
<p>Similar terms appear in the transport equations for other quantities that are solved in
a conservative form, such as energy and scalar transport.</p>
<p>It is noted a non-conservative form of the momentum equation is used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>.
This is obtained by subtracting the continuity equation from the conservative
form of the momentum equation. The terms due to time-change of <img class="math" src="_images/math/2618d92ec29b4b2156fc2251e70e6459ddf41c2d.png" alt="V_F" style="vertical-align: -3px"/> are
found canceled thus momentum equations in the non-conservative form keep the
same form as those for stationary object problems.</p>
<p>The non-zero tangential velocity of the moving objects is considered in the calculation
of the shear stress terms in fluid in Eq. <a class="reference internal" href="#equation-momentumconservation">(9)</a>.</p>
</div>
<div class="section" id="dynamic-equations-for-rigid-body-collision">
<span id="dynamicequationsforrigidbodycollisionth"></span><span id="index-129"></span><h4>Dynamic Equations for Rigid-Body Collision<a class="headerlink" href="#dynamic-equations-for-rigid-body-collision" title="Permalink to this headline">¶</a></h4>
<div class="section" id="coulomb-s-law-of-friction">
<span id="coulombslawth"></span><h5>Coulomb’s Law of Friction<a class="headerlink" href="#coulomb-s-law-of-friction" title="Permalink to this headline">¶</a></h5>
<p>Assume body B collides on body B’ and their contact point (or collision point)
is respectively denoted as C on body B and C’ on body B’. A collision reference
system (collision system) is set up with its origin located at the contact point
with <img class="math" src="_images/math/ba3ff37f2d5c83f5608ad7c8673e1bc20acff8ec.png" alt="n_1" style="vertical-align: -3px"/>, <img class="math" src="_images/math/163ce779b03ce0933049782f99a039aa256674f0.png" alt="n_2" style="vertical-align: -3px"/>, <img class="math" src="_images/math/e404ab2a43e44530a34486fd1553861d6bc8ab1e.png" alt="n_3" style="vertical-align: -3px"/> denoting the unit vectors of its
three coordinate axes. <img class="math" src="_images/math/e404ab2a43e44530a34486fd1553861d6bc8ab1e.png" alt="n_3" style="vertical-align: -3px"/> is along the normal direction of the common
tangential plane of the two bodies at the contact point and directs from body B’
to body B. Let <img class="math" src="_images/math/4d51814c09ca770e1567976fb6ff52619c3c98a3.png" alt="\vec v" style="vertical-align: 0px"/> represent the relative velocity of point C to C’, and
<img class="math" src="_images/math/74fcef74f604a4afcba55f9133dfabfc9957ed59.png" alt="\vec p" style="vertical-align: -4px"/> the impulse of contact force on body B. In vector form, they are</p>
<div class="math" id="equation-coulombslawoffriction">
<p><span class="eqno">(176)<a class="headerlink" href="#equation-coulombslawoffriction" title="Permalink to this equation">¶</a></span><img src="_images/math/18f1c8af48c703d02af1fbf5b77ecbc72c4ca842.png" alt="\vec v = ({v_1},{v_2},{v_3}) {\text ,} \; \vec p = ({p_1},{p_2},{p_3})"/></p>
</div><p>where the lower index represents the corresponding component in <img class="math" src="_images/math/ba3ff37f2d5c83f5608ad7c8673e1bc20acff8ec.png" alt="n_1" style="vertical-align: -3px"/>,
<img class="math" src="_images/math/163ce779b03ce0933049782f99a039aa256674f0.png" alt="n_2" style="vertical-align: -3px"/>, or <img class="math" src="_images/math/e404ab2a43e44530a34486fd1553861d6bc8ab1e.png" alt="n_3" style="vertical-align: -3px"/>. We now simply denote <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> for normal direction
<img class="math" src="_images/math/e404ab2a43e44530a34486fd1553861d6bc8ab1e.png" alt="n_3" style="vertical-align: -3px"/> and <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> for normal impulse <img class="math" src="_images/math/8bd1f1870cdfe03f9e5c178d2daa3acc33625c92.png" alt="p_3" style="vertical-align: -4px"/>, Coulomb’s law of
friction is then written</p>
<div class="math" id="equation-coulombslawoffrictionnormaldirectionnormalimpulse1">
<p><span class="eqno">(177)<a class="headerlink" href="#equation-coulombslawoffrictionnormaldirectionnormalimpulse1" title="Permalink to this equation">¶</a></span><img src="_images/math/b1eaf85b87f6eb878814e12d416388a9879b7643.png" alt="{\sqrt {{{(d{p_1})}^2} + {{(d{p_2})}^2}}  &lt; \mu \,dp} {\text ,} \quad {\mathbf {if}} \quad {{v_1}^2 + {v_2}^2 = 0}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-coulombslawoffrictionnormaldirectionnormalimpulse2">
<p><span class="eqno">(178)<a class="headerlink" href="#equation-coulombslawoffrictionnormaldirectionnormalimpulse2" title="Permalink to this equation">¶</a></span><img src="_images/math/b0467f5549ad3d61844f6bb43e3880f66254c58f.png" alt="{d{p_i} =  - \frac{{\mu \,{v_i}}}{{\sqrt {{v_1}^2 + {v_2}^2} }}dp} {\text ,} \quad {\mathbf {i=1,2,}} \quad {\mathbf {if}} \quad {{v_1}^2 + {v_2}^2 = 0}"/></p>
</div><p>Equation <a class="reference internal" href="#equation-coulombslawoffrictionnormaldirectionnormalimpulse2">(178)</a> can also be
written</p>
<div class="math" id="equation-coulombslawoffrictionnormaldirectionnormalimpulse3">
<p><span class="eqno">(179)<a class="headerlink" href="#equation-coulombslawoffrictionnormaldirectionnormalimpulse3" title="Permalink to this equation">¶</a></span><img src="_images/math/4696f192277d5c12d7a53019c8fecad1e73277b7.png" alt="d{p_1} =  - \mu \cos \varphi \,\,dp {\text ,} \; d{p_2} =  - \mu \sin \varphi \,dp {\text ,} \quad {\mathbf {if}} \quad {v_1}^2 + {v_2}^2 &gt; 0"/></p>
</div><p>where <img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/> is the angle of sliding direction measured from <img class="math" src="_images/math/ba3ff37f2d5c83f5608ad7c8673e1bc20acff8ec.png" alt="n_1" style="vertical-align: -3px"/> about
<img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>.</p>
</div>
<div class="section" id="stronge-s-energetic-coefficient-of-restitution">
<span id="strongescoefficientth"></span><span id="index-130"></span><h5>Stronge’s Energetic Coefficient of Restitution<a class="headerlink" href="#stronge-s-energetic-coefficient-of-restitution" title="Permalink to this headline">¶</a></h5>
<p>As generally understood, a collision process is divided into compression and
restitution phases. Stronge’s hypothesis is to relate the work done by normal
impulse during restitution to that during compression. Stronge’s energetic
coefficient of restitution <img class="math" src="_images/math/a7228df3b7d8f5ae91504d95e1bf39e4323d0a90.png" alt="e" style="vertical-align: 0px"/> is defined as</p>
<div class="math" id="equation-strongesenergeticcoefficientofrestitutione">
<p><span class="eqno">(180)<a class="headerlink" href="#equation-strongesenergeticcoefficientofrestitutione" title="Permalink to this equation">¶</a></span><img src="_images/math/33dd0c78b309b91606f10fa987679ff6daef697b.png" alt="e =  \sqrt{- \frac{{{W_3}({p_f}) - {W_3}({p_c})}}{{{W_3}({p_c})}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/690bb54c3bf62b8d7793d6e9ad0d9611633c8ea6.png" alt="W_3" style="vertical-align: -3px"/> is work done by normal impulse,</li>
<li><img class="math" src="_images/math/08988c10887791be6f2ca49309e4a1116e8c3283.png" alt="p_c" style="vertical-align: -4px"/> is the normal impulse when collision reaches maximum compression, and</li>
<li><img class="math" src="_images/math/f4f1d3e7a7da59d465af748240b8bb109b5a1450.png" alt="p_f" style="vertical-align: -6px"/> is the total impulse of collision.</li>
</ul>
<p>In Eq. <a class="reference internal" href="#equation-strongesenergeticcoefficientofrestitutione">(180)</a>, the numerator under the square root is the
total work by normal impulse during restitution and always non-negative, and the
denominator is the work done during compression and is always negative. The value of
<img class="math" src="_images/math/a7228df3b7d8f5ae91504d95e1bf39e4323d0a90.png" alt="e" style="vertical-align: 0px"/> is between 0 and 1. <img class="math" src="_images/math/690bb54c3bf62b8d7793d6e9ad0d9611633c8ea6.png" alt="W_3" style="vertical-align: -3px"/> is calculated by</p>
<div class="math" id="equation-strongesenergeticcoefficientofrestitutionw3">
<p><span class="eqno">(181)<a class="headerlink" href="#equation-strongesenergeticcoefficientofrestitutionw3" title="Permalink to this equation">¶</a></span><img src="_images/math/7c727dd6a261df8c90f425d6b26450bd6d65cbd8.png" alt="{W_3}(p) = \int_{\,0}^{\,p} {{v_3}dp}"/></p>
</div></div>
<div class="section" id="dynamic-equations-in-general-form">
<span id="dynamicequationgeneralth"></span><span id="index-131"></span><h5>Dynamic Equations in General Form<a class="headerlink" href="#dynamic-equations-in-general-form" title="Permalink to this headline">¶</a></h5>
<p>Assume the two bodies B and B’ have mass M and M’, and their mass centers are
located at G and G’, respectively. In the collision system, the relative
velocity at the contact point satisfies the equations of motion,</p>
<div class="math" id="equation-collisionsystemequationsofmotion">
<p><span class="eqno">(182)<a class="headerlink" href="#equation-collisionsystemequationsofmotion" title="Permalink to this equation">¶</a></span><img src="_images/math/dca3d63b4e69d6e068c7469b9c6517ca1101414f.png" alt="d{v_i} = m_{ij}^{ - 1}d{p_j} \quad {\mathbf {(i=1,2,3)}}"/></p>
</div><p>where Einstein’s convention of summation is used, and</p>
<div class="math" id="equation-einsteinsconventionofsummation">
<p><span class="eqno">(183)<a class="headerlink" href="#equation-einsteinsconventionofsummation" title="Permalink to this equation">¶</a></span><img src="_images/math/761c314ab910c330e78dc3192fd5ae8cbf3b9177.png" alt="m_{ij}^{ - 1} = {m_{B,}}_{ij}^{ - 1} + {m_{B\,',}}_{ij}^{ - 1}"/></p>
</div><p>in which <img class="math" src="_images/math/00d24969ea3b0f8ad7ebb6b6b828fd1130780043.png" alt="{m_{B,}}_{ij}^{ - 1}" style="vertical-align: -9px"/> and <img class="math" src="_images/math/f803878e746e2eb675a812db883ca5da8b74b828.png" alt="{m_{B\,',}}_{ij}^{ - 1}" style="vertical-align: -9px"/> are
terms for bodies B and B’, respectively. If both bodies have 6 DOF, the
expressions of <img class="math" src="_images/math/00d24969ea3b0f8ad7ebb6b6b828fd1130780043.png" alt="{m_{B,}}_{ij}^{ - 1}" style="vertical-align: -9px"/> and <img class="math" src="_images/math/f803878e746e2eb675a812db883ca5da8b74b828.png" alt="{m_{B\,',}}_{ij}^{ - 1}" style="vertical-align: -9px"/>
are</p>
<div class="math" id="equation-einsteinsconventionofsummationifbothbodies6dof1">
<p><span class="eqno">(184)<a class="headerlink" href="#equation-einsteinsconventionofsummationifbothbodies6dof1" title="Permalink to this equation">¶</a></span><img src="_images/math/5ce249244cf2b700c79dde63a1318d75ff293cc5.png" alt="{m_{{B,}_{ij}}}^{ - 1} = \frac{1}{M}{\delta _{ij}} + {\varepsilon _{ikm}}{\varepsilon _{jl\,n}}J_{kl}^{ - 1}{r_m}{r_n} \quad {\mathbf {(6~DOF)}}"/></p>
</div><div class="math" id="equation-einsteinsconventionofsummationifbothbodies6dof2">
<p><span class="eqno">(185)<a class="headerlink" href="#equation-einsteinsconventionofsummationifbothbodies6dof2" title="Permalink to this equation">¶</a></span><img src="_images/math/2d7fe41a8dcda7d5ca100d6cd8738c688b30c31a.png" alt="{m_{B\,',}}_{ij}^{ - 1} = \frac{1}{{M'}}{\delta _{ij}} + {\varepsilon _{ikm}}{\varepsilon _{jl\,n}}{J'}_{kl}^{ - 1}{r'_m}{r'_n} \quad {\mathbf {(6~DOF)}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/600d8fcbcb6ce4449b6454c8abc8fc79c36256c7.png" alt="\delta _{ij}" style="vertical-align: -6px"/> is Kronecker delta,</li>
<li><img class="math" src="_images/math/e8bce7a04c8aec8a52adad6180d38447911ac018.png" alt="\varepsilon _{ijk}" style="vertical-align: -6px"/> is permutation tensor,</li>
<li><img class="math" src="_images/math/81de09b034d1d5ab7ed8f82bc257665c12037dcb.png" alt="J_{kl}^{ - 1}" style="vertical-align: -5px"/> and <img class="math" src="_images/math/19c3ad7aed6b25a4f1efb805eaeaeba53c8422bd.png" alt="{J'}_{kl}^{ - 1}" style="vertical-align: -5px"/> are elements of inverses of inertia tensor about mass center for the two bodies in the collision system, respectively,</li>
<li><img class="math" src="_images/math/7dde9acb103e0d4e443b333d9d6116475e317fbe.png" alt="r_i" style="vertical-align: -3px"/> and <img class="math" src="_images/math/748d19b0b28aace28720fef09437f136581c0864.png" alt="{r'_i}" style="vertical-align: -5px"/> are components of distance vectors from the mass center to the collision point for the two bodies, respectively,</li>
</ul>
<p>Expressions for <img class="math" src="_images/math/efd5bfc88387a69a57138cf9547486f4f5be82eb.png" alt="m_{ij}^{ - 1}" style="vertical-align: -8px"/> for fixed-axis and fixed-point motions
can be found in Flow Science Technical Note #76 on the users site at
<a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>.</p>
</div>
<div class="section" id="dynamic-equations-in-terms-of-normal-impulse">
<span id="dynamicequationnormalimpulseth"></span><span id="index-132"></span><h5>Dynamic Equations in Terms of Normal Impulse<a class="headerlink" href="#dynamic-equations-in-terms-of-normal-impulse" title="Permalink to this headline">¶</a></h5>
<p>If two bodies in collision slide initially at their contact point, friction may
bring slip to a halt when collision is eccentric and initial speed of sliding is
small enough. After that, they either stick at the contact point (called slip-stick)
or renew sliding immediately (called slip reversal) in a new direction
until they are separated, depending on inertia property of the two objects and
the friction coefficient. The sliding before halt occurs is called the first
phase of sliding, and that in slip reversal is called the second phase of
sliding. If friction does not cause halt of slip or the collision is
frictionless, only the first phase of sliding can exist throughout collision.</p>
<p>When two objects slide during collision, the tangential velocity components are</p>
<div class="math" id="equation-tangentialvelocitycomponents">
<p><span class="eqno">(186)<a class="headerlink" href="#equation-tangentialvelocitycomponents" title="Permalink to this equation">¶</a></span><img src="_images/math/a0ae082001a7cd266ae796fe23abcc7079ee8d90.png" alt="{v_1} = s\cos \varphi \quad {\text ,} \quad {v_2} = s\sin \varphi"/></p>
</div><p>where <img class="math" src="_images/math/3e821331961a936174f714f67bb5669fca7b828b.png" alt="s" style="vertical-align: 0px"/> is sliding speed,</p>
<div class="math" id="equation-slidingspeed">
<p><span class="eqno">(187)<a class="headerlink" href="#equation-slidingspeed" title="Permalink to this equation">¶</a></span><img src="_images/math/91f927be973c3a8e8b76f343c131fa4664fda177.png" alt="s = \sqrt {{v_1}^2 + {v_2}^2}"/></p>
</div><p>and <img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/> is sliding direction which varies during collision. Introducing
Coulomb’s Law of friction in Eq.
<a class="reference internal" href="#equation-coulombslawoffrictionnormaldirectionnormalimpulse3">(179)</a> into Eq.
<a class="reference internal" href="#equation-collisionsystemequationsofmotion">(182)</a>, equations of motion in terms of the
normal impulse <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> for the first phase of sliding are</p>
<div class="math" id="equation-equationsofmotiontermsofnormalimpulse1">
<p><span class="eqno">(188)<a class="headerlink" href="#equation-equationsofmotiontermsofnormalimpulse1" title="Permalink to this equation">¶</a></span><img src="_images/math/3e16d7324f65882d787de7e800867713717e568d.png" alt="\frac{{d{v_1}}}{{dp}} = {\text{ - }}\mu \,m_{11}^{ - 1}\cos \varphi  - \mu \,m_{12}^{ - 1}\sin \varphi  + m_{13}^{ - 1}"/></p>
</div><div class="math" id="equation-equationsofmotiontermsofnormalimpulse2">
<p><span class="eqno">(189)<a class="headerlink" href="#equation-equationsofmotiontermsofnormalimpulse2" title="Permalink to this equation">¶</a></span><img src="_images/math/eda4e8139960d45ab9bcda0dee497a91f1c835ff.png" alt="\frac{{d{v_2}}}{{dp}} = {\text{ - }}\mu \,m_{21}^{ - 1}\cos \varphi  - \mu \,m_{22}^{ - 1}\sin \varphi  + m_{23}^{ - 1}"/></p>
</div><div class="math" id="equation-equationsofmotiontermsofnormalimpulse3">
<p><span class="eqno">(190)<a class="headerlink" href="#equation-equationsofmotiontermsofnormalimpulse3" title="Permalink to this equation">¶</a></span><img src="_images/math/eda4e8139960d45ab9bcda0dee497a91f1c835ff.png" alt="\frac{{d{v_2}}}{{dp}} = {\text{ - }}\mu \,m_{21}^{ - 1}\cos \varphi  - \mu \,m_{22}^{ - 1}\sin \varphi  + m_{23}^{ - 1}"/></p>
</div><p>If the objects are perfectly smooth (<img class="math" src="_images/math/1daf0dedbc12f6456074bb820d798749a26376e0.png" alt="\mu = 0" style="vertical-align: -4px"/>), then Eqs.
<a class="reference internal" href="#equation-equationsofmotiontermsofnormalimpulse1">(188)</a> to
<a class="reference internal" href="#equation-equationsofmotiontermsofnormalimpulse3">(190)</a> are independent, otherwise they
are coupled. Equations governing <img class="math" src="_images/math/3e821331961a936174f714f67bb5669fca7b828b.png" alt="s" style="vertical-align: 0px"/> and <img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/> are</p>
<div class="math" id="equation-equationgovereningsandvarphi1">
<p><span class="eqno">(191)<a class="headerlink" href="#equation-equationgovereningsandvarphi1" title="Permalink to this equation">¶</a></span><img src="_images/math/f173e3942e2d12c07aea5947d9316e5276be63fe.png" alt="\frac{{ds}}{{dp}} = m_{13}^{ - 1}\cos \varphi  + m_{23}^{ - 1}\sin \varphi  - \mu \,m_{11}^{ - 1}{\cos ^2}\varphi  - 2\mu \,m_{12}^{ - 1}\sin \varphi \cos \varphi  - \mu \,m_{22}^{ - 1}{\sin ^2}\varphi  \equiv g(\mu ,\varphi )"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-equationgovereningsandvarphi2">
<p><span class="eqno">(192)<a class="headerlink" href="#equation-equationgovereningsandvarphi2" title="Permalink to this equation">¶</a></span><img src="_images/math/40b87e30f6991c157418d685ba50f163eb5a4fbf.png" alt="s\frac{{d\varphi }}{{dp}} =  - m_{13}^{ - 1}\sin \varphi  + m_{23}^{ - 1}\cos \varphi  + \mu \,(m_{11}^{ - 1} - m_{22}^{ - 1})\sin \varphi \cos \varphi  + \mu \,m_{12}^{ - 1}({\sin ^2}\varphi  - {\cos ^2}\varphi ) \equiv h(\mu ,\varphi )"/></p>
</div><p>For slip-stick, <img class="math" src="_images/math/8fe4f8a70c17b1645d51130efec762059b793521.png" alt="{v_1} = {v_2} = 0" style="vertical-align: -3px"/> and <img class="math" src="_images/math/690c607a5a9eb9909fa1235464755b447e496deb.png" alt="\frac{d{v_1}}{dp} = \frac{d{v_2}}{dp} = 0" style="vertical-align: -9px"/>.
The zero tangential velocity is accompanied by a tangential
frictional force along a constant direction <img class="math" src="_images/math/d5f7236216fd97eed8bbdf1fc428a66f7be7acf6.png" alt="\bar \varphi  - \pi" style="vertical-align: -4px"/>. It is
shown <a class="reference internal" href="zbibliography.html#stronge-2000" id="id17">[Str00]</a>,</p>
<div class="math" id="equation-tangentialfrictionalforcealongconstantdirection">
<p><span class="eqno">(193)<a class="headerlink" href="#equation-tangentialfrictionalforcealongconstantdirection" title="Permalink to this equation">¶</a></span><img src="_images/math/71c7408ab7ece43d15957179919744f6f61c667a.png" alt="\bar \varphi  = {\tan ^{ - 1}}\left( {\frac{{m_{11}^{ - 1}m_{23}^{ - 1} - m_{12}^{ - 1}m_{13}^{ - 1}}}{{m_{22}^{ - 1}m_{13}^{ - 1} - m_{23}^{ - 1}m_{12}^{ - 1}}}} \right)"/></p>
</div><p>Components of differential impulse of the tangential force in <img class="math" src="_images/math/ba3ff37f2d5c83f5608ad7c8673e1bc20acff8ec.png" alt="n_1" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/163ce779b03ce0933049782f99a039aa256674f0.png" alt="n_2" style="vertical-align: -3px"/> satisfy</p>
<div class="math" id="equation-componentsofdifferentialimpulsetangentialforce">
<p><span class="eqno">(194)<a class="headerlink" href="#equation-componentsofdifferentialimpulsetangentialforce" title="Permalink to this equation">¶</a></span><img src="_images/math/de8369e5d5dc8a31484fe9199fcb2b87633b515d.png" alt="\begin{gathered}
d{p_1} =  - \bar \mu \cos \bar \varphi \,\,dp \quad {\text ,} \quad d{p_2} =  - \bar \mu \sin \bar \varphi \,\,dp \\
\sqrt {{{(d{p_1})}^2} + {{(d{p_2})}^2}}  = \bar \mu \,dp \\
\end{gathered}"/></p>
</div><p>where <img class="math" src="_images/math/6fa02d2f5a449472ccf00a1ca619a5315bd422cf.png" alt="\bar \mu" style="vertical-align: -4px"/> is coefficient for stick,</p>
<div class="math" id="equation-barmucoefficientforstick">
<p><span class="eqno">(195)<a class="headerlink" href="#equation-barmucoefficientforstick" title="Permalink to this equation">¶</a></span><img src="_images/math/7d6be8abdac099ea25574814083dbf2d626466b3.png" alt="\bar \mu  = \frac{{\sqrt {{{(m_{11}^{ - 1}m_{23}^{ - 1} - m_{12}^{ - 1}m_{13}^{ - 1})}^2} + {{(m_{22}^{ - 1}m_{13}^{ - 1} - m_{23}^{ - 1}m_{12}^{ - 1})}^2}} }}{{m_{11}^{ - 1}m_{22}^{ - 1} - m_{12}^{ - 1}m_{12}^{ - 1}}}"/></p>
</div><p>and <img class="math" src="_images/math/a4398b06bac9e33d9de6035fc0e91bf6526c9601.png" alt="\bar \mu  &lt; \mu" style="vertical-align: -4px"/>. Equations of motion are thus</p>
<div class="math" id="equation-equationsofmotion">
<p><span class="eqno">(196)<a class="headerlink" href="#equation-equationsofmotion" title="Permalink to this equation">¶</a></span><img src="_images/math/5b101b34b6663a6db1cf4881d8a05635f3afa18c.png" alt="\begin{gathered}
{v_1} = 0 \\
{v_2} = 0 \\
\frac{{d{v_3}}}{{dp}} = {\text{ - }}\bar \mu \,m_{31}^{ - 1}\cos \bar \varphi  - \bar \mu \,m_{32}^{ - 1}\sin \bar \varphi  + m_{33}^{ - 1}\\
\end{gathered}"/></p>
</div><p>During the second phase of sliding, or slip reversal, equations of motion,
Eqs. <a class="reference internal" href="#equation-equationsofmotiontermsofnormalimpulse1">(188)</a> to
<a class="reference internal" href="#equation-equationsofmotiontermsofnormalimpulse3">(190)</a>, are still valid. However,
different from the first phase of sliding in which sliding direction varies
during collision, sliding in the second phase is along a constant direction
<img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/>. It is obtained by solving <img class="math" src="_images/math/b6825c98b1503cfdaa339fc0391f8f9045bea428.png" alt="h\,(\mu ,\varphi ) = 0" style="vertical-align: -5px"/> in Eq.
<a class="reference internal" href="#equation-equationgovereningsandvarphi2">(192)</a> for <img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/>. There can be multiple
solutions of <img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/>. The sliding direction is the unique solution satisfying
<img class="math" src="_images/math/4a0c86e44f34664f3aef4f91b27601c3c11a59db.png" alt="{\frac{ds}{dp}} = g(\mu ,\varphi ) &gt; 0" style="vertical-align: -9px"/> defined in Eq.
<a class="reference internal" href="#equation-equationgovereningsandvarphi1">(191)</a>.</p>
<p>If friction causes slip halt, then comparison of the friction coefficient <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>
and coefficient for stick <img class="math" src="_images/math/6fa02d2f5a449472ccf00a1ca619a5315bd422cf.png" alt="\bar \mu" style="vertical-align: -4px"/> determines if slip stick or slip
reversal occurs after that. If <img class="math" src="_images/math/a4398b06bac9e33d9de6035fc0e91bf6526c9601.png" alt="\bar \mu  &lt; \mu" style="vertical-align: -4px"/>, slip-stick is achieved.
Otherwise, slip reversal happens immediately.</p>
<p>For further details of the dynamic equations and the numerical method for
collision simulation, please refer to Flow Science Technical Notes #75 and #76
on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>.</p>
<span class="target" id="index-133"></span></div>
</div>
<div class="section" id="mooring-line-model">
<span id="mooringlinesth"></span><span id="index-134"></span><h4>Mooring Line Model<a class="headerlink" href="#mooring-line-model" title="Permalink to this headline">¶</a></h4>
<p>The mooring line model allows moving objects with prescribed or coupled motion to be
connected to fixed anchors or other moving or non-moving objects via compliant mooring lines.
Multiple mooring lines can exist in one simulation, and their connections to moving objects
are arbitrary. The mooring lines can are be taut or slack and may be partially rest on sea/river
floor. The mooring line end point(s) can be tethered on moving objects with coupled or
prescribed motion, fixed in space, or completely free. The model considers gravity, buoyancy, fluid
drag and tension force on the mooring lines. It numerically calculates the full 3D dynamics of the
lines and their dynamic interactions with the tethered moving objects.</p>
<p>The model assumes that the mooring lines are cylinders with uniform diameter and material
distribution. Each line, however, can have its own length, diameter, mass density and physical
properties. The model uses a finite segment approach to calculate mooring motion. As shown in
figure below, a mooring line is divided uniformly into a certain number of discrete segments which
are represented by mass particles located at the segment centers. The dynamic equation of
motion for each segment is</p>
<div class="math" id="equation-mooringlinemotionequation">
<p><span class="eqno">(197)<a class="headerlink" href="#equation-mooringlinemotionequation" title="Permalink to this equation">¶</a></span><img src="_images/math/22655e0f6c3afb5b1fc5d87969c0bb84665def65.png" alt="{m_p}\frac{d{\mathbf{v}}_p}{dt} = \mathbf{G} + \mathbf{B} + \mathbf{T}_1 + \mathbf{T}_2 + \mathbf{D}_n + \mathbf{D}_t"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/6c1b6d397d797874a7002ac1819f961bf4c8c948.png" alt="{m_p}" style="vertical-align: -6px"/> is mass of the segment,</li>
<li><img class="math" src="_images/math/94c6cd85d7170d5ef1bb5e737fecf9907bf99fc7.png" alt="{\mathbf{v}_p}" style="vertical-align: -6px"/> is is the mass center velocity of the segment,</li>
<li><img class="math" src="_images/math/d73fae32ef38c99d9af10681cd8a7522a94fc75b.png" alt="{\mathbf{G}}" style="vertical-align: 0px"/> is the gravitational force,</li>
<li><img class="math" src="_images/math/46e42c0ca4c179912d23e3d24e73e904846e19de.png" alt="{\mathbf{B}}" style="vertical-align: 0px"/> is the buoyant force,</li>
<li><img class="math" src="_images/math/7c7f5e616423ee7f7371ff13519bb1498322f6a6.png" alt="{\mathbf{T}_1}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/d91ec53d0ce53ae690aca4a36604742173795266.png" alt="{\mathbf{T}_2}" style="vertical-align: -3px"/> are the tension forces at the two ends of the segment,</li>
<li><img class="math" src="_images/math/853adbe6bef36f1e285de550e3c4dfb92c793fcd.png" alt="{\mathbf{D}_n}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/5abbecc1949377a16ca14f2f035f2a44c07769fd.png" alt="{\mathbf{D}_t}" style="vertical-align: -3px"/>  are the fluid drag forces in normal and tangential directions of the segment, respectively. They are evaluated using the quadratic drag law:</li>
</ul>
<div class="math" id="equation-mooringlinenormaldragequationn">
<p><span class="eqno">(198)<a class="headerlink" href="#equation-mooringlinenormaldragequationn" title="Permalink to this equation">¶</a></span><img src="_images/math/fb2f97e47441aab91264b7140678dd3e905a5441.png" alt="\mathbf{D}_n = - C_{D,n} {\rho}_f A_{n} \mathbf{v}_{r,n} \left| \mathbf{v}_{r}  \right|"/></p>
</div><div class="math" id="equation-mooringlinenormaldragequationt">
<p><span class="eqno">(199)<a class="headerlink" href="#equation-mooringlinenormaldragequationt" title="Permalink to this equation">¶</a></span><img src="_images/math/07a453150aa31e9ef916baaa1bb1630a780ba95e.png" alt="\mathbf{D}_t = - C_{D,t} {\rho}_f A_{t} \mathbf{v}_{r,t} \left| \mathbf{v}_{r}  \right|"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/42fc7056ce2df013d1716a79e3aa98cef24509eb.png" alt="{C_{D,n}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/51d51cd31d363491580dad7199523d86cc235e6a.png" alt="{C_{D,t}}" style="vertical-align: -6px"/> are the drag coefficients in the normal and the tangential directions of the segment, respectively,</li>
<li><img class="math" src="_images/math/57083bdd33c70b311906cf446b22bf7e8121673a.png" alt="{\mathbf{v}_r}" style="vertical-align: -3px"/> is the velocity of the segment mass center relative to fluid flow,</li>
<li><img class="math" src="_images/math/82137ed7535880f41e7dc11e5b07ee3dbb3f0308.png" alt="{\mathbf{v}_{r,n}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/cedf7f2730f6ab64a5ea4091495a70aebf0d911b.png" alt="{\mathbf{v}_{r,t}}" style="vertical-align: -6px"/> are the components of <img class="math" src="_images/math/57083bdd33c70b311906cf446b22bf7e8121673a.png" alt="{\mathbf{v}_r}" style="vertical-align: -3px"/> in the normal and the tangential directions of the segment, respectively,</li>
<li><img class="math" src="_images/math/67d5b4c75a326d90d8b4be767394dff5692e3ed0.png" alt="{A_n}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/0c8170eb99161f495b72250e096aae8c04e2b603.png" alt="{A_t}" style="vertical-align: -3px"/>  are the cross-sectional areas in the normal and tangential directions of the segment, respectively,</li>
<li><img class="math" src="_images/math/beb73707de158ce2b9a7e2f2efc515847c051982.png" alt="{\rho_f}" style="vertical-align: -6px"/> is fluid density.</li>
</ul>
<div class="figure" id="id114">
<span id="mooringlinesegments"></span><a class="reference internal image-reference" href="_images/mooring-line-segments.png"><img alt="_images/mooring-line-segments.png" src="_images/mooring-line-segments.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 5: Discrete segments of a mooring line and the mass particle representation of the segments</span></p>
</div>
<div class="figure" id="id115">
<span id="mooringlineforces"></span><a class="reference internal image-reference" href="_images/mooring-line-forces.png"><img alt="_images/mooring-line-forces.png" src="_images/mooring-line-forces.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 6: Forces applied on a segment of mooring line</span></p>
</div>
<p>The forces applied on a segment are sketched in the figure below. At each time step of fluid flow calculation, <a class="reference internal" href="#equation-mooringlinemotionequation">(197)</a> is integrated explicitly for <img class="math" src="_images/math/94c6cd85d7170d5ef1bb5e737fecf9907bf99fc7.png" alt="{\mathbf{v}_p}" style="vertical-align: -6px"/> using a
sub-time step algorithm: the time step is divided into sub-time steps to integrate the equation to
ensure numerical stability. Mass center location of the segment is calculated by integrating  <img class="math" src="_images/math/94c6cd85d7170d5ef1bb5e737fecf9907bf99fc7.png" alt="{\mathbf{v}_p}" style="vertical-align: -6px"/> over
the sub-time steps. The instantaneous mooring line shape is determined by the updated locations of all the
segment mass centers.</p>
<p>For initial condition, the mooring lines are assumed to be in static equilibrium. Their shapes are
calculated by numerical integration of  <a class="reference internal" href="#equation-mooringlinemotionequation">(197)</a> with <img class="math" src="_images/math/853adbe6bef36f1e285de550e3c4dfb92c793fcd.png" alt="{\mathbf{D}_n}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/5abbecc1949377a16ca14f2f035f2a44c07769fd.png" alt="{\mathbf{D}_t}" style="vertical-align: -3px"/> replaced by a high
artificial drag so that equilibrium state can be obtained quickly. The first guess of a mooring line
shape is a straight line between its two end points.</p>
<p>Mooring lines are allowed to be partially or completely outside the computational domain. When a line
is anchored deep in water, depending on the vertical size of the computational domain, the lower part of the line
can be located below the domain bottom where there is no computation of fluid flow. In this case, it
is assumed that a uniform water current exists below the domain for that part of mooring line, and the
corresponding drag force is evaluated based on the uniform deep water velocity.</p>
<p>Mooring line failure can be simulated using the model. At each time step, the maximum tension
force of a mooring line is computed and compared with the Minimum Breaking Load (MBL) which is the
lowest amount of tension force required to break the mooring line. If the former is equal or greater
than the latter, the mooring line breaks at the location of the maximum tension force.</p>
<p>Interactions between the mooring lines and the tethered moving objects are implemented by data
exchange: the moving objects provide instantaneous locations of the tether points of the mooring
lines, and the mooring line model supplies tension forces on the moving objects.</p>
<p>The model has limitations. It does not consider bending stiffness of mooring lines. When
mooring line networks are simulated, free nodes are not allowed.</p>
<span class="target" id="index-135"></span></div>
</div>
<div class="section" id="dissolving-solid-solute-model">
<span id="dissolvingsolidsolutemodel"></span><span id="index-136"></span><h3>Dissolving Solid Solute Model<a class="headerlink" href="#dissolving-solid-solute-model" title="Permalink to this headline">¶</a></h3>
<p>Dissolution of solid solute in liquid may be of interest in several
applications - from solution mining to food processing to medical
applications. This section describes a model for dissolving solid solute in
fluids and tracking the solute in the brine.</p>
<p>The dissolution of solid solute increases the density of the fluid and thus
may affect the flow. In addition, as the solute is dissolved, the flow domain
increases. The model accounts for the basic physical phenomena, such as mass
transfer at the interface between solid and fluid, the change of volume and
shape of the solid solute, diffusion and convection of the dissolved solute in
fluid and, finally, the change in fluid density, viscosity and surface tension
coefficient.</p>
<p>The amount of dissolved solute in fluid is represented with its mass
concentration <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/>. The transport equation for <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> is</p>
<div class="math" id="equation-transportequationforc">
<p><span class="eqno">(200)<a class="headerlink" href="#equation-transportequationforc" title="Permalink to this equation">¶</a></span><img src="_images/math/ffbbf3fdf08c9040e1366edb175e42b1ce3b70c2.png" alt="\frac{{\partial C}}{{\partial t}} + ({\mathbf{u}} \cdot \nabla )C = \nabla  \cdot (D\nabla C) + Q"/></p>
</div><p>where <img class="math" src="_images/math/a5c9bb92bb978b1ec5a2659e75f1d57dd9910c1b.png" alt="\mathbf u" style="vertical-align: 0px"/> is the fluid velocity and <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is the diffusion
coefficient of the dissolved solute in the fluid. The mass flux of solute,
<img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/>, at the fluid/solid boundary is defined as</p>
<div class="math" id="equation-massfluxofsoluteqatfluidsolidboundary">
<p><span class="eqno">(201)<a class="headerlink" href="#equation-massfluxofsoluteqatfluidsolidboundary" title="Permalink to this equation">¶</a></span><img src="_images/math/ebbde302f20ec1cf55bd475ed484773655de6644.png" alt="Q = \kappa ({C_{\rm{SAT}}} - C)"/></p>
</div><p>where <img class="math" src="_images/math/8552154a335b142ca0da9298ca0c193c45daf188.png" alt="\kappa" style="vertical-align: 0px"/> is the constant mass transfer coefficient and <img class="math" src="_images/math/d44514fedead79073f863707c47d78265e9b4e2b.png" alt="C_{\rm{SAT}}" style="vertical-align: -3px"/> is
the solute saturation concentration. The fluid mixture density <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is assumed
to be a linear function of concentration:</p>
<div class="math" id="equation-fluidmixturedensityrho">
<p><span class="eqno">(202)<a class="headerlink" href="#equation-fluidmixturedensityrho" title="Permalink to this equation">¶</a></span><img src="_images/math/d6474228d3eae5200d1db828e1d476ad3b52598c.png" alt="\rho  = {\rho _0} + \alpha  \cdot C"/></p>
</div><p>where <img class="math" src="_images/math/31d563b2d45cb4d69c56a65957e97b1b66e62ae3.png" alt="\rho _0" style="vertical-align: -4px"/> is the density of pure liquid and <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> is a constant
obtained experimentally. Accordingly, the fluid volume varies with the
concentration, also linearly:</p>
<div class="math" id="equation-fluidvolumevarieswithconcentration">
<p><span class="eqno">(203)<a class="headerlink" href="#equation-fluidvolumevarieswithconcentration" title="Permalink to this equation">¶</a></span><img src="_images/math/7473f0b6dd11f3630f7d8098c10a53334b0cbeeb.png" alt="V = {V_0}\left[ {1 + \left( {1 - \alpha } \right)\frac{C}{{{\rho _0}}}} \right]"/></p>
</div><p>The mixture density coefficient <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> may take values in the range between <img class="math" src="_images/math/441a5de03f8505d3b284cd4886fca0e86bdc1b49.png" alt="1
- {\rho _0}/{\rho _s}" style="vertical-align: -5px"/> for substitutional solutes (<img class="math" src="_images/math/d5c2f29ca6f35099e3db11f5e15f2634d163f8ef.png" alt="\rho _s" style="vertical-align: -4px"/> is the
solid solute density), when the solvent molecules are completely displaced by
the larger molecules of the solute, and 1.0 for interstitial solutes, when the
smaller solute molecules fit perfectly in the spaces between the molecules of
the solvent.</p>
<p>For example, the density of the saturated sea water (brine) at room temperature
is about 26% greater than the density of fresh water, while its volume increases
by 13%, resulting in <img class="math" src="_images/math/fc5e9c6f17580ab83e543d1983d53e9ae5d46549.png" alt="\alpha = 0.5" style="vertical-align: 0px"/>.</p>
<p>Note that there is no change to the mixture volume upon dissolution when
<img class="math" src="_images/math/e59a5450e2806fb0d5def5b7626243b3537c3a97.png" alt="\alpha = 1.0" style="vertical-align: 0px"/>. This assumption can also be used as a simplification of
the model if:</p>
<ul class="simple">
<li>the velocity of the interface controlled by the dissolution rate is small compared to the average fluid velocity; and</li>
<li>solute concentrations are small compared to fluid density.</li>
</ul>
<p>The flow equations are</p>
<div class="math" id="equation-flowequations">
<p><span class="eqno">(204)<a class="headerlink" href="#equation-flowequations" title="Permalink to this equation">¶</a></span><img src="_images/math/8b6996e7f8a6caa98fd6a96a97e6fef1cbacd4dc.png" alt="\begin{gathered}
\nabla  \cdot {\mathbf{u}} = S \hfill \\
\frac{{\partial {\mathbf{u}}}}{{\partial t}} + ({\mathbf{u}} \cdot \nabla ){\mathbf{u}} =  - \frac{1}{\rho }\nabla P + \frac{1}{\rho }\nabla  \cdot (\mu \nabla {\mathbf{u}}) + {\mathbf{g}} \hfill \\
\end{gathered}"/></p>
</div><p>with <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> being fluid pressure, <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> viscosity and <img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/> gravity. The
source term <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> accounts for the change in the position of the boundary
between fluid and solid solute as well as for the increase in the fluid specific
volume (see Eq. <a class="reference internal" href="#equation-sinktermsincontinuityequation">(208)</a>).</p>
<p>The Fractional Area/Volume Obstacle Representation method (FAVOR<sup>TM</sup>) is used to
represent the changing geometry of the solid solute. To account for the presence
of solid solute in the flow domain, and its change in volume and shape as it is
dissolved in the fluid, a variant of <a class="reference internal" href="#gmomodelth"><span class="std std-ref">General Moving Objects Model</span></a> model has
been developed. While the standard GMO model describes the motion of rigid
objects moving through the flow domain, the solute model tracks the change of
the solid solute boundary of the otherwise stationary dissolving component. Both
models use time-dependent area and volume fractions to represent the changing
geometry in the fixed rectangular grid. These variables are updated at every
time step to reflect the changes in component’s boundary location. Fluid
quantities such as pressure and velocity must be initialized in newly-opened
cells. Volume sources and sinks are also computed at the moving boundaries to
maintain continuity of the fluid and solid.</p>
<p>In the augmented model, the geometry component representing the solid solute is
designated as a component of a type <em>dissolving</em>: it is stationary but changes
shape and volume. It is designated with the input variable
<span class="target" id="index-137"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IFOBDISS(nob)</span></code>=1, where <code class="docutils literal notranslate"><span class="pre">nob</span></code> is the component number. The area and volume
fractions are recomputed at every time step to reflect the gradual dissolution
of the solid solute. The primary variable representing such geometry component
is the relative (fractional) volume of solid solute in a cell, which is the
ratio of the solid volume in the cell to the total cell volume:</p>
<div class="math" id="equation-ratioofsolidvolumeincelltototalcellvolume">
<p><span class="eqno">(205)<a class="headerlink" href="#equation-ratioofsolidvolumeincelltototalcellvolume" title="Permalink to this equation">¶</a></span><img src="_images/math/fec371d1cb105a77b7a7e9e35ad4b4818e190882.png" alt="{V_{f,{\rm{solute}}}} = {V_{\rm{solute}}}/{V_{\rm{cell}}} \quad 0 \leq {V_{f,{\rm{solute}}}} \leq 1.0"/></p>
</div><p>The open volume fraction in cell, or volume fraction, is then</p>
<div class="math" id="equation-openvolumefraction">
<p><span class="eqno">(206)<a class="headerlink" href="#equation-openvolumefraction" title="Permalink to this equation">¶</a></span><img src="_images/math/4cd65ab1b6b12048b0acf3f075514d62a8a3efee.png" alt="{V_f} = 1.0 - {V_{f,{\rm{solute}}}}"/></p>
</div><p>The area fraction at a cell face, <img class="math" src="_images/math/1feadfdfc7c5587700a07512d62d8f291d5410f1.png" alt="A_f" style="vertical-align: -6px"/>, is computed from the volume
fractions in the two cells sharing the face.</p>
<p>The rate of change of the solid solute content in a computational cell is defined is:</p>
<div class="math" id="equation-solidsolidcontentcomputationalcell">
<p><span class="eqno">(207)<a class="headerlink" href="#equation-solidsolidcontentcomputationalcell" title="Permalink to this equation">¶</a></span><img src="_images/math/35b7e697c9a92a8c47213fa1815367a6333f8747.png" alt="\frac{{dV{f_{\rm{solute}}}}}{{dt}} = \frac{{QdA}}{{{\rho _S}{V_{\rm{cell}}}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/a69647592ac940ec9af8354c7d37812f127bc52b.png" alt="dA" style="vertical-align: 0px"/> is the wetted area of solid surface in the cell and</li>
<li><img class="math" src="_images/math/d5c2f29ca6f35099e3db11f5e15f2634d163f8ef.png" alt="\rho _s" style="vertical-align: -4px"/> is the density of solid solute.</li>
</ul>
<p>The sink term <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> in the continuity equation, Eq. <a class="reference internal" href="#equation-flowequations">(204)</a>,
reflecting continuity of fluid and solid at the interface and the change in
fluid volume as solute is dissolved, is:</p>
<div class="math" id="equation-sinktermsincontinuityequation">
<p><span class="eqno">(208)<a class="headerlink" href="#equation-sinktermsincontinuityequation" title="Permalink to this equation">¶</a></span><img src="_images/math/d13de2174ac77036fc5e52bff11c44230ce58356.png" alt="S = \frac{{dV{f_{\rm{solute}}}}}{{dt}} + \frac{{QdA}}{{{\rho _0}{V_{\rm{cell}}}}}\left( {1 - \alpha } \right) = \frac{{QdA}}{{{V_{\rm{cell}}}}}\left( {\frac{1}{{{\rho _s}}} + \frac{{1 - \alpha }}{{{\rho _0}}}} \right)"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="figure" id="id116">
<span id="schematicinterfaceregionnumericalmodel"></span><a class="reference internal image-reference" href="_images/schematic-interface-region-numerical-model.png"><img alt="Schematic of the interface region in the numerical model" src="_images/schematic-interface-region-numerical-model.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 7: A schematic of the interface region in the numerical model. The shaded area
to the right of the interface is occupied by a dissolving component
representing the solid solute whose shape and volume vary with time. The
dissolved solute is distributed in the fluid within the volume adjacent to
the interface marked by the thin dashed line. The thick dashed line shows the
volume of solid solute in cell.</span></p>
</div>
<p>The amount of solute dissolved in a given time increment, <img class="math" src="_images/math/76912f6602e2135fc9bc65611bb6986e569012af.png" alt="dm=QdAdt" style="vertical-align: -4px"/>, is
distributed over a fluid volume adjacent to the interface equal to the volume of
the mesh cell containing the interface (thin dashed-line rectangle in the figure
above. If the interfacial cell is only partially filled with fluid, then part of
the dissolved solute will be apportioned to a neighboring cell. Such averaging
of the solute concentration makes the solution less dependent on the position of
the interface within a cell and is consistent with the control volume approach,
where each volume is associated with a single solute concentration value.</p>
<p>The dissolution rate of the solid solute is assumed to be limited by diffusion,
that is, the dissolved solute must diffuse away from the interface before more
can be dissolved. The volume of solute dissolved in a time increment <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/>
per unit surface area is <img class="math" src="_images/math/6c4783ab954ba75b7407309823cc21e060cb80c9.png" alt="Qdt" style="vertical-align: -4px"/>. In the same period of time, the amount of
solute that diffuses from the interface into the bulk is approximately
<img class="math" src="_images/math/333ccac199abb0f1bb7a7f009d219b25a1fed331.png" alt="\rho \sqrt {Ddt} ({C_{\rm{SAT}}} - C)" style="vertical-align: -5px"/>. Comparing the two expressions imposes
a limit on the effective solute mass transfer coefficient:</p>
<div class="math" id="equation-masstransfercoefficient">
<p><span class="eqno">(209)<a class="headerlink" href="#equation-masstransfercoefficient" title="Permalink to this equation">¶</a></span><img src="_images/math/d08e637feadc7f411fdfb6b9d1bf804a2c2ac2bb.png" alt="{\kappa _{\rm{eff}}} = {\text{min}}\left( {\kappa ,\rho \sqrt {\frac{D}{{dt}}} } \right)"/></p>
</div><p>Once the dissolved solute has been apportioned to the control volumes, diffusion
and convection take over and may further redistribute the solute within the
mixture.</p>
<span class="target" id="index-138"></span></div>
<div class="section" id="combustible-object-model">
<span id="combustibleobjectmodel"></span><span id="index-139"></span><h3>Combustible Object Model<a class="headerlink" href="#combustible-object-model" title="Permalink to this headline">¶</a></h3>
<p>The combustion of solid propellant is of interest in rocket engine design. This section
describes a model for the burning of solid propellant in gas.</p>
<p>The burning of the propellant results in increased temperature and pressure of the surrounding gas.
In response, stresses and deformations develop in the solid propellant. In addition, as propellant
is being spent, the flow domain increases. It is of interest to predict these changes. The model
has the following properties:</p>
<ol class="arabic simple">
<li>The combustion rate is controlled by gas pressure using a power function with empirical coefficients;</li>
<li>The chemistry of the combustion reaction is not modeled;</li>
<li>The spent solid propellant is converted into gas with equivalent mass which is then transported according to the dynamically computed pressure and velocity fields as well as diffusion;</li>
<li>Density of the combustion gas is calculated from the ideal gas equation-of-state (EOS);</li>
<li>Direct turbulence effects on the burn rate are ignored;</li>
<li>The calculation of stresses and deformations in the combusting component can also be included.</li>
</ol>
<p>The numerical approach is similar to that used in <a class="reference internal" href="#dissolvingsolidsolutemodel"><span class="std std-ref">Dissolving Solid Solute Model</span></a>. The combustible
solid is represented by a special type of geometry component. The mass of the solid is converted to
fluid based on a calculated mass transfer rate. Mass, energy and momentum sources are applied at the
interface of the solid propellant. The shape of the solid is adjusted using the area and volume fractions.</p>
<p>The combustion mass flow rate at the gas/propellant boundary, <img class="math" src="_images/math/6a400e98e59d04208988795b26c6c9295ff8a118.png" alt="Q_{M}" style="vertical-align: -4px"/>, is defined as</p>
<div class="math" id="equation-combustionmasssource">
<p><span class="eqno">(210)<a class="headerlink" href="#equation-combustionmasssource" title="Permalink to this equation">¶</a></span><img src="_images/math/351f198a0fd971d78390342e238aa23a75a9e201.png" alt="Q_{M} = \rho_{\rm{solid}} (a \cdot P^{b})"/></p>
</div><p>where <img class="math" src="_images/math/ca97771713414d816b6ff6dddbbdfff5a04062f2.png" alt="\rho_{\rm{solid}}" style="vertical-align: -4px"/> is the solid propellant density, <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> is the gas pressure at the interface
and <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> and <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> are user-defined empirical constants. The expression in the parenthesis in
<a class="reference internal" href="#equation-combustionmasssource">(210)</a> is effectively the normal speed of the interface.</p>
<p>The energy produced by the reaction, <img class="math" src="_images/math/9c6820b27f18682efa4e8b15a12c5e7610fbdd96.png" alt="Q_{E}" style="vertical-align: -4px"/>, is</p>
<div class="math" id="equation-combustionenergysource">
<p><span class="eqno">(211)<a class="headerlink" href="#equation-combustionenergysource" title="Permalink to this equation">¶</a></span><img src="_images/math/afd577b543008047ef9e50e3313515f532b93440.png" alt="Q_{E} = Q_{M} C_{P} T_{\rm{burn}}"/></p>
</div><p>where <img class="math" src="_images/math/0edea025673762f21c3d797a7bdba7b6085cf168.png" alt="C_{P}" style="vertical-align: -3px"/> is the gas specific heat at constant pressure, and <img class="math" src="_images/math/d6d93854a320872f67abad1f66f8b847d5c5181b.png" alt="T_{\rm{burn}}" style="vertical-align: -3px"/> is the user-defined
combustion temperature.</p>
<p>The mass source is assumed to be of the <em>stagnation</em> type, i.e., the initial velocity of the exhaust gas
is zero. As a result of this assumption, no additional source term is present in the momentum equations.</p>
<p>The Fractional Area/Volume Obstacle Representation method (FAVOR<sup>TM</sup>) is used to
represent the changing geometry of the combusting solid object. To account for the presence
of the propellant in the flow domain, and its change in volume and shape as it is
dissolved in the fluid, a variant of <a class="reference internal" href="#gmomodelth"><span class="std std-ref">General Moving Objects Model</span></a> model has
been developed. While the standard GMO model describes the motion of rigid
objects moving through the flow domain, the combustible object model tracks the change of
the propellant’s boundary of the otherwise stationary combustible component. Both
models use time-dependent area and volume fractions to represent the changing
geometry in the fixed rectangular grid. These variables are updated at every
time step to reflect the changes in component’s boundary location. Fluid
quantities such as pressure and velocity must be initialized in newly-opened
cells. Volume sources and sinks are also computed at the moving boundaries to
maintain continuity of the fluid and solid.</p>
<p>In the augmented model, the geometry component representing the propellant is
designated as a component of a type <span class="menuselection">Combusting</span>: it is stationary but changes
shape and volume. It is designated with the input variable
<span class="target" id="index-140"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IFOBBURN(nob)</span></code>= 1, where <code class="docutils literal notranslate"><span class="pre">nob</span></code> is the component number. The area and volume
fractions are recomputed at every time step to reflect the gradual diminishing
of the propellant. The primary variable representing such geometry component
is the relative (fractional) volume of solid in a cell, which is the
ratio of the solid volume in the cell to the total cell volume:</p>
<div class="math" id="equation-ratioofpropellantvolumeincelltototalcellvolume">
<p><span class="eqno">(212)<a class="headerlink" href="#equation-ratioofpropellantvolumeincelltototalcellvolume" title="Permalink to this equation">¶</a></span><img src="_images/math/6ecd8cddcd82c0981e9fa95a14eeaec78a283706.png" alt="V_{f,{\rm{combust}}} = V_{\rm{combust}}/V_{\rm{cell}} \quad 0 \leq V_{f,{\rm{combust}}} \leq 1.0"/></p>
</div><p>The open volume fraction in cell, or volume fraction, is then</p>
<div class="math" id="equation-openvolumefractioncombust">
<p><span class="eqno">(213)<a class="headerlink" href="#equation-openvolumefractioncombust" title="Permalink to this equation">¶</a></span><img src="_images/math/77bb71f132bd91203cd9c04b90a5de8e3fb9e7c4.png" alt="{V_f} = 1.0 - {V_{f,{\rm{combust}}}}"/></p>
</div><p>The change in the cell solid propellant content is then</p>
<div class="math" id="equation-changeofpropellantincell">
<p><span class="eqno">(214)<a class="headerlink" href="#equation-changeofpropellantincell" title="Permalink to this equation">¶</a></span><img src="_images/math/f0eb86cffbaa5f9f4ae356e43fba679331357bab.png" alt="\frac{dV{f_{\rm{combust}}}}{dt} = \frac{{Q_{M}dA}}    {\rho_{\rm{solid}}   V_{\rm{cell}}}"/></p>
</div><p>where <img class="math" src="_images/math/a69647592ac940ec9af8354c7d37812f127bc52b.png" alt="dA" style="vertical-align: 0px"/> is the area of solid propellant  surface in cell.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="figure" id="id117">
<span id="schematicinterfaceregioncombustionmodel"></span><a class="reference internal image-reference" href="_images/schematic-interface-region-combustion-model.png"><img alt="A schematic of the interface region." src="_images/schematic-interface-region-combustion-model.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 8: A schematic of the interface region in the numerical model. The shaded area
to the right of the interface is occupied by a combustible component
representing the solid propellant whose shape and volume vary with time. The
reaction gas is distributed in the fluid within the volume adjacent to
the interface marked by the thin dashed line. The thick dashed line shows the
volume of solid propellant in cell.</span></p>
</div>
<p>The amount of propellant burned in a given time step <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/>, <img class="math" src="_images/math/fb1c388d0d953cc90f465f198bc627d2d1dd13e7.png" alt="dM = Q_{M} dA dt" style="vertical-align: -4px"/>, and energy are
distributed over the gas volume immediately adjacent to the interface. Once the mass and energy have been
apportioned to the control volume, diffusion and convection processes take over.</p>
<p>A mass transport equation is solved for the gas produced by the reaction. The solution is output as the
mass fraction of the combustion gas in the mixture with the initial gas (presumably air) and can be viewed
in the post-processor along with other spatial variables. The properties of the gas initially in the cavity
are assumed to be the same as those of the combustion gases, which, of course, is not always true. However,
the errors introduced by this assumtpion descrease as the initial gas is expelled from the cavity. Therefore,
the properties of the compressible fluid #2 should correspond to those of the combustion gas.</p>
<p>If the elastic stresses within the solid propellant are to be modeled, the Fluid Structure Interaction
model (<a class="reference internal" href="#fsitsemodelsth"><span class="std std-ref">Fluid-Structure Interaction (FSI) and Thermal Stress Evolution (TSE) Models</span></a>) needs to be deployed, with the combustible component designed as of type
FSI (<a class="reference internal" href="model-reference.html#fsitsemodelsetupmr"><span class="std std-ref">Model Setup</span></a>). As the shape and volume of the solid propellant vary with time, so too
does the Finite Element mesh  used to simulate the elastic stresses: in regions where the solid fuel has
burned away, the elements are eliminated from the simulation and the resulting pressure of the gas
is applied to the newly exposed solid surface.</p>
<p>In order to use this model, the mesh for the combustible component needs to be
generated by turning on the  Fluid Structure Interaction or Thermal Stress
Evolution (FSI/TSE) model temporarily and turning off the  combustible
component flag (<span class="target" id="index-141"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ifobburn(nob)</span></code> =0). The mesh file created should be
saved following which, the  FSI/TSE model can be turned off and the
combustible component flag can be turned back on (<span class="target" id="index-142"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ifobburn(nob)</span></code> =0).
The mesh generated  should be used during the simulation using the
<span class="target" id="index-143"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">iffem(nob)</span></code> =1 and <span class="target" id="index-144"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ffem(nob)</span></code> = <code class="file docutils literal notranslate"><span class="pre">fe_mesh_file.FEMESH</span></code>
flags. This completes  the setup for a combustible component.</p>
<span class="target" id="index-145"></span></div>
<div class="section" id="lost-foam-model">
<span id="lostfoammodelth"></span><span id="index-146"></span><h3>Lost Foam Model<a class="headerlink" href="#lost-foam-model" title="Permalink to this headline">¶</a></h3>
<p>In the lost foam casting process, foam occupies the mold cavity and offers a
resistance to the flow of metal. Momentum plays only a small role in the lost
foam process.</p>
<p>Foam is represented with a special kind of obstacle that prevents the flow of
metal unless it is heated sufficiently to lose its strength. In this sense the
movement of metal into foam is controlled by heat transfer mechanisms and not by
pressure or inertia of the metal.</p>
<p>When metal enters a control volume containing foam, the heat transferred to the
foam from the metal during one increment in time is computed. This amount is
then used to compute the volume of foam that is decomposed and raised to the
temperature of the metal. When computing the amount of foam decomposed, it is
necessary to include the heats-of-transformation for melting and vaporization of
the foam. Energy transferred to the foam is removed from the metal. Thermal
conduction in the foam is ignored in the model.</p>
<p>Metal advances through the action of a sink equal to the amount of foam volume
removed in each control volume. The sink is specified in terms of velocity
components at the metal surface, which keeps the metal moving into the foam as
long as the pressure in the metal is sufficiently high.</p>
<p>The average speed of the metal front, <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>, can be estimated as</p>
<div class="math" id="equation-averagespeedofmetalfrontu">
<p><span class="eqno">(215)<a class="headerlink" href="#equation-averagespeedofmetalfrontu" title="Permalink to this equation">¶</a></span><img src="_images/math/4202628fa7e7c94cb7b2abbbab2205d19781ba02.png" alt="u = \frac{\rm{HOBS1}}{\rm{RCOBS}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-147"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOBS1</span></code> is the metal/foam heat transfer coefficient, and</li>
<li><span class="target" id="index-148"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCOBS</span></code> is the foam density times specific-heat product.</li>
</ul>
<p>No attempt has been made to directly model the flow of gas produced from
vaporized foam. The importance of gas is well known in terms of the effect that
different coating permeabilities on the foam pattern may have on the performance
of a casting. With insufficient permeability, gas buildup may actually blow
metal back out of the mold. The effects of coating permeability are
approximately included in the present model through a change in the metal/foam
heat transfer coefficient. The reasoning behind this is that the rate of heat
transfer should be proportional to the thickness of the gas region. A low
permeability coating would result in gas buildup and reduce heat transfer.</p>
<p>A gravity effect can be taken into account in the calculation of the
metal/foam heat transfer coefficient using variable <span class="target" id="index-149"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CGFOB</span></code>. Since the
foam decomposition products are usually lighter than the metal, they can be
displaced by the metal advancing downwards and accumulate above the metal
front that is moving upwards. Thus, one can expect a smaller interfacial gap
when metal is above foam than in the reverse situation. This effect is
described by making the metal/foam heat transfer coefficient a function of the
gravity component, <img class="math" src="_images/math/4a1d80c5c11bd9a3dfb5ed065b0b794a768c8630.png" alt="{\rm{GHT}}" style="vertical-align: 0px"/>, normal to the metal/foam front</p>
<div class="math" id="equation-metalfoamheattransfercoefficient">
<p><span class="eqno">(216)<a class="headerlink" href="#equation-metalfoamheattransfercoefficient" title="Permalink to this equation">¶</a></span><img src="_images/math/4ca3f3eabc4d7d6d71fce5e62b1fad6f6bf5afc7.png" alt="h = {\rm{HOBS1}} \cdot \left(1 + {\rm{sign}}({\rm{CGFOB}},{\rm{GHT}}) \cdot {\frac{{\rm{GVEL}}}{{{\rm{GVEL}} + \frac{\rm{HOBS1}}{\rm{RCOBS}}}}} \right)"/></p>
</div><p>where</p>
<div class="math" id="equation-metalfoamheattransfercoefficientgvelvalue">
<p><span class="eqno">(217)<a class="headerlink" href="#equation-metalfoamheattransfercoefficientgvelvalue" title="Permalink to this equation">¶</a></span><img src="_images/math/7ddc0bc25104ec1e760f30d6a5362c7f0aaa8fec.png" alt="{\rm{GVEL}} = \sqrt {\left| {\rm{GHT}} \right| \cdot {\rm{ROUGH}}}"/></p>
</div><p><span class="target" id="index-150"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROUGH</span></code> is user-defined roughness for each foam obstacle. The roughness
parameter describes the characteristic length scale of the surface
irregularities at the metal/foam interface (a value of 0.1 cm is not
unreasonable). According to the expression, the heat transfer coefficient
between metal and foam is larger where metal is above foam, therefore making it
easier for the metal to advance downwards than upwards. The recommended value
for <span class="target" id="index-151"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CGFOB</span></code> is 0.5.</p>
<p>A special simplified filling model is available, <span class="target" id="index-152"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IFLFOAM</span></code>=2, that may be used to
determine general filling patterns and locate possible sources of defects
arising from the convergence of metal fronts (folds). This model, however, gives
no information about temperature or velocity distributions, surface defects, or
solidification.</p>
<p>For better pressure iteration convergence it is recommended to use a small
degree of limited compressibility by setting <span class="target" id="index-153"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQL</span></code> to a value around 10<sup>-6</sup> in CGS units or to a value on the order of 0.1/(estimated maximum
fluid pressure).</p>
<span class="target" id="index-154"></span></div>
<div class="section" id="porous-media-models">
<span id="porousmediamodelsth"></span><span id="index-155"></span><h3>Porous Media Models<a class="headerlink" href="#porous-media-models" title="Permalink to this headline">¶</a></h3>
<p>Filters, soils, fractured rock, sponges, and paper are all examples of porous media.
Porous media refers to solid materials with connected interstitial voids through
which fluid can flow. On a microscopic scale the velocities and pressures in the
void spaces are highly irregular but from a macroscopic viewpoint, a volume
averaged approach represents the flow quite well.</p>
<p>The size of the voids relative to the overall dimensions of the material
suggests the appropriateness of modeling a material as porous vs. simulating
each individual void. For example, although a sheet of paper is quite thin, the
size of the voids within the sheet is much smaller. If the average flow through
the paper is of interest, treating the paper as a porous medium with certain
volume-averaged macroscopic properties, such as porosity, would be appropriate.
However, if the wicking behavior in a small region within the paper, due to
anisotropic fiber distribution, is of interest, each fiber would need to be
represented in the simulation. For the concept of averaging many pores over the
volume of a computation cell to be valid, the size of the voids must be much
smaller than the control volume.</p>
<div class="figure" id="id118">
<span id="porousmodeldiscretemodel"></span><a class="reference internal image-reference" href="_images/porous-model-discrete-model.png"><img alt="Left: Porous model; Right: Discrete model" src="_images/porous-model-discrete-model.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 9: Left: A porous model is appropriate when the size of the pores is much
smaller than the size of the control volume, for example, sandstone, and
packed powder. Right: A discrete model (each solid modeled) is appropriate
when the size of the pores is on the same order as the control volume and
flow details in the pores is of interest. For example, micro-flows in fiber
mats.</span></p>
</div>
<div class="section" id="governing-equations-in-porous-media">
<span id="governingequationsinporousmediath"></span><span id="index-156"></span><h4>Governing Equations in Porous Media<a class="headerlink" href="#governing-equations-in-porous-media" title="Permalink to this headline">¶</a></h4>
<p>The porosity of a porous medium is defined as the open volume divided by the
total volume. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> nomenclature, porosity is identical to volume fraction
<img class="math" src="_images/math/8011acfe3bd0a9eac603ad36403ae8aa4005dae0.png" alt="V_f" style="vertical-align: -6px"/>.</p>
<div class="math" id="equation-porosityindenticalvolumefractionvf">
<p><span class="eqno">(218)<a class="headerlink" href="#equation-porosityindenticalvolumefractionvf" title="Permalink to this equation">¶</a></span><img src="_images/math/c292ac6da438c0771044eddaeab63104c297e8a3.png" alt="{\text{Porosity }} \equiv {\text{ }}{V_f}"/></p>
</div><p>Materials such as metallic foam filters are almost completely open and may have
porosities approaching 1.0. The porosity of close packed spheres varies from 25%
to 47% depending on the packing configuration.</p>
<p>By constructing a continuum model of the porous material and applying
averaging to each control volume, the usual conservation equations are
obtained. Conservation of mass is expressed by Eq. <a class="reference internal" href="#equation-conservationofmass">(219)</a>.</p>
<div class="math" id="equation-conservationofmass">
<p><span class="eqno">(219)<a class="headerlink" href="#equation-conservationofmass" title="Permalink to this equation">¶</a></span><img src="_images/math/8a360ef007af0a230e14a88543cc71b07a6032ff.png" alt="\frac{{\partial {\rho _f}}}{{\partial t}} + \nabla  \cdot ({\rho _f}{\mathbf{U}}) = 0"/></p>
</div><p>where <img class="math" src="_images/math/129fad26732c5694a88df1dce54dbed294d94981.png" alt="\mathbf U" style="vertical-align: 0px"/> is the microscopic flow velocity. A momentum equation in
porous media can be formed based on the observation of French engineer Henry
Darcy in 1856 who noted that the unidirectional flow rate through porous media
is proportional to the applied pressure difference. This relationship is
expressed as</p>
<div class="math" id="equation-unidirectionalflowratethroughporousmedia">
<p><span class="eqno">(220)<a class="headerlink" href="#equation-unidirectionalflowratethroughporousmedia" title="Permalink to this equation">¶</a></span><img src="_images/math/29cb1d12b545fe5e4ce4b4c5af928d6aa45e5aa6.png" alt="{V_f}{\mathbf{U}} =  - \frac{K}{\mu }\frac{{\partial P}}{{\partial x}}"/></p>
</div><p>where the coefficient <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is the specific or intrinsic permeability of the
material. <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is generally independent of the fluid and has dimensions of
length<sup>2</sup>. Equation <a class="reference internal" href="#equation-unidirectionalflowratethroughporousmedia">(220)</a> is
referred to as Darcy’s law. Values of <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> for common materials are 10<sup>-7</sup> <img class="math" src="_images/math/e8d97f32673c334f8aba0c42398aed7ef8ee7b14.png" alt="\sim" style="vertical-align: 2px"/> 10<sup>-9</sup> m<sup>2</sup> for gravel and 10<sup>-13</sup>
<img class="math" src="_images/math/e8d97f32673c334f8aba0c42398aed7ef8ee7b14.png" alt="\sim" style="vertical-align: 2px"/> 10<sup>-16</sup> m<sup>2</sup> for clay. The smaller the value of the
permeability the greater the resistance to flow. This resistance is commonly
referred to in porous media modeling as drag. The resistance to flow in a porous
medium is represented in the Navier-Stokes equations as a drag term proportional
to the velocity</p>
<div class="math" id="equation-navierstokesequationdragtermproportionaltovelocity">
<p><span class="eqno">(221)<a class="headerlink" href="#equation-navierstokesequationdragtermproportionaltovelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/6b2367d828200f393ddfe41e4ff7cad98d6332be.png" alt="{\mathbf{b}}{\text{ }} = {\text{ }}{F_d}{\mathbf{U}}"/></p>
</div><p>where <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> is the porous media drag coefficient.</p>
<p>The permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> can be expressed in terms of the drag coefficient <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/>
according to</p>
<div class="math" id="equation-permeabilitykexpressedintermsofcoefficientfd">
<p><span class="eqno">(222)<a class="headerlink" href="#equation-permeabilitykexpressedintermsofcoefficientfd" title="Permalink to this equation">¶</a></span><img src="_images/math/a6a3bebf0f381cad2a381efcb4f09770e0f95542.png" alt="K = \frac{{{V_f}\mu }}{{\rho {F_d}}}"/></p>
</div><p>Before discussing the various types of drag models available in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, it should
be noted that there are two flow regimes possible within the porous
medium - saturated and unsaturated. A saturated flow is one where the interface
between the gas and the liquid is relatively sharp. An unsaturated flow is one
where the interface between gas and liquid is diffuse and may exhibit fingering
and trapped gas regions.</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/saturated-flow-unsaturated-flow.png"><img alt="Saturated Flow and Unsaturated Flow" src="_images/saturated-flow-unsaturated-flow.png" style="width: 4.1in;" /></a>
</div></blockquote>
</div>
<div class="section" id="saturated-porous-media">
<span id="index-157"></span><h4>Saturated porous media<a class="headerlink" href="#saturated-porous-media" title="Permalink to this headline">¶</a></h4>
<div class="section" id="resistance-to-flow-drag">
<span id="dragcalculationssaturatedflowsth"></span><h5>Resistance to flow (drag)<a class="headerlink" href="#resistance-to-flow-drag" title="Permalink to this headline">¶</a></h5>
<p>Since the permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> is determined by geometry factors rather than
fluid properties, it is possible to derive <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> from geometrical parameters
such as particle size and fiber diameter. The Carman-Kozeny equation
<a class="reference internal" href="#equation-carmankozenyequation">(223)</a> is derived from the hydraulic radius theory, and is
stated as</p>
<div class="math" id="equation-carmankozenyequation">
<p><span class="eqno">(223)<a class="headerlink" href="#equation-carmankozenyequation" title="Permalink to this equation">¶</a></span><img src="_images/math/09c8dfe551bd45dbed8acb351c29317a6b5be6bb.png" alt="K{\text{ }} = {\text{ }}\frac{{{D^2}V_f^3}}{{180{{(1 - {V_f})}^2}}}"/></p>
</div><p>where <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is the particle or fiber diameter and 180 is referred to as the
Carman-Kozeny constant. Equation <a class="reference internal" href="#equation-carmankozenyequation">(223)</a> gives good results
when the porous medium consists of nearly spherical shapes of similar size. Some
researchers have found that the Carman-Kozeny constant is dependent on porosity
and fiber aspect ratio.</p>
<span class="target" id="index-158"></span><div class="section" id="darcian-saturated-drag">
<span id="darciansaturateddragth"></span><span id="index-159"></span><h6>Darcian Saturated Drag<a class="headerlink" href="#darcian-saturated-drag" title="Permalink to this headline">¶</a></h6>
<p>From Equation <a class="reference internal" href="#equation-permeabilitykexpressedintermsofcoefficientfd">(222)</a>, the drag
coefficient used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be expressed in terms of the permeability
<img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> as:</p>
<div class="math" id="equation-darciandragcoefficientonk">
<p><span class="eqno">(224)<a class="headerlink" href="#equation-darciandragcoefficientonk" title="Permalink to this equation">¶</a></span><img src="_images/math/9662515bd5c1dd0a54fa87a483ef4105165ea9f7.png" alt="{F_d}{\text{ }} = \frac{{{V_f}\mu }}{\rho K}"/></p>
</div><p>The drag coefficient can also be written as:</p>
<div class="math" id="equation-darciandragcoefficientconstant">
<p><span class="eqno">(225)<a class="headerlink" href="#equation-darciandragcoefficientconstant" title="Permalink to this equation">¶</a></span><img src="_images/math/c76f4a98b465ae609fb4394437fcc2369f6be0f7.png" alt="{F_d}{\text{ }} = {\text{ }}a"/></p>
</div><p>where <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> is a positive constant, when a constant drag coefficient is
desired. Equations <a class="reference internal" href="#equation-darciandragcoefficientonk">(224)</a> and
<a class="reference internal" href="#equation-darciandragcoefficientconstant">(225)</a> hold true in saturated flows in porous
media where the pore Reynolds number, computed from</p>
<div class="math" id="equation-porereynoldsnumber">
<p><span class="eqno">(226)<a class="headerlink" href="#equation-porereynoldsnumber" title="Permalink to this equation">¶</a></span><img src="_images/math/0694d4b0cc4bee1999fbe0a63992308c5ee9bc39.png" alt="{\operatorname{Re} _P} = \frac{{\rho \mathbf{U} D}}{\mu }"/></p>
</div><p>is less than 1. This is usually true for low velocity flows or for porous media
with small pore sizes.</p>
<span class="target" id="index-160"></span></div>
<div class="section" id="forchheimer-saturated-drag">
<span id="forchheimersaturateddragth"></span><span id="index-161"></span><h6>Forchheimer Saturated Drag<a class="headerlink" href="#forchheimer-saturated-drag" title="Permalink to this headline">¶</a></h6>
<p>If a porous medium is composed of coarse particles or fibers, the microscopic
velocity may be significant and the flow losses it induces may be proportional
to the square of the flow velocity rather as well as being a linear function of
the velocity. This is typically the case when <img class="math" src="_images/math/f5ae954a9595538d2603280f78056bc57f5d57a1.png" alt="{{\operatorname{Re} }_P} &gt;
10" style="vertical-align: -3px"/>. In Forchheimer’s equation, the pressure drop is given by</p>
<div class="math" id="equation-forchheimerequationbypermeability">
<p><span class="eqno">(227)<a class="headerlink" href="#equation-forchheimerequationbypermeability" title="Permalink to this equation">¶</a></span><img src="_images/math/d22bfc6e8ecb1bba3fa070d170b79581142019db.png" alt="\frac{\partial P}{\partial x}=\frac{\mu}{K}{V_f}{\mathbf{U}}+\frac{\rho}{K_2}{\left| {V_f}\mathbf{U} \right|} {V_f}\mathbf{U}"/></p>
</div><p>where <img class="math" src="_images/math/a4c4145679585cfa713022ab94234b0b7a2a03e7.png" alt="K_2" style="vertical-align: -3px"/> is the non-Darcian or inertial permeability.</p>
<p>The linear (Darcian) and quadratic (non-Darcian) flow loss equations can be
combined into a single expression for <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/></p>
<div class="math" id="equation-reynoldsnumberdependentdrag">
<p><span class="eqno">(228)<a class="headerlink" href="#equation-reynoldsnumberdependentdrag" title="Permalink to this equation">¶</a></span><img src="_images/math/6aa7f4df6390caa66aa8b1ea0eff0c8798e29a29.png" alt="{F_d} = \frac{\mu }{\rho }\frac{{1 - {V_f}}}{{{V_f}}}\left[ {a\frac{{1 - {V_f}}}{{{V_f}}} + b\frac{{{{\operatorname{Re} }_P}}}{D}} \right]"/></p>
</div><p>where <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> and <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> are constant coefficients. They can be defined
by experimental data. When experimental data is unavailable, they can be
estimated as:</p>
<div class="math">
<p><img src="_images/math/f306ecbaecd4cb60fbdd76b7896f5bdbe5a39ad7.png" alt="a = \alpha /{D^2}, \ b = \beta /D"/></p>
</div><p>where:</p>
<ul class="simple">
<li>The constant <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> typically has the value of 180, and</li>
<li><img class="math" src="_images/math/58f961270cf905208364b40799bc1ab9d5b3ed34.png" alt="\beta" style="vertical-align: -4px"/> is a roughness factor in the range of 1.8 to 4.0 (smooth to rough).</li>
</ul>
<p>The parameter <img class="math" src="_images/math/2a3e6468d8e8436144abc2ac7a0eba94cfcf8833.png" alt="a" style="vertical-align: 0px"/> should be specified for each porous component to
prevent unphysical flow. The definition of <img class="math" src="_images/math/9a35981bab3fb1e23a2f374e4a027a565471a18d.png" alt="b" style="vertical-align: 0px"/> is optional; it defaults
to zero.</p>
</div>
</div>
<div class="section" id="capillary-pressure">
<span id="capillarypressureth"></span><span id="index-162"></span><h5>Capillary Pressure<a class="headerlink" href="#capillary-pressure" title="Permalink to this headline">¶</a></h5>
<p>Within a saturated porous medium, the effects of surface tension on the
fluid/gas interface may be significant if the fluid is strongly wetting or
non-wetting relative to the porous material. This capillary pressure arises
because of the high surface curvatures present in the tiny pores of the
material. When the material is wetted by the fluid (i.e. the static contact
angle is less than <img class="math" src="_images/math/dab2357c933e316892b0ea2bc616021d5d855a50.png" alt="{90}^{\circ}" style="vertical-align: 0px"/>), absorption and wicking of the fluid
into a porous medium occurs. When the fluid and porous material are
non-wetting, the opposite occurs and external pressure must be applied to force
fluid into the material. The strength of the wetting or non-wetting dynamics
of the porous medium are defined by the <em>capillary pressure</em>.</p>
<p>The value of the capillary pressure is based on the average pore diameter, the
surface tension of the imbibing fluid, and the static contact angle to the
porous material and can be estimated using</p>
<div class="math" id="equation-staticcontactangletoporousmaterial">
<p><span class="eqno">(229)<a class="headerlink" href="#equation-staticcontactangletoporousmaterial" title="Permalink to this equation">¶</a></span><img src="_images/math/7dc6081748a4429abaf0079983172cfb36ff12fe.png" alt="{P_{\rm{CAP}}} = \frac{{4\sigma \cos \theta }}{D}"/></p>
</div><p>where <img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> is the surface tension coefficient of the fluid, <img class="math" src="_images/math/a01767bfd5cd11a5df9711bef31674eb09d9516d.png" alt="\Theta" style="vertical-align: 0px"/>  is the
static contact angle of the fluid relative to the porous solid and <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is
the average pore diameter. The most accurate method of determining
<img class="math" src="_images/math/ec81be8e702af0cf6017c2b9b64d9b9bfc4f3ef2.png" alt="P_{\rm{CAP}}" style="vertical-align: -3px"/> is experimentally through the use of laboratory apparatus.</p>
<p>The capillary pressure represented by
Eq. <a class="reference internal" href="#equation-staticcontactangletoporousmaterial">(229)</a> is applied to the liquid/gas
interface (cells where the fluid fraction is less than 1.0 and greater than
0.0).</p>
</div>
</div>
<div class="section" id="unsaturated-porous-media">
<span id="unsaturatedflowporousmediath"></span><span id="index-163"></span><h4>Unsaturated Porous Media<a class="headerlink" href="#unsaturated-porous-media" title="Permalink to this headline">¶</a></h4>
<p>The unsaturated porous media model is designed to simulate two phases (usually
liquid and gas) which intermingle to varying degrees throughout the porous
medium. Therefore, the fluid fraction (akin to saturation, the local volume
fraction of the pore space occupied by liquid) varies throughout. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the
Volume-of-Fluid technique (VOF) is used to track this fluid fraction, <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>.</p>
<p>The drag is a function of the saturation because there is more flow resistance
within a porous material where there are two phases than a single phase. This is
due to the many small bubbles which are difficult to dislodge because of the
strong surface tension effects at small scales.</p>
<span class="target" id="index-164"></span></div>
<div class="section" id="drag-calculations-in-unsaturated-flows">
<span id="dragcalculationsinunsaturatedflowsth"></span><span id="index-165"></span><h4>Drag Calculations in Unsaturated Flows<a class="headerlink" href="#drag-calculations-in-unsaturated-flows" title="Permalink to this headline">¶</a></h4>
<p>Drag losses in unsaturated porous components, like capillary pressure effects,
are primarily a function of saturation, as well as intrinsic characteristics
of the media like pore size, tortuosity, and microscopic geometry.</p>
<p>Three drag models for unsaturated flow have been incorporated into <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>.</p>
<span class="target" id="index-166"></span><div class="section" id="power-law-unsaturated-drag-model">
<span id="powerlawdragth"></span><span id="index-167"></span><h5>Power Law Unsaturated Drag Model<a class="headerlink" href="#power-law-unsaturated-drag-model" title="Permalink to this headline">¶</a></h5>
<p>The simplest of the unsaturated drag models relates the drag coefficient
<img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> (described above) to a constant <span class="guilabel">Drag Coefficient A</span> and
a power-law relation to saturation via <span class="guilabel">Drag Coefficient B</span>:</p>
<div class="math" id="equation-powerlawmodel">
<p><span class="eqno">(230)<a class="headerlink" href="#equation-powerlawmodel" title="Permalink to this equation">¶</a></span><img src="_images/math/d65826b28381004f527363255c42af22dff616eb.png" alt="{F_d} = A \cdot S_e^{ - B}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/358695c21929026e3978a87b20230517725436b0.png" alt="B" style="vertical-align: 0px"/> is the empirically-determined parameter <span class="guilabel">Drag Coefficient B</span> and describes
the saturation relation, and it can be shown that <img class="math" src="_images/math/358695c21929026e3978a87b20230517725436b0.png" alt="B" style="vertical-align: 0px"/> = 3.0 theoretically represents a close-packed bed of uniform pore size, and</li>
<li><img class="math" src="_images/math/9d29d6445fd61abc5c4f51a4377e59e1732dc89b.png" alt="S_e" style="vertical-align: -3px"/> is the effective saturation of the porous material. The saturation <img class="math" src="_images/math/9d29d6445fd61abc5c4f51a4377e59e1732dc89b.png" alt="S_e" style="vertical-align: -3px"/> is computed from:</li>
</ul>
<div class="math" id="equation-powerlawmodelsaturations">
<p><span class="eqno">(231)<a class="headerlink" href="#equation-powerlawmodelsaturations" title="Permalink to this equation">¶</a></span><img src="_images/math/fce82cb3e35ec4bdd6dbf6af2b0b3dea6998c0db.png" alt="S_e = \frac{{F - {F_{\rm{CMN}}}}}{{{F_{\rm{CMX}}} - {F_{\rm{CMN}}}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is the fluid fraction within the control volume,</li>
<li><img class="math" src="_images/math/49c713678806361705a6d3923d3444446e54da1b.png" alt="F_{\rm{CMN}}" style="vertical-align: -3px"/> is the irreducible saturation and</li>
<li><img class="math" src="_images/math/60db375feb8cf625aa2adc29f8053549fb8a1086.png" alt="F_{\rm{CMX}}" style="vertical-align: -3px"/> is the maximum saturation limit for the porous medium.</li>
<li><img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is the <span class="guilabel">Drag Coefficient A</span> and describes the drag when the media is fully saturated (units of inverse time), and can be empirically estimated as:</li>
</ul>
<div class="math">
<p><img src="_images/math/a964ae8cef413e0ea7bf668d712e3af53baaa94a.png" alt="A = \frac{{\alpha \mu {{\left( {1 - \phi} \right)}^2}}}{{\rho \phi^2 d_{particle}^2}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> is a constant that typically has a value around 180 (150 is correct for the Ergun equation for randomly-packed spheres), and</li>
<li><img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> is the porosity of the porous material.</li>
</ul>
<p>There is evidence that the relation to drag also follows hysteresis in the same
way as capillary pressure; in this simplified power-law model, the uncertainties
of the hysteresis effect are ignored.</p>
<span class="target" id="index-168"></span></div>
<div class="section" id="exponential-unsaturated-drag-model">
<span id="exponentialunsaturateddragmodelth"></span><span id="index-169"></span><h5>Exponential Unsaturated Drag Model<a class="headerlink" href="#exponential-unsaturated-drag-model" title="Permalink to this headline">¶</a></h5>
<p>More physically descriptive than the power-law model, the exponential model
uses the following relation between the drag coefficient <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> and the
cell fluid fraction <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>:</p>
<div class="math">
<p><img src="_images/math/2a4b68ac1f9f0fb9a6565a7dd646cf56a10c6cf6.png" alt="F_d = \frac{F}{F - F_{CMN} } \cdot A \cdot S_e^{ - P_{exp}} \cdot e^{B \left( {1 - S_e} \right)}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> is the drag coefficient (described above),</li>
<li><img class="math" src="_images/math/4f46b7362cc76411bba8801b667533bb93ce9e91.png" alt="F_{CMN}" style="vertical-align: -3px"/> is the <span class="guilabel">Minimum Saturation</span>,</li>
<li><img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is the <span class="guilabel">Drag Coefficient A</span>,</li>
<li><img class="math" src="_images/math/a4b4f4e277b3917b8d26f652741fac5502202554.png" alt="P_{exp}" style="vertical-align: -6px"/> is the <span class="guilabel">Pressure Curve Fitting Coefficient</span>, and</li>
<li><img class="math" src="_images/math/358695c21929026e3978a87b20230517725436b0.png" alt="B" style="vertical-align: 0px"/> is the <span class="guilabel">Drag Coefficient B</span>.</li>
</ul>
<p>Choose values of <span class="guilabel">Minimum Saturation</span>, <span class="guilabel">Pressure Curve
Fitting Coefficient</span>, and <span class="guilabel">Drag Coefficient B</span> to fit to known
permeability data, and the <span class="guilabel">Drag Coefficient A</span> (units of inverse
time) can be estimated using</p>
<div class="math">
<p><img src="_images/math/a964ae8cef413e0ea7bf668d712e3af53baaa94a.png" alt="A = \frac{{\alpha \mu {{\left( {1 - \phi} \right)}^2}}}{{\rho \phi^2 d_{particle}^2}}"/></p>
</div><span class="target" id="index-170"></span></div>
<div class="section" id="mualem-s-unsaturated-drag-model-for-relative-permeability">
<span id="mualemsunsatdragmodelrelativepermeabilityth"></span><span id="index-171"></span><h5>Mualem’s Unsaturated Drag Model for Relative Permeability<a class="headerlink" href="#mualem-s-unsaturated-drag-model-for-relative-permeability" title="Permalink to this headline">¶</a></h5>
<p>This model has a strong experimental basis and defines permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> as
the product of the saturated permeability <img class="math" src="_images/math/4f059974131bd44f22a1ca2e2fdfa4194d6e06da.png" alt="K_0" style="vertical-align: -3px"/> (units of area) and a
relative permeability <img class="math" src="_images/math/4f65385dd4945fab8b6432ea1f2255c38a13eedc.png" alt="K_r" style="vertical-align: -3px"/> (dimensionless):</p>
<div class="math">
<p><img src="_images/math/9f102cee54d3e75f8cf1ec272bacbfb675705149.png" alt="K = {K_0} \cdot {K_r}"/></p>
</div><p><img class="math" src="_images/math/4f65385dd4945fab8b6432ea1f2255c38a13eedc.png" alt="K_r" style="vertical-align: -3px"/> is defined as a function of effective saturation <img class="math" src="_images/math/9d29d6445fd61abc5c4f51a4377e59e1732dc89b.png" alt="S_e" style="vertical-align: -3px"/> (defined above)
and the dimensionless parameter <img class="math" src="_images/math/358695c21929026e3978a87b20230517725436b0.png" alt="B" style="vertical-align: 0px"/> (<span class="guilabel">Drag Coefficient B</span>):</p>
<div class="math">
<p><img src="_images/math/b2d15f28a2ba26bee2d74f1a2360c85d1639903a.png" alt="K_r = \sqrt {S_e} {\left[ {1 - {{\left( 1 - S_e^{\frac{1}{B}} \right)}^B}} \right]^2}."/></p>
</div><p>All porous drag models in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> relate permeability <img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/> to a calculated
drag function <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/>:</p>
<div class="math">
<p><img src="_images/math/28a19e148f086e73191844d6297398e64a264d70.png" alt="K = \frac{{\phi \mu }}{{\rho {F_d}}}."/></p>
</div><p>In this model, <img class="math" src="_images/math/4f059974131bd44f22a1ca2e2fdfa4194d6e06da.png" alt="K_0" style="vertical-align: -3px"/>, the saturated permeability is set by the reciprocal of the
<span class="guilabel">Drag Coefficient A</span> (represented by <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> below):</p>
<div class="math">
<p><img src="_images/math/dea1d5021525cac60588c7b2d7ff7bb7fb252a58.png" alt="K_0 = \frac{{\phi \mu }}{{\rho A}}."/></p>
</div><p>The resulting drag coefficient <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> is:</p>
<div class="math">
<p><img src="_images/math/0a30daea2a0e5fff10acc2d24d3c9b5647c2d5e7.png" alt="{F_d} = { \frac{A}{\sqrt {S_e} {{\left[ {1 - {{\left( {1 - S_e^{\frac{1}{{B}}}} \right)}^{B}}} \right]}^2}}}"/></p>
</div></div>
</div>
<div class="section" id="capillary-pressure-in-unsaturated-flows">
<span id="capillarypressureinunsaturatedflowsth"></span><span id="index-172"></span><h4>Capillary Pressure in Unsaturated Flows<a class="headerlink" href="#capillary-pressure-in-unsaturated-flows" title="Permalink to this headline">¶</a></h4>
<p>The capillary pressure model in porous media can be used only in one-fluid,
free-surface flows. There are two models that describe the relationship
between saturation and capillary pressure: the <span class="guilabel">Simplified capillary
pressure</span> model and a more thorough <span class="guilabel">Van Genuchten capillary pressure</span>
model <a class="reference internal" href="zbibliography.html#niemi-bodvarsson-1988" id="id18">[NB88]</a>.</p>
<span class="target" id="index-173"></span><div class="section" id="simplified-unsaturated-capillary-pressure-model">
<span id="simplifiedunsaturatedcappressmodelth"></span><span id="index-174"></span><h5>Simplified Unsaturated Capillary Pressure Model<a class="headerlink" href="#simplified-unsaturated-capillary-pressure-model" title="Permalink to this headline">¶</a></h5>
<p>The capillary pressure is a function of the local saturation. In regions of
the medium where the saturation is low, there are multiple interfaces with a
high degree of curvature and a resulting very high capillary pressure.
Conversely, in saturated regions, there are few free surfaces and the capillary
pressure is near zero.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, there are two capillary pressure curves computed: one for when the
material is draining (i.e., the saturation is going down) and the other for when
the material is filling (i.e., the saturation is going up). The relationship
between capillary pressure and saturation is shown in the diagram below for
advancing flows (filling curve) and receding flows (draining curve).</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/draining-filling-curves.png"><img alt="Draining and Filling Curve" src="_images/draining-filling-curves.png" style="width: 4.1in;" /></a>
</div></blockquote>
<p>The draining curve is defined as</p>
<div class="math" id="equation-drainingcurve">
<p><span class="eqno">(232)<a class="headerlink" href="#equation-drainingcurve" title="Permalink to this equation">¶</a></span><img src="_images/math/dddd9b2a6f189c82b28b2258d44ce2579c5d83bc.png" alt="{P_{{\rm{CAP}},{\rm{DRAIN}}}} = {P_{\rm{BUB}}}{S^{ - {P_{\exp }}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/7cd942197b396792d66e7f4f085bb2024eac2579.png" alt="P_{\rm{BUB}}" style="vertical-align: -3px"/> is the maximum capillary pressure at saturation condition <img class="math" src="_images/math/76eb1a141a3e1a33d29a26a6118e66e15ed94d50.png" alt="F = F_{\rm{CPMX}}" style="vertical-align: -3px"/> and</li>
<li><img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> is the saturation.</li>
</ul>
<p>The bubbling pressure, <img class="math" src="_images/math/7cd942197b396792d66e7f4f085bb2024eac2579.png" alt="P_{\rm{BUB}}" style="vertical-align: -3px"/>, is defined as</p>
<div class="math" id="equation-bubblingpressure">
<p><span class="eqno">(233)<a class="headerlink" href="#equation-bubblingpressure" title="Permalink to this equation">¶</a></span><img src="_images/math/c3fbbbaeddb56eef3e0b015521c6ae2a37e92357.png" alt="{P_{\rm{BUB}}} = {P_{\rm{PCMX}}}{\left( {\frac{{{F_{\rm{PCMX}}} - {F_{\rm{CMN}}}}}{{{F_{\rm{CMX}}} - {F_{\rm{CMN}}}}}} \right)^{{P_{\exp }}}}"/></p>
</div><p>The filling curve is defined as</p>
<div class="math" id="equation-fillingcurve">
<p><span class="eqno">(234)<a class="headerlink" href="#equation-fillingcurve" title="Permalink to this equation">¶</a></span><img src="_images/math/d9b8c90b75a851f5476972fe76c9b10178adaa9f.png" alt="{P_{{\rm{CAP}},{\rm{FILL}}}} = {P_{\rm{BUB}}}({S^{ - {P_{\exp }}}} - 1)"/></p>
</div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The filling and draining curves are always equidistant and separated by the
value of bubbling pressure.</p>
</div>
<span class="target" id="index-175"></span><div class="section" id="transition-between-draining-and-filling-curves">
<span id="drainingfillingcurvesth"></span><span id="index-176"></span><h6>Transition between Draining and Filling Curves<a class="headerlink" href="#transition-between-draining-and-filling-curves" title="Permalink to this headline">¶</a></h6>
<p>When a local region of the material switches between filling to draining (or
vice versa), the capillary pressure follows a scanning curve between the curves.
The slope of this scanning curve is computed from the local slope of the
draining curve, plus 10 times the local difference between the target curve
(either draining or filling) and the locally computed pressure until the
scanning curve intersects the target curve.</p>
<p>If a simulation is expected to involve only the filling or draining of a region,
then it is only necessary to specify the appropriate capillary
pressure-versus-saturation curve. However, when there are alternating filling and draining
transients, then both curves must be considered and some means must be provided
to numerically transition between these processes. Experimentally it is observed
that the transition occurs along a “scanning” curve. This curve must have a
slope that is larger than the slopes of the filling and draining curves,
otherwise it would not be possible to pass between them. Because no experimental
data has been found for guidance, we have arbitrarily set the slope of the
scanning curve. We use a value equal to the slope of the draining curve at the
current value of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> plus an additional slope computed as the difference
between the filling and draining curve pressures at saturation <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> divided
by a change in saturation of 0.1.</p>
<p>When evaluating <img class="math" src="_images/math/ec81be8e702af0cf6017c2b9b64d9b9bfc4f3ef2.png" alt="P_{\rm{CAP}}" style="vertical-align: -3px"/>, which is done in the user-accessible subroutine
<strong class="program">pcapcl</strong>, a first guess for the new capillary pressure at time step <img class="math" src="_images/math/b58a6e67def83a6a714de5895b3b56c336397c23.png" alt="n+1" style="vertical-align: -2px"/> is
obtained from the previous time-step value by assuming a variation along the
scanning curve:</p>
<div class="math" id="equation-subroutinepcapclf">
<p><span class="eqno">(235)<a class="headerlink" href="#equation-subroutinepcapclf" title="Permalink to this equation">¶</a></span><img src="_images/math/0e0256a5048f675007e60c0cd7c87e06169d20be.png" alt="P_{\rm{CAP}}^{n + 1} = P_{\rm{CAP}}^n + \frac{{d{P_{\rm{CAP}}}}}{{dF}}\left( {{F^{n + 1}} - {F^n}} \right)"/></p>
</div><p>where <img class="math" src="_images/math/c8cf25966161319e06bda83d5ea1ecff673d29b0.png" alt="d{P_{\rm{CAP}}}/dF" style="vertical-align: -5px"/> is the slope of the scanning curve at the
current saturation. The new value is then tested against the filling and
draining curve values <img class="math" src="_images/math/f796930b05ea33a237bba0cbb50fc11c7565754e.png" alt="P_{{\rm{CAP}},{\rm{FILL}}}" style="vertical-align: -6px"/> and
<img class="math" src="_images/math/e7ae674ce1d9e8f02f0c515d7deebcd58a6ab4ed.png" alt="P_{{\rm{CAP}},{\rm{DRAIN}}}" style="vertical-align: -6px"/> such that:</p>
<div class="math" id="equation-testingagainstfillinganddrainingvalues">
<p><span class="eqno">(236)<a class="headerlink" href="#equation-testingagainstfillinganddrainingvalues" title="Permalink to this equation">¶</a></span><img src="_images/math/e080e2586ad414e8b5faf6004559cf1d3c73601f.png" alt="\begin{gathered}
P_{\rm{CAP}}^{n + 1} = \max (P_{\rm{CAP}}^{n + 1},{P_{{\rm{CAP}},{\rm{FILL}}}}) \hfill \\
\\
P_{\rm{CAP}}^{n + 1} = \max (P_{\rm{CAP}}^{n + 1},{P_{{\rm{CAP}},{\rm{DRAIN}}}}) \hfill \\
\end{gathered}"/></p>
</div><p>These tests ensure that the capillary pressure is between the limits imposed by the
two curves, or in the case of only one curve, maintain <img class="math" src="_images/math/ec81be8e702af0cf6017c2b9b64d9b9bfc4f3ef2.png" alt="P_{\rm{CAP}}" style="vertical-align: -3px"/> on that
curve. This behavior can be customized by modifying the subroutine <strong class="program">pcapcl</strong>.</p>
<span class="target" id="index-177"></span></div>
</div>
<div class="section" id="van-genuchten-unsaturated-capillary-pressure-model">
<span id="vangenuchtenunsaturatedcappressmodelth"></span><span id="index-178"></span><h5>Van Genuchten Unsaturated Capillary Pressure Model<a class="headerlink" href="#van-genuchten-unsaturated-capillary-pressure-model" title="Permalink to this headline">¶</a></h5>
<p>A more physical form of the complex relationship between saturation, capillary
pressure, and draining/wetting state of the fluid is provided by the <span class="guilabel">Van
Genuchten capillary pressure</span> model illustrated below, with arrows showing the
state path for a series of changes in wetting direction:</p>
<blockquote>
<div><img alt="Van Genuchten Capillary Pressure Model Hysteresis" src="_images/flow-in-porous-components-van-genuchten-capillary-pressure.jpg" />
</div></blockquote>
<p>The numbers on the plot are from a typical saturation path with a porous
material, which proceeds as follows:</p>
<ol class="arabic simple">
<li>Begin draining from saturated media. Capillary pressure follows envelope.</li>
<li>Reverse to filling. Capillary pressure follows 1st-order filling scanning curve.</li>
<li>Reverse to draining. Capillary pressure follows 2nd-order draining scanning curve.</li>
<li>Continue draining. Capillary pressure follows draining envelope.</li>
<li>Minimum absolute saturation. Begin filling. Capillary pressure follows envelope.</li>
<li>Reverse to draining. Capillary pressure follows 1st-order draining scanning curve.</li>
<li>Reverse to filling. Capillary pressure follows 2nd-order filling scanning curve.</li>
<li>Reverse to draining. Capillary pressure follows 3rd-order draining scanning curve.</li>
<li>Finish experiment.</li>
</ol>
<p>The primary wetting and draining curves define the envelope of the capillary
pressure for each porous media-liquid system. If the process switches between
wetting and draining before filling or draining is complete, the capillary
pressure follows scanning curves inside the envelope. There are an infinite
number of wetting and draining scanning curves within the envelope, and the
actual curve depends on the local saturation and capillary pressure when the
reversal occurs. The model detailed by <a class="reference internal" href="zbibliography.html#niemi-bodvarsson-1988" id="id19">[NB88]</a> has been
enhanced to include the first-order draining and second-order wetting
scanning curves.</p>
<div class="math">
<p><img src="_images/math/f19920d6ae31d1a4752e614317fc7b7ca041c696.png" alt="p_{cap,wet} &amp;= \alpha_w \left[ \left( \frac{1}{S_e} \right)^{\frac{1}{m_w}} - 1 \right]^{\frac{1}{n_w}} \\

p_{cap,drain} &amp;= \alpha_d \left[ \left( \frac{1}{S_e} \right)^{\frac{1}{m_d}} - 1 \right]^{\frac{1}{n_d}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/4f4423270d687f7e948cfe3e4db69beb2da93dab.png" alt="p_{cap,wet}" style="vertical-align: -6px"/> is the wetting capillary pressure</li>
<li><img class="math" src="_images/math/1fa2ab50f791384248917ce9dbf618771c33b3d5.png" alt="\alpha_w" style="vertical-align: -3px"/> is the <span class="guilabel">Wetting Curve Alpha Coefficient</span> in units of pressure: you may need to convert literature values that are in units of inverse length (head)</li>
<li><img class="math" src="_images/math/68cd2c2647bf64a6eb7d71e4c17bb4a6cf657318.png" alt="m_w" style="vertical-align: -3px"/> is the <span class="guilabel">Wetting Curve m-exponent</span>, for soils often assumed to be <img class="math" src="_images/math/f3681ed3ba63ef79f8add10b3c7a958ab6524455.png" alt="1 - \frac{1}{n_w}" style="vertical-align: -8px"/></li>
<li><img class="math" src="_images/math/b88e30a4aa4ffa8bdec0deae1c60ef2d44bb16f6.png" alt="n_w" style="vertical-align: -3px"/> is the <span class="guilabel">Wetting Curve n-exponent</span></li>
<li><img class="math" src="_images/math/72bded1c791a65835b01395389b45b769e57ce33.png" alt="p_{cap,drain}" style="vertical-align: -6px"/> is the draining capillary pressure</li>
<li><img class="math" src="_images/math/a023ff8e7de5b327aca8c69468a8d24b207f6f3f.png" alt="\alpha_d" style="vertical-align: -3px"/> is the <span class="guilabel">Draining Curve Alpha Coefficient</span> in units of pressure like <img class="math" src="_images/math/1fa2ab50f791384248917ce9dbf618771c33b3d5.png" alt="\alpha_w" style="vertical-align: -3px"/> and in soils is often assumed to equal <img class="math" src="_images/math/1fa2ab50f791384248917ce9dbf618771c33b3d5.png" alt="\alpha_w" style="vertical-align: -3px"/></li>
<li><img class="math" src="_images/math/88b017891831682e9fba5563c50b5617b7f3d572.png" alt="m_d" style="vertical-align: -3px"/> is the <span class="guilabel">Draining Curve m-exponent</span>, for soils often assumed to be <img class="math" src="_images/math/5114fe41776a22737ea9c857d858b45ab75a1587.png" alt="1 - \frac{1}{n_d}" style="vertical-align: -8px"/></li>
<li><img class="math" src="_images/math/440b255bf2f86aaa61e774c8a6a7ff6b02cc3554.png" alt="n_d" style="vertical-align: -3px"/> is the <span class="guilabel">Draining Curve n-exponent</span>, for soils often assumed to equal <img class="math" src="_images/math/b88e30a4aa4ffa8bdec0deae1c60ef2d44bb16f6.png" alt="n_w" style="vertical-align: -3px"/></li>
</ul>
<p>The curves should be defined from experimental data and curve-fit using the
equations above. The first-, second-, and higher-order draining curves define
intermediate capillary pressure vs. saturation paths depending on whether the
direction of flow has reversed once, twice, or more than twice. The scanning
curve shapes are set by the primary curve parameters, which should be
determined experimentally.</p>
</div>
</div>
</div>
<div class="section" id="rigid-body-dynamics-for-non-inertial-reference-frame">
<span id="rigidbodydynamicsnirfth"></span><span id="index-179"></span><h3>Rigid Body Dynamics for Non-Inertial Reference Frame<a class="headerlink" href="#rigid-body-dynamics-for-non-inertial-reference-frame" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we are interested in the flow of fluids within rigid bodies whose
motion is itself influenced by the dynamics of the fluid. In such cases, one may
apply the coupled rigid body dynamics model, integrated into <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, to predict
the combined motion of the rigid body and the associated fluid.</p>
<p>We shall consider the evaluation of the motion of a rigid body relative to
inertial space. Furthermore, we shall suppose that the body contains internal
cavities (tanks) which may be partially filled with fluid. We wish to simulate
the motion of the rigid-body center of mass, its rotation (attitude) and the
motion of the fluid in its tanks. The simulation is to predict these attributes
as time progresses. Evaluation of the fluid motion and the resulting forces and
torques are performed with the usual <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> algorithms, allowing inclusion of a
wide variety of physical phenomena.</p>
<div class="figure" id="id119">
<span id="inertialandbodyfixedcoordinates"></span><img alt="Inertial and body-fixed coordinates" src="_images/inertial-and-body-fixed-coordinates.png" />
<p class="caption"><span class="caption-text">Figure 10: Inertial and body-fixed coordinates</span></p>
</div>
<p>To perform this simulation, we define both inertial and body-fixed reference
frames, as shown in the figure above. We label the Cartesian coordinates fixed
in the rigid body as (<em>x</em>, <em>y</em>, <em>z</em>) and those fixed in inertial space
as (<em>x’</em>, <em>y’</em>, <em>z’</em>). The fluid dynamics calculation uses the body-fixed
coordinates as usual. Newton’s equation for the location of the rigid-body
center of mass is solved in the inertial reference frame, but the equations
for the rotation of the body are formulated in body-fixed coordinates.</p>
<p>We also define a gravitating-body reference frame, the origin of which coincides
with that of the inertial coordinate system but which may rotate at a constant
rate about the <em>z’</em> axis. We use a spherical coordinate system for this
reference frame to reduce confusion. This reference frame is not used in the
formulation of the equations of motion. It is intended as a convenience for the
user, directly relating the computed results to an earth (or solar) based
system.  It should be kept in mind that an earth-based reference frame is
only approximately inertial. Corrections to this approximation can be
implemented elsewhere in the solution algorithm if necessary.</p>
<p>The effect of the gravitational force emanating from this body is included in
the rigid-body motion equations and the fluid motion equations. Torques
resulting from the gravitational field have been ignored.</p>
<p>Provision has been made for the inclusion of both environmental and control
forces and torques. This is accomplished by including subprograms that can
easily communicate with the other portions of the solution algorithm. These
subprograms do not model specific sources of force and torque but are available
for the user to include such phenomena as aerodynamic and geomagnetic effects or
control jets and/or flywheels.</p>
<p>Sometimes more than one tank may influence the motion of the rigid body. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
can account for this by treating each tank as an independent flow region (or
component). The fluid forces and torques are then summed over all components to
determine their effect on the rigid body.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#nirfth"><span class="std std-ref">Non-Inertial Reference Frame</span></a> notation</li>
<li><a class="reference internal" href="#rigidbodydynamicsalgorithmth"><span class="std std-ref">Rigid Body Dynamics Algorithm for Non-Inertial Reference Frame Model</span></a></li>
<li><a class="reference internal" href="#noninertialreferenceframeth"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a> equations</li>
<li><a class="reference internal" href="#rigidbodydynamicsnirfth"><span class="std std-ref">Rigid Body Dynamics for Non-Inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#centrifugalcastingmr"><span class="std std-ref">Non-inertial reference frame application example:  Centrifugal Casting</span></a></li>
<li><a class="reference internal" href="model-reference.html#gravitysectionmr"><span class="std std-ref">Gravity</span></a></li>
<li><a class="reference internal" href="model-reference.html#impulsivemotionmr"><span class="std std-ref">Impulsive Motion of Non-inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#noninertialreferenceframemotionmr"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a></li>
<li><a class="reference internal" href="model-reference.html#smoothtabularmotionmr"><span class="std std-ref">Smooth Tabular Motion</span></a></li>
</ul>
</div>
<span class="target" id="index-180"></span><span class="target" id="index-181"></span></div>
<div class="section" id="sediment-scour-model">
<span id="sedimentscourmodelth"></span><span id="index-182"></span><h3>Sediment Scour Model<a class="headerlink" href="#sediment-scour-model" title="Permalink to this headline">¶</a></h3>
<p>The sediment scour model assumes multiple non-cohesive sediment species with different properties including grain size, mass density, critical shear stress, angle of repose and parameters for entrainment and transport. For example, medium sand, coarse sand and fine gravel can be categorize into three different species in a simulation. The model is applicable for both 3D and shallow water flows.
It estimates the motion of sediment by predicting the
erosion, advection and deposition of sediment. It does so by:</p>
<ul class="simple">
<li>Computing the suspended sediment transport.</li>
<li>Computing the settling of sediment due to gravity.</li>
<li>Computing the entrainment of the sediment due to bed shearing and flow perturbations.</li>
<li>Computing the bed-load transport, whereby sediment grains roll, hop or slide along the packed sediment bed.</li>
</ul>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> this is done by considering two states in which sediment can exist:
suspended and packed sediment. Suspended sediment is typically of low
concentration and advects with fluid flow. Packed sediment exists at the critical packing fraction which can
be defined by the user (default value is 0.64). Only a thin surface layer of grains
of the packed sediment (in the thickness
of a few grain diameters) can move in the form of bed-load transport.</p>
<p>Sediment is entrained by the picking up and re-suspension due
to shearing and small eddies at the packed sediment interface. Because it is not
possible to compute the flow dynamics about each individual grain of sediment,
an empirical model must be used. The model used here is based on Mastbergen and
Van den Berg <a class="reference internal" href="zbibliography.html#mastbergen-vandenberg-2003" id="id20">[MVanDBerg03]</a>. Also, the Soulsby-Whitehouse
equation <a class="reference internal" href="zbibliography.html#soulsby-1997" id="id21">[Sou97]</a> can be used to predict the critical Shields parameter, or a
user-defined parameter can be specified. By default, the critical Shields parameter is 0.05.
The first step to computing the
critical Shields parameter is calculating the dimensionless parameter
<img class="math" src="_images/math/b957f61365b158f56646da80e1fe4b28f5e53cb5.png" alt="d_i^*" style="vertical-align: -5px"/>:</p>
<div class="math" id="equation-dimensionlessparameterdistar">
<p><span class="eqno">(237)<a class="headerlink" href="#equation-dimensionlessparameterdistar" title="Permalink to this equation">¶</a></span><img src="_images/math/8c1c8fbc951b0ad0ba1f12532e6587edbc5b5998.png" alt="{d_{*,i}} = {d_i}{\left[ {\frac{{{\rho _f}\left( {{\rho _i} - {\rho _f}} \right)\left\| {\mathbf{g}} \right\|}}{{{\mu_f ^2}}}} \right]^{\frac{1}{3}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/9784c57dc7d2cb9a6bd91aea19cc60d9aa27e248.png" alt="\rho _i" style="vertical-align: -4px"/> is the density of the sediment species <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>,</li>
<li><img class="math" src="_images/math/5c826843f057fc92c57aa6171c818c272b33ec3a.png" alt="\rho _f" style="vertical-align: -6px"/> is the fluid density.</li>
<li><img class="math" src="_images/math/75c2e5e0bd10223333af6b116c85280d37f30a11.png" alt="d_i" style="vertical-align: -3px"/> is the diameter.</li>
<li><img class="math" src="_images/math/5d93efb843a0a66f0d4a373f04e7adf70769d9d6.png" alt="\mu _f" style="vertical-align: -6px"/> is the dynamic viscosity of fluid.</li>
<li><img class="math" src="_images/math/204f336337d2bf7d2c641097df00bebd8d25a943.png" alt="\left\| {\mathbf{g}} \right\|" style="vertical-align: -5px"/> is the magnitude of the acceleration of gravity <img class="math" src="_images/math/649d529d718bc6af1e8de2faa5cf2a656a0ff5ec.png" alt="\mathbf g" style="vertical-align: -4px"/>.</li>
</ul>
<p>From this, the dimensionless critical Shields parameter is computed using
the Soulsby-Whitehouse equation <a class="reference internal" href="zbibliography.html#soulsby-1997" id="id22">[Sou97]</a>:</p>
<div class="math" id="equation-soulsby-whitehouseequation">
<p><span class="eqno">(238)<a class="headerlink" href="#equation-soulsby-whitehouseequation" title="Permalink to this equation">¶</a></span><img src="_images/math/f0b563dff46e31cc2b5849ed546cb8f834e06ce4.png" alt="{\theta _{{\rm{cr}},i}} = \frac{0.3}{1+1.2d_{*,i}} + 0.055\left[ {1 - \exp \left(  -0.02 d_{*,i} \right)} \right]"/></p>
</div><p>The critical Shields parameter can be modified for sloping surfaces to
include the angle of repose. The idea here is that at sloping interfaces, the
packed sediment is less stable and is thus more easily entrained by
fluid moving down the slope. The modification further alters <img class="math" src="_images/math/fc75ee637b57a97189f5b4cc181a5985c7b8aa1e.png" alt="{\theta_{{\rm{cr}},i}}" style="vertical-align: -6px"/>
<a class="reference internal" href="zbibliography.html#soulsby-1997" id="id23">[Sou97]</a>:</p>
<div class="math" id="equation-shieldsparametermodifiedforslopingsurfacesincludeangleofrepose">
<p><span class="eqno">(239)<a class="headerlink" href="#equation-shieldsparametermodifiedforslopingsurfacesincludeangleofrepose" title="Permalink to this equation">¶</a></span><img src="_images/math/18f863332884efd002cd4e290037928e43e903f7.png" alt="\theta '_{{\rm{cr}},i} = \theta _{{\rm{cr}},i}\frac{{\cos \psi \sin \beta  + \sqrt {{{\cos }^2}\beta {{\tan }^2}{\varphi _i} - {{\sin }^2}\psi {{\sin }^2}\beta } }}{{\tan {\varphi _i}}}"/></p>
</div><p>where <img class="math" src="_images/math/58f961270cf905208364b40799bc1ab9d5b3ed34.png" alt="\beta" style="vertical-align: -4px"/> is the angle of slope of bed, <img class="math" src="_images/math/a8fb4f6da8b547d91ff79c050145c03ac62a1415.png" alt="\varphi _i" style="vertical-align: -4px"/> is the user-defined angle of
repose for sediment species <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> (default is <img class="math" src="_images/math/7a5c3ae6682bdea5c717d0fea413a024e4adc3bb.png" alt="32^\circ" style="vertical-align: 0px"/>), and <img class="math" src="_images/math/22e7bbdc5bdeef74134a5feb0a44f7269c104e83.png" alt="\psi" style="vertical-align: -4px"/> is the angle between the flow
and the upslope direction. For flow directly up a slope <img class="math" src="_images/math/e9570a0522f2f45e095a422f56042cacddb22a27.png" alt="\psi
= 0^\circ" style="vertical-align: -4px"/>.</p>
<p>The local Shields parameter is computed based on the local bed shear stress, <img class="math" src="_images/math/79aedd36af08713ce51192cbfb62fb1531326f1a.png" alt="\tau" style="vertical-align: 0px"/>:</p>
<div class="math" id="equation-localshieldsnumber">
<p><span class="eqno">(240)<a class="headerlink" href="#equation-localshieldsnumber" title="Permalink to this equation">¶</a></span><img src="_images/math/ee578a049cd2af52ac5097f602569678a51f692f.png" alt="{\theta _i} = \frac{\tau }{{\left\| {\mathbf{g}} \right\|{d_i}({\rho _i} - {\rho _f})}}"/></p>
</div><p>where <img class="math" src="_images/math/79aedd36af08713ce51192cbfb62fb1531326f1a.png" alt="\tau" style="vertical-align: 0px"/> is calculated using the law of the wall and the quadratic law of bottom shear stress for 3D
turbulent flow and shallow water turbulent flow, respectively, with consideration of bed surface roughness.
It is assumed that the Nikuradse roughness of the bed surface <img class="math" src="_images/math/500ce2c31540c941a69d0af54e2b58eb9e4b25fd.png" alt="k_s" style="vertical-align: -3px"/> is proportional to the local median grain
diameter in packed sediment <img class="math" src="_images/math/23eba5d543b4b0f3db19f0f927c4ec0daabb1c98.png" alt="d_{50,\rm{packed}}" style="vertical-align: -6px"/>,</p>
<div class="math" id="equation-nikuradseroughness">
<p><span class="eqno">(241)<a class="headerlink" href="#equation-nikuradseroughness" title="Permalink to this equation">¶</a></span><img src="_images/math/99331ea88ea234df162ad97bdce558374cb7f2e9.png" alt="k_s=c_{\rm{rough}} d_{50,\rm{packed}}"/></p>
</div><p>where <img class="math" src="_images/math/d9d7a7e03faf025b9597b758340b6b1b248c5161.png" alt="c_{\rm{rough}}" style="vertical-align: -6px"/> is a user-defined coefficient with default value 2.5.</p>
<p>The entrainment lift velocity of sediment is then computed as
<a class="reference internal" href="zbibliography.html#mastbergen-vandenberg-2003" id="id24">[MVanDBerg03]</a>:</p>
<div class="math" id="equation-entrainmentliftvelocityofsediment">
<p><span class="eqno">(242)<a class="headerlink" href="#equation-entrainmentliftvelocityofsediment" title="Permalink to this equation">¶</a></span><img src="_images/math/2dbc1d68f82e4b85409aea7ee417b96211f4b6e8.png" alt="{{\mathbf{u}}_{{\rm{lift}},i}} = {\alpha _i}{{\mathbf{n}}_{\mathbf{s}}}d_*^{0.3}{\left( {{\theta _i} - {{\theta '}_{{\rm{cr}},i}}} \right)^{1.5}}\sqrt {\frac{{\left\| {\mathbf{g}} \right\|{d_i}\left( {{\rho _i} - {\rho _f}} \right)}}{{{\rho _f}}}}"/></p>
</div><p>where <img class="math" src="_images/math/3bce1c2934b8c266c9d4ea41f7c78afdf2c7a161.png" alt="\alpha _i" style="vertical-align: -3px"/> is the entrainment parameter, whose recommended value is
0.018 <a class="reference internal" href="zbibliography.html#mastbergen-vandenberg-2003" id="id25">[MVanDBerg03]</a>, and <img class="math" src="_images/math/ef0df3fe65b22a3334f54ded8bc6f6ffabaa2fd0.png" alt="\mathbf {n_s}" style="vertical-align: -3px"/> is the
outward pointing normal to the packed bed interface.
<img class="math" src="_images/math/7ba6018964aab2b54d5eecbd984b23ca48e2bbb4.png" alt="{{\mathbf{u}}_{{\rm{lift}},i}}" style="vertical-align: -6px"/> is then used to compute the amount of packed
sediment that is converted into suspension, effectively acting as a mass
source of suspended sediment at the packed bed interface. After that,
the sediment is transported with fluid flow.</p>
<p>Deposition is the process that the sediment grains either settle out of suspension onto packed bed
due to their weight or come to rest in bed-load transport.
Settling and entrainment of grains are opposite processes and often occur at the same time. The settling velocity equation proposed by Soulsby <a class="reference internal" href="zbibliography.html#soulsby-1997" id="id26">[Sou97]</a> is used:</p>
<div class="math" id="equation-settlingvelocity">
<p><span class="eqno">(243)<a class="headerlink" href="#equation-settlingvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/8c20a56244a3449211e1262dc0dd003765e7b51a.png" alt="{{u}_{{\rm{settling}},i}} = \frac {\nu_f}{d_i} \left[\left(10.36^2+1.049d^3_*\right)^{0.5}-10.36\right]"/></p>
</div><p>where <img class="math" src="_images/math/27d7430fe11e697ee2ec70c620f7f1b0ef3b3a88.png" alt="\nu_f" style="vertical-align: -6px"/> is the kinematic viscosity of fluid. It is assumed that the settling motion is in the gravity direction,</p>
<div class="math" id="equation-settlingvelocityvector">
<p><span class="eqno">(244)<a class="headerlink" href="#equation-settlingvelocityvector" title="Permalink to this equation">¶</a></span><img src="_images/math/9ea538ea814778215dd83cf1e3a7f16eb75d7b84.png" alt="{{\mathbf{u}}_{{\rm{settling}},i}} = {u_{{\rm{settling}},i}}\frac{{{\mathbf{g}}}}{{\left\| {{\mathbf{g}}} \right\|}}"/></p>
</div><p>To account for the particle-particle interactions, Richardson-Zaki”s correlation is applied to the settling velocity,</p>
<div class="math" id="equation-richardsonzaki">
<p><span class="eqno">(245)<a class="headerlink" href="#equation-richardsonzaki" title="Permalink to this equation">¶</a></span><img src="_images/math/593c1fa3d07967e2d641d7d9af8e31907a70c24e.png" alt="{{\mathbf{u}}_{{\rm{settling}},i}^*}= {{\mathbf{u}}_{{\rm{settling}},i}} {\left( {1 - min(0.5,c_s)} \right)^\zeta }"/></p>
</div><p>where <img class="math" src="_images/math/dadac531f3b3aaf21349c5d6cb6bbeed32fb8b88.png" alt="c_s" style="vertical-align: -3px"/> is the total volume fraction of suspended sediment. The exponent <img class="math" src="_images/math/641ac646152ce966fe12cc9c69c275954b47ab83.png" alt="\zeta" style="vertical-align: -4px"/> is</p>
<div class="math" id="equation-richardsonzakimmltiplier">
<p><span class="eqno">(246)<a class="headerlink" href="#equation-richardsonzakimmltiplier" title="Permalink to this equation">¶</a></span><img src="_images/math/42a61390cc32e5b42df2c74582d2844b5134ed7f.png" alt="{\zeta} = {\zeta _{{\text{user}}}}{\zeta _0}"/></p>
</div><p><img class="math" src="_images/math/3cebfc7fa96fe8f2bc204580c0d570a93b272fa7.png" alt="\zeta _{\text{user}}" style="vertical-align: -4px"/> is the Richardson-Zaki coefficient multiplier (default is 1.0),
and  <img class="math" src="_images/math/9628bdbabd75625e749f50b611587cb859842071.png" alt="\zeta _0" style="vertical-align: -4px"/> is the Richardson-Zaki coefficient defined by:</p>
<table border="1" class="colwidths-given longtable docutils" id="richardsonzakicoefficienttable2">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><th class="stub">Re &lt; 0.2</th>
<td><img class="math" src="_images/math/7f9b97abc3a8fc0d7ea81faf199c2f8b3a22732c.png" alt="{\zeta _0} = 4.35" style="vertical-align: -4px"/></td>
</tr>
<tr class="row-even"><th class="stub">0.2 &lt; Re &lt; 1.0</th>
<td><img class="math" src="_images/math/0e1809c1b52719916b71370a27b822c494104f9d.png" alt="{\zeta _0} = 4.35/{Re}^{0.03}" style="vertical-align: -5px"/></td>
</tr>
<tr class="row-odd"><th class="stub">1.0 &lt; Re &lt; 500</th>
<td><img class="math" src="_images/math/fbce196df8f8ae0371359151acc9414d893b84d2.png" alt="{\zeta _0} = 4.45/{Re}^{0.1}" style="vertical-align: -5px"/></td>
</tr>
<tr class="row-even"><th class="stub">500 &lt; Re</th>
<td><img class="math" src="_images/math/0888d9fad0cab515812744f48c4ec7c93ad0457c.png" alt="{\zeta _0} = 2.39" style="vertical-align: -4px"/></td>
</tr>
</tbody>
</table>
<p>Here <img class="math" src="_images/math/3a419aa9969c7e85e998e02252cd2897ba03d7b6.png" alt="Re" style="vertical-align: 0px"/> is the particle Reynolds number,</p>
<div class="math" id="equation-particlere">
<p><span class="eqno">(247)<a class="headerlink" href="#equation-particlere" title="Permalink to this equation">¶</a></span><img src="_images/math/3ec9f129dc35831acfce0537090f2a0a30c46bd0.png" alt="{Re} = {\frac{{d_i}{u_{\rm{settling},i}}}{\nu _f}}"/></p>
</div><p>Bed-load transport is the mode of sediment transport due to rolling or bouncing
over the surface of the packed bed of sediment. Users can choose one of the
three equations for volumetric transport rate of sediment per width of bed:</p>
<ul class="simple">
<li>Meyer, Peter and Müller  <a class="reference internal" href="zbibliography.html#meyer-peter-muller-1948" id="id27">[MPM48]</a></li>
</ul>
<div class="math" id="equation-bed-loadtransportmpm">
<p><span class="eqno">(248)<a class="headerlink" href="#equation-bed-loadtransportmpm" title="Permalink to this equation">¶</a></span><img src="_images/math/6b767d2dc79c2930eb1e0a7a5cfbca5049046dce.png" alt="{\Phi _i} = {\beta _{\rm{MPM},i}}{\left( {{\theta _i} - {{\theta '}_{{\rm{cr}},i}}} \right)^{1.5}} c_{b,i}"/></p>
</div><ul class="simple">
<li>Nielsen  <a class="reference internal" href="zbibliography.html#nielsen-1992" id="id28">[Nie92]</a></li>
</ul>
<div class="math" id="equation-bed-loadtransportnielsen">
<p><span class="eqno">(249)<a class="headerlink" href="#equation-bed-loadtransportnielsen" title="Permalink to this equation">¶</a></span><img src="_images/math/26fbd30de39e0ef226581eb5c09aa72cddfbee78.png" alt="{\Phi _i} = {\beta _{\rm{Nie},i}} {\theta _i}^{0.5} {\left( {{\theta _i} - {{\theta '}_{{\rm{cr}},i}}} \right)} c_{b,i}"/></p>
</div><ul class="simple">
<li>Van Rijn  <a class="reference internal" href="zbibliography.html#vanrijn-1984" id="id29">[vanRijn84]</a></li>
</ul>
<div class="math" id="equation-bed-loadtransportvanrijn">
<p><span class="eqno">(250)<a class="headerlink" href="#equation-bed-loadtransportvanrijn" title="Permalink to this equation">¶</a></span><img src="_images/math/4ab41f27df81581fd1cedb0615b7623a44d425be.png" alt="{\Phi _i} = {\beta _{\rm{VR},i}} {d _{*,i}}^{-0.3} {\left( {\frac{\theta _i} {{\theta '}_{{\rm{cr}},i}} -1.0} \right)^{2.1}} c_{b,i}"/></p>
</div><p>where <img class="math" src="_images/math/bf09cf9193929e431b10028f9280ae9ceb805309.png" alt="\beta _{\rm{MPM},i}" style="vertical-align: -6px"/>, <img class="math" src="_images/math/601e485a8462807cfe98a156dc754cf5fc882ca8.png" alt="\beta _{\rm{Nie},i}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/4896a9a3c477164289010b4cb6d70acc7fbb8f9a.png" alt="\beta _{\rm{VR},i}" style="vertical-align: -6px"/> are coefficients typically equal to 8.0, 12.0 and 0.053, respectively.  <img class="math" src="_images/math/901cf9c3a6c6ded5e1f931415c08b28ecae22bac.png" alt="c_{b,i}" style="vertical-align: -6px"/> is the volume fraction of species <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> in the bed material. It does not exist in the original equations but is added in Eq. <a class="reference internal" href="#equation-bed-loadtransportmpm">(248)</a>, <a class="reference internal" href="#equation-bed-loadtransportnielsen">(249)</a> and <a class="reference internal" href="#equation-bed-loadtransportvanrijn">(250)</a> to account for the effect of multiple species. <img class="math" src="_images/math/4fcc926539c4d9fb79ea4247b3e08472e27ebb07.png" alt="{\Phi _i}" style="vertical-align: -3px"/> is the dimensionless bed-load transport rate, and is
related to the volumetric bed-load transport rate, <img class="math" src="_images/math/a6a50fe76d47616e1e919d9e35e956c0aaedfb30.png" alt="q_{b,i}" style="vertical-align: -6px"/>,
by</p>
<div class="math" id="equation-volumetricbed-loadtranportrateperunitwidth">
<p><span class="eqno">(251)<a class="headerlink" href="#equation-volumetricbed-loadtranportrateperunitwidth" title="Permalink to this equation">¶</a></span><img src="_images/math/5edbf80afb2e8a764563dbe043a1fc4a807eec3f.png" alt="{q_{b,i}} = {\Phi _i}{\left[ {\left\| {\mathbf{g}} \right\|\left( {\frac{{{\rho _i} - {\rho _f}}}{{{\rho _f}}}} \right)d_i^3} \right]^{\frac{1}{2}}}"/></p>
</div><p>Equation <a class="reference internal" href="#equation-volumetricbed-loadtranportrateperunitwidth">(251)</a> computes the bed-load
transport rate in units of volume per bed width per time. Another piece of information
needed is an estimate of the bed-load thickness, i.e., the thickness of the
saltating sediment. The relationship chosen to estimate this thickness is
<a class="reference internal" href="zbibliography.html#vanrijn-1984" id="id30">[vanRijn84]</a>.</p>
<div class="math" id="equation-thicknesssaltatingsediment">
<p><span class="eqno">(252)<a class="headerlink" href="#equation-thicknesssaltatingsediment" title="Permalink to this equation">¶</a></span><img src="_images/math/78d4ccf4c4b0293f53e9162b84f4fcb061507f0d.png" alt="\frac{{{\delta _i}}}{{{d_i}}} = 0.3d_*^{0.7}{\left( {\frac{{{\theta _i}}}{{{{\theta '}_{{\rm{cr}},i}}}} - 1} \right)^{0.5}}"/></p>
</div><p>To compute the motion of the sediment in each computational cell, the
value of <img class="math" src="_images/math/a6a50fe76d47616e1e919d9e35e956c0aaedfb30.png" alt="q_{b,i}" style="vertical-align: -6px"/> is converted into the bed-load velocity by <a class="reference internal" href="zbibliography.html#vanrijn-1984" id="id31">[vanRijn84]</a>:</p>
<div class="math" id="equation-motionofsedimenteachcomputationalcell">
<p><span class="eqno">(253)<a class="headerlink" href="#equation-motionofsedimenteachcomputationalcell" title="Permalink to this equation">¶</a></span><img src="_images/math/f554a20e4c0e8f3cc4a3a8e910551051729fafb9.png" alt="{u_{{\rm{bedload}},i}} = \frac{{{q_{b,i}}}}{{{\delta _i}{c_{b,i}}{f_b}}}"/></p>
</div><p>where <img class="math" src="_images/math/b9641632d3e9034217fce8ca1251a33602722691.png" alt="f_b" style="vertical-align: -4px"/> is the critical packing fraction of the sediment. The bed-load velocity is assumed to be in the
same direction as that of the fluid flow adjacent to the packed bed interface.</p>
<p>For each species, the suspended sediment concentration is calculated by solving its own transport equation,</p>
<div class="math" id="equation-transportequationeachsedimentspecies">
<p><span class="eqno">(254)<a class="headerlink" href="#equation-transportequationeachsedimentspecies" title="Permalink to this equation">¶</a></span><img src="_images/math/c44c2bad7a13cb5aa12bd533021b5d4b4d5c6c85.png" alt="\frac{{\partial {C_{s,i}}}}{{\partial t}} + \nabla  \cdot ({\mathbf{u}_{s,i}}{C_{s,i}}) =
 \nabla  \cdot \nabla (D C_{s,i})"/></p>
</div><p>Here <img class="math" src="_images/math/f695daaaf6b2ee6038419efc8359ec14e8696de3.png" alt="C_{s,i}" style="vertical-align: -6px"/>  is the suspended sediment mass concentration of species  <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, which is defined as the sediment mass per volume of fluid-sediment mixture; <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/> is the diffusivity; <img class="math" src="_images/math/678567e5127775375f961186bc9d2065e140b448.png" alt="\mathbf {u}_{s,i}" style="vertical-align: -6px"/> is the suspended sediment velocity. It is noted that each sediment species in suspension moves at its own velocity that is different from those of fluid and other species. This is because grains with different mass density and sizes have different inertia and receive different drag force.</p>
<p>Correspondingly, the suspended sediment volume concentration <img class="math" src="_images/math/2bd3e26d54f1ba04a1413160db6d23bedb44513e.png" alt="c_{s,i}" style="vertical-align: -6px"/> is defined as the volume of suspended sediment species  <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> per volume of the fluid-sediment mixture. It is related to <img class="math" src="_images/math/f695daaaf6b2ee6038419efc8359ec14e8696de3.png" alt="C_{s,i}" style="vertical-align: -6px"/> by</p>
<div class="math" id="equation-masstovolumesedimentconcentration">
<p><span class="eqno">(255)<a class="headerlink" href="#equation-masstovolumesedimentconcentration" title="Permalink to this equation">¶</a></span><img src="_images/math/bf0b7d5b850cc6f5cb22d1aedbdf2df7a9786130.png" alt="{c_{s,i}}=\frac{C_{s,i}} {\rho_i}"/></p>
</div><p>To solve equation Eqs. <a class="reference internal" href="#equation-transportequationeachsedimentspecies">(254)</a> for <img class="math" src="_images/math/f695daaaf6b2ee6038419efc8359ec14e8696de3.png" alt="C_{s,i}" style="vertical-align: -6px"/>, <img class="math" src="_images/math/678567e5127775375f961186bc9d2065e140b448.png" alt="\mathbf {u}_{s,i}" style="vertical-align: -6px"/> must be calculated first. It is assumed that: 1) the grains in suspension do not have strong interactions with each other; 2) the velocity difference between the suspended grains and the fluid-sediment mixture is mainly the settling velocity of grains, <img class="math" src="_images/math/cb4e90fdc535eee72ad78f0d1c37061b24c838f1.png" alt="\mathbf {u}_{settling,i}" style="vertical-align: -6px"/>.
<img class="math" src="_images/math/678567e5127775375f961186bc9d2065e140b448.png" alt="\mathbf {u}_{s,i}" style="vertical-align: -6px"/> is thus evaluated using</p>
<div class="math" id="equation-speciesvelocity">
<p><span class="eqno">(256)<a class="headerlink" href="#equation-speciesvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/b07a84cfab470d04d19ee5e08a8ada7b8ef81b03.png" alt="\mathbf {u}_{s,i}=\mathbf{\bar u}+\mathbf {u}_{settling,i} c_{s,i}"/></p>
</div><p>where <img class="math" src="_images/math/2a34d9f3cdf8a3a859f2d520deda3bdd2a816e9b.png" alt="\mathbf{\bar u}" style="vertical-align: 0px"/> denotes velocity of the fluid-sediment mixture.</p>
<p>To avoid convective numerical instability, there is restriction of time step for suspended sediment transport.
Sediment grains are not allowed to be transported across more than one computational cell in one time step. The effect of fractional area and volume open to sediment advection must also be considered. The stability condition is</p>
<div class="math" id="equation-stabilitysediment">
<p><span class="eqno">(257)<a class="headerlink" href="#equation-stabilitysediment" title="Permalink to this equation">¶</a></span><img src="_images/math/57cdbbdc8d2acf56d1baa6addb00bf09a173e80c.png" alt="\delta t &lt; {\rm{CON}} \cdot \min \left( {\frac{{{V_F}\delta {x}}}{{{A_x}u_{s,i}}},{\text{ }}\frac{{{V_F}\delta {y}}}{{{R_i}{A_y}v_{s,i}}},{\text{ }}\frac{{{V_F}\delta {z}}}{{{A_z}w_{s,i}}}} \right)"/></p>
</div><p>where <img class="math" src="_images/math/b5568d069e3320a0f6958578d691950574726423.png" alt="(u_{s,i}, v_{s,i}, w_{s,i},)" style="vertical-align: -6px"/> are the x, y and z components of  <img class="math" src="_images/math/678567e5127775375f961186bc9d2065e140b448.png" alt="\mathbf {u}_{s,i}" style="vertical-align: -6px"/>,
respectively, and <img class="math" src="_images/math/e6ba77d211bda21abf5b8df36ed6d01bfbbd1ae6.png" alt="CON &lt; 1.0" style="vertical-align: -1px"/> is a safety factor to account for “worst cases” of convective numerical
instability.</p>
<p>The model has limitations. It is not valid for cohesive soils including silts and clays. Caution should be taken when it is applied with excessively large grains due to the limited validity of the sediment theory used in the model. Due to the empirical nature of the sediment theory and other approximations such as those in the turbulence models, parameter calibration may be needed in applications to achieve the best results.</p>
<p>Note that alterations to the empirical equations for lifting velocity, critical Shields parameter and
settling velocity in shallow water can be made by modifying the user-customizable routines <code class="file docutils literal notranslate"><span class="pre">scour_lift.F</span></code>,
<code class="file docutils literal notranslate"><span class="pre">scour_critic.F</span></code> and <code class="file docutils literal notranslate"><span class="pre">scour_uset.F90</span></code>.</p>
<span class="target" id="index-183"></span></div>
<div class="section" id="shallow-water-model">
<span id="shallowwatermodelth"></span><span id="index-184"></span><h3>Shallow Water Model<a class="headerlink" href="#shallow-water-model" title="Permalink to this headline">¶</a></h3>
<p>A shallow flow is one in which the horizontal extent is much larger than the
vertical extent. Examples include flow in the sea, estuaries, large lakes,
seasonal floods, liquid coatings, lubricating films, and water on automobile
windshields.</p>
<p>It can be shown that in a shallow flow, the vertical acceleration of fluid is
negligible, and it is a good approximation to the full three-dimensional model
to replace all flow variables by their depth-averaged equivalents
<a class="reference internal" href="zbibliography.html#pedlosky-1987" id="id32">[Ped87]</a>. The three-dimensional equations of motion are then reduced
to two-dimensional equations in the horizontal plane, referred to as the
shallow water equations or shallow water model. With this model, the fluid
free surface is free to exhibit wave phenomena. Non-uniform horizontal
boundaries (e.g., a sloping beach) may also induce small deviations from
purely horizontal flow. In this sense the depth-averaged approximation still
includes some three-dimensional effects. There are excellent discussions of
the shallow-water equations and their higher order refinements in references
<a class="reference internal" href="zbibliography.html#knauss-1978" id="id33">[Kna78]</a>, <a class="reference internal" href="zbibliography.html#su-gardner-1969" id="id34">[SG69]</a>.</p>
<p>The shallow water model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> assumes that the shallow direction is the
z-direction and gravity is in the negative z-direction. When depth averaging
is applied to the three-dimensional momentum equation in the z-direction, it
reduces to a hydrostatic relation for the pressure</p>
<div class="math" id="equation-shallowwatermodel01">
<p><span class="eqno">(258)<a class="headerlink" href="#equation-shallowwatermodel01" title="Permalink to this equation">¶</a></span><img src="_images/math/c4c6b98a3f73d1abe460765e3154473b55daf0b9.png" alt="p = {p_0} + \rho g(\eta  - z)"/></p>
</div><p>in terms of fluid density <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/>, vertical acceleration of gravity <img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/>,
fluid elevation <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> measured from <img class="math" src="_images/math/bb0da472076ff59dd1d9397a420e88fda45f5327.png" alt="z = 0" style="vertical-align: 0px"/>, and external pressure at the
free surface <img class="math" src="_images/math/39e9cb3a8b7c7ad28c1d81f0407b56e5219b5951.png" alt="p_0" style="vertical-align: -4px"/> which includes the effect of surface tension force.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, shallow water flow can reside in only one horizontal layer of control
volumes. Pressure in an
element containing a free-surface is defined as</p>
<div class="math" id="equation-shallowwatermodel02">
<p><span class="eqno">(259)<a class="headerlink" href="#equation-shallowwatermodel02" title="Permalink to this equation">¶</a></span><img src="_images/math/8b1a7705a077d0d28f7199e7db689f72ff1be201.png" alt="p = {p_0} + \rho gH"/></p>
</div><p>where <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> is the surface elevation measured from the bottom of the grid.
<img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> is, therefore, the sum of the fluid depth and obstacle height</p>
<div class="math" id="equation-shallowwatermodel03">
<p><span class="eqno">(260)<a class="headerlink" href="#equation-shallowwatermodel03" title="Permalink to this equation">¶</a></span><img src="_images/math/2de575cde237e18ce3cc44dbe1d508fcb4f55a2f.png" alt="H = F{V_F}\delta z + \left( {1 - {V_F}} \right)\delta z"/></p>
</div><p>where <img class="math" src="_images/math/ac59b859f86a99e206d1350f2a25968b183176df.png" alt="\delta z" style="vertical-align: 0px"/> is the cell size in z-direction,
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is fluid fraction, and
<img class="math" src="_images/math/2618d92ec29b4b2156fc2251e70e6459ddf41c2d.png" alt="V_F" style="vertical-align: -3px"/> is volume fraction (fraction of open volume in cell).</p>
<p>The volume/area blockages used in the FAVOR<sup>TM</sup> method can be interpreted as the
height of the bottom contour. When making this correspondence, it is only
necessary to make sure all the approximations used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> consider the solid
blockage to lie at the bottom of the control volumes.</p>
<p>Applying depth-averaging to the three-dimensional momentum equations in the
horizontal direction, we obtain the momentum equations for the shallow water
model,</p>
<div class="math" id="equation-shallowwatermodel04">
<p><span class="eqno">(261)<a class="headerlink" href="#equation-shallowwatermodel04" title="Permalink to this equation">¶</a></span><img src="_images/math/5e9cb3bb8711b2fdede422d86e1f06bef857735f.png" alt="\frac{{\partial u}}{{\partial t}} + \frac{1}{{{V_F}}}\left( {u{A_x}\frac{{\partial u}}{{\partial x}} + v{A_y}\frac{{\partial u}}{{\partial y}}} \right) =  - \frac{1}{\rho }\frac{{\partial p}}{{\partial x}} + {G_x} + \frac{{{\tau _{s,\,x}} + {\tau _{b,\,x}}}}{{\rho \,d}} + 2\Omega v {\text ,}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-shallowwatermodel05">
<p><span class="eqno">(262)<a class="headerlink" href="#equation-shallowwatermodel05" title="Permalink to this equation">¶</a></span><img src="_images/math/e33778e7654ec7bfe738a8fb5686a078fe049b76.png" alt="\frac{{\partial v}}{{\partial t}} + \frac{1}{{{V_F}}}\left( {u{A_x}\frac{{\partial v}}{{\partial x}} + v{A_y}\frac{{\partial v}}{{\partial y}}} \right) =  - \frac{1}{\rho }\frac{{\partial p}}{{\partial y}} + {G_y} + \frac{{{\tau _{s,\,y}} + {\tau _{b,\,y}}}}{{\rho \,d}} - 2\Omega u {\text ,}"/></p>
</div><p>where <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> and <img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/> are the depth-averaged <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>
velocities, respectively. One additional assumption made in Eqs.
<a class="reference internal" href="#equation-shallowwatermodel04">(261)</a> and <a class="reference internal" href="#equation-shallowwatermodel05">(262)</a> is that viscous
diffusion in horizontal direction is negligible compared to the diffusion in the
vertical diffusion. The third term on the right-hand side accounts for the
depth-averaged effect of the viscous diffusion in the vertical direction, which
is related to the sum of the wind shear stress at the free surface and the shear
stress at the bottom of the reservoir. Here <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is the water depth;
<img class="math" src="_images/math/ca043f713e6b277546248c1a24b0d9cb881b5cb5.png" alt="{\tau _{s,\,x}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/aa5209a5e89c0c7f7669d2dad36946c18f3039f8.png" alt="{\tau _{s,\,y}}" style="vertical-align: -6px"/> are the wind shear stress on
fluid surface in <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> directions, respectively; <img class="math" src="_images/math/8a5dad9b5e0343a5bba49a84ad5d79205087f8d5.png" alt="{\tau
_{b,\,x}}" style="vertical-align: -6px"/> and  <img class="math" src="_images/math/b743a4908c70d92a607ab8d024ba0bb09deaf3a3.png" alt="{\tau _{b,\,y}}" style="vertical-align: -6px"/> are the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>
components of the bottom shear stress, respectively.</p>
<p><img class="math" src="_images/math/ca043f713e6b277546248c1a24b0d9cb881b5cb5.png" alt="{\tau _{s,\,x}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/aa5209a5e89c0c7f7669d2dad36946c18f3039f8.png" alt="{\tau _{s,\,y}}" style="vertical-align: -6px"/> follow the quadratic law</p>
<div class="math" id="equation-shallowwatermodel06">
<p><span class="eqno">(263)<a class="headerlink" href="#equation-shallowwatermodel06" title="Permalink to this equation">¶</a></span><img src="_images/math/282a9db160c962cc7d60b5f6250e278e7c6ca516.png" alt="{\tau _{s,x}} = {\rho _a}{C'_D}W_{10,x}^{}\sqrt {W_{10,x}^2 + W_{10,y}^2}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-shallowwatermodel07">
<p><span class="eqno">(264)<a class="headerlink" href="#equation-shallowwatermodel07" title="Permalink to this equation">¶</a></span><img src="_images/math/428fdb8d34856780daaf31d6725a42f66c198ac6.png" alt="{\tau _{s,y}} = {\rho _a}{C'_D}W_{10,y}^{}\sqrt {W_{10,x}^2 + W_{10,y}^2}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/14cfe5c94628e1bd8eebbda9d6deedd5e81af8a9.png" alt="\rho _a" style="vertical-align: -4px"/> is the air density;</li>
<li><img class="math" src="_images/math/651f29fa3b4d564d0e11b26f2fae7569f8054a27.png" alt="{C'_D}" style="vertical-align: -5px"/> is the wind drag coefficient which is typically equal to 0.003;</li>
<li><img class="math" src="_images/math/69398c14d1fdaadfcd279628a80c163f77349f31.png" alt="W_{10,x}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/ebc33de9005cd8c095b132fe1fa1ecae45741988.png" alt="W_{10,y}" style="vertical-align: -6px"/> are the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/> velocities of wind at 10m above the water surface, respectively.</li>
</ul>
<p>Eq. <a class="reference internal" href="#equation-shallowwatermodel07">(264)</a> assumes that the
wind speed is much larger than that of the fluid.</p>
<p>For turbulent flow, the shallow water model does not use any of the turbulent
models in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. Instead, it uses a quadratic law to evaluate the bottom shear
stress,</p>
<div class="math" id="equation-shallowwatermodel08">
<p><span class="eqno">(265)<a class="headerlink" href="#equation-shallowwatermodel08" title="Permalink to this equation">¶</a></span><img src="_images/math/d95eadab2808f731bab94ecf7d57147010db2de7.png" alt="{\tau _{b,x}} =  - \rho \,{C_D}u\sqrt {{u^2} + {v^2}} \qquad \qquad {\tau _{b,y}} =  - \rho \,{C_D}v\sqrt {{u^2} + {v^2}}"/></p>
</div><p>where <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> is the drag coefficient. <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> can be either
user-defined with the default value of 0.0026 or calculated using surface roughness or Manning’s roughness coefficient <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> (or, Manning’s <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> )</p>
<p>The equation to calculate <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> using surface roughness is</p>
<div class="math" id="equation-dragcoefficientshallowwater">
<p><span class="eqno">(266)<a class="headerlink" href="#equation-dragcoefficientshallowwater" title="Permalink to this equation">¶</a></span><img src="_images/math/53fa1af1fb2d38da14c6c2acbeaf15451b9275bc.png" alt="C_D=\left[ \frac{\kappa}{B+\rm{ln} \left( z_0/d \right)} \right]^2"/></p>
</div><p>where <img class="math" src="_images/math/8da0b9ab701fdf47954008eea0dc8a2989878e5a.png" alt="\kappa =0.4" style="vertical-align: 0px"/> is Von Karman constant, B=0.71, <img class="math" src="_images/math/74f8a6fd517974372ade8e9bfd3f6fa0b68132e5.png" alt="z_0={k_s}/{30}" style="vertical-align: -5px"/>, <img class="math" src="_images/math/500ce2c31540c941a69d0af54e2b58eb9e4b25fd.png" alt="k_s" style="vertical-align: -3px"/> is surface roughness.</p>
<p>If Manning’s <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> is used instead of surface roughness, the equation to calculate <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> is</p>
<div class="math" id="equation-dragcoefficientshallowwater-n">
<p><span class="eqno">(267)<a class="headerlink" href="#equation-dragcoefficientshallowwater-n" title="Permalink to this equation">¶</a></span><img src="_images/math/e0832174fcfb3c709e7c26c1bbeeee3d7c8f18c7.png" alt="C_D=\frac{n^2 g}{d^{\frac{1}{3}}}"/></p>
</div><p>where <img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/> is the gravitational acceleration. It is noted that n is a dimensional parameter, and its dimension is <img class="math" src="_images/math/ba03c4bf7f6bff2038c89d646604de5de4eba5ec.png" alt="T L^{\frac{1}{3}}" style="vertical-align: 0px"/>, where <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is time, and <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> is length. It is also seen that <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> is inversely proportional to <img class="math" src="_images/math/93eb101dbfaec61a99775965116a4b64731d0f61.png" alt="d^{\frac{1}{3}}" style="vertical-align: 0px"/>. To avoid unphysically high value of <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> when water is too shallow, a cap is applied to <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/>, which is a user-specific parameter with a default value of 0.1.</p>
<p>For laminar flow, <img class="math" src="_images/math/7b741ab2525d4cc4de71507d314baad147b3ca90.png" alt="{\tau _{b,\,x}}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/b743a4908c70d92a607ab8d024ba0bb09deaf3a3.png" alt="{\tau _{b,\,y}}" style="vertical-align: -6px"/> are calculated
as</p>
<div class="math" id="equation-shallowwatermodel09">
<p><span class="eqno">(268)<a class="headerlink" href="#equation-shallowwatermodel09" title="Permalink to this equation">¶</a></span><img src="_images/math/8c617acd04811805a1b5e83f2ed35edb9fca7306.png" alt="{\tau _{b,x}} =  - {k_\mu }\mu \frac{u}{{d/2}} {\text ,} \qquad   {\tau _{b,y}} =  - {k_\mu }\mu \frac{v}{{d/2}}"/></p>
</div><p>where <img class="math" src="_images/math/374cd70808e8d8c4b478b789b1d674add3854ec0.png" alt="{k_\mu }" style="vertical-align: -6px"/> is the vertical viscosity multiplier that is designed to
compensate for the lack of velocity profile in the vertical direction. For a
steady-state shear flow that has a quadratic velocity profile in the vertical
direction, the theoretical value of <img class="math" src="_images/math/374cd70808e8d8c4b478b789b1d674add3854ec0.png" alt="{k_\mu }" style="vertical-align: -6px"/> is 1.5.</p>
<p>The last term in equation <a class="reference internal" href="#equation-shallowwatermodel04">(261)</a> or <a class="reference internal" href="#equation-shallowwatermodel05">(262)</a>
represents the Coriolis force due to rotation of the Earth. The Coriolis force
is important for geophysical fluid flow such as those in the sea, estuaries and
large lakes. In this term, <img class="math" src="_images/math/87a21f4cad695b5781e10af6eafe59cec535dffc.png" alt="\Omega" style="vertical-align: 0px"/> is the vertical component of the earth’s
angular velocity,</p>
<div class="math" id="equation-shallowwatermodel10">
<p><span class="eqno">(269)<a class="headerlink" href="#equation-shallowwatermodel10" title="Permalink to this equation">¶</a></span><img src="_images/math/63875912acb01349623800113ef8b1a52cb48d6b.png" alt="\Omega  = {\Omega _e}\sin \varphi"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/6250b9b937eb1d26212723d6780a0f8e0c4e8b5a.png" alt="{\Omega _e} = 7.29 \times {10^{ - 5}}" style="vertical-align: -3px"/> rad/s is the Earth’s angular speed and</li>
<li><img class="math" src="_images/math/016569ed25a4517195717f832459be810a448e6b.png" alt="\varphi" style="vertical-align: -4px"/> is the constant (i.e., average for the flow domain) latitude. It is positive in the northern hemisphere and negative in the southern hemisphere.</li>
</ul>
<p>Depth-averaging the three-dimensional continuity equation and then substituting
the fluid elevation using Eq. <a class="reference internal" href="#equation-shallowwatermodel03">(260)</a>, and considering the
appropriate area fractions for the x and y directions, we arrive at</p>
<div class="math" id="equation-shallowwatermodel11">
<p><span class="eqno">(270)<a class="headerlink" href="#equation-shallowwatermodel11" title="Permalink to this equation">¶</a></span><img src="_images/math/cdf9227027358172e8a64045b5e6c8bc37cc31c2.png" alt="\frac{{\partial {V_F}F}}{{\partial t}} + \frac{{\partial u{A_x}F}}{{\partial x}} + \frac{{\partial v{A_y}F}}{{\partial y}} = 0"/></p>
</div><p>This is precisely the equation for <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> used in the VOF method for flow
in a single, horizontal layer of control volumes, provided there is no <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>
transport in the z-direction, which is a restriction necessary in the
shallow-flow model (see Eq. <a class="reference internal" href="#equation-fluidinterfacesandfreesurfaces1">(19)</a>). The VOF method for
shallow water flow allows fluid to move into dry regions or withdraw from
previously wet regions.</p>
<p>Equations <a class="reference internal" href="#equation-shallowwatermodel02">(259)</a>, <a class="reference internal" href="#equation-shallowwatermodel04">(261)</a>,
<a class="reference internal" href="#equation-shallowwatermodel05">(262)</a> and <a class="reference internal" href="#equation-shallowwatermodel11">(270)</a> can be solved
explicitly, in which case, there is a limitation on the size of the time step
to prevent gravity waves from moving more than one grid cell in one time step.
An implicit, iterative solution is also available that removes the limitation
on the time-step size. The implicit option is used by default.</p>
<p>The shallow water model can be combined with the full 3D solution in a
<em>hybrid</em> approach, using a multi-block mesh. A given mesh block is either of
the shallow water or 3D type. Blocks of either type are interfaced with each
other at their common boundaries. Blocks can be linked with each other
(non-overlapping) and/or nested within other blocks (fully overlapping).</p>
<p>A mesh block of the shallow water type must have at least <em>two</em> cells defined
in the <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-direction, with the bottom one containing all the fluid and
the upper layer void of fluid and geometry. There is no reason to have more
than two cells since fluid is only allowed to exist in the <em>bottommost</em> layer
of cells. Therefore, the cell size in the <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-direction should be
sufficiently large to contain all fluid in that layer <em>throughout</em> the
simulation. An error is generated if fluid crosses into an upper layer of
cells. Cells in the second layer of <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-cells should be left empty of
fluid and geometry. This will enable the model to properly treat the free
surface in the lower layer.</p>
<span class="target" id="index-185"></span></div>
<div class="section" id="sludge-settling-model">
<span id="sludgemodelth"></span><span id="index-186"></span><h3>Sludge Settling Model<a class="headerlink" href="#sludge-settling-model" title="Permalink to this headline">¶</a></h3>
<p>The sludge settling model is used to simulate sludge settlement in septic tanks, clarifiers and other sewage treatment equipment. Sludge motion is governed by both sewage flow and gravity-caused settling. The transport equation for sludge is</p>
<div class="math" id="equation-transportequationsludge">
<p><span class="eqno">(271)<a class="headerlink" href="#equation-transportequationsludge" title="Permalink to this equation">¶</a></span><img src="_images/math/6c324360e0719ef907baf28a63c053b6389da8a7.png" alt="\frac{{\partial {C_{s}}}}{{\partial t}} + \nabla  \cdot ({\mathbf{u}_{s}}{C_{s}}) =
 \nabla  \cdot \nabla (D_{s} C_{s})"/></p>
</div><p>where <img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/> denotes sludge concentration that is defined as sludge mass per unit volume of sludge-water mixture; <img class="math" src="_images/math/b60b67498bffa4371916ba9b3c77a78c987288df.png" alt="D_s" style="vertical-align: -3px"/> is sludge diffusion coefficient;  <img class="math" src="_images/math/24790e5d6cccdcc01c1c7e566c75a8cd24f374c0.png" alt="\mathbf{u}_{s}" style="vertical-align: -3px"/> is total sludge velocity and can be written as</p>
<div class="math" id="equation-sludgevelocity">
<p><span class="eqno">(272)<a class="headerlink" href="#equation-sludgevelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/2451f266a87bc1701aa7b48ad445afbe571485f6.png" alt="\mathbf{u}_{s} =\mathbf{u} + \mathbf{u}_{settle}"/></p>
</div><p>where <img class="math" src="_images/math/dd781290bb86d4b2e998dea60a15c5364f4d82e1.png" alt="\mathbf{u}" style="vertical-align: 0px"/> is velocity of sludge-water mixture; <img class="math" src="_images/math/2490d76faebd7acb7203a67e854cbd3afe22203c.png" alt="\mathbf{u}_{settle}" style="vertical-align: -3px"/> is sludge settling velocity and is always in the direction of gravity.  In general, <img class="math" src="_images/math/2490d76faebd7acb7203a67e854cbd3afe22203c.png" alt="\mathbf{u}_{settle}" style="vertical-align: -3px"/> value decreases with increasing <img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/>. It drops to zero when <img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/> reaches a critical value, <img class="math" src="_images/math/de34a1c25a790f2cec13081ed40c20ae85af4996.png" alt="C_{max}" style="vertical-align: -3px"/>, which is the maximum sludge concentration in settling tanks. In the fully settled regions, <img class="math" src="_images/math/25344ca344fad74c4561ddcaca19f830a310d9b5.png" alt="C = C_{max}" style="vertical-align: -3px"/>, and sludge stops settling but its advection with fluid flow continues. <img class="math" src="_images/math/de34a1c25a790f2cec13081ed40c20ae85af4996.png" alt="C_{max}" style="vertical-align: -3px"/> is a user-specified input parameter in the model.</p>
<p>Users are allowed to define <img class="math" src="_images/math/f95bda09780c5aa09f2e70faaa6040549d84e5d6.png" alt="{u}_{settle}" style="vertical-align: -3px"/> as a function of <img class="math" src="_images/math/3fe7e6b62b7e4a98ec63049ab2558b4862a7ac3b.png" alt="C_s" style="vertical-align: -3px"/> using either tabulated data or the Vesilind equation <a class="reference internal" href="zbibliography.html#vesilind-1968" id="id35">[Ves68]</a>,</p>
<div class="math" id="equation-sludgesettlingvelocity">
<p><span class="eqno">(273)<a class="headerlink" href="#equation-sludgesettlingvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/06deb2b08bb7658fc68e91d88ffb9f38b8a86073.png" alt="u_{settle}= U_0 e^{-n C_s}"/></p>
</div><p>where <img class="math" src="_images/math/e25c3e2fe829f2322c3b7ee919e11c03f964f384.png" alt="U_0" style="vertical-align: -3px"/> is the maximum sludge velocity, and n is Vesilind parameter with the dimension of volume/mass. When <img class="math" src="_images/math/25344ca344fad74c4561ddcaca19f830a310d9b5.png" alt="C = C_{max}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/f95bda09780c5aa09f2e70faaa6040549d84e5d6.png" alt="{u}_{settle}" style="vertical-align: -3px"/> is set to zero in the model.</p>
</div>
<div class="section" id="solidification-model">
<span id="index-187"></span><h3>Solidification Model<a class="headerlink" href="#solidification-model" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-188"></span><div class="section" id="solidification-shrinkage-and-porosity-models">
<span id="solidificationshrinkageporositymodelsth"></span><span id="index-189"></span><h4>Solidification Shrinkage and Porosity Models<a class="headerlink" href="#solidification-shrinkage-and-porosity-models" title="Permalink to this headline">¶</a></h4>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be used to model casting processes such as high pressure injection,
gravity and tilt pours, and centrifugal and squeeze castings. One such
application is modeling volumetric shrinkage during solidification, which is a
common cause of porosity defects leading to poor mechanical properties of the
final product. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> provides an efficient way to help design a cost-effective
process that minimizes the occurrence of these defects.</p>
<p>Porosity in solidifying metal occurs as a result of gas evolution as well as
volumetric changes (i.e., shrinkage) during phase transformation. There are two
models in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> that can be employed to predict macro-porosity formation in
metals due to shrinkage. The first model involves the solution of the full
system of hydrodynamic equations. As a result, the evolution of velocity and
pressure in the solidifying metal can be predicted. Therefore, this model is
called the Hydrodynamic, or First Principles (FP), shrinkage model.</p>
<p>The continuity and energy equations, Eqs. <a class="reference internal" href="#equation-impressibilitycondition">(5)</a> and
<a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, are modified to include volumetric source terms.
These are defined by the solidification rate and solid/liquid density
difference. The basis of the model is that material contracts when it
solidifies, and this induces some tension in the material in the form of a
lowered pressure that attempts to pull surrounding liquid in to replace the
volume lost to shrinkage. If the surrounding liquid is confined and cannot
flow, the pressure will continue to decrease with further shrinkage until the
critical pressure is reached. At that point a shrinkage cavity is allowed to
open. The critical pressure can be related to the typical pressure at which
dissolved gases come out of solution.</p>
<p>Despite being an accurate tool to study the porosity formation phenomena, the FP
model may be computationally costly because at each time step the numerical
algorithm involves the complete solution of momentum and energy equations. The
size of the time step, controlled by various stability criteria associated with
fluid flow, may also be small compared to the total solidification time of the
casting. The latter may be as long as hours for large sand castings.</p>
<p>The other, simplified shrinkage model is based on the solution of the metal and
mold energy equations only. No fluid flow equations are solved in this case.
Porosity is predicted by evaluating the volume of the solidification shrinkage
in each isolated liquid region in the casting at each time step. This volume is
then subtracted from the top of the liquid region in accordance with the amount
of liquid metal available in the cells from which the fluid is removed. The
“top” of a liquid region is defined by the direction of gravity. The relevance
of this approach is supported by the fact that in many situations fluid flow in
the solidifying metal can be ignored. Porosity formation in that case is
primarily governed by metal cooling and gravity. Feeding due to gravity often
occurs on a time scale much smaller than the total solidification time. This
model is called Simplified Solidification Shrinkage (SSS) model. The SSS model
in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> provides a simple tool to perform quick simulations of shrinkage in
complicated castings.</p>
<p>Neither model includes the evolution of gases, therefore, the porosity volume is
defined by the cooling rate and solid/liquid density difference.</p>
<p>The simplified model accounts for the compressibility of the fluid
as pressure descreases due to shrinkage, stretching the metal before pores actually open.
A linear relationship between volume and pressure is used, with the bulk modulus
as the coefficient of proportionality. The opening of the pores is delayed until
the local pressure drops below a critical value. Thus applying a large external
pressure can delay and reduce the formation of porosity.</p>
<p>The most important aspect of shrinkage modeling in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is that shrinkage
cavities are explicitly described, therefore, its influence on fluid and heat
flow is also taken into consideration. Volumetric expansion, e.g., due to
remelting, is also included in these models.</p>
<p>Both shrinkage models account for volume changes occurring during
solidification as well as during the cooling of the liquid phase before it
begins to solidify.</p>
<p>The Simplified Solidification Shrinkage model is also coupled to the Cast Iron
Solidification model which describes the evolution of gamma-iron (austenite),
graphite and carbide phases during the eutectic solidification
<a class="reference internal" href="zbibliography.html#carter-starobin-2011" id="id36">[CS11]</a>. The evolution of these phases affects the density and,
therefore, the volumetric changes of the solidifying alloy. The metal may shrink
or expand during solidification of a casting, depending on the initial carbon
and silicon compositions of the alloy as well as the cooling rate. Liquid
shrinkage upon cooling is also included in the model.</p>
<p>The full flow shrinkage model does not account for the density changes due to
the formation of graphite and carbon during cast iron solidification. Instead,
the volume changes in that model are defined by the thermal
expansion/contraction of the liquid phase and the densities of the liquid and
solid phases.</p>
<p>In addition to the shrinkage models designed to predict macro-cavity formation,
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> computes a variety of solidification functions that can be used to
evaluate the occurrence of microporosity and some microstructural features
<a class="reference internal" href="zbibliography.html#overfelt-1992" id="id37">[Ove92]</a>. These are:</p>
<ul>
<li><p class="first">Solidus velocity, <img class="math" src="_images/math/993afb86f729e677125c9a08e0a194f55669c1de.png" alt="V_s" style="vertical-align: -3px"/>, which is the velocity of the solidus isotherm at the time of solidification.</p>
</li>
<li><p class="first">Thermal gradient, <img class="math" src="_images/math/58480c8cf19c69c3af184a56ed6985d65b9b244f.png" alt="G" style="vertical-align: 0px"/>, at the time of solidification.</p>
</li>
<li><p class="first">Cooling rate, <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/>, at the time of solidification. Local and absolute solidification times,
<img class="math" src="_images/math/e8696ece3fa85b85364ab41f1882d900dd9fca50.png" alt="t_l" style="vertical-align: -3px"/> and <img class="math" src="_images/math/347084213ff018518666a15294b9683b8fab1961.png" alt="t_a" style="vertical-align: -3px"/>.</p>
</li>
<li><p class="first">Local solidification time is the time it takes metal temperature ito descrease from the liquidus to the solidus.</p>
</li>
<li><p class="first">Solidification time is the time when the metal temperature in a cell reaches a user-defined value <span class="target" id="index-190"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TNIYAM</span></code> during cooling.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By default, the Niyama temperature is set to the larger value between the solidus temperature and
eutectic temperature</p>
</div>
</li>
<li><p class="first">Feeding efficiency index, <img class="math" src="_images/math/5fe4ed9847c0954ab0bf94ece3847e20f55d2368.png" alt="G/t_l" style="vertical-align: -5px"/>. This function can be visualized by plotting the <span class="target" id="index-191"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SLDCF2</span></code> variable.</p>
</li>
<li><p class="first">Niyama criterion function, <img class="math" src="_images/math/a5cd05d706703a8462064764916caffe8e7fe30a.png" alt="\frac{G}{{\sqrt R }}" style="vertical-align: -10px"/>. This function can be visualized by plotting the <span class="target" id="index-192"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SLDCF1</span></code> variable.</p>
</li>
<li><p class="first">Lee, Chang and Chieu (LCC) criterion, <img class="math" src="_images/math/cd7d21cff22551a7959e8cd8d9ed43c3f277c2b1.png" alt="\left( {\frac{G}{V_s}} \right)t_l^{\frac{2}{3}}" style="vertical-align: -12px"/>. This function can be visualized by plotting the <span class="target" id="index-193"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SLDCF3</span></code> variable.</p>
</li>
</ul>
<span class="target" id="index-194"></span></div>
<div class="section" id="solidification-drag">
<span id="solidifictiondragmodelth"></span><span id="index-195"></span><h4>Solidification Drag<a class="headerlink" href="#solidification-drag" title="Permalink to this headline">¶</a></h4>
<p>The effect of solidification on fluidity can be accounted in one of two ways: either by using
an enhanced viscosity of the solidified fluid or through the use of a drag force.</p>
<p>The viscosity-based approach is useful when the solidified phase is deformable and can still move
as, for example, in the twin-roll continuous casting process or for amorphous alloys.
A constant finite viscosity, higher than that in the liquid, is assigned to the solidified fluid and
the liquid/solid mixture viscosity is calculated as a solid-fraction weighted average of the
viscosities of the liquid and solidified phases.</p>
<p>The drag-based flow model is constructed using the porous media drag concept.
By neglecting volume changes associated with a phase change and assuming that solid material is at
rest with respect to the computational mesh, we can approximate solidification processes (i.e., the state
of zero flow velocity) by using a drag coefficient that is a function of the local solid fraction.</p>
<p>The drag should be effectively infinite when material is in the solid phase. At
intermediate states consisting of a mush, the drag should assume an intermediate
value. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the drag coefficient is</p>
<div class="math" id="equation-dragcoefficientfd">
<p><span class="eqno">(274)<a class="headerlink" href="#equation-dragcoefficientfd" title="Permalink to this equation">¶</a></span><img src="_images/math/95ab0b9d046434c235d21975b54317c46bd6dd67.png" alt="F_d = {\rm{TSDRG}} \cdot \frac{{F_s^2}}{{{{(1 - {F_s})}^3}}}"/></p>
</div><p>where <img class="math" src="_images/math/e7f40891acbcdc6b2374ef73226e4a1484eeeb97.png" alt="F_s" style="vertical-align: -3px"/> is the local solid fraction. When <img class="math" src="_images/math/35d514914844993719238588f83a7b2404559a88.png" alt="F_s =" style="vertical-align: -3px"/> <span class="target" id="index-196"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCR</span></code>, the drag
coefficient, <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/>, becomes effectively infinite. <span class="target" id="index-197"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCR</span></code> is a
user-defined constant denoting the critical solid fraction value at which all flow in
the mushy zone seizes. <span class="target" id="index-198"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TSDRG</span></code> is a user-defined constant. Its value
depends on the mushy zone microstructure the modeling of which is outside the
scope of the solidification model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The actual choice for <span class="target" id="index-199"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TSDRG</span></code> is
likely to depend on the specific application and, in general, will require some
confirmation with experimental data. When the value of <span class="target" id="index-200"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TSDRG</span></code> is set to
zero, then no drag force is applied to the fluid in the mushy region.</p>
<p>The Darcy-type drag model for the liquid phase flow in the mushy zone given by
Eqs. <a class="reference internal" href="#equation-unidirectionalflowratethroughporousmedia">(220)</a> and <a class="reference internal" href="#equation-dragcoefficientfd">(274)</a>
can be enhanced to include additional flow effects at low and high solid
fractions. At low solid fraction values, <img class="math" src="_images/math/fc294ac3eab691965b63931d81e7f119f04123fe.png" alt="F_s &lt;" style="vertical-align: -3px"/> <span class="target" id="index-201"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCO</span></code>, crystals of the
solid phase are sparse and float freely in the liquid without forming a coherent
solid structure <a class="reference internal" href="zbibliography.html#afs-1996" id="id38">[BAAmericanFoundrymensSociety+96]</a>. The solid/liquid mixture can then be approximated
as a single fluid with the mixture viscosity dependent on the solid fraction
according to</p>
<div class="math" id="equation-solidliquidapproximation">
<p><span class="eqno">(275)<a class="headerlink" href="#equation-solidliquidapproximation" title="Permalink to this equation">¶</a></span><img src="_images/math/4bb39986c8388cee1137a6aca95968a6c81a012d.png" alt="\mu  = {\mu _0} \cdot {\left( {1.0 - \frac{{\min ({F_s},{\rm{FSCO}})}}{{\rm{FSCR}}}} \right)^{ - 1.55}}"/></p>
</div><p>where <img class="math" src="_images/math/ec8c80620c26bac27f514b1db8c5e8f3c6b7697e.png" alt="\mu _0" style="vertical-align: -4px"/> is the molecular viscosity of the liquid phase. The drag
coefficient <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> in this range of solid fraction values is zero. As
solidification continues and the solid fraction reaches the coherency point,
<span class="target" id="index-202"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCO</span></code>, the solidified phase is assumed to form a rigid structure. In this
case the fluid viscosity is maintained at the value given by Eq.
<a class="reference internal" href="#equation-solidliquidapproximation">(275)</a> with <img class="math" src="_images/math/35d514914844993719238588f83a7b2404559a88.png" alt="F_s =" style="vertical-align: -3px"/> <span class="target" id="index-203"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCO</span></code> and the drag term given
by Eq. <a class="reference internal" href="#equation-dragcoefficientfd">(274)</a> is applied. This continues until the solid
fraction exceeds the critical solid fraction, <span class="target" id="index-204"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCR</span></code>, at which point the
flow stops.</p>
<p>Both <span class="target" id="index-205"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCO</span></code> and <span class="target" id="index-206"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCR</span></code> are user-defined constants. It is assumed in
the model that</p>
<div class="math" id="equation-constantsfscoandfscr">
<p><span class="eqno">(276)<a class="headerlink" href="#equation-constantsfscoandfscr" title="Permalink to this equation">¶</a></span><img src="_images/math/40f0b14de0039a156b36f01fa6de82ba399ecf57.png" alt="0.0 \leq {\rm{FSCO}} &lt; {\rm{FSCR}} \leq 1.0"/></p>
</div><p>In addition, the solid phase can be moving at a uniform linear velocity (which
may be time-dependent) as happens during a continuous casting process. Please
refer to <a class="reference internal" href="model-reference.html#movingsolidphasemr"><span class="std std-ref">Moving Solid Phase</span></a> in the Model Reference chapter for more
details.</p>
<p>Other models could be incorporated into <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> by altering the subroutines <strong class="program">drgcl</strong>,
in which the drag coefficient is computed, and <strong class="program">mucal</strong>, where the fluid viscosity
is computed.</p>
<p>The concept of the solidification drag and the effective viscosity described
by Eqs. <a class="reference internal" href="#equation-dragcoefficientfd">(274)</a> and <a class="reference internal" href="#equation-solidliquidapproximation">(275)</a> is based on
the important assumption that a mushy zone exists within the solidification
range through which the liquid phase flows. This assumption is not true for
materials with a zero freezing range, like pure metals. In this case it helps
the accuracy of the model is a small artificial freezing range is introduced
of the order of 0.1 to 1.0 degree.</p>
<span class="target" id="index-207"></span></div>
</div>
<div class="section" id="turbulence-models">
<span id="turbulencemodelsth"></span><span id="index-208"></span><h3>Turbulence Models<a class="headerlink" href="#turbulence-models" title="Permalink to this headline">¶</a></h3>
<p>Turbulence is the chaotic, unstable motion of fluids that occurs when there
are insufficient stabilizing viscous forces. At high Reynolds numbers, the
natural instabilities that occur within the flow are not dampened and they
manifest in the formation of eddies of various sizes. This behavior is easily
observed in flow out of a faucet or in a fast-moving stream by the striations
visible on the free surface. Less visible are the turbulent eddies swirling
around the car during your daily commute. Turbulence can be important in
industrial processes as well: high pressure die casting filling is most
certainly turbulent, as are almost all medium to large scale flow processes.</p>
<p>In short, turbulence is all around us, and cannot be ignored in numerical flow
modeling. Ideally, we would be able to simulate, with the equations of mass and
momentum conservation, the full spectrum of turbulent fluctuations. This is
possible only if the mesh resolution is sufficient to capture such details.
However, this is generally not possible because of the computer memory and
processing time limitations. Therefore, we must resort to simplified modeling
that describes the effects of turbulence on the mean flow characteristics.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, there are six turbulence models available: the Prandtl mixing
length model, the one-equation, the two-equation <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/>,
RNG, and <img class="math" src="_images/math/13853265c95e6af6471a597df7645aff4c6d1421.png" alt="k - \omega" style="vertical-align: 0px"/> models, and a large eddy simulation, LES, model. Our
formulation, however, differs slightly from other formulations in that we have included
the influence of the fractional areas/volumes of the FAVOR<sup>TM</sup> method and have generalized
the turbulence production (or decay) associated with buoyancy forces. The latter generalization,
for example, includes buoyancy effects associated with non-inertial accelerations.</p>
<span class="target" id="index-209"></span><div class="section" id="turbulence-transport-models">
<span id="turbulencetransportmodelth"></span><span id="index-210"></span><h4>Turbulence Transport Models<a class="headerlink" href="#turbulence-transport-models" title="Permalink to this headline">¶</a></h4>
<div class="section" id="one-equation-model">
<span id="one-equation-turb"></span><h5>One-equation model<a class="headerlink" href="#one-equation-model" title="Permalink to this headline">¶</a></h5>
<p>The one-equation turbulence transport model consists of a transport equation
for the specific kinetic energy associated with turbulent velocity
fluctuations in the flow (the turbulent kinetic energy)</p>
<div class="math" id="equation-turbulentkineticenergy">
<p><span class="eqno">(277)<a class="headerlink" href="#equation-turbulentkineticenergy" title="Permalink to this equation">¶</a></span><img src="_images/math/1f979e67bfc96a507f7dfee00361d4a25da094ad.png" alt="{k_T} = \frac{1}{2}\left( {\overline {u{'^2}}  + \overline {v{'^2}}  + \overline {w{'^2}} } \right)"/></p>
</div><p>where <img class="math" src="_images/math/d7a4c9b7239fb3df64468f8a4481d43574aa9bee.png" alt="u'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/85d63236a00f61525800dae79701d253c99812e1.png" alt="v'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/c40ccce5e24659f1127740aa923b585e487b5d67.png" alt="w'" style="vertical-align: 0px"/> are the <img class="math" src="_images/math/3b07384912ea86d87808db0e436fc8a9bb3acf4e.png" alt="x-" style="vertical-align: 0px"/>, <img class="math" src="_images/math/407fa03c678b2c345280b48af734e7fb4bbdc569.png" alt="y-" style="vertical-align: -4px"/>,
<img class="math" src="_images/math/0bb0cb8bcab2be0288f6d5e24f1d29efaf1dba02.png" alt="z-" style="vertical-align: 0px"/>components of the fluid velocity associated with chaotic turbulent
fluctuations.  This corresponds to a turbulence intensity of</p>
<div class="math">
<p><img src="_images/math/494754c13a45552838289a5b07a9ebb0f0a4bc41.png" alt="I = \sqrt{\frac{k_T}{\overline{K}}}"/></p>
</div><p>where <img class="math" src="_images/math/35880d77707f83656b876d56019286ff848d5242.png" alt="\overline{K}" style="vertical-align: 0px"/> is the mass-averaged mean kinetic energy in the domain,
as defined in <a class="reference internal" href="#equation-turbulentintensity">(278)</a> and <img class="math" src="_images/math/f9b8db083d410a1599cdb153ea3d3de0f0961e37.png" alt="\forall" style="vertical-align: 0px"/> represents the total volume of the domain.</p>
<div class="math" id="equation-turbulentintensity">
<p><span class="eqno">(278)<a class="headerlink" href="#equation-turbulentintensity" title="Permalink to this equation">¶</a></span><img src="_images/math/597b4fbcd98f5e79142897f92d67f21f006c1358.png" alt="\overline{K} = \frac{\int \limits_\forall \frac{1}{2} \rho \cdot \left( {u^2+v^2+w^2} \right) \, d\forall }{\int \limits_\forall \rho \, d\forall}"/></p>
</div><p>The transport equation for <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> includes the convection and diffusion of
the turbulent kinetic energy, the production of turbulent kinetic energy due to
shearing and buoyancy effects, diffusion, and dissipation due to viscous losses
within the turbulent eddies. Buoyancy production only occurs if there is a
non-uniform density in the flow, and includes the effects of gravity and
non-inertial accelerations. The transport equation is:</p>
<div class="math" id="equation-transportequation">
<p><span class="eqno">(279)<a class="headerlink" href="#equation-transportequation" title="Permalink to this equation">¶</a></span><img src="_images/math/755078c5fc5cc9fbc85a8a31e8b22e226f140bd8.png" alt="\frac{{\partial {k_T}}}{{\partial t}} + \frac{1}{{{V_F}}}\left\{ {u{A_x}\frac{{\partial {k_T}}}{{\partial x}} + v{A_y}\frac{{\partial {k_T}}}{{\partial y}} + w{A_z}\frac{{\partial {k_T}}}{{\partial z}}} \right\} = {P_T} + {G_T} + {\rm{Diff}}_{{k_T}} - {\varepsilon_T}"/></p>
</div><p>where <img class="math" src="_images/math/2618d92ec29b4b2156fc2251e70e6459ddf41c2d.png" alt="V_F" style="vertical-align: -3px"/>, <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/>, <img class="math" src="_images/math/8adf1860c3314cce8ae4bd9d6e57e19bf0ffd1de.png" alt="A_y" style="vertical-align: -6px"/>, and <img class="math" src="_images/math/2e6a1ee0ee3e238e36573fb81bfaaaeaa81ff9cc.png" alt="A_z" style="vertical-align: -3px"/>
are <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>’s FAVOR<sup>TM</sup> functions, <img class="math" src="_images/math/11fe9b7102ed15faf477d2a6307492aacaf8ba0c.png" alt="P_T" style="vertical-align: -3px"/> is the turbulent kinetic energy
production:</p>
<div class="math" id="equation-turbulentkineticenergyproduction">
<p><span class="eqno">(280)<a class="headerlink" href="#equation-turbulentkineticenergyproduction" title="Permalink to this equation">¶</a></span><img src="_images/math/d9e163b17a1ad6a54338613469cef83a2ce6636d.png" alt="{P_T} = {\rm{CSPRO}}\left( {\frac{\mu }{{\rho {V_F}}}} \right)\left\{ \begin{gathered}
2{A_x}{\left( {\frac{{\partial u}}{{\partial x}}} \right)^2} + 2{A_y}{\left( {R\frac{{\partial v}}{{\partial y}} + \xi \frac{u}{x}} \right)^2} + 2{A_z}{\left( {\frac{{\partial w}}{{\partial z}}} \right)^2} \hfill \\
+ \left( {\frac{{\partial v}}{{\partial x}} + R\frac{{\partial u}}{{\partial y}} - \xi \frac{v}{x}} \right)\left[ {{A_x}\frac{{\partial v}}{{\partial x}} + {A_y}\left( {R\frac{{\partial u}}{{\partial y}} - \xi \frac{v}{x}} \right)} \right] \hfill \\
+ \left( {\frac{{\partial u}}{{\partial z}} + \frac{{\partial w}}{{\partial x}}} \right)\left( {{A_z}\frac{{\partial u}}{{\partial z}} + {A_x}\frac{{\partial w}}{{\partial x}}} \right) \hfill \\
+ \left( {\frac{{\partial v}}{{\partial z}} + R\frac{{\partial w}}{{\partial y}}} \right)\left( {{A_z}\frac{{\partial v}}{{\partial z}} + {A_y}R\frac{{\partial w}}{{\partial y}}} \right) \hfill \\
\end{gathered}  \right\}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-211"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CSPRO</span></code> is a turbulence parameter, whose default value is 1.0, and</li>
<li><img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> and <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/> are described earlier in the <a class="reference internal" href="#masscontinuityequationth"><span class="std std-ref">Mass Continuity Equation section</span></a> and are related to the cylindrical coordinate system (if used). The buoyancy production term is</li>
</ul>
<div class="math" id="equation-buoyancyproduction">
<p><span class="eqno">(281)<a class="headerlink" href="#equation-buoyancyproduction" title="Permalink to this equation">¶</a></span><img src="_images/math/d035c183a83ae21aba5225814a6f0645432ddca6.png" alt="{G_T} =  - {\rm{CRHO}}\left( {\frac{\mu }{{{\rho ^3}}}} \right)\left( {\frac{{\partial \rho }}{{\partial x}}\frac{{\partial p}}{{\partial x}} + {R^2}\frac{{\partial \rho }}{{\partial y}}\frac{{\partial p}}{{\partial y}} + \frac{{\partial \rho }}{{\partial z}}\frac{{\partial p}}{{\partial z}}} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> is the molecular dynamic viscosity,</li>
<li><img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> is the fluid density,</li>
<li><img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> is the pressure, and</li>
<li><span class="target" id="index-212"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CRHO</span></code> is another turbulence parameter, whose default value is 0.0, but for thermally buoyant flow problems should be chosen to be approximately 2.5. The diffusion term is</li>
</ul>
<div class="math" id="equation-diffusionterm">
<p><span class="eqno">(282)<a class="headerlink" href="#equation-diffusionterm" title="Permalink to this equation">¶</a></span><img src="_images/math/8aac1133f07c261edb24989bd9e9ed971bb1b82f.png" alt="{\rm{Diff}}_{{k_T}} = \frac{1}{{{V_F}}}\left\{ {\frac{\partial }{{\partial x}}\left( {{\upsilon _k}{A_x}\frac{{\partial {k_T}}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {{\upsilon _k}{A_y}R\frac{{\partial {k_T}}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{\upsilon _k}{A_z}\frac{{\partial {k_T}}}{{\partial z}}} \right) + \xi \frac{{{\upsilon _k}{A_x}{k_T}}}{x}} \right\}"/></p>
</div><p>where <img class="math" src="_images/math/65443201b1ef21740d8fc60026b943c6a16c4a35.png" alt="{\upsilon _k}" style="vertical-align: -3px"/> is the diffusion coefficient of <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and is
computed based on the local value of the turbulent viscosity. The user-defined
parameter <span class="target" id="index-213"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMTKE</span></code> is the multiplier of viscosity used to compute the
turbulent diffusion coefficient (its value defaults to 1.0).</p>
<p>The rate of turbulent energy dissipation, <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>, in the
one-equation model is related to the turbulent kinetic energy <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/>:</p>
<div class="math" id="equation-rateturbulentenergydissipation">
<p><span class="eqno">(283)<a class="headerlink" href="#equation-rateturbulentenergydissipation" title="Permalink to this equation">¶</a></span><img src="_images/math/a51c14d96823ea775edcd0b57a424fc1f385b5ed.png" alt="{\varepsilon _T} = {\rm{CNU}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}}} \frac{{{k_T}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}}}}{{\rm{TLEN}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-214"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CNU</span></code> is a parameter (0.09 by default),</li>
<li><img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> is the turbulent kinetic energy and</li>
<li><img class="math" src="_images/math/322a7f0efd43559961ae7df235dc03a1d4648f9c.png" alt="\rm{TLEN}" style="vertical-align: 0px"/> is the turbulent length scale.</li>
</ul>
<p>This is consistent with mixing-length-based formulations. In this case, by default <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> chooses a value for <img class="math" src="_images/math/aeec6515d1538e1defa141d32e3fb1fa086cca53.png" alt="{\rm{TLEN}}" style="vertical-align: 0px"/> that is 7% of the smallest
domain dimension; however, it is recommended that this value should instead be
7% of the hydraulic diameter <a class="reference internal" href="zbibliography.html#fard-boyaghchi-2007" id="id39">[ShojaeeFardB07]</a>, which is a
characteristic length scale of the flow. In pipe flow, the hydraulic diameter is
equal to the inner pipe diameter. In stream flows, it is the depth of the
stream.</p>
</div>
<div class="section" id="k-epsilon">
<span id="id40"></span><h5>k-epsilon<a class="headerlink" href="#k-epsilon" title="Permalink to this headline">¶</a></h5>
<p>A more sophisticated - and more widely used - model consists of two transport
equations for the turbulent kinetic energy <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and its dissipation
<img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>, the so-called <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> model
<a class="reference internal" href="zbibliography.html#harlow-nakayama-1967" id="id41">[HN67]</a>, thus eliminating the need for Eq.
<a class="reference internal" href="#equation-rateturbulentenergydissipation">(283)</a> (except at inflow boundaries and in flow
regions with near-zero dissipation <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>). The <img class="math" src="_images/math/c20b779606cad94983ac42abe35d81a8319d5185.png" alt="k -
\varepsilon" style="vertical-align: 0px"/> model has been shown to provide reasonable approximations to many
types of flows <a class="reference internal" href="zbibliography.html#rodi-1980" id="id42">[Rod80]</a>. An additional transport equation is solved for
the turbulent dissipation, <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>:</p>
<div class="math" id="equation-additionaltransportturbulentdissipation">
<p><span class="eqno">(284)<a class="headerlink" href="#equation-additionaltransportturbulentdissipation" title="Permalink to this equation">¶</a></span><img src="_images/math/bf440a87bc81743c11d46acc766c782c237b6793.png" alt="\frac{{\partial {\varepsilon _T}}}{{\partial t}} + \frac{1}{{{V_F}}}\left\{ {u{A_x}\frac{{\partial {\varepsilon _T}}}{{\partial x}} + v{A_y}R\frac{{\partial {\varepsilon _T}}}{{\partial y}} + w{A_z}\frac{{\partial {\varepsilon _T}}}{{\partial z}}} \right\} = \frac{{{\rm{CDIS1}} \cdot {\varepsilon _T}}}{{{k_T}}}\left( {{P_T} + {\rm{CDIS3}} \cdot {G_T}} \right) + {\rm{Diff}}_\varepsilon - {\rm{CDIS2}}\frac{{\varepsilon _T^2}}{{{k_T}}}"/></p>
</div><p>Here <span class="target" id="index-215"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CDIS1</span></code>, <span class="target" id="index-216"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CDIS2</span></code>, and <span class="target" id="index-217"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CDIS3</span></code> are all dimensionless
user-adjustable parameters, and have defaults of 1.44, 1.92 and 0.2, respectively for
the <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> model. In most of the flow domain, Eq.
<a class="reference internal" href="#equation-additionaltransportturbulentdissipation">(284)</a> replaces Eq.
<a class="reference internal" href="#equation-rateturbulentenergydissipation">(283)</a> and thus reduces the need for a
user-specified value of <img class="math" src="_images/math/aeec6515d1538e1defa141d32e3fb1fa086cca53.png" alt="{\rm{TLEN}}" style="vertical-align: 0px"/> throughout the domain.</p>
<p>The diffusion of dissipation, <img class="math" src="_images/math/46cfeadd2b7227ea5df97be30f2132a5b703c6d5.png" alt="{\rm{Diff}}_\varepsilon" style="vertical-align: -3px"/>, is:</p>
<div class="math" id="equation-diffusionofdissipation">
<p><span class="eqno">(285)<a class="headerlink" href="#equation-diffusionofdissipation" title="Permalink to this equation">¶</a></span><img src="_images/math/3d7009eec931992de5c8a1f406f5142529dbbfc5.png" alt="{\rm{Diff}}_\varepsilon = \frac{1}{{{V_F}}}\left\{ {\frac{\partial }{{\partial x}}\left( {{\upsilon _\varepsilon }{A_x}\frac{{\partial {\varepsilon _T}}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {{\upsilon _\varepsilon }{A_y}R\frac{{\partial {\varepsilon _T}}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{\upsilon _\varepsilon }{A_z}\frac{{\partial {\varepsilon _T}}}{{\partial z}}} \right) + \xi \frac{{{\upsilon _\varepsilon }{A_x}{\varepsilon _T}}}{x}} \right\}"/></p>
</div><p>Another turbulence model is based on Renormalization-Group (RNG)
methods <a class="reference internal" href="zbibliography.html#yakhot-orszag-1986" id="id43">[YO86]</a> <a class="reference internal" href="zbibliography.html#yakhot-smith-1992" id="id44">[YS92]</a>. This approach
applies statistical methods to the derivation of the averaged equations for
turbulence quantities, such as turbulent kinetic energy and its dissipation
rate.</p>
</div>
<div class="section" id="rng-k-epsilon">
<span id="rng"></span><h5>RNG k-epsilon<a class="headerlink" href="#rng-k-epsilon" title="Permalink to this headline">¶</a></h5>
<p>The RNG model uses equations similar to the equations for the <img class="math" src="_images/math/c20b779606cad94983ac42abe35d81a8319d5185.png" alt="k -
\varepsilon" style="vertical-align: 0px"/> model. However, equation constants that are found empirically in
the standard <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> model are derived explicitly in the RNG
model. Generally, the RNG model has wider applicability than the standard
<img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> model. In particular, the RNG model is known to
describe low intensity turbulence flows and flows having strong shear regions
more accurately. Also, the default values of <span class="target" id="index-218"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMTKE</span></code>, <span class="target" id="index-219"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CDIS1</span></code> and
<span class="target" id="index-220"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CNU</span></code> are different than are used in the <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> model;
they are 1.39, 1.42 and 0.085, respectively. <span class="target" id="index-221"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CDIS2</span></code> is computed from the
turbulent kinetic energy (<img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/>) and turbulent production (<img class="math" src="_images/math/11fe9b7102ed15faf477d2a6307492aacaf8ba0c.png" alt="P_T" style="vertical-align: -3px"/>) terms.</p>
<p>In all turbulence transport models, the kinematic turbulent viscosity is
computed from</p>
<div class="math" id="equation-kinematicturbulentviscosity">
<p><span class="eqno">(286)<a class="headerlink" href="#equation-kinematicturbulentviscosity" title="Permalink to this equation">¶</a></span><img src="_images/math/8f1028ddea076093482745396d228fd1af35bb7a.png" alt="{\nu _T} = {\rm{CNU}}\frac{{k_T^2}}{{{\varepsilon _T}}}"/></p>
</div><p>where <img class="math" src="_images/math/24a75620a0859613d3a7bf05ba501abde4fcf590.png" alt="{\nu _T}" style="vertical-align: -3px"/> is the turbulent kinematic viscosity.</p>
<p>One particular numerical challenge of both the two-equation <img class="math" src="_images/math/c20b779606cad94983ac42abe35d81a8319d5185.png" alt="k -
\varepsilon" style="vertical-align: 0px"/> and RNG models is the need to limit the value of <img class="math" src="_images/math/a076a6f700a948b90bcc207d961e207af6cc80e8.png" alt="\varepsilon
_T" style="vertical-align: -3px"/> from below. Equation <a class="reference internal" href="#equation-additionaltransportturbulentdissipation">(284)</a> could
produce values of <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> very near zero, and although physically
<img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> should approach zero in such instances as well, it may fail to do so
for numerical reasons, resulting in unphysically large values of <img class="math" src="_images/math/cd8ff0110ec1b79d43b525adceec207e086480b4.png" alt="{\nu
_T}" style="vertical-align: -3px"/> in Eq. <a class="reference internal" href="#equation-kinematicturbulentviscosity">(286)</a>. To deal with this
problem, we limit the value of <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> such that it cannot fall
below</p>
<div class="math" id="equation-limitvalueofvarepsilont">
<p><span class="eqno">(287)<a class="headerlink" href="#equation-limitvalueofvarepsilont" title="Permalink to this equation">¶</a></span><img src="_images/math/7f15d82dbf70b689937aa9233c09df7b8a7289b0.png" alt="{\varepsilon _{T,\min }} = {\rm{CNU}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}}} \frac{{{k_T}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}}}}{{\rm{TLEN}}}"/></p>
</div><p>where <span class="target" id="index-222"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TLEN</span></code> is the <em>maximum turbulent length scale</em>. This can be defined
by the user or the turbulent length scale can be limited automatically. Further
discussion on this is presented in the following section.</p>
</div>
<div class="section" id="k-omega">
<span id="id45"></span><h5>k-omega<a class="headerlink" href="#k-omega" title="Permalink to this headline">¶</a></h5>
<p>Each of the models above offers a set of strengths at varying levels of complexity. The <img class="math" src="_images/math/13853265c95e6af6471a597df7645aff4c6d1421.png" alt="k - \omega" style="vertical-align: 0px"/> two-equation model is no exception. In certain flow conditions, it is superior to the <img class="math" src="_images/math/8116d534728af5bfda694b22b8809c952fd7ba30.png" alt="k - \varepsilon" style="vertical-align: 0px"/> or RNG models, in particular, near wall boundaries and in flows with streamwise pressure gradients like jets and wakes. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> users often encounter these flow regimes in their applications and therefore, could benefit from the superior properties of this turbulence model.</p>
<p>The variable <img class="math" src="_images/math/534baa068359d030674cc73c21a9651cf30cfb80.png" alt="\omega \equiv \varepsilon/k" style="vertical-align: -5px"/> <a class="reference internal" href="zbibliography.html#kolmogorov-1942" id="id46">[Kol42]</a> has dimensions of 1/time. The <img class="math" src="_images/math/13853265c95e6af6471a597df7645aff4c6d1421.png" alt="k - \omega" style="vertical-align: 0px"/> <a class="reference internal" href="zbibliography.html#wilcox-1998" id="id47">[Wil98]</a> is formulated as:</p>
<div class="math" id="equation-komegaktransportequation">
<p><span class="eqno">(288)<a class="headerlink" href="#equation-komegaktransportequation" title="Permalink to this equation">¶</a></span><img src="_images/math/72776be8732941f933e4a9a3019b89c29a72ad93.png" alt="\frac{{\partial {k_T}}}{{\partial t}} + \frac{1}{{{V_F}}}\left\{ {u{A_x}\frac{{\partial {k_T}}}{{\partial x}} + v{A_y}\frac{{\partial {k_T}}}{{\partial y}} + w{A_z}\frac{{\partial {k_T}}}{{\partial z}}} \right\} = {P_T} + {G_T} + {\rm{Diff}}_{{k_T}} - {{\beta^*} {k}{\omega}}"/></p>
</div><p>where:</p>
<div class="math" id="equation-komegabetak">
<p><span class="eqno">(289)<a class="headerlink" href="#equation-komegabetak" title="Permalink to this equation">¶</a></span><img src="_images/math/b88539840c6b194019a22a4bedf3d3110d0bf6ff.png" alt="\beta^* = \beta^*_0 f_{\beta^*}"/></p>
</div><p>with <img class="math" src="_images/math/43f23e12ec865253ca7a15e04667a9917ca1892c.png" alt="\beta^*_0=0.09" style="vertical-align: -5px"/> and</p>
<div class="math" id="equation-komegafbetak">
<p><span class="eqno">(290)<a class="headerlink" href="#equation-komegafbetak" title="Permalink to this equation">¶</a></span><img src="_images/math/cb50e470c4367e2436fef65c223b06f853d9812e.png" alt="f_{\beta^*} = 1 \quad {\rm{when}} \quad {\chi}_k \leq 0 \quad {\rm{and}} \quad f_{\beta^*} = {\frac{1+680{\chi}_k^2}{1+400{\chi}_k^2}} \quad {\rm{when}} \quad {\chi}_k &gt; 0"/></p>
</div><p>where:</p>
<div class="math" id="equation-komegachik">
<p><span class="eqno">(291)<a class="headerlink" href="#equation-komegachik" title="Permalink to this equation">¶</a></span><img src="_images/math/24fc13b0139646503ae137bb109f339b90825123.png" alt="\chi_k \equiv {\frac{1}{\omega^3}}\left( {\frac{\partial {k_T}}{\partial {x}}} {\frac{\partial {\omega_T}}{\partial {x}}} + {\frac{\partial {k_T}}{\partial {y}}} {\frac{\partial {\omega_T}}{\partial {y}}}+ {\frac{\partial {k_T}}{\partial {z}}} {\frac{\partial {\omega_T}}{\partial {z}}} \right)"/></p>
</div><p><span class="target" id="index-223"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMTKE</span></code> for the diffusion term is 1/2.</p>
<p>For <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> transport we have:</p>
<div class="math" id="equation-transportturbulentomega">
<p><span class="eqno">(292)<a class="headerlink" href="#equation-transportturbulentomega" title="Permalink to this equation">¶</a></span><img src="_images/math/e72990adc9a43851bac564425e9280228545d352.png" alt="\frac{{\partial {\omega _T}}}{{\partial t}} + \frac{1}{{{V_F}}}\left\{ {u{A_x}\frac{{\partial {\omega _T}}}{{\partial x}} + v{A_y}R\frac{{\partial {\omega _T}}}{{\partial y}} + w{A_z}\frac{{\partial {\omega _T}}}{{\partial z}}} \right\} = {\alpha}\frac{{{\omega _T}}}{{{k_T}}}\left( {{P_T} + {\rm{CDIS3}} \cdot {G_T}} \right) + {\rm{Diff}}_\omega - {\beta}{\omega _T^2}"/></p>
</div><p>where <img class="math" src="_images/math/ef57f85c38f30e90809a783442bdaf5106da5e59.png" alt="\alpha=13/25" style="vertical-align: -5px"/>, <span class="target" id="index-224"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMDTKE</span></code> = <img class="math" src="_images/math/4586f63e2f80e6935325b6024ac3a2d1716dec1e.png" alt="1/2" style="vertical-align: -5px"/> and</p>
<div class="math" id="equation-komegabetaw">
<p><span class="eqno">(293)<a class="headerlink" href="#equation-komegabetaw" title="Permalink to this equation">¶</a></span><img src="_images/math/0523f37a8296149a889b251ed7335d23f1bf9867.png" alt="\beta = \beta_0 f_{\beta}"/></p>
</div><p>with <img class="math" src="_images/math/15a9936af2632a14d4330f1e74ad38bac9e565b7.png" alt="\beta_0=9/125" style="vertical-align: -5px"/> and</p>
<div class="math" id="equation-komegafbetaw">
<p><span class="eqno">(294)<a class="headerlink" href="#equation-komegafbetaw" title="Permalink to this equation">¶</a></span><img src="_images/math/c6e218f6c0b58685c3b8ebb24721a2fbdf35377f.png" alt="f_{\beta} = {\frac{1+70{\chi}_\omega}{1+80{\chi}_\omega}}"/></p>
</div><p>where:</p>
<div class="math" id="equation-komegachiw">
<p><span class="eqno">(295)<a class="headerlink" href="#equation-komegachiw" title="Permalink to this equation">¶</a></span><img src="_images/math/f6f98fac1be9f0983315ee1e9a060db1f860cab8.png" alt="\chi_w \equiv \left| {\frac{\Omega_{ij} \Omega_{jk} S_{ki}}{(\beta^*_0 \omega)^3}} \right|"/></p>
</div><p><img class="math" src="_images/math/761c3ee7c063df196e53e196fb54722b1dc3e655.png" alt="\Omega_{ij}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/090250527dbd19fd71e06a25489c3e1c73848329.png" alt="S_{ij}" style="vertical-align: -6px"/> are the mean-rotation and mean-strain-rate tensors respectively and the buoyancy term is the same as Eq. <a class="reference internal" href="#equation-buoyancyproduction">(281)</a>.</p>
<p>For reference, in the <img class="math" src="_images/math/13853265c95e6af6471a597df7645aff4c6d1421.png" alt="k - \omega" style="vertical-align: 0px"/> model <img class="math" src="_images/math/33d893f45d3b6092c0de4e358887887075fa6539.png" alt="\varepsilon = \beta^* \omega k" style="vertical-align: -4px"/> and <img class="math" src="_images/math/c106573436dc445c299545b0725422cf6828b771.png" alt="\nu_T=k/\omega" style="vertical-align: -5px"/>.</p>
<p>The principal goal of any turbulence model is to provide a mechanism for
estimating the influence of turbulent fluctuations on the mean flow quantities.
This influence is usually expressed by additional diffusion terms in the
equations for mean mass, momentum, and energy transport, Eqs.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>, <a class="reference internal" href="#equation-momentumconservation">(9)</a> and
<a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>. Because turbulence enhances the diffusion of momentum,
it effectively enhances the viscosity. Wherever the coefficient of dynamic
viscosity appears in the equations, we assume that it is a sum of the molecular
and turbulent viscosities,</p>
<div class="math" id="equation-coefficientdynamicviscosity">
<p><span class="eqno">(296)<a class="headerlink" href="#equation-coefficientdynamicviscosity" title="Permalink to this equation">¶</a></span><img src="_images/math/14610f3a7c34bbe4a2f862952939af4cad67bc14.png" alt="\mu  = \rho \left( {\nu  + {\nu _T}} \right)"/></p>
</div><p>Strictly speaking, this is not always correct, but it is a good approximation
for high levels of turbulence, i.e., when the turbulent viscosity is much larger
than the molecular value. At low levels of turbulence the <img class="math" src="_images/math/c20b779606cad94983ac42abe35d81a8319d5185.png" alt="k -
\varepsilon" style="vertical-align: 0px"/> model is not correct without additional modifications.</p>
<span class="target" id="index-225"></span></div>
<div class="section" id="prandtl-mixing-length-model">
<span id="prandtlmixinglengthmodelth"></span><span id="index-226"></span><h5>Prandtl Mixing Length Model<a class="headerlink" href="#prandtl-mixing-length-model" title="Permalink to this headline">¶</a></h5>
<p>The simplest model, the Prandtl mixing length model, assumes that the fluid
viscosity is enhanced by turbulent mixing processes in regions of high shear,
e.g., near solid boundaries. However, this is really only adequate for fully
developed, nearly steady flows. More generally, it is necessary to account for
some transport processes (i.e., convection and diffusion) to better emulate the
space and time distributions of turbulence intensity. The Prandtl mixing length
model assumes that turbulence production and dissipation are in balance
everywhere in the flow:</p>
<div class="math" id="equation-prandtlmixingturbulenceprodanddissipationinbalance">
<p><span class="eqno">(297)<a class="headerlink" href="#equation-prandtlmixingturbulenceprodanddissipationinbalance" title="Permalink to this equation">¶</a></span><img src="_images/math/829be1599a0396815941d050a26d88b7b931b940.png" alt="{P_T} + {G_T} = {\varepsilon _T}"/></p>
</div><p>where, as above,</p>
<ul class="simple">
<li><img class="math" src="_images/math/11fe9b7102ed15faf477d2a6307492aacaf8ba0c.png" alt="P_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/a75e2e12c28348e1910a911dceb37d31772b2f27.png" alt="G_T" style="vertical-align: -3px"/> are the turbulence productions due to shearing and buoyancy effects, respectively, and</li>
<li><img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> is the turbulence dissipation.</li>
<li><img class="math" src="_images/math/11fe9b7102ed15faf477d2a6307492aacaf8ba0c.png" alt="P_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/a75e2e12c28348e1910a911dceb37d31772b2f27.png" alt="G_T" style="vertical-align: -3px"/> are defined as above. In other words, advection, diffusion, and the time rate of change of turbulent energy are neglected. The turbulence dissipation can also be written as</li>
</ul>
<div class="math" id="equation-prandtlmixingturbulencedissipation2">
<p><span class="eqno">(298)<a class="headerlink" href="#equation-prandtlmixingturbulencedissipation2" title="Permalink to this equation">¶</a></span><img src="_images/math/b6613583f6f339bf9af2157972f7d10bc090f1fb.png" alt="{\varepsilon _T} = {\rm{CNU}}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}} \frac{{{k_T}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}}}}{{\rm{TLEN}}}"/></p>
</div><p>where <span class="target" id="index-227"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CNU</span></code> is a parameter (0.09 by default). Combining Eqs.
<a class="reference internal" href="#equation-prandtlmixingturbulenceprodanddissipationinbalance">(297)</a> and
<a class="reference internal" href="#equation-prandtlmixingturbulencedissipation2">(298)</a>, <img class="math" src="_images/math/e177705d166e4996cbcc1b71e736acf68e86326f.png" alt="{k_T}" style="vertical-align: -3px"/> is computed in terms of
<span class="target" id="index-228"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TLEN</span></code> and the local shear rates and pressure/density gradients. Then
<img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <span class="target" id="index-229"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TLEN</span></code> can be used to compute the turbulent kinematic viscosity
<img class="math" src="_images/math/24a75620a0859613d3a7bf05ba501abde4fcf590.png" alt="{\nu _T}" style="vertical-align: -3px"/> from</p>
<div class="math" id="equation-turbulentkinematgicviscosityvt">
<p><span class="eqno">(299)<a class="headerlink" href="#equation-turbulentkinematgicviscosityvt" title="Permalink to this equation">¶</a></span><img src="_images/math/6d159ed8fc4e21949fbbb3bb2f0064dddf7fd4fe.png" alt="{\nu _T} =  {\rm{CNU}}^{{\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}} {\rm{TLEN}} \sqrt {k_T}"/></p>
</div><p>It has been shown that this procedure produces a result which is a
generalization of the original Prandtl mixing length model <a class="reference internal" href="zbibliography.html#rodi-1980" id="id48">[Rod80]</a>.
Because of its restrictive assumptions, this model is less useful than the
one- and two-equation turbulence transport models.</p>
<span class="target" id="index-230"></span></div>
<div class="section" id="large-eddy-simulation-model">
<span id="largeeddysimulationmodelth"></span><span id="index-231"></span><h5>Large Eddy Simulation Model<a class="headerlink" href="#large-eddy-simulation-model" title="Permalink to this headline">¶</a></h5>
<p>The Large Eddy Simulation (LES) model of turbulence arose from atmospheric
modeling efforts. The basic idea is that one should directly compute all
turbulent flow structures that can be resolved by the computational grid and
only approximate those features that are too small to be resolved
<a class="reference internal" href="zbibliography.html#smagorinsky-1963" id="id49">[Sma63]</a>. When using the LES model, it is important to remember
that the model is inherently three dimensional and time-dependent. Furthermore,
fluctuations must be initialized and/or input at inflow boundaries. Although
this requires more effort, and computations can be CPU-intensive due to the
finer meshes than otherwise would be required, LES results often provide more
information than that produced by models based on Reynolds averaging (i.e., the
aforementioned models). For example, when LES models are used to compute
turbulent flow around large buildings, one gets not only mean wind stresses but
also an estimate of the magnitude and standard deviation of force fluctuations
associated with the turbulent flow.</p>
<p>In the LES model, the effects of turbulence too small to compute are represented
by an eddy viscosity, which is proportional to a length scale times a measure of
velocity fluctuations on that scale. For the length scale, <a class="reference internal" href="zbibliography.html#smagorinsky-1963" id="id50">[Sma63]</a>
uses a geometric mean of the grid cell dimensions,</p>
<div class="math" id="equation-geometricmeanofgridcelldimensions">
<p><span class="eqno">(300)<a class="headerlink" href="#equation-geometricmeanofgridcelldimensions" title="Permalink to this equation">¶</a></span><img src="_images/math/52eee7e662d6eff94f34e21c5b6a9bb9d28cfc9f.png" alt="L = {(\delta x\delta y\delta z)^{\frac{1}{3}}}"/></p>
</div><p>and scales velocity fluctuations by the magnitude of <img class="math" src="_images/math/48db08e51669ad87af374b5f0fd4dacbb2de0ea6.png" alt="L" style="vertical-align: 0px"/> times the mean
shear stress. These quantities are combined into the LES kinematic eddy
viscosity,</p>
<div class="math" id="equation-leskinematiceddyviscosity">
<p><span class="eqno">(301)<a class="headerlink" href="#equation-leskinematiceddyviscosity" title="Permalink to this equation">¶</a></span><img src="_images/math/1802d3d8709215d7b9cd43fd6e733731a29e9d5f.png" alt="{v_T} = {(cL)^2} \cdot \sqrt {2{e_{ij}}2{e_{ij}}}"/></p>
</div><p>where <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is a constant having a typical value in the range of 0.1 to 0.2
and <img class="math" src="_images/math/992f70236542777c373e18ea21c43911c1367e5e.png" alt="e_{ij}" style="vertical-align: -6px"/> denotes the strain rate tensor components. This kinematic
eddy viscosity is incorporated into the dynamic viscosity used throughout <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> in
exactly the same way as it is for the turbulence transport models (Eq.
<a class="reference internal" href="#equation-coefficientdynamicviscosity">(296)</a>):</p>
<div class="math" id="equation-kinematiceddyviscosityincoropratedintodynamicviscosity">
<p><span class="eqno">(302)<a class="headerlink" href="#equation-kinematiceddyviscosityincoropratedintodynamicviscosity" title="Permalink to this equation">¶</a></span><img src="_images/math/f6becfa6b9a7fdab339f53e6d78f20297a0b66cf.png" alt="\mu = \rho \left( {\nu + {\nu _T}} \right)"/></p>
</div></div>
</div>
<div class="section" id="turbulent-scales">
<span id="turbulentscalesth"></span><span id="index-232"></span><h4>Turbulent Scales<a class="headerlink" href="#turbulent-scales" title="Permalink to this headline">¶</a></h4>
<p>Turbulent time and length scales can be formed from turbulent kinetic energy and
dissipation</p>
<div class="math" id="equation-turbulenttimeandlengthscales">
<p><span class="eqno">(303)<a class="headerlink" href="#equation-turbulenttimeandlengthscales" title="Permalink to this equation">¶</a></span><img src="_images/math/89d107854bac22e5ac09920cb02943419a5ec7bc.png" alt="\begin{gathered}
{T_T} = \frac{{{k_T}}}{{{\varepsilon _T}}} \\
\\
{L_T} =  {\rm{CNU}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}}} \frac{{{k_T}^{{\raise0.5ex\hbox{$\scriptstyle 3$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}}}}{{\varepsilon_T}} \\
\end{gathered}"/></p>
</div><p>In the equation for <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> as well as turbulent viscosity the
term <img class="math" src="_images/math/85c1bb810c7d43bb0fb436618132cd814e22115b.png" alt="{k_T}/{\varepsilon _T}" style="vertical-align: -5px"/> is replaced by the turbulent time scale.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, <span class="target" id="index-233"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TLEN</span></code> is a user-defined parameter that represents an estimate of
the actual turbulent length scale for the one-equation model, and a maximum
value of the length scale for the two-equation models. Additionally, this
maximum turbulent length scale can be computed automatically as a function of
space and time during the simulation.</p>
<p>When the dynamic computation is selected, the model computes the bounded
turbulent time and length scales. The bounded turbulent time scale is</p>
<div class="math" id="equation-boundedturbulenttimescaletime">
<p><span class="eqno">(304)<a class="headerlink" href="#equation-boundedturbulenttimescaletime" title="Permalink to this equation">¶</a></span><img src="_images/math/2581029bbbbf696d5fa35f82df5f77468e528ac1.png" alt="{\tilde T_T} = \max \left[ {T_T^{\rm{low}},\min \left( {T_T^{\rm{up}},\frac{{{k_T}}}{{{\varepsilon _T}}}} \right)} \right]"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-boundedturbulenttimescalelength">
<p><span class="eqno">(305)<a class="headerlink" href="#equation-boundedturbulenttimescalelength" title="Permalink to this equation">¶</a></span><img src="_images/math/10cfad38a1841834249955394d6073dea58a4d18.png" alt="{\tilde L_T} = \max \left[ {L_T^{\rm{low}},\min \left( {L_T^{\rm{up}},{\rm{CNU}}^{3/4} \frac{{ k_T^{3/2}}}{{{\varepsilon _T}}}} \right)} \right]"/></p>
</div><p>These limiters originate from the Kolmogorov scales <a class="reference internal" href="zbibliography.html#pope-2000" id="id51">[Pop00]</a> on the lower bound
and the rapid distortion theory on the upper bound <a class="reference internal" href="zbibliography.html#kato-launder-1993" id="id52">[KL93]</a>,
<a class="reference internal" href="zbibliography.html#durbin-1996" id="id53">[Dur96]</a>.</p>
<p>In the case of <img class="math" src="_images/math/13853265c95e6af6471a597df7645aff4c6d1421.png" alt="k - \omega" style="vertical-align: 0px"/> :</p>
<div class="math" id="equation-komegaturbulenttimeandlengthscales">
<p><span class="eqno">(306)<a class="headerlink" href="#equation-komegaturbulenttimeandlengthscales" title="Permalink to this equation">¶</a></span><img src="_images/math/aea5f44f135502ec914a76858c3fb2ecdaa70a95.png" alt="\begin{gathered}
{T_T} = \frac{1}{\beta^* \omega_T} \\
\\
{L_T} =  \frac{{{k_T}^{{\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 2$}}}}}{{\rm{\beta^*}^{{\raise0.5ex\hbox{$\scriptstyle 1$}
\kern-0.1em/\kern-0.15em
\lower0.25ex\hbox{$\scriptstyle 4$}}}}{\omega_T}} \\
\end{gathered}"/></p>
</div><p>and the limiters follow similarly.</p>
</div>
<div class="section" id="turbulence-boundary-conditions">
<span id="turbulenceboundaryconditionsth"></span><span id="index-234"></span><h4>Turbulence Boundary Conditions<a class="headerlink" href="#turbulence-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>Equations <a class="reference internal" href="#equation-turbulentkineticenergy">(277)</a> and
<a class="reference internal" href="#equation-additionaltransportturbulentdissipation">(284)</a> constitute the two-equation
turbulence models used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. Boundary conditions for these equations are
partly built into the equations through the fractional areas. For instance,
all advective and diffusive fluxes are automatically zero at rigid walls where
the fractional open areas vanish. At free surfaces, tangential stresses are
zero because of vanishing velocity derivatives across the surface.</p>
<p>At inflow boundaries, the user can specify turbulent kinetic energy and
dissipation directly. If a value is provided for the turbulent kinetic energy,
but not dissipation, then a value for the dissipation will be automatically
computed based on the value of <span class="target" id="index-235"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TLEN</span></code>.</p>
<p>Tangential stresses evaluated at wall boundaries are also zero because of zero
flow areas. However, there should be contributions to the <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> transport equations arising from tangential wall shear
stresses. These stresses occur in laminar sub-layers and are proportional to the
molecular viscosity and local velocity gradients. Thus, we could incorporate
wall shear stress contributions in the production term <img class="math" src="_images/math/11fe9b7102ed15faf477d2a6307492aacaf8ba0c.png" alt="P_T" style="vertical-align: -3px"/>.
Unfortunately, this approach does not always seem to work well. It does not
properly limit the values of <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> near
boundaries. Therefore, we have followed the more standard procedure (e.g.,
Reference <a class="reference internal" href="zbibliography.html#rodi-1980" id="id54">[Rod80]</a>) in which <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> are
specified at mesh locations adjacent to wall boundaries.</p>
<p>Because the FAVOR<sup>TM</sup> method accounts for wall boundaries that can pass through a
mesh cell at any angle, the calculation of suitable boundary values for
<img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> has been generalized beyond a simple cell
edge evaluation.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> values are assigned to <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/> in every
mesh cell that has one or more of its faces partially blocked or wholly blocked
by a rigid wall. To determine boundary values for <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>, the usual procedure assumes a local equilibrium between
turbulent shear production and decay processes and a law-of-the-wall velocity
profile <a class="reference internal" href="zbibliography.html#rodi-1980" id="id55">[Rod80]</a>. Combined with the definition of the turbulent viscosity,
Eq. <a class="reference internal" href="#equation-kinematicturbulentviscosity">(286)</a>, this leads to the values</p>
<div class="math" id="equation-turbulenttimescalelengthcombinedwithturbulentviscosity">
<p><span class="eqno">(307)<a class="headerlink" href="#equation-turbulenttimescalelengthcombinedwithturbulentviscosity" title="Permalink to this equation">¶</a></span><img src="_images/math/322f9866ac0b567bf6841e40b4fb35ca01177976.png" alt="{k_T} = \frac{{u_*^2}}{{\sqrt {\rm{CNU}} }}\quad {\text{and}}\quad {\varepsilon _T} = \frac{{u_*^3}}{{\kappa d}} \quad {\text{or}}\quad {\omega _T} = \frac{{u_*}}{{\sqrt{\rm{CNU}} \kappa d}}"/></p>
</div><p>where <img class="math" src="_images/math/81414a1de7f0c046f8897d3ca66d5cccf3c8a26d.png" alt="u^{*}" style="vertical-align: 0px"/> is the local shear velocity determined from the equation</p>
<div class="math" id="equation-localshearvelocityu">
<p><span class="eqno">(308)<a class="headerlink" href="#equation-localshearvelocityu" title="Permalink to this equation">¶</a></span><img src="_images/math/dce3487271ce6f794616725e94cb00655a0deb46.png" alt="u = {u_*}\left[ {\frac{1}{\kappa }{\mathbf{ln}}\left( {\frac{{\rho {u_*}d}}{\mu }} \right) + 5.0} \right]"/></p>
</div><p>and <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is the parallel component of the velocity computed adjacent to the
wall. The normal distance of the computed velocity from the wall is denoted by
<img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> and <img class="math" src="_images/math/8552154a335b142ca0da9298ca0c193c45daf188.png" alt="\kappa" style="vertical-align: 0px"/> is the von Karman constant.</p>
<p>Since the FAVOR<sup>TM</sup> method does not precisely locate wall locations within a cell,
approximations must be introduced to find <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>, <img class="math" src="_images/math/81414a1de7f0c046f8897d3ca66d5cccf3c8a26d.png" alt="u^{*}" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>. For this purpose, we first determine the direction of the wall normal
in the cell, then <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> can be computed as the component of the
cell-centered velocity that is parallel to the wall. The average distance to the
wall, <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>, is estimated to be half of the cell width in the wall normal
direction. That is, the triplet (<img class="math" src="_images/math/8baa18e36a1087dc297e35fe32f270f105923852.png" alt="\delta x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/e52f04f63fec4166edb346a6cdb2b041a1fcb832.png" alt="\delta y" style="vertical-align: -4px"/>,
<img class="math" src="_images/math/ac59b859f86a99e206d1350f2a25968b183176df.png" alt="\delta z" style="vertical-align: 0px"/>) is treated as a vector whose inner product with the wall
normal is defined as the cell width in the normal direction. Finally,
<img class="math" src="_images/math/81414a1de7f0c046f8897d3ca66d5cccf3c8a26d.png" alt="u^{*}" style="vertical-align: 0px"/> is iteratively computed from Eq.
<a class="reference internal" href="#equation-localshearvelocityu">(308)</a> in terms of
<img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> and <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>. If there is a mass source at the wall surface, then we
add to <img class="math" src="_images/math/81414a1de7f0c046f8897d3ca66d5cccf3c8a26d.png" alt="u^{*}" style="vertical-align: 0px"/> a term equal to <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> times the effective normal
injection speed of the mass. This roughly accounts for the additional shear
stress induced by mass injection. Once these quantities have been computed, Eq.
<a class="reference internal" href="#equation-turbulenttimescalelengthcombinedwithturbulentviscosity">(307)</a> is then used to
specify the cell-centered values of <img class="math" src="_images/math/a12540328f872a051bd3c1ef39a0609e0480a1a7.png" alt="k_T" style="vertical-align: -3px"/> and <img class="math" src="_images/math/28fe4383505dd097aed45ab322d9e0fd5e70cedd.png" alt="\varepsilon _T" style="vertical-align: -3px"/>,
which represent the desired boundary conditions.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#turbulencemodelboundaryconditionsth"><span class="std std-ref">Turbulence Model Boundary Conditions</span></a> in the <a class="reference internal" href="#numericalapproximationsth"><span class="std std-ref">Numerical Approximations</span></a> section.</p>
</div>
</div>
</div>
<div class="section" id="wall-heat-transfer">
<span id="wallheattransferth"></span><span id="index-236"></span><h3>Wall Heat Transfer<a class="headerlink" href="#wall-heat-transfer" title="Permalink to this headline">¶</a></h3>
<p>For calculations performed with the energy transport equation option, <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
allows the transfer of heat between fluid and structural material called a heat
structure. Fluid calculations may be fully compressible, nearly incompressible,
or incompressible flows. Heat structures may be either internal obstacles or
walls at the computational mesh boundaries. Heat transfer across two-dimensional
baffles is also permitted.</p>
<p>The heat transfer model has numerous options intended to provide flexibility for
the user. Flows may or may not be dominated by buoyant forces generated by the
heat transfer. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> calculates heat transfer from boundaries having a known
temperature, a specified heat flux, or a specified internal power source.
Multiple structures can be included, each with an independent
temperature/heat-flux/power-source model.</p>
<p>For two-fluid problems, the mixture internal energy equations, Eqs.
<a class="reference internal" href="#equation-fluidenergyequations1">(21)</a> and <a class="reference internal" href="#equation-heatoftransformation1">(25)</a>, are used so that a
source (or sink) term is added to the mixture energy. This term is evaluated
from the heat transfer between fluid and walls as described below. The source is
divided between the two fluids in such a way as to assure equal fluid
temperatures.</p>
<div class="section" id="energy-source-terms">
<span id="energysourcetermsth"></span><span id="index-237"></span><h4>Energy Source Terms<a class="headerlink" href="#energy-source-terms" title="Permalink to this headline">¶</a></h4>
<p>Evaluation of the energy source term must consider multiple structures. In any
computational mesh cell there may be more than one structure, in which case
the source must be the sum of the individual contributions. Each contribution
is determined by options specified for that structure. The source term may be
directly specified by the user as a time-dependent energy per unit time
(power) or calculated from the heat-structure and fluid temperatures.</p>
<p>Specified net heat-flow rates for a structure are converted to local heat-flow
rates by assuming a uniform heat flux over the surface of the heat structure.
Optionally, the heat flux may be uniform on the wetted area of the heat
structure. This results in an energy source rate for a computational mesh cell
of the form</p>
<div class="math" id="equation-energysourcerateforcomputationalmeshcell">
<p><span class="eqno">(309)<a class="headerlink" href="#equation-energysourcerateforcomputationalmeshcell" title="Permalink to this equation">¶</a></span><img src="_images/math/9146257bada576b5a2fa42d23507780d97053424.png" alt="q = \frac{{{W_A}{Q_T}}}{{{A_T}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/a1b86f89d38a0ecac2e8cbcb807a6e46d1bc68ff.png" alt="W_A" style="vertical-align: -3px"/>, <img class="math" src="_images/math/0d39481c7ab1a3c1c7fcaf82c4c0aa10c3c42fb8.png" alt="Q_T" style="vertical-align: -4px"/> , and <img class="math" src="_images/math/6a527a7a352d1523a66deaadf03c815285b397d1.png" alt="A_T" style="vertical-align: -3px"/> refer to the heat structure under consideration and represent the surface area within the cell, the total structure heat flow rate, and the total structure surface area, respectively.</li>
<li><img class="math" src="_images/math/0d39481c7ab1a3c1c7fcaf82c4c0aa10c3c42fb8.png" alt="Q_T" style="vertical-align: -4px"/> can be specified by the user as a time-dependent quantity.</li>
</ul>
<p>If the wall temperature of a heat structure is known (either as a specified or
calculated value), <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> evaluates the local energy source rate as</p>
<div class="math" id="equation-localenergysourcerate">
<p><span class="eqno">(310)<a class="headerlink" href="#equation-localenergysourcerate" title="Permalink to this equation">¶</a></span><img src="_images/math/ab6daddf30cd4e2eb04e8f7eb43d3152a193725c.png" alt="q = h{W_A}({T_w} - T)"/></p>
</div><p>where the heat transfer coefficient to the fluid, <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/>, may be specified by
the user or evaluated from correlation functions based on local conditions, as
described below. In Eq. <a class="reference internal" href="#equation-localenergysourcerate">(310)</a>, <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the fluid
surface temperature, <img class="math" src="_images/math/a1b86f89d38a0ecac2e8cbcb807a6e46d1bc68ff.png" alt="W_A" style="vertical-align: -3px"/> is the heat structure surface area, and
<img class="math" src="_images/math/f661723e0c77ee24f137c489cf6bec1e092f2e44.png" alt="T_w" style="vertical-align: -3px"/> is the heat-structure (i.e., obstacle or wall) surface temperature.</p>
<p>The heat-structure surface temperature, <img class="math" src="_images/math/f661723e0c77ee24f137c489cf6bec1e092f2e44.png" alt="T_w" style="vertical-align: -3px"/>, may be a specified time-dependent
quantity dynamically calculated from the conduction equation (as
described in <a class="reference internal" href="#diffusionprocessheatconductionheattransferth"><span class="std std-ref">Diffusion Processes</span></a>) or evaluated from the lumped
parameter expression</p>
<div class="math" id="equation-lumpedparameterexpression">
<p><span class="eqno">(311)<a class="headerlink" href="#equation-lumpedparameterexpression" title="Permalink to this equation">¶</a></span><img src="_images/math/2e869afdc515523c513d164020cdf5b27fa74019.png" alt="{M_w}{C_w}\frac{{d{T_w}}}{{dt}} = {\rm{POW}} - \sum q"/></p>
</div><p>where the sum is carried out over all cells connected to the structure,
<img class="math" src="_images/math/9b16b7caaca609c9d0b6ed2959233c5c4654a300.png" alt="{\rm{POW}}" style="vertical-align: 0px"/> is a specified time-dependent power for the structure, and
<img class="math" src="_images/math/b9f4fc0d1bd7ab822e76a1ef8fd4aebaa2a4b203.png" alt="{M_w}{C_w}" style="vertical-align: -3px"/> is the total heat capacity (mass times specific heat) of the
structure. The energy source terms <img class="math" src="_images/math/63a49bc6a730cec2e3e15896b3e086423d1aad32.png" alt="q" style="vertical-align: -4px"/> are calculated from Eq.
<a class="reference internal" href="#equation-localenergysourcerate">(310)</a>.</p>
</div>
<div class="section" id="surface-area-evaluation">
<span id="surfaceareaevaluationth"></span><span id="index-238"></span><h4>Surface Area Evaluation<a class="headerlink" href="#surface-area-evaluation" title="Permalink to this headline">¶</a></h4>
<p>The heat surface area in each fluid mesh cell is automatically evaluated by
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> from the geometry of the heat structure. However, a surface roughness
provided by the user can be used as a multiplicative factor on the geometric
area to increase or decrease the effective heat transfer rate. Specifying a
zero roughness, for example, eliminates the heat-structure calculation
entirely, which is useful for an adiabatic boundary. The surface area
multipliers <span class="target" id="index-239"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROBS</span></code> and <span class="target" id="index-240"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RWALL</span></code> are used to account for the
surface roughness of obstacles and  wall mesh boundaries, respectively. A
separate roughness variable <span class="target" id="index-241"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ROUGH</span></code> can be used to define frictional
roughness (see <a class="reference internal" href="model-reference.html#walleffectsmr"><span class="std std-ref">Wall Effects: Slip, Shear, and Component Roughness</span></a>).</p>
<p>The correct geometric surface area in a mesh cell is easily calculated at a mesh
boundary, since this boundary necessarily falls on a mesh coordinate plane.
Obstacle boundaries, on the other hand, may cut through mesh cells. In this case
the surface area is estimated by assuming that the surface is locally flat. This
is also consistent with the calculation of area and volume fractions within
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The result is then multiplied by the roughness to obtain the actual area
used in subsequent calculations.</p>
<p>The total surface area of a heat structure is evaluated by summing all the mesh
cell surface areas. Because of finite resolution, the calculated value may not
equal the exact geometric surface area of the obstacle. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> permits the user
to renormalize calculated areas by specifying known total areas through input.
This assures the correct total surface area in cases where the total area is
expected to be an important consideration for accurate results.</p>
</div>
<div class="section" id="fluid-obstacle-heat-transfer-coefficient">
<span id="fluidobstacleheattransfercoefficientth"></span><span id="index-242"></span><h4>Fluid/Obstacle Heat Transfer Coefficient<a class="headerlink" href="#fluid-obstacle-heat-transfer-coefficient" title="Permalink to this headline">¶</a></h4>
<p>Care must be taken to resolve areas where the flow variables have steep
gradients, including discontinuous surfaces and internal boundaries.
The VOF method, for example, allows one to resolve a free-surface boundary
inside a computational mesh cell and set boundary conditions in the cell
according to the amount of fluid in it and the surface orientation
<a class="reference internal" href="zbibliography.html#hirt-nichols-1981" id="id56">[HN81]</a>. Another example is the use of the FAVOR<sup>TM</sup> method
to describe the obstacle surfaces inside mesh cells
<a class="reference internal" href="zbibliography.html#hirt-sicilian-1985" id="id57">[HS85]</a>. The FAVOR<sup>TM</sup> method is also used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to
compute the fluid/obstacle interfacial heat fluxes.</p>
<p>Cell-centered temperatures represent control volume averaged fluid and obstacle
heat contents and may be substantially different from the interfacial
temperatures used in Eq. <a class="reference internal" href="#equation-localenergysourcerate">(310)</a>. Therefore, using
cell-centered temperatures to compute the interfacial flux would not be right. In
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, a linear interpolation of the temperature between a cell node and the
location of the metal/mold interface is employed to obtain metal and mold
temperatures at the interface <a class="reference internal" href="zbibliography.html#goldstein-1950" id="id58">[Gol50]</a>. These temperatures are then
used to compute the heat flux at the interface, Eq. <a class="reference internal" href="#equation-localenergysourcerate">(310)</a>.
The approximate location and orientation of the interface can be evaluated from
fractional area and volume fractions.</p>
<p>The interfacial temperatures are obtained by assuming a linear profile of the
temperature between the interface and the nearest cell node in the normal
direction to the interface. This procedure yields an effective heat transfer
coefficient <img class="math" src="_images/math/72309248d6db39af0e2e1f0fab49bc2b7a32c11f.png" alt="{h_{\rm{eff}}}" style="vertical-align: -3px"/> between two temperature nodes on either
side of the interface,</p>
<div class="math" id="equation-effectiveheattransfercoeffecientheff">
<p><span class="eqno">(312)<a class="headerlink" href="#equation-effectiveheattransfercoeffecientheff" title="Permalink to this equation">¶</a></span><img src="_images/math/7c847c04b1677a0ce90aac18fea6f3c1653e06b9.png" alt="{h_{\rm{eff}}} = \frac{{h\frac{{{k_1}{k_2}}}{{{a_1}{a_2}}}}}{{h\left( {\frac{{{k_1}}}{{{a_1}}} + \frac{{{k_2}}}{{{a_2}}}} \right) + \frac{{{k_1}{k_2}}}{{{a_1}{a_2}}}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/dd8d2d558dee8f3dc0b68f687626c94e040d52f4.png" alt="1/h" style="vertical-align: -5px"/> is the thermal resistance of the interface (defined by the user),</li>
<li><img class="math" src="_images/math/db59793ceba06bd3cea13ffaeb8a7767c614f94e.png" alt="k_1" style="vertical-align: -3px"/> and <img class="math" src="_images/math/081745e48ec442476ae2d82faaceda05a715970a.png" alt="k_2" style="vertical-align: -3px"/> are fluid and obstacle thermal conduction coefficients, and</li>
<li><img class="math" src="_images/math/7848814fe80b7b9d7192270de2733668dec05e75.png" alt="a_1" style="vertical-align: -3px"/> and <img class="math" src="_images/math/87a1d98503353faeca87b651ae6d3782a6518682.png" alt="a_2" style="vertical-align: -3px"/> are distances to the interface from the nearest cell nodes in the fluid and obstacle, respectively.</li>
</ul>
<p>Eq. <a class="reference internal" href="#equation-effectiveheattransfercoeffecientheff">(312)</a> implies the net heat transfer is limited by the
smallest of the thermal resistances of the fluid, obstacle and interface.
Conductive terms in the fluid and obstacle energy equations are also modified in
the interfacial cells to account more accurately for temperature gradients in
partially blocked cells.</p>
<p>In two-fluid problems the mixture heat transfer
coefficient is computed as a weighted average with respect to the local volume
fraction of each fluid</p>
<div class="math" id="equation-mixtureheatcoefficient2fluids">
<p><span class="eqno">(313)<a class="headerlink" href="#equation-mixtureheatcoefficient2fluids" title="Permalink to this equation">¶</a></span><img src="_images/math/31bb86b8ce32f850606dedf9eedda524ccbc2c83.png" alt="{h_{\rm{eff}}} = F \cdot {h_{\rm{eff1}}} + (1 - F) \cdot {h_{\rm{eff2}}}"/></p>
</div><p>where <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is the fluid fraction and <img class="math" src="_images/math/24f0631d503d9d7946e4f4a4070505d825a57614.png" alt="{h_{\rm{eff1}}}" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/e5b66cec437b2776d2c5e08d5a3d33a7bc373894.png" alt="{h_{\rm{eff2}}}" style="vertical-align: -3px"/> are computed according to Eq.
<a class="reference internal" href="#equation-effectiveheattransfercoeffecientheff">(312)</a>, in which <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> is substituted
by the heat transfer coefficient for fluids one and two, respectively.</p>
<p>If no heat transfer coefficient is supplied by the user, then it is evaluated by
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> using simple analytical or empirical expressions for flow over a flat
plate. Flow conditions near a wall in each control volume are correlated to one
of the following physical situations: natural convection, forced laminar and
turbulent convection, and conduction within the fluid. The heat transfer
coefficient is then derived based on the closest situation. It is important to
understand that the resulting value of <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> in each control volume reflects
heat transfer conditions in the <em>fluid layer</em> between the wall and the center of
the cell open volume. The actual thermal resistance of the fluid/obstacle
interface is assumed to be zero.</p>
<p>The thermal resistance of the contact interface between two materials, i.e.,
fluid and wall, represented in Eq. <a class="reference internal" href="#equation-heattransfercoefficientsolidfractionfs">(314)</a>
by the heat transfer coefficient <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/>, is largely a function of the surface
properties of the two materials, like roughness, and the size of the gap between
them, if any. In casting applications it may also be a function of temperature
and solid fraction. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the latter is accounted for through a linear
relationship between the heat transfer coefficient and the solid fraction
<img class="math" src="_images/math/e7f40891acbcdc6b2374ef73226e4a1484eeeb97.png" alt="F_s" style="vertical-align: -3px"/>:</p>
<div class="math" id="equation-heattransfercoefficientsolidfractionfs">
<p><span class="eqno">(314)<a class="headerlink" href="#equation-heattransfercoefficientsolidfractionfs" title="Permalink to this equation">¶</a></span><img src="_images/math/223734789202d2a9fc5b151dacc0805e07d27c56.png" alt="h = {F_s} \cdot {\rm{HOBS1S(n)}} + (1 - {F_s}) \cdot {\rm{HOBS1(n)}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><span class="target" id="index-243"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOBS1(n)</span></code> is the user-defined heat transfer coefficient in the liquid metal,</li>
<li><span class="target" id="index-244"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOBS1S(n)</span></code> is the user-defined heat transfer coefficient in the solid metal and</li>
<li><img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> is the component number described by these coefficients.</li>
</ul>
<p>Typically, <span class="target" id="index-245"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOBS1S(n)</span></code> is much smaller than <span class="target" id="index-246"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOBS1(n)</span></code> because of a
better contact that liquid materials make with walls than the solid ones.</p>
</div>
<div class="section" id="baffle-heat-transfer">
<span id="baffleheattransferth"></span><span id="index-247"></span><h4>Baffle Heat Transfer<a class="headerlink" href="#baffle-heat-transfer" title="Permalink to this headline">¶</a></h4>
<p>Heat transfer across baffles is quite different from that with heat structures.
Since baffles are treated as having no thickness and consequently no heat
capacity, the heat transfer rate depends only on the instantaneous fluid
temperatures on either side of the baffle.</p>
<p>Suppose one face of a baffle with porosity <span class="target" id="index-248"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PBAF</span></code> separates fluid cells
<img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> and <img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/>. The energy source (sink) rate in fluid cell <img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/>
is evaluated as:</p>
<div class="math" id="equation-energysourcesinkratefluidcellm">
<p><span class="eqno">(315)<a class="headerlink" href="#equation-energysourcesinkratefluidcellm" title="Permalink to this equation">¶</a></span><img src="_images/math/48db9556f1a0cdf8b32e99c485fa3ecda8668c98.png" alt="{q_M} = (1 - {\rm{PBAF}}) \cdot {\rm{HBFT}} \cdot ({T_N} - {T_M})"/></p>
</div><p>The effective heat transfer coefficient <span class="target" id="index-249"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HBFT</span></code> is approximated by an
electrical resistance analog as</p>
<div class="math" id="equation-effectiveheattransfercoefficienthbft">
<p><span class="eqno">(316)<a class="headerlink" href="#equation-effectiveheattransfercoefficienthbft" title="Permalink to this equation">¶</a></span><img src="_images/math/309ef1b6c21621ef20263c41972a89a44d628042.png" alt="{\rm{HBFT}} = \frac{{2{H_N}{H_M}}}{{{H_N} + {H_M}}}"/></p>
</div><p>where <img class="math" src="_images/math/7d2f05f457b4bc6af0363c594105c5073d23facd.png" alt="H_N" style="vertical-align: -3px"/>, for example, is the two-fluid volume weighted average for cell
<img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-2fluidvolumeweightedaveragecelln">
<p><span class="eqno">(317)<a class="headerlink" href="#equation-2fluidvolumeweightedaveragecelln" title="Permalink to this equation">¶</a></span><img src="_images/math/10ef510afcf461fc473c1397a2db02e7bf846d3b.png" alt="{H_N} = (1 - {F_N}) \cdot {\rm{HBAF2}} + {F_N} \cdot {\rm{HBAF1}}"/></p>
</div><p>and where <span class="target" id="index-250"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HBAF2</span></code> and <span class="target" id="index-251"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HBAF1</span></code> are user-supplied heat transfer
coefficients. These coefficients must account for any heat conduction losses as
well as convection. If both are zero, no heat is transferred across the baffle.</p>
</div>
<div class="section" id="heat-transfer-to-void-regions">
<span id="heattransfervoidregionsth"></span><span id="index-252"></span><h4>Heat Transfer to Void Regions<a class="headerlink" href="#heat-transfer-to-void-regions" title="Permalink to this headline">¶</a></h4>
<p>Fluid and obstacles transfer heat to void regions according to</p>
<div class="math" id="equation-heattransfervoidreqionseq">
<p><span class="eqno">(318)<a class="headerlink" href="#equation-heattransfervoidreqionseq" title="Permalink to this equation">¶</a></span><img src="_images/math/80f195005ffe9aaa7be61df960194f1265c9688d.png" alt="{q_V} = {h_V}{W_V}({T_V} - T)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/e9c94dadde0542ea1e1c837afd3bbd65960edfdb.png" alt="h_V" style="vertical-align: -3px"/> is a (constant) heat transfer coefficient,</li>
<li><img class="math" src="_images/math/1bf92692e11f73888812bcd0ecf02a7675c2e13f.png" alt="W_V" style="vertical-align: -3px"/> is the heat transfer surface area,</li>
<li><img class="math" src="_images/math/60247c693455a43c2132ffdae863a8cafc3b9f90.png" alt="T_V" style="vertical-align: -3px"/> the void region temperature, and</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the fluid or obstacle temperature. Each void can have a different but constant temperature.</li>
</ul>
<p>Heat transfer coefficients can be set for fluid/void heat transfer associated
with both convective and radiation heat losses. Similarly, two heat transfer
coefficients may be set for obstacle/void heat transfer. Another heat transfer
coefficient can be set for the heat exchange between a fluid and void separated
by a baffle.  Radiation is modeled based on the Stefan-Boltzmann law which
states that the rotal radiant energy is proportional to the fourth power of the
radiating body temperature and the temperature of the void.</p>
</div>
<div class="section" id="heat-transfer-to-cooling-channels">
<span id="heattransfercoolingchannelsth"></span><span id="index-253"></span><h4>Heat Transfer to Cooling Channels<a class="headerlink" href="#heat-transfer-to-cooling-channels" title="Permalink to this headline">¶</a></h4>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> models cooling channels as special regions. The fluid flow in the
channel is not modeled explicitly but instead the physical influence is
modeled approximately using the heat transfer coefficient and temperature of
the radiating surface. Obstacles transfer heat to cooling channels according
to</p>
<div class="math" id="equation-heattransfercoolingchannelseq">
<p><span class="eqno">(319)<a class="headerlink" href="#equation-heattransfercoolingchannelseq" title="Permalink to this equation">¶</a></span><img src="_images/math/80e9f349da60ce34d360d6ebfdd2a267a2d6c3d9.png" alt="{q_{cc}} = {h_{cc}}{W_{cc}}({T_{cc}} - T)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/e7066821340c688889e152996aaf09996408c7e4.png" alt="h_{cc}" style="vertical-align: -3px"/> is heat transfer coefficient,</li>
<li><img class="math" src="_images/math/8eef919d617efeb0e29895cd7d906b60f51742e6.png" alt="W_{cc}" style="vertical-align: -3px"/> is the heat transfer surface area,</li>
<li><img class="math" src="_images/math/dc85d8744ff20506cfa16f177b35bb2f5d7d3114.png" alt="T_{cc}" style="vertical-align: -3px"/> the cooling channel temperature, and</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the obstacle temperature.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="numerical-approximations">
<span id="numericalapproximationsth"></span><span id="index-254"></span><h2>Numerical Approximations<a class="headerlink" href="#numerical-approximations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="numericaloverviewth">
<span id="id59"></span><h3>Overview<a class="headerlink" href="#numericaloverviewth" title="Permalink to this headline">¶</a></h3>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> numerically solves the equations described in the previous sections
using finite-difference (or finite-volume) approximations. The flow region is
subdivided into a mesh of fixed rectangular cells. With each cell there are
associated local average values of all dependent variables. As explained in the
following, all variables are located at the centers of the cells except for
velocities, which are located at cell-faces (staggered grid arrangement).</p>
<p>Curved obstacles, wall boundaries, or other geometric features are embedded in
the mesh by defining the fractional face areas and fractional volumes of the
cells that are open to flow (the FAVOR<sup>TM</sup> method <a class="reference internal" href="zbibliography.html#hirt-sicilian-1985" id="id60">[HS85]</a>).</p>
<p>To construct discrete numerical approximations to the governing equations,
control volumes are defined surrounding each dependent variable location. For
each control volume, surface fluxes, surface stresses, and body forces can be
computed in terms of surrounding variable values. These quantities are then
combined to form approximations for the conservation laws expressed by the
equations of motion.</p>
<p>Most terms in the equations are evaluated using the current time-level values of
the local variables, i.e., explicitly, although various implicit options exist
as well. This produces a simple and efficient computational scheme for most
purposes but requires the use of a limited time-step size to maintain
computationally stable and accurate results.</p>
<p>One important exception to this explicit formulation is in the treatment of
pressure forces. Pressures and velocities are coupled implicitly by using
time-advanced pressures in the momentum equations and time-advanced velocities
in the mass (continuity) equation. This implicit formulation of the
finite-difference equations allows for the efficient and stable solution of
low speed compressible and incompressible flow problems.</p>
<p>The implicit pressure-velocity formulation results in coupled sets of
equations that must be solved by an iterative technique. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, three such
techniques are provided. The simplest is a successive over-relaxation (SOR) method.
In some instances, where a more implicit solution method is required, a special
alternating-direction, line-implicit method (SADI) is available. As described
later, the SADI technique can be used in one, two, or in all three directions
depending on the characteristics of the problem to be solved. Finally,
a Generalized Minimal Residual (GMRES) method is also available. The GMRES solver
has superior convergence properties than the SOR and SADI methods, especially
in the presence of large source terms and in grids with variable cell sizes. The
GMRES solver is also more suitable for shared-memory parallelization. It is the
default solver.</p>
<p>The basic numerical method used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> has a formal accuracy that is
first-order with respect to time and space increments. Special precautions have been
taken to maintain this degree of accuracy even when the finite-difference mesh
is non-uniform. Second-order accurate options are also available. In any case,
boundary conditions are at least first-order accurate in all circumstances. For
example, in cells partially occupied by an obstacle, the FAVOR<sup>TM</sup> method is
equivalent to a first-order interpolation of boundary conditions within the
cell. However, the implementation of the heat transfer boundary conditions at
fluid/obstacle interfaces is second-order accurate with respect to the cell
size.</p>
<p>Input values of pressure and temperature are converted to absolute units based
degrees Kelvin. If gauge pressure is used to set up the simulation, then it is
converted to absolute scale using the reference pressure defined by the user
with the default being one atmosphere in the simulation units. The conversion
is done so that models that use an equation of state, such as the compressible
flow model, phase change or adiabatic bubble models, can be seamlessly integrated
into the simulation.</p>
<p>In the following sections these numerical techniques are made more precise
through specific examples of the finite-difference and control volume
approximations used throughout FAVOR<sup>TM</sup>.</p>
</div>
<div class="section" id="notation">
<span id="numericalnotationth"></span><span id="index-255"></span><h3>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h3>
<p>The finite-difference mesh used for numerically solving the governing
equations consists of rectangular cells of width <img class="math" src="_images/math/b52252bcf09440a62b3b7f4aaa7040e2af1c4ee3.png" alt="dx_i" style="vertical-align: -3px"/>, depth
<img class="math" src="_images/math/0ce3ece0c32ee345eb62c8133badda11e73940ed.png" alt="dy_j" style="vertical-align: -6px"/>, and height <img class="math" src="_images/math/4d2c1b95c39988867b66de841b51b927cf6211ef.png" alt="dz_k" style="vertical-align: -3px"/>. The active mesh region has IBAR cells
in the x-direction labeled with the index <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, JBAR cells in the
y-direction labeled with the index <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, and KBAR cells in the
z-direction labeled with the index <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>. This region is surrounded by
layers of fictitious or boundary cells used to set mesh boundary conditions.
Thus, there are usually (<em>IBAR + 2</em>)(<em>JBAR + 2</em>)(<em>KBAR + 2</em>) total cells in a
complete mesh. If periodic or specified pressure boundary conditions are used
in a given coordinate direction, however, one additional layer of boundary
cells is used in that direction. This fact must be remembered only when
setting dimension statements. The preprocessor will automatically initialize
the necessary number of boundary cells needed to satisfy all boundary
conditions. The figure below illustrates the cell labeling nomenclature.</p>
<div class="figure" id="id120">
<span id="mesharrangementandlabelingconvention"></span><a class="reference internal image-reference" href="_images/mesh-arrangement-and-labeling-convention.png"><img alt="Mesh arrangement and labeling convention" src="_images/mesh-arrangement-and-labeling-convention.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 11: Mesh arrangement and labeling convention</span></p>
</div>
<p>Fluid velocities and pressures are located at staggered mesh locations as shown
for a typical cell in the figure below: <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> velocities and fractional
areas <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/> at the centers of cell-faces normal to the x-direction, <img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/>
velocities and fractional areas <img class="math" src="_images/math/8adf1860c3314cce8ae4bd9d6e57e19bf0ffd1de.png" alt="A_y" style="vertical-align: -6px"/> at the centers of cell-faces normal
to the y-direction, and <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> velocities and fractional areas <img class="math" src="_images/math/2e6a1ee0ee3e238e36573fb81bfaaaeaa81ff9cc.png" alt="A_z" style="vertical-align: -3px"/> at the
centers of cell-faces normal to the z-direction. Pressures (<img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/>), fluid
fractions (<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>), fractional volumes (<img class="math" src="_images/math/2618d92ec29b4b2156fc2251e70e6459ddf41c2d.png" alt="V_F" style="vertical-align: -3px"/>), densities (<img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/>),
internal energy (<img class="math" src="_images/math/496af7d1f086e49a5be0614f2b933a137b0fd0a7.png" alt="I" style="vertical-align: 0px"/>), turbulence quantities for energy (<img class="math" src="_images/math/63a49bc6a730cec2e3e15896b3e086423d1aad32.png" alt="q" style="vertical-align: -4px"/>),
dissipation (<img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/>), and viscosity (<img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>) are at cell centers.</p>
<div class="figure" id="id121">
<span id="locationofvariablesinmeshcell"></span><img alt="Location of variables in a mesh cell" src="_images/location-of-variables-in-a-mesh-cell.png" />
<p class="caption"><span class="caption-text">Figure 12: Location of variables in a mesh cell</span></p>
</div>
<p>The finite-difference notation used here corresponds to that used in the code
where fractional index values cannot be used. The convention is that all
fractional indexes are decreased to the nearest whole integer. For example, the
<img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> velocity at <img class="math" src="_images/math/8427a55325b2cbda06204971e1c1fad91149c074.png" alt="i + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$}" style="vertical-align: -5px"/> which is located on the cell-face
between cells (<img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>) and (<img class="math" src="_images/math/6f59a3aca83b7992e68b3fdcd5d1e0bc8d3e8b6a.png" alt="i+1" style="vertical-align: -2px"/>, <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>,
<img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>), is denoted by <img class="math" src="_images/math/a855d4917b86bd44bddcc63b275592e7947ed3b7.png" alt="u_{i,j,k}^n" style="vertical-align: -8px"/>. A superscript <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> refers to
the <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>-th time-step value. Similarly,</p>
<div class="math" id="equation-finitedifferencenotation">
<p><span class="eqno">(320)<a class="headerlink" href="#equation-finitedifferencenotation" title="Permalink to this equation">¶</a></span><img src="_images/math/edf64db26eed28990cc64718ebee057c1fad1dec.png" alt="F_{i,j,k}^n and= {\text{ fluid fraction at center of cell }}\left( {i,{\text{ }}j,{\text{ }}k} \right){\text{ at time level }}n. \\
P_{i,j,k}^n and= {\text{ pressure at center of cell }}\left( {i,{\text{ }}j,{\text{ }}k} \right){\text{ at time level }}n. \\"/></p>
</div><p>Similarly for <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/>, <img class="math" src="_images/math/496af7d1f086e49a5be0614f2b933a137b0fd0a7.png" alt="I" style="vertical-align: 0px"/>, <img class="math" src="_images/math/63a49bc6a730cec2e3e15896b3e086423d1aad32.png" alt="q" style="vertical-align: -4px"/>, <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/>, and <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>.</p>
<div class="math" id="equation-finitedifferencerhoiqdmu">
<p><span class="eqno">(321)<a class="headerlink" href="#equation-finitedifferencerhoiqdmu" title="Permalink to this equation">¶</a></span><img src="_images/math/7b4db7bd69b8c4f93d56a48e316691646deac746.png" alt="u_{i,j,k}^n and= {\text{x}} - {\text{direction velocity at middle of }}i + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face at time level n }}n. \\
\\
v_{i,j,k}^n and= {\text{ y}} - {\text{direction velocity at middle of }}j + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face at time level }}n. \\
\\
w_{i,j,k}^n and= {\text{ z}} - {\text{direction velocity at middle of }}k + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face at time level }}n. \\"/></p>
</div><p>Fractional areas and volumes appear with the following notation:</p>
<div class="math" id="equation-fractionalareasandvolumesnotation">
<p><span class="eqno">(322)<a class="headerlink" href="#equation-fractionalareasandvolumesnotation" title="Permalink to this equation">¶</a></span><img src="_images/math/571fa547e4e5fd5eb7011d1a89557d7763ce870e.png" alt="{\text{AF}}{{\text{R}}_{i,j,k}} and= {\text{ fractional area }}{A_x}{\text{ for flow in x}} - {\text{direction at }}i + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face}}. \\
\\
{\text{AF}}{{\text{B}}_{i,j,k}} and= {\text{ fractional area }}{A_y}{\text{ for flow in y}} - {\text{direction at }}j + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face}}. \\
\\
{\text{AF}}{{\text{T}}_{i,j,k}} and= {\text{ fractional area }}{A_x}{\text{ for flow in z}} - {\text{direction at }}k + \raise.5ex\hbox{$\scriptstyle 1$}\kern-.1em/
\kern-.15em\lower.25ex\hbox{$\scriptstyle 2$} {\text{ cell}} - {\text{face}}. \\
\\
{\text{V}}{{\text{F}}_{i,j,k}} and= {\text{fractional volume for flow at center of cell }}\left( {i,j,k} \right). \\"/></p>
</div><p>When free surfaces or fluid interfaces are present, it is necessary to
distinguish those cells that are empty, contain a surface, or are full of one
fluid. By definition, a surface cell is a cell containing fluid #1 and having at
least one adjacent cell (at <img class="math" src="_images/math/85b543d18c566a1b713f0801077ebc442b2ca34b.png" alt="i \pm 1" style="vertical-align: 0px"/>,<img class="math" src="_images/math/1a9eb633f8907a6507748436c2fbd26a50a5cf5d.png" alt="j \pm 1" style="vertical-align: -4px"/>,<img class="math" src="_images/math/5370c514d079c26a38e2314ca87c238563347bea.png" alt="k \pm
1" style="vertical-align: 0px"/>), that is empty or full of fluid #2. A cell with an <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value less than
unity, but with no empty neighbor, is considered a full cell in one-fluid
problems. A flag <img class="math" src="_images/math/febaca3b550b8b0c78aae95c8e18013bc5adde97.png" alt="N{F_{i,j,k}}" style="vertical-align: -6px"/> is used to label the cells and also, in
the case of surface cells, to indicate which neighboring cell lies in the
direction of the inward normal to the surface. The flag values are</p>
<div class="math" id="equation-distinguishfreesurfacecellflagvalues">
<p><span class="eqno">(323)<a class="headerlink" href="#equation-distinguishfreesurfacecellflagvalues" title="Permalink to this equation">¶</a></span><img src="_images/math/1ebd0623bbf4a4d750c0845598a3f67e57929abc.png" alt="N{F_{i,j,k}} and= 0 {\text { full or obstacle cell}} \\
and= 1 {\text{ surface (}} i - 1 {\text{ inward neighbor)}} \\
and= 2 {\text{ surface (}} i + 1 {\text{ inward neighbor)}} \\
and= 3 {\text{ surface (}} j - 1 {\text{ inward neighbor)}} \\
and= 4 {\text{ surface (}} j + 1 {\text{ inward neighbor)}} \\
and= 5 {\text{ surface (}} k - 1 {\text{ inward neighbor)}} \\
and= 6 {\text{ surface (}} k + 1 {\text{ inward neighbor)}} \\
and= 7 {\text{ cell undergoing cavitation}} \\
and= 8 {\text{ empty cell}} \\"/></p>
</div><p><img class="math" src="_images/math/475a93774871a5836c2e2d65820024940026e3a6.png" alt="NF" style="vertical-align: 0px"/> is used to indicate the orientation of the surface between two
fluids in an analogous manner.</p>
</div>
<div class="section" id="outline-of-finite-difference-solution-method">
<span id="finitedifferencesolutionmethodth"></span><span id="index-256"></span><h3>Outline of Finite Difference Solution Method<a class="headerlink" href="#outline-of-finite-difference-solution-method" title="Permalink to this headline">¶</a></h3>
<p>The basic procedure for advancing a solution through one increment in time,
<img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/>, consists of three steps:</p>
<ol class="arabic simple">
<li>Explicit approximations of the momentum equations, Eq. <a class="reference internal" href="#equation-momentumconservation">(9)</a>, are used to compute the first guess for new time-level velocities using the initial conditions or previous time-level values for all advective, pressure, and other accelerations.</li>
<li>To satisfy the continuity equation, Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>, <a class="reference internal" href="#equation-impressibilitycondition">(5)</a>, or <a class="reference internal" href="#equation-modifiedcontinuityequation">(8)</a>, when the implicit option is used, the pressures are iteratively adjusted in each cell and the velocity changes induced by each pressure change are added to the velocities computed in Step (1). An iteration is needed because the change in pressure needed in one cell will upset the balance in the six adjacent cells. In explicit calculations, an iteration may still be performed within each cell to satisfy the equation-of-state for compressible problems.</li>
<li>Finally, when there is a free-surface or fluid interface, it must be updated using Eq. <a class="reference internal" href="#equation-fluidinterfacesandfreesurfaces1">(19)</a> to give the new fluid configuration. For compressible problems, density, Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>, and energy, Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, must be updated to reflect advective, diffusive, and source processes. Turbulence quantities and wall temperatures are also updated in this step.</li>
</ol>
<p>Repetition of these steps will advance a solution through any desired time
interval. At each step, of course, suitable boundary conditions must be imposed
at all mesh, obstacle, and free-boundary surfaces. Details of these steps and
boundary conditions are given in the following sections.</p>
</div>
<div class="section" id="momentum-equation-approximations">
<span id="momentumequationapproximationsth"></span><span id="index-257"></span><h3>Momentum Equation Approximations<a class="headerlink" href="#momentum-equation-approximations" title="Permalink to this headline">¶</a></h3>
<p>A generic form for the finite-difference approximation of Equation
<a class="reference internal" href="#equation-momentumconservation">(9)</a> is (remember the fractional index convention)</p>
<div class="math" id="equation-finitedifferenceapproximationgeneralform">
<p><span class="eqno">(324)<a class="headerlink" href="#equation-finitedifferenceapproximationgeneralform" title="Permalink to this equation">¶</a></span><img src="_images/math/a9679afa4e7703ee669f67f704e6b6d6badc126a.png" alt="\begin{gathered}
u_{i,j,k}^{n + 1} = u_{i,j,k}^n + \delta {t^{n + 1}}\left[ { - \frac{{p_{i + 1,j,k}^{n + 1} - p_{i,j,k}^{n + 1}}}{{(\rho \delta x)_{i + \frac{1}{2},j,k}^n}} + {G_x} - {\rm{FUX}} - {\rm{FUY}} - {\rm{FUZ}} + {\rm{VISX}} - {\rm{BX}} - {\rm{WSHX}}} \right] \hfill \\
v_{i,j,k}^{n + 1} = v_{i,j,k}^n + \delta {t^{n + 1}}\left[ { - \frac{{p_{i,j + 1,k}^{n + 1} - p_{i,j,k}^{n + 1}}}{{(\rho \delta y)_{i,j + \frac{1}{2},k}^n}} \cdot {R_{i + \frac{1}{2}}} + {G_y} - {\rm{FVX}} - {\rm{FVY}} - {\rm{FVZ}} + {\rm{VISY}} - {\rm{BY}} - {\rm{WSHY}}} \right] \hfill \\
w_{i,j,k}^{n + 1} = w_{i,j,k}^n + \delta {t^{n + 1}}\left[ { - \frac{{p_{i,j,k + 1}^{n + 1} - p_{i,j,k}^{n + 1}}}{{(\rho \delta z)_{i,j,k + \frac{1}{2}}^n}} + {G_z} - {\rm{FWX}} - {\rm{FWY}} - {\rm{FWZ}} + {\rm{VISZ}} - {\rm{BZ}} - {\rm{WSHZ}}} \right] \hfill \\
\end{gathered}"/></p>
</div><p>here, for example,</p>
<div class="math" id="equation-momentumequationapprox1">
<p><span class="eqno">(325)<a class="headerlink" href="#equation-momentumequationapprox1" title="Permalink to this equation">¶</a></span><img src="_images/math/00a2b3569736762df8da92e69b4c178706ff725e.png" alt="(\rho \delta x)_{_{i + \frac{1}{2},j,k}}^n = \frac{{(\rho _{i,j,k}^n\delta {x_i} + \rho _{i + 1,j,k}^n\delta {x_{i + 1}})}}{2}"/></p>
</div><p>and</p>
<div class="math" id="equation-momentumequationapprox2">
<p><span class="eqno">(326)<a class="headerlink" href="#equation-momentumequationapprox2" title="Permalink to this equation">¶</a></span><img src="_images/math/08ac7661a0f0ce7af0d3fc8e4fe328bd5543fd7c.png" alt="{R_{i + \frac{1}{2}}} = \left\{ \begin{gathered}
1.0{\text{ in Cartesian coordinates}} \hfill \\
\frac{{{{\text{x}}_{{\text{max}}}}}}{{\frac{1}{2}({x_i} + {x_{i + 1}})}}{\text{ in cylindrical coordinates}} \hfill \\
\end{gathered} \right."/></p>
</div><p>The advective, viscous, and acceleration terms have an obvious meaning, e.g.,
<img class="math" src="_images/math/c159b41ab0134ea5978cc3291e168129df3e01c8.png" alt="{\rm{FUX}}" style="vertical-align: 0px"/> means the advective flux of <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> in the x-direction;
<img class="math" src="_images/math/a98b332e8cc8e252d79092cd4f12b50b17d4b5c1.png" alt="{\rm{VISX}}" style="vertical-align: 0px"/> is the x-component viscous acceleration; <img class="math" src="_images/math/4fd0a4466852ab4cf72df7273907eb4fae749b15.png" alt="{\rm{BX}}" style="vertical-align: 0px"/>
is the flow loss for a baffle normal to the x-direction; <img class="math" src="_images/math/0b84c307eb1ce22f5a1724503aad9d599011b670.png" alt="{\rm{WSHX}}" style="vertical-align: 0px"/>
is the viscous wall acceleration in the x-direction; and <img class="math" src="_images/math/89cf2b2e24d6998cf2ebf3bdf662a789df3e59ca.png" alt="G_x" style="vertical-align: -3px"/> includes
gravitational, rotational, and general non-inertial accelerations.</p>
<div class="section" id="advective-fluxes">
<span id="index-258"></span><h4>Advective Fluxes<a class="headerlink" href="#advective-fluxes" title="Permalink to this headline">¶</a></h4>
<div class="section" id="first-order-method">
<span id="firstordermethodth"></span><span id="index-259"></span><h5>First-Order Method<a class="headerlink" href="#first-order-method" title="Permalink to this headline">¶</a></h5>
<p>The simplest <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> finite-difference approximation is first-order accurate in
both space and time increments. In this case the advective and viscous terms are
all evaluated using old-time level (<img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>) values for velocities. Wall
shear stresses are implicitly evaluated as described below. Because the
pressures at time level <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/> are generally unknown at the beginning of
the cycle, these equations cannot be used directly to evaluate the <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>
level velocities but must be combined with the continuity equation. In the first
step of a solution, the <img class="math" src="_images/math/3edc12ad27db513236953eb0128a0081a72d2db5.png" alt="p^{n+1}" style="vertical-align: -4px"/> values in these equations are replaced
by <img class="math" src="_images/math/e19e41c9151528e7bac2749c7abd87d4ea62a5e4.png" alt="p^n" style="vertical-align: -4px"/> values to get a first guess for the new velocities. In an
explicit approximation the pressure gradient in Equation
<a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a> is evaluated at time <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>,
therefore further adjustment to <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> does not influence the evaluation of
<img class="math" src="_images/math/2189516554ed0119dcdc22b93d60d9acd79adfe5.png" alt="u^{n+1}" style="vertical-align: 0px"/>.</p>
<div class="figure" id="id122">
<span id="controlvolumeinxyplane"></span><img alt="Control volume (dashed line) in x-z plane used in finite-difference approximation for U momentum" src="_images/control-volume-in-xy-plane.png" />
<p class="caption"><span class="caption-text">Figure 13: Control volume (dashed line) in x-z plane used in finite-difference approximation for U momentum</span></p>
</div>
<p>Specific approximations chosen for the various acceleration terms in Eq.
<a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a> are relatively unimportant
provided they lead to a numerically stable algorithm. Special care must be
exercised, however, when making approximations in a mesh with non-uniform cell
sizes. This problem has been discussed elsewhere (e.g., Reference
<a class="reference internal" href="zbibliography.html#hirt-nichols-1981" id="id61">[HN81]</a>) but is repeated here because it is a problem that has often
been overlooked. Consider the approximation procedure used in the original MAC
method for Cartesian coordinates <a class="reference internal" href="zbibliography.html#harlow-welch-1965" id="id62">[HW65]</a>,
<a class="reference internal" href="zbibliography.html#welch-et-al-1966" id="id63">[WHS+66]</a>. Let us also assume for simplicity that all fractional areas and
volumes are equal to unity. In the MAC scheme the continuity and momentum
equations, Eqs. <a class="reference internal" href="#equation-modifiedcontinuityequation">(8)</a> and
<a class="reference internal" href="#equation-momentumconservation">(9)</a>, were first combined so that the advective flux
terms could be written in a divergence form (i.e., <img class="math" src="_images/math/6f239b319c204043031c290b5a95a262bad0bbb5.png" alt="\nabla uu" style="vertical-align: -1px"/> instead
of <img class="math" src="_images/math/e98cbb42a56798a142748bb9014d470edf8cd90e.png" alt="u \nabla u" style="vertical-align: -1px"/>). Thus <img class="math" src="_images/math/c159b41ab0134ea5978cc3291e168129df3e01c8.png" alt="{\rm{FUX}}" style="vertical-align: 0px"/> would be, for example,
<img class="math" src="_images/math/446afe5080c87f2e369d036a17e11f4321ff1488.png" alt="{\delta u^{2}} / {\delta x}" style="vertical-align: -5px"/> rather than <img class="math" src="_images/math/c138fb825364402845dc7fd65349fbf665113e91.png" alt="u \delta u / \delta x" style="vertical-align: -5px"/>.
The divergence form was preferred in MAC because it provided a simple way to
ensure conservation of momentum in the difference approximations. This may be
seen by considering an x-z cross section of the control volume used for <img class="math" src="_images/math/0fac5be6863d603e469a220b75024e0ed28c8540.png" alt="u_{i}" style="vertical-align: -3px"/> as
indicated by dashed lines in the figure above. With the divergence form,
Gauss’ theorem may be used to convert the integrated value of
<img class="math" src="_images/math/c159b41ab0134ea5978cc3291e168129df3e01c8.png" alt="{\rm{FUX}}" style="vertical-align: 0px"/> over the control volume to boundary fluxes at its sides.
Then, the flux leaving one control volume will be gained by the adjacent one
and conservation during advection is assured.</p>
<p>This idea worked well in the original MAC scheme, which was developed for use in
uniform meshes. Unfortunately, in non-uniform meshes, conservation does not
automatically imply accuracy. To see this, suppose an upstream or donor-cell
difference approximation is used for <img class="math" src="_images/math/fc2249edfd9f132d1d1319b7876405858dd99367.png" alt="{\text{FUX = }}\frac{{\partial
{u^2}}}{{\partial x}}" style="vertical-align: -6px"/>, which provides a conditionally stable algorithm. The
donor-cell approximation is</p>
<div class="math" id="equation-donorcellapproximation">
<p><span class="eqno">(327)<a class="headerlink" href="#equation-donorcellapproximation" title="Permalink to this equation">¶</a></span><img src="_images/math/52acff43db9f42e590b6aa03a1aa6a543c73ada9.png" alt="{\rm{FUX}} = \frac{{({u_R} &lt; {u_R} &gt; - {u_L} &lt; {u_L} &gt; )}}{{\delta {x_{i + \frac{1}{2}}}}}"/></p>
</div><p>where</p>
<div class="math" id="equation-donorcellapproxvalueur">
<p><span class="eqno">(328)<a class="headerlink" href="#equation-donorcellapproxvalueur" title="Permalink to this equation">¶</a></span><img src="_images/math/ac07f072ceef439ae92d180ceac4b05288f1a41a.png" alt="{u_R} = \frac{1}{2}({u_{i + 1,j,k}} + {u_{i,j,k}})"/></p>
</div><p>and</p>
<div class="math" id="equation-donorcellapproxvalueurbrackets">
<p><span class="eqno">(329)<a class="headerlink" href="#equation-donorcellapproxvalueurbrackets" title="Permalink to this equation">¶</a></span><img src="_images/math/294ca6d080df685bb541fb6164c9a34a28ca719d.png" alt="&lt; {u_R} &gt; = \left\{ \begin{gathered}
{u_{i,j,k}}{\text{ if }}{u_R} \geq 0 \hfill \\
{u_{i + 1,j,k}}{\text{ if }}{u_R} &lt; 0 \hfill \\
\end{gathered} \right.."/></p>
</div><p>To check the accuracy of Eq. <a class="reference internal" href="#equation-donorcellapproximation">(327)</a> we expand it in a
Taylor series about the x-position where <img class="math" src="_images/math/c159b41ab0134ea5978cc3291e168129df3e01c8.png" alt="{\rm{FUX}}" style="vertical-align: 0px"/> is evaluated (assuming
u-velocities are positive)</p>
<div class="math" id="equation-checkaccuracyexpandtaylorseries">
<p><span class="eqno">(330)<a class="headerlink" href="#equation-checkaccuracyexpandtaylorseries" title="Permalink to this equation">¶</a></span><img src="_images/math/3e0b5d87b0cfa44fc5476be6d1a94e229180376c.png" alt="{\rm{FUX}} = \frac{1}{2}\left( {\frac{{3\delta {x_i} + \delta {x_{i + 1}}}}{{\delta {x_i} + \delta {x_{i + 1}}}}} \right)\frac{{\partial {u^2}}}{{\partial x}} + {\rm O}(\delta x)"/></p>
</div><p>The coefficient on the zeroth order term is incorrect unless the cell
widths are equal, <img class="math" src="_images/math/36ed5ba48e9f8853acace6e58431a22ccf70d5b0.png" alt="\delta {x_{i}} = \delta {x_{i+1}}" style="vertical-align: -5px"/>. In other words, the
variable mesh reduces the order of the conservative difference approximation by
one, which in this case leads to an incorrect zeroth order result. If a
centered, rather than a donor-cell, approximation had been used the result would
have been first-order accurate, not second-order, as it is in a uniform mesh.</p>
<p>It does not necessarily follow from the above analysis that variable meshes are
always less accurate in practice. For example, they allow improved resolution in
regions where flow variables are rapidly varying. Nevertheless, variable meshes
must be used with considerable care. It is best, for example, to use a gradual
variation in cell size to minimize the reduction in approximation order. It is
also worthwhile to look for other approximations that do not lose their formal
accuracy when applied to variable meshes. In this regard, it should be noted
that the reason the conservative form of the advective term loses accuracy is
because the control volume is not centered about the position of <img class="math" src="_images/math/59fe336074d03403ea5d2b98c016a75e56ef4ed7.png" alt="u_i" style="vertical-align: -3px"/>.
The shifted control volume leads directly to the reduction in accuracy computed
in Eq. <a class="reference internal" href="#equation-checkaccuracyexpandtaylorseries">(330)</a>.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> a modified donor-cell approximation has been developed that retains its
accuracy in a variable mesh and reduces to a conservative difference expression
when the mesh is uniform <a class="reference internal" href="zbibliography.html#hirt-sicilian-1985" id="id64">[HS85]</a>. This method approximates
advective fluxes in the non-conservative form, <img class="math" src="_images/math/e98cbb42a56798a142748bb9014d470edf8cd90e.png" alt="u \nabla u" style="vertical-align: -1px"/>, which is
necessary because of the inherent difficulty with conservative approximations
noted above. In this approximation it is also possible to combine the
donor-cell and centered-difference approximations into a single expression
with a parameter that controls the relative amount of each. The general form
of this approximation for <img class="math" src="_images/math/9af44843748f32df0e0d6203a9e82992e7d601c2.png" alt="{\rm{FUX}} = \left( {\frac{{{A_x}}}{V}}
\right)\frac{{u\partial u}}{{\partial x}}" style="vertical-align: -6px"/> is</p>
<div class="math" id="equation-generalformapproximationflow3d">
<p><span class="eqno">(331)<a class="headerlink" href="#equation-generalformapproximationflow3d" title="Permalink to this equation">¶</a></span><img src="_images/math/05558dcfbf2dd5b089a7e5aac764cf3799f2ad78.png" alt="{\rm{FUX}} = \frac{{0.5}}{{{\rm{VFC}}}}\left[ {\left( {{\rm{UAR}} - \alpha \left| {{\rm{UAR}}} \right|} \right) \cdot {\rm{DUDR}} + ({\rm{UAL}} + \alpha \left| {{\rm{UAL}}} \right|) \cdot {\rm{DUDL}}} \right]"/></p>
</div><p>where</p>
<div class="math" id="equation-generalformapproxflow3dvaluesdudlanddudr">
<p><span class="eqno">(332)<a class="headerlink" href="#equation-generalformapproxflow3dvaluesdudlanddudr" title="Permalink to this equation">¶</a></span><img src="_images/math/9dc3ffbd49535c27f78398ed725919df21f27c04.png" alt="\begin{gathered}
{\rm{DUDL}} = \frac{{{u_{i,j,k}} - {u_{i - 1,j,k}}}}{{\delta {x_i}}} \hfill \\
{\rm{DUDR}} = \frac{{{u_{i + 1,j,k}} - {u_{i,j,k}}}}{{\delta {x_{i + 1}}}} \hfill \\
\end{gathered}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-generalformapproxflow3dvaluesuarandualandvfc">
<p><span class="eqno">(333)<a class="headerlink" href="#equation-generalformapproxflow3dvaluesuarandualandvfc" title="Permalink to this equation">¶</a></span><img src="_images/math/66c67394b82e1635b01f936bec603f6cae3b2e13.png" alt="\begin{gathered}
{\rm{UAR}} = 0.5({u_{i + 1,j,k}}{\rm{AFR}}_{i + 1,j,k} + {u_{ijk}}{\rm{AFR}}_{ijk}) \hfill \\
{\rm{UAL}} = 0.5({u_{i,j,k}}{\rm{AFR}}_{i,j,k} + {u_{i - 1,j,k}}{\rm{AFR}}_{i - 1,j,k}) \hfill \\
{\text{and}} \hfill \\
{\rm{VFC}} = \frac{{(\delta {x_i}{V_F}_{_{i,j,k}} + \delta {x_{i + 1}}{V_F}_{_{i + 1,j,k}})}}{{\left( {\delta {x_i} + \delta {x_{i + 1}}} \right)}} \hfill \\
\end{gathered}"/></p>
</div><p>If the mesh is uniform, this approximation reduces to a spatially second-order
accurate, centered-difference approximation when <img class="math" src="_images/math/7afe665b7f9ae21a1f5641693415845648b9dd40.png" alt="\alpha = 0" style="vertical-align: 0px"/>. When
<img class="math" src="_images/math/98e293255e1b964c0eafaeb09e9171f3e883190d.png" alt="\alpha = 1" style="vertical-align: 0px"/>, the first-order, donor-cell approximation is recovered. In
either case, the method reduces to the correct zeroth order expression in a
variable mesh. In a uniform mesh the advective flux approximations can be shown
to reduce to a conservative approximation form <img class="math" src="_images/math/6f239b319c204043031c290b5a95a262bad0bbb5.png" alt="\nabla uu" style="vertical-align: -1px"/>.</p>
<p>The basic idea underlying Eq. <a class="reference internal" href="#equation-generalformapproximationflow3d">(331)</a> is to weight
the upstream quantity being fluxed more than the downstream value. The weighting
factors are (<img class="math" src="_images/math/563af60466e96c618b011b5a055a687017242906.png" alt="1 + \alpha" style="vertical-align: -2px"/>) and (<img class="math" src="_images/math/c06b86fe8d9d99a60aac84283b7182c1eb3e25d2.png" alt="1 - \alpha" style="vertical-align: 0px"/>) for the upstream
and downstream directions, respectively. This type of first-order approximation
scheme is used for all advective flux terms appearing in Eq.
<a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a>.</p>
<p>All other acceleration terms in the momentum equations are approximated by
standard centered differences.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#locallyimplicitapproximationth"><span class="std std-ref">Locally Implicit Approximation of Advection</span></a></p>
</div>
</div>
<div class="section" id="second-order-monotonicity-preserving-method">
<span id="secondordermonotonicityth"></span><span id="index-260"></span><h5>Second-Order Monotonicity Preserving Method<a class="headerlink" href="#second-order-monotonicity-preserving-method" title="Permalink to this headline">¶</a></h5>
<p>A higher order advection algorithm in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is based on a second-order,
monotonicity-preserving upwind-difference method <a class="reference internal" href="zbibliography.html#vanleer-1977" id="id65">[VanLeer77]</a>. It is as
robust as the original first-order advection scheme. It requires slightly more
CPU time than the first-order method, although in most cases the difference is
insignificant.</p>
<p>The monotonicity-preserving method may be applied in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to approximate
momentum advection, as well as density, energy and fluid fraction advection. The
higher-order discretization scheme is derived by using second-order polynomial
approximations to the advected quantity in each of the coordinate directions
<a class="reference internal" href="zbibliography.html#bronisz-hirt-1991" id="id66">[BH91]</a>. For a variable <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> advected in the
x-direction, the value fluxed through a cell-face, <img class="math" src="_images/math/f19779e087395751ae89825fedfad3737820a841.png" alt="Q^*" style="vertical-align: -4px"/>, is computed as</p>
<div class="math" id="equation-secondordermonotonicictyvariableqfluxedthroughcellfaceqstar">
<p><span class="eqno">(334)<a class="headerlink" href="#equation-secondordermonotonicictyvariableqfluxedthroughcellfaceqstar" title="Permalink to this equation">¶</a></span><img src="_images/math/ef8a331a4b0db2edd1b659dceb50ff7b43754028.png" alt="Q* = {Q_i} + \frac{1}{2}A(1 - C)\delta {x_i}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/c770887188fec33ccf0cafdb06e71e326bc61df5.png" alt="Q_i" style="vertical-align: -4px"/> is the cell-centered value,</li>
<li><img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> is the Courant number,</li>
<li><img class="math" src="_images/math/eaa3a05c7ad8b107527d175411d919c9b51743d7.png" alt="\delta {x_i}" style="vertical-align: -3px"/> is the cell size, and</li>
<li><img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is a second-order approximation to the first derivative of <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> at the location</li>
</ul>
<div class="math" id="equation-firstderivativeofqatlocation">
<p><span class="eqno">(335)<a class="headerlink" href="#equation-firstderivativeofqatlocation" title="Permalink to this equation">¶</a></span><img src="_images/math/0fc265605a65421bc28c1cdf609881e5680022eb.png" alt="{x_0} = \frac{1}{6}(1 - 2C)\delta {x_i}"/></p>
</div><p>within the cell. Coefficient <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> can easily be computed from two
neighboring first derivatives by linear interpolation, provided these
derivatives are second-order accurate. The latter can be achieved by computing
the derivatives at the midpoints between <img class="math" src="_images/math/c770887188fec33ccf0cafdb06e71e326bc61df5.png" alt="Q_i" style="vertical-align: -4px"/> locations; for example,</p>
<div class="math" id="equation-computingderivativesatmidpointqilocations">
<p><span class="eqno">(336)<a class="headerlink" href="#equation-computingderivativesatmidpointqilocations" title="Permalink to this equation">¶</a></span><img src="_images/math/028eac02e7e8e972bc7071805c3715f9cf4ce111.png" alt="\frac{{dQ}}{{d{x_{i + \frac{1}{2}}}}} = 2 \cdot \frac{{{Q_{i + 1}} - {Q_i}}}{{\delta {x_{i + 1}} + \delta {x_i}}}"/></p>
</div><p>is a second-order accurate first derivative of <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> at the point between
<img class="math" src="_images/math/c770887188fec33ccf0cafdb06e71e326bc61df5.png" alt="Q_i" style="vertical-align: -4px"/> and <img class="math" src="_images/math/d9ab60a377a1f0a0b4a6fcc3b08b86408c24cce2.png" alt="Q_i + 1" style="vertical-align: -4px"/>. With this approach it is easy to extend the
higher-order, monotonicity-preserving method to non-uniform grids.</p>
<p>An advantage of Eq.
<a class="reference internal" href="#equation-secondordermonotonicictyvariableqfluxedthroughcellfaceqstar">(334)</a> is that the
first term on the right side gives the usual first-order donor-cell
approximation. Thus, the second-order approximation, which is generated by the
addition of the second term on the right side of Eq.
<a class="reference internal" href="#equation-secondordermonotonicictyvariableqfluxedthroughcellfaceqstar">(334)</a>, can easily
be made an option in a computer program.</p>
<p>To ensure monotonicity, <em>it is necessary</em> to restrict the value of the derivative
<img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/>. According to Reference <a class="reference internal" href="zbibliography.html#vanleer-1977" id="id67">[VanLeer77]</a>, the value of <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is
not allowed to exceed twice the minimum magnitude of the centered <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/>
derivatives used in its computation</p>
<div class="math" id="equation-monotonicityensuredrestrictvaluederivative">
<p><span class="eqno">(337)<a class="headerlink" href="#equation-monotonicityensuredrestrictvaluederivative" title="Permalink to this equation">¶</a></span><img src="_images/math/a362fb936c283eda0a3d41b23b0a8fc62b5be8b0.png" alt="A \leq 2\min \left( {\frac{{dQ}}{{d{x_i}}},\frac{{dQ}}{{d{x_{i + 1}}}}} \right)"/></p>
</div><p>Furthermore, if <img class="math" src="_images/math/c770887188fec33ccf0cafdb06e71e326bc61df5.png" alt="Q_i" style="vertical-align: -4px"/> is a local minimum or maximum value - that is, if
the two centered derivatives appearing in Eq.
<a class="reference internal" href="#equation-monotonicityensuredrestrictvaluederivative">(337)</a> are of opposite sign - then
<img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is set to zero and the donor-cell approximation is used.</p>
</div>
<div class="section" id="second-order-method">
<span id="secondordermethodth"></span><span id="index-261"></span><h5>Second-Order Method<a class="headerlink" href="#second-order-method" title="Permalink to this headline">¶</a></h5>
<p>The approximations described in <a class="reference internal" href="#firstordermethodth"><span class="std std-ref">First-Order Method</span></a> have truncation errors proportional to the
first power of the time increment <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> and, if <img class="math" src="_images/math/b8b71ac67f43e090424694f06d16ef215866dd3d.png" alt="\alpha \neq 0" style="vertical-align: -4px"/>
or the mesh is non-uniform, the first power of the space increments <img class="math" src="_images/math/133e167f7f4d47c09ccf155e84fa3f7fe6b2ce0b.png" alt="dx" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/97e02ce79ff90bbf8a190ff1de720be4e88e4346.png" alt="dy" style="vertical-align: -4px"/> and <img class="math" src="_images/math/f7ceaa9506d0ef0b7fe3f027110b30ca30fb761f.png" alt="dz" style="vertical-align: 0px"/>. The advantage of these first-order approximations is
that they are simple and easy to keep computationally stable. For a great many
applications they also provide good solutions. In some cases, however, it may be
too costly to use the mesh resolution necessary for an accurate first-order
solution. When this happens, it may be useful to employ a second-order accurate
approximation for the advective and viscous accelerations. Two optional
second-order approximation schemes for the momentum equations can be requested through
the input data. The essence of the first scheme is a double pass through the
advection and viscous subroutines. In the first pass, the first-order method is
used with the donor cell parameter <img class="math" src="_images/math/e59a5450e2806fb0d5def5b7626243b3537c3a97.png" alt="\alpha = 1.0" style="vertical-align: 0px"/>. These new velocities
are then stored in the arrays for the previous time velocities. The first-order
calculations are then repeated, but this time the parameter is set to
<img class="math" src="_images/math/c62c59af73e1307c635beb9650e6313dda433cad.png" alt="\alpha = -1.0" style="vertical-align: 0px"/>. Finally, the results of the two calculations are averaged
to give the desired second-order approximation to the new time-level velocities.</p>
<p>These approximations are second-order in time because the first pass uses time-<img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> velocities, while the second pass uses (first-order) approximations
for velocities at time <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>. The average then has level <img class="math" src="_images/math/038afab0b31a6a1b3c2ddfae42a23d13e430a7e8.png" alt="n +
\raise.5ex\hbox{$\scriptstyle 1$} \kern-.1em/ \kern-.15em\lower.25ex
\hbox{$\scriptstyle 2$}" style="vertical-align: -5px"/>, which is second-order in <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/>. Likewise,
using <img class="math" src="_images/math/811907ade5b3844d683b1d1354688845ce25344d.png" alt="\alpha = + 1.0" style="vertical-align: -2px"/> in the first pass and <img class="math" src="_images/math/c62c59af73e1307c635beb9650e6313dda433cad.png" alt="\alpha = -1.0" style="vertical-align: 0px"/> in the
second results in an average <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/>-value of zero, which is second-order in
<img class="math" src="_images/math/133e167f7f4d47c09ccf155e84fa3f7fe6b2ce0b.png" alt="dx" style="vertical-align: 0px"/>, <img class="math" src="_images/math/97e02ce79ff90bbf8a190ff1de720be4e88e4346.png" alt="dy" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f7ceaa9506d0ef0b7fe3f027110b30ca30fb761f.png" alt="dz" style="vertical-align: 0px"/> if the mesh is uniform. (See Reference
<a class="reference internal" href="zbibliography.html#hirt-1978" id="id68">[Hir78]</a> for a more complete analysis of this second-order scheme.)</p>
<p>This algorithm is the least numerically diffusive of the three advection methods
available in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. However, it does not possess the transportive property,
which in standard upstream differencing schemes ensures that a flow disturbance
only propagates downstream from its initial location. In addition, this method
is the most CPU intensive. Finally, this method may occasionally generate a
numerically unstable solution for flows with transient free-surfaces.</p>
</div>
<div class="section" id="immersed-boundary-method">
<span id="immersedboundarymethodth"></span><span id="index-262"></span><h5>Immersed Boundary Method<a class="headerlink" href="#immersed-boundary-method" title="Permalink to this headline">¶</a></h5>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, a simple method is used to eliminate numerical boundary layers caused by fractional cell areas and volumes, in which any spatial velocity derivative that requires velocity values located within solid or void regions when computing the momentum advection term is set to zero. From the physical point of view, this method applies a free-slip (non-penetration) boundary condition to the advection at walls, thus suppresses the artificial boundary layer. Compared to the method without using zero derivatives, the flow solutions are more in accord with real flows, e.g. uniform flow in an inclined duct, <a class="reference internal" href="zbibliography.html#hirt-sicilian-1985" id="id69">[HS85]</a> <a class="reference internal" href="zbibliography.html#hirt-1993" id="id70">[Hir93]</a>, especially when coarse grids are used.</p>
<p>The loss of flux in the momentum equation is compensated by the pressure. Therefore, in certain situations the portion of pressure to compensate the flux loss may grow in time, and at some point causes a numerical instability, which is expressed as a monotonic growth of velocities. In order to prevent the instability from developing, an empirical technique in the solver has been used to “correct” the flux at the location where possible instability may emerge. However, this approach does not resolve the flux loss from the source, and could occasionally introduce a nonphysical behavior of the solution such as pressure oscillations.</p>
<p>Based on the ghost-cell immersed boundary method <a class="reference internal" href="zbibliography.html#mittal-2008" id="id71">[MDB+08]</a>, a technique for approximating the advection term has been developed to fundamentally resolve the issue and provide more accurate force predictions near walls. Ghost cells, or more appropriately ghost nodes in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, are nodes located at the cell faces in solid regions but considered as pseudo fluid nodes with fluid velocity. The velocity values at the ghost nodes are computed to implicitly satisfy the wall boundary condition. The calculation of the velocity gradients near the boundary can be performed straightforwardly using the value at the ghost nodes with appropriate finite difference schemes.</p>
<p>To help enforce the non-penetration boundary condition at the wall near a ghost node, an image-point of the ghost node in fluid regions is identified by extending a line segment from the ghost node in the direction normal to the wall that intersects it midway between the ghost node and the image-point. Assuming that the ghost node and its image-point have the same velocity as the wall surface velocity in the tangent direction, the following equation can be obtained:</p>
<div class="math" id="equation-nonpenetrationwallbc">
<p><span class="eqno">(338)<a class="headerlink" href="#equation-nonpenetrationwallbc" title="Permalink to this equation">¶</a></span><img src="_images/math/9daee1803e339b2f0fc0bdd5c148c60423a18935.png" alt="\vec{u}_{GN}=\vec{u}_{IP}-2\left [ \left ( \vec{u}_{IP}-\vec{u}_{B} \right )\cdot \vec{n} \right ]\vec{n}"/></p>
</div><p>where <img class="math" src="_images/math/0681263ec276923d65f75f193d0a0b3dbc5d2d87.png" alt="\vec{u}_{GN}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/141dc9db7ce9eb8045e0633ac4d5e0e72fe5b77b.png" alt="\vec{u}_{IP}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/03b1d7c4fc47b2f38ff9be74d41bcd3491d7580a.png" alt="\vec{u}_{B}" style="vertical-align: -3px"/> are the velocity vector at the ghost node, the image-point, and the solid boundary, respectively. <img class="math" src="_images/math/cc0476bd29fd1e3eadf398794309155c1723a20b.png" alt="\vec{n}" style="vertical-align: 0px"/> is the unit normal vector at the boundary. Note that only one of the velocity components of <img class="math" src="_images/math/0681263ec276923d65f75f193d0a0b3dbc5d2d87.png" alt="\vec{u}_{GN}" style="vertical-align: -3px"/> is needed for each ghost node due to the nature of the staggered grid system; however, all the velocity components of the image-point <img class="math" src="_images/math/141dc9db7ce9eb8045e0633ac4d5e0e72fe5b77b.png" alt="\vec{u}_{IP}" style="vertical-align: -3px"/> are involved in computing <img class="math" src="_images/math/0681263ec276923d65f75f193d0a0b3dbc5d2d87.png" alt="\vec{u}_{GN}" style="vertical-align: -3px"/> in Eq. <a class="reference internal" href="#equation-nonpenetrationwallbc">(338)</a>. The value of the image-point is evaluated from the value of the fluid nodes that surround the image-point using interpolation schemes.</p>
<p>The immersed boundary method can work with the other advection algorithms. When it is activated in a simulation, more accurate force and velocity head predictions can be obtained because of the more accurate flux calculation. This method can be used with 3D mesh blocks or hybrid 3D/shallow water mesh blocks, but not for shallow water meshes alone. In other words, it has no use in the shallow water solver.</p>
<p>For more details on the immersed boundary method, Flow Science TN105 can be found on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>.</p>
</div>
</div>
<div class="section" id="density-evaluation">
<span id="densityevaluationth"></span><span id="index-263"></span><h4>Density Evaluation<a class="headerlink" href="#density-evaluation" title="Permalink to this headline">¶</a></h4>
<p>The densities, <img class="math" src="_images/math/394dd3f2eafd6ee3349f3c47932ac4817b83c7fe.png" alt="\rho _{i,j,k}^n" style="vertical-align: -8px"/>, required for Eq.
<a class="reference internal" href="#equation-momentumconservation">(9)</a> are evaluated based on the type of problem at hand.
For one-material, incompressible flows, all density values are set to the
density of fluid #1. For two-fluid, incompressible flows the density is a
weighted average of the densities of the two fluids (<img class="math" src="_images/math/2cdd3a6e79151e050bba6eddfe4df4e5404ad5e9.png" alt="\rho_1" style="vertical-align: -4px"/> and
<img class="math" src="_images/math/ecca08cef6bbd74d627b4bccac4eb9f9fcb2fdf8.png" alt="\rho_2" style="vertical-align: -4px"/>) based on volume fraction, <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-densityevaluation1">
<p><span class="eqno">(339)<a class="headerlink" href="#equation-densityevaluation1" title="Permalink to this equation">¶</a></span><img src="_images/math/1b0976d717e64fb7da1aa32e61c163a3ddc3058d.png" alt="{\rm{RHO}}(i,j,k) = F(i,j,k){\rho _1} + \left[ {1.0 - F(i,j,k)} \right]{\rho _2}"/></p>
</div><p>Fluid densities <img class="math" src="_images/math/be4b5e17fe49154ed1ad530d98da4a18ed805dea.png" alt="\rho 1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/0fec41826a5dbb346697c9088506ac1cb149ff7d.png" alt="\rho 2" style="vertical-align: -4px"/> may be temperature-dependent
as discussed in the Vaporization Residue section.</p>
<p>Fluids at free surfaces in a one-fluid problem can either evaporate or condense
when a phase change model is used. This holds true for both cases where the gas
side of the interface is a constant pressure or when it is a homogeneous bubble
region. If the fluid contains one or more solutes, the concentration of the
solutes must change in response to the gain or loss of liquid. Typically the
solutes become more concentrated due to liquid evaporation.</p>
<p>In either the evaporation or condensation case, any scalar concentration that is
associated with the fluid will have its concentration altered by the phase
change. If a surface element is less than half filled with liquid, then the
concentration change is spread into the principal neighbor of the surface
element to the extent that the concentration region equals half the thickness of
the surface element.</p>
<p>If enough evaporation occurs and the solute concentration becomes high enough,
it may result in a surface skin or a residue may form on a solid surface if the
liquid is completely evaporated. For this to be simulated in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the residue
model must be selected. Activation of this model causes the solute to form a
non-moving residue once its concentration reaches a user-defined maximum packing
density. If more than one solute is present, the residue model will record the
total of all solute contributions to the residue.</p>
<p>For compressible problems the density is evaluated from the continuity equation,
Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>. As discussed below, this is equivalent
to a volume-weighted equation-of-state density</p>
<div class="math" id="equation-densityevaluation2">
<p><span class="eqno">(340)<a class="headerlink" href="#equation-densityevaluation2" title="Permalink to this equation">¶</a></span><img src="_images/math/5354fa6f4d768ff3c51b67e385dea1f42c0c0a3f.png" alt="{\rm{RHO}}(i,j,k) = F(i,j,k) \cdot {\rho _1}\left[ {P(i,j,k),{I_1}(i,j,k)} \right] + \left[ {1.0 - F(i,j,k)} \right] \cdot {\rho _2}\left[ {P(i,j,k),{I_2}(i,j,k)} \right]"/></p>
</div><p>where <img class="math" src="_images/math/be4b5e17fe49154ed1ad530d98da4a18ed805dea.png" alt="\rho 1" style="vertical-align: -4px"/> and <img class="math" src="_images/math/0fec41826a5dbb346697c9088506ac1cb149ff7d.png" alt="\rho 2" style="vertical-align: -4px"/> are functions of the pressure and
internal energy.</p>
<p>The compressible flow equation-of-state functions for density are programmed to
permit easy modification; however, the functions provided have some flexibility.
Both fluids are assumed to have a constant specific heat (which can be defined
by the user) so that the specific internal energies are</p>
<div class="math" id="equation-densityevaluation3">
<p><span class="eqno">(341)<a class="headerlink" href="#equation-densityevaluation3" title="Permalink to this equation">¶</a></span><img src="_images/math/4e31b67a185b5e17970c9c59279ea527a1e0d69a.png" alt="\begin{gathered}
{I_1} = {\rm{CV1}} \cdot T \hfill \\
{I_2} = {\rm{CV2}} \cdot T \hfill \\
\end{gathered}"/></p>
</div><p>Fluid #1 is assumed incompressible, and its density is specified as
<img class="math" src="_images/math/77a2f4d050158021ec51e27454fed21b90a024c1.png" alt="RHO1" style="vertical-align: 0px"/>. Fluid #2 is a perfect gas with</p>
<div class="math" id="equation-densityevaluation4">
<p><span class="eqno">(342)<a class="headerlink" href="#equation-densityevaluation4" title="Permalink to this equation">¶</a></span><img src="_images/math/d724483811afcb82062cb0df55a2c32a85dd0a02.png" alt="{\rho _2} = \frac{P}{{{\rm{RF2}} \cdot T}}"/></p>
</div><p>where <img class="math" src="_images/math/1ff0a35e9d4d92ff7c9330f0f0b79ade48c94258.png" alt="RF2" style="vertical-align: 0px"/> is a user-supplied gas constant.</p>
</div>
<div class="section" id="wall-shear-stresses">
<span id="wallshearstressesth"></span><span id="index-264"></span><h4>Wall Shear Stresses<a class="headerlink" href="#wall-shear-stresses" title="Permalink to this headline">¶</a></h4>
<p>Wall stresses in Eq. <a class="reference internal" href="#equation-viscousaccelerations">(11)</a> are included in an implicit
way to avoid possible numerical instabilities arising in cells with large wall
areas and small flow volumes. The basic approach for the <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>-velocity
equation, for example, is as follows. Wall shears influencing <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> can
arise from wall areas located on <em>x</em> or <em>y</em> cell-faces surrounding <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>.
For any one of these faces, if the fractional flow area <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> is less than
unity, the remaining area fraction (<img class="math" src="_images/math/8b243f6716a67e0168ef14b4417454a7b5a773fa.png" alt="1 - A" style="vertical-align: 0px"/>) is considered to be a
wall on which a stress is generated. On an <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> face to the right of
<img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>, for instance, the acceleration due to wall shear in laminar flow,
<img class="math" src="_images/math/67c237c41f1feaa7fe3900af4ddb6f3f11f74b26.png" alt="wsz" style="vertical-align: 0px"/>, is an approximation to <img class="math" src="_images/math/9a29078f3b9562cbbf371f2ee3526c89099f4c35.png" alt="\partial /\partial x\left( {\mu
\left( {\partial w/\partial x} \right)} \right)" style="vertical-align: -5px"/>,</p>
<div class="math" id="equation-wallshearstresses1">
<p><span class="eqno">(343)<a class="headerlink" href="#equation-wallshearstresses1" title="Permalink to this equation">¶</a></span><img src="_images/math/680d17e565aaf26f9268a5941d49d3b527d70c4f.png" alt="wsz = - \frac{{2\mu }}{{{A_z}\delta {x^2}}}(1 - {A_x})(w - {w_0})"/></p>
</div><p>where <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/>, <img class="math" src="_images/math/5125e9f6df3f75fd2719dc4d22e61de01335e66c.png" alt="\delta _x" style="vertical-align: -3px"/> and <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> are evaluated in the cell in
which <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is located. The area fraction <img class="math" src="_images/math/2e6a1ee0ee3e238e36573fb81bfaaaeaa81ff9cc.png" alt="A_z" style="vertical-align: -3px"/> is estimated at the
same control volume face where <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is located. The velocity <img class="math" src="_images/math/c52e6fc219e9502e3efd004f3ac757b869abcb55.png" alt="w_o" style="vertical-align: -3px"/> is
either zero or is equal to the z-direction tangential velocity at moving
component and mesh boundaries. Because <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is on the boundary between two
cells, the <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/> is an average for these cells.</p>
<p>Similar stresses are evaluated at each of the four surrounding cell walls, and
their sum is taken as the total stress.</p>
<p>If the <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> appearing in Eq. <a class="reference internal" href="#equation-wallshearstresses1">(343)</a> is the time level
<img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> value, the approximation is explicit but subject to possible numerical
instability. To avoid this possibility, the <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is taken to be the new
value computed from the full momentum equation. Although this makes the momentum
equation for <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> implicit, it is trivial to solve since it is linear in
<img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>.</p>
<p>For turbulent shear stress, Eq. <a class="reference internal" href="#equation-wallshearstresses1">(343)</a> changes to</p>
<div class="math" id="equation-wallshearstresses2">
<p><span class="eqno">(344)<a class="headerlink" href="#equation-wallshearstresses2" title="Permalink to this equation">¶</a></span><img src="_images/math/a831d4529caf0a4c0f86f5fe1da6557527e68eb9.png" alt="wsz = \frac{\rho }{{\delta x}}\left( {1 - {A_x}} \right){u^*}^2 = \frac{\rho }{{\delta x}}\left( {1 - {A_x}} \right){u^ + }^2\left| {w - {w_0}} \right|\left( {w - {w_0}} \right)"/></p>
</div><p>where <img class="math" src="_images/math/cd128873af6973bec19efa6fc1a3b22b4957a5a9.png" alt="{u^ + } = {u^{\text{*}}}/u" style="vertical-align: -5px"/> computed from Eq.
<a class="reference internal" href="#equation-localshearvelocityu">(308)</a>. The quadratic expression for the tangential velocity
is linearized, with the <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> in the parenthesis on the right-hand side
taken at time level <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>.</p>
<p>Effective wall shear stresses arising from mass injection from obstacle surfaces
are modeled in much the same way. The effective stress is, e.g.,</p>
<div class="math" id="equation-wallshearstresses3">
<p><span class="eqno">(345)<a class="headerlink" href="#equation-wallshearstresses3" title="Permalink to this equation">¶</a></span><img src="_images/math/5dc232b388ad55630f14e554f2875bd45e5c7724.png" alt="{\rm{QWSZ}} = \left\{ \begin{gathered}
- {V_F} \cdot {\rm{QSR}} \cdot w{\text{ if }} {\rm{QSR}} &gt; 0 \hfill \\
0,{\text{ if }}{\rm{QSR}} &lt; 0 \hfill \\
\end{gathered} \right."/></p>
</div><p>where <img class="math" src="_images/math/5aab21a715f886c1d5b693f5892a989c94ca2a51.png" alt="QSR" style="vertical-align: -4px"/> is the average mass source rate in the mesh cells on either
side of the boundary where <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> is defined. No stress is used if the source
is negative (a sink) because fluid is assumed to leave with the local velocity.
Here again one uses the new <img class="math" src="_images/math/45211f792aabf6b50fe2d7c047f4bd830dc5fd90.png" alt="W" style="vertical-align: 0px"/> value so that the contribution to the
momentum equation is implicit for enhanced numerical stability.</p>
<p>Slippage at walls is only allowed for laminar flows and is modeled by using a
friction factor <img class="math" src="_images/math/8552154a335b142ca0da9298ca0c193c45daf188.png" alt="\kappa" style="vertical-align: 0px"/>. The wall shear stress given by Eq.
<a class="reference internal" href="#equation-wallshearstresses1">(343)</a> modified for slippage is</p>
<div class="math" id="equation-wallshearstresses4">
<p><span class="eqno">(346)<a class="headerlink" href="#equation-wallshearstresses4" title="Permalink to this equation">¶</a></span><img src="_images/math/af64bc10f59edef105878eca10e5f886c711b8cd.png" alt="wsz = \frac{{2\mu }}{{{A_x}\delta {x^2}}}(1 - {A_x})(w - {w_s})"/></p>
</div><p>where <img class="math" src="_images/math/10f2c7e4d0cc0565592bedf63a887ec8879c6e18.png" alt="w_s" style="vertical-align: -3px"/> is the fluid slip velocity at the wall:</p>
<div class="math" id="equation-wallshearstresses5">
<p><span class="eqno">(347)<a class="headerlink" href="#equation-wallshearstresses5" title="Permalink to this equation">¶</a></span><img src="_images/math/fee52976afb627b3d91e2be1d8a06781eb8a6c8c.png" alt="{w_s} = \frac{{\frac{{2\mu w}}{{({A_z}\delta x)}} + \kappa {w_0}}}{{\frac{{2\mu }}{{({A_z}\delta x)}} + \kappa }}"/></p>
</div><p>Both laminar and turbulent wall shear stresses at wall surfaces can be modified
by defining a wall roughness. The roughness has the dimensions of length. The
length is, in some sense, proportional to the size of the roughness elements. It
is incorporated into the usual shear stress calculations by adding to the
molecular viscosity the product of <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/>, <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/>, and <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>, where <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/> is the
surface roughness and <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> means the difference between the local fluid velocity
and the wall velocity. In this implementation the wall shear stress in laminar
flow is equal to <img class="math" src="_images/math/7d109b80c6a0b9b868caaaf483acb50043faf966.png" alt="\rho \left( {\nu + \xi w} \right)w/\delta x" style="vertical-align: -5px"/>. For
turbulent flow, the law-of-the-wall relation retains the same form as for a
smooth wall, except the change in viscosity (i.e., from <img class="math" src="_images/math/6f0271089ab36d5f12ee5fe3eef8d89debc5529f.png" alt="\nu" style="vertical-align: 0px"/> to <img class="math" src="_images/math/492ac80588193aa301abf673b737fef8a2cc2462.png" alt="\nu + \xi
_w" style="vertical-align: -4px"/>) automatically converts the logarithm dependence from a characteristic
length scale defined by <img class="math" src="_images/math/45024ff33b0537bd3d320504010ae5079c0c6cbd.png" alt="\nu /w" style="vertical-align: -5px"/> to <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/>, when <img class="math" src="_images/math/8cd3e149bf85984fbe3eb1478f48316fd2e629ea.png" alt="\xi" style="vertical-align: -4px"/> is the larger of the
two characteristic lengths.</p>
<p>The roughness should be smaller than the grid cell size at the obstacle
boundary, although larger values can be used. The value of the frictional
roughness parameter ROUGH does not affect obstacle/fluid heat transfer (see also
<a class="reference internal" href="#surfaceareaevaluationth"><span class="std std-ref">Surface Area Evaluation</span></a>).</p>
</div>
<div class="section" id="porous-baffle-flow-losses">
<span id="porousbaffleflowlossesth"></span><span id="index-265"></span><h4>Porous Baffle Flow Losses<a class="headerlink" href="#porous-baffle-flow-losses" title="Permalink to this headline">¶</a></h4>
<p>For flow losses at baffles, an implicit solution is used that is similar to
that for wall shear stresses. The only difference in this case is that the
implicit equation for <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> (or <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> and <img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/>) may be quadratic
and may require the taking of a square root for its solution.</p>
</div>
<div class="section" id="generalized-drag-forces">
<span id="generalizeddragforcesth"></span><span id="index-266"></span><h4>Generalized Drag Forces<a class="headerlink" href="#generalized-drag-forces" title="Permalink to this headline">¶</a></h4>
<p>Flow in porous media and the solidification/melting model use a drag force
proportional to the first power of the velocity, <img class="math" src="_images/math/7f320b4ac8a4fcf45b8dc4145391030d9755816e.png" alt="- F_d{\text{u}}" style="vertical-align: -3px"/>. These
models assume the possibility of an arbitrarily large drag coefficient,
<img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/>, in which the momentum equations may reduce to a balance between drag
and pressure gradient forces. To compute in this high drag limit for
incompressible flow, it is necessary to treat the drag terms implicitly, not
only in the momentum equations but also in the continuity equation. This is
accomplished by using the time-advanced value for the velocity in the drag term
and algebraically solving the difference equation for the new velocity. The
result is a division of all contributions to the new velocity by the term (<img class="math" src="_images/math/2e778e7388f06d01783f32c941d02b31ce7fc8db.png" alt="1 + {F_ddt}" style="vertical-align: -3px"/>). Keeping the effect of this extra term throughout all
pressure/velocity adjustments then ensures that a balance between pressure
gradient and drag forces can be achieved that also satisfies the continuity
equation.</p>
</div>
<div class="section" id="non-inertial-reference-frame">
<span id="nirfth"></span><span id="index-267"></span><h4>Non-Inertial Reference Frame<a class="headerlink" href="#non-inertial-reference-frame" title="Permalink to this headline">¶</a></h4>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> has two strategies for analysis of flows inside a moving tank: the
<a class="reference internal" href="#gmomodelth"><span class="std std-ref">General Moving Objects Model</span></a> method and the non-inertial frame method. The former
moves the tanks through the computational mesh that is fixed in an inertial
frame (See <a class="reference internal" href="#gmomodelth"><span class="std std-ref">General Moving Objects Model</span></a> in this chapter and in <a class="reference internal" href="model-reference.html#gmobasicsmr"><span class="std std-ref">Model Reference</span></a>). The latter embeds the computational mesh in a non-inertial
reference frame that moves with the tank, which is presented in this section.</p>
<p>Due to reference frame transformation, in the non-inertial frame the fluid
experiences “fictitious” accelerations that can be related to a set of
independent variables that describe the motion of the reference frame with
respect to inertial space. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, these variables are the three Cartesian
components of linear acceleration, three components of angular velocity (in
radians per unit time), and three components of angular acceleration (in radians
per unit time squared). All nine of these variables may be functions of time.
There are also three relationships between the components of angular
velocity and angular acceleration that must be satisfied. Therefore, there are
really only six independent functions of time.</p>
<p>Additionally, there are three (time-independent) variables, which simplify the
specification of some types of motion. These are the three Cartesian components
of an “offset” vector (<span class="target" id="index-268"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCX</span></code>, <span class="target" id="index-269"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCY</span></code> and <span class="target" id="index-270"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCZ</span></code>). These components specify the</p>
<p>vector from the origin of the coordinate system to a point about which rotations
are to be described (see <a class="reference internal" href="#inertialandbodyfixedcoordinates"><span class="std std-ref">figure in Rigid Body Dynamics</span></a>). This is useful, for example, in describing
the motion of a body that is moving without experiencing “external” forces, in
which case the center of mass can conveniently be taken as the “rotation” point.</p>
<p>The evaluation of the local “fictitious” force experienced by the fluid is
evaluated by three completely general subroutines <strong class="program">accxcl</strong>,
<strong class="program">accycl</strong>, and <strong class="program">acczcl</strong>. These routines do not, generally, require
modifications by the user. Evaluation of the nine time-dependent variables,
however, cannot be completely generalized. Therefore, this evaluation has been
segregated to a single subroutine <strong class="program">motion</strong>, which may be modified by the
user if necessary. Another special case is discussed in
<a class="reference internal" href="#coupledrigidbodydynamicsth"><span class="std std-ref">Coupled Rigid Body Dynamics</span></a> description and will not be discussed
further in this section.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#nirfth"><span class="std std-ref">Non-Inertial Reference Frame</span></a> notation</li>
<li><a class="reference internal" href="#rigidbodydynamicsalgorithmth"><span class="std std-ref">Rigid Body Dynamics Algorithm for Non-Inertial Reference Frame Model</span></a></li>
<li><a class="reference internal" href="#noninertialreferenceframeth"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a> equations</li>
<li><a class="reference internal" href="#rigidbodydynamicsnirfth"><span class="std std-ref">Rigid Body Dynamics for Non-Inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#centrifugalcastingmr"><span class="std std-ref">Non-inertial reference frame application example:  Centrifugal Casting</span></a></li>
<li><a class="reference internal" href="model-reference.html#gravitysectionmr"><span class="std std-ref">Gravity</span></a></li>
<li><a class="reference internal" href="model-reference.html#impulsivemotionmr"><span class="std std-ref">Impulsive Motion of Non-inertial Reference Frame</span></a></li>
<li><a class="reference internal" href="model-reference.html#noninertialreferenceframemotionmr"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a></li>
<li><a class="reference internal" href="model-reference.html#smoothtabularmotionmr"><span class="std std-ref">Smooth Tabular Motion</span></a></li>
</ul>
</div>
<div class="section" id="gravitational-force-in-non-inertial-frames">
<span id="gravitationalforceth"></span><span id="index-271"></span><h5>Gravitational Force in Non-inertial Frames<a class="headerlink" href="#gravitational-force-in-non-inertial-frames" title="Permalink to this headline">¶</a></h5>
<p>In many cases, one may be interested in the movement of a reference frame within
a uniform gravitational field. An example is the slosh of cargo in tanker ships
on the ocean surface. To facilitate such analyses, a specific “gravity vector”
model can be used. In this model, the user must specify the initial components
of gravity (relative to the Cartesian computational reference frame) through the
input variables <span class="target" id="index-272"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVX</span></code>, <span class="target" id="index-273"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVY</span></code>, and <span class="target" id="index-274"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVZ</span></code> in namelist
<span class="target" id="index-275"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MOTN</span></code>. The routine <strong class="program">motion</strong> will then evaluate the instantaneous components
required by the fluid solution algorithm as the reference frame rotates. Note
that translation of the reference frame has no effect on these gravitational
components.</p>
</div>
<div class="section" id="specifying-non-inertial-reference-frame-motion">
<span id="specifyingnirfmotionth"></span><span id="index-276"></span><h5>Specifying Non-Inertial Reference Frame Motion<a class="headerlink" href="#specifying-non-inertial-reference-frame-motion" title="Permalink to this headline">¶</a></h5>
<p>To use the non-inertial reference frame model in any calculation, one must first
request that this option be turned on by setting <span class="target" id="index-277"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IACCF</span></code> = 1 in namelist <span class="target" id="index-278"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">XPUT</span></code>.
This causes <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to read and process the <span class="target" id="index-279"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MOTN</span></code> namelist and to invoke the
<strong class="program">motion</strong>, <strong class="program">accxcl</strong>, <strong class="program">accycl</strong>, and <strong class="program">acczcl</strong> subroutines at
appropriate points in the calculation.</p>
<p>Since there are now four options for specifying the movement of the reference
frame to <strong class="program">motion</strong>, a new input parameter has been added to <span class="target" id="index-280"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MOTN</span></code> to choose among
them. Its values signify:</p>
<ul class="simple">
<li><span class="target" id="index-281"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 0: Simple rotation or acceleration along the x axis or rotation about
the z axis.</li>
<li><span class="target" id="index-282"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 1: Harmonic oscillation of the components of linear acceleration and
angular velocity and acceleration.</li>
<li><span class="target" id="index-283"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 2 through 5: Tabular specification of reference frame parameters.</li>
</ul>
<p>The following sections describe each of these options in more detail.</p>
<div class="section" id="simple-rotation-or-acceleration-along-the-x-axis">
<span id="simplerotationth"></span><span id="index-284"></span><h6>Simple Rotation or Acceleration along the X-Axis<a class="headerlink" href="#simple-rotation-or-acceleration-along-the-x-axis" title="Permalink to this headline">¶</a></h6>
<p>This option is provided for compatibility with earlier versions of <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The
same reference frame motions can be selected using other options if desired.
The input parameters relevant to this
option are: <span class="target" id="index-285"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCX</span></code>, <span class="target" id="index-286"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCY</span></code>, <span class="target" id="index-287"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCZ</span></code>, <span class="target" id="index-288"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">A0</span></code>, <span class="target" id="index-289"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMG0</span></code>, <span class="target" id="index-290"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SPIN</span></code> and
<span class="target" id="index-291"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RPS</span></code>. Three motions are permitted under this option and may be combined if
desired:</p>
<p>The acceleration along the Cartesian x-axis is specified by</p>
<div class="math" id="equation-accelerationalongcartesianxaxis">
<p><span class="eqno">(348)<a class="headerlink" href="#equation-accelerationalongcartesianxaxis" title="Permalink to this equation">¶</a></span><img src="_images/math/6b1e14d8f5b2a6663d743e6fe1a56fac30c6ed75.png" alt="{\rm{UCDX}} = {\rm{A0}} \cdot \sin ({\rm{OMG0}} \cdot t)"/></p>
</div><p>The rotation through the offset point <span class="target" id="index-292"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCX</span></code>, <span class="target" id="index-293"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCY</span></code> and <span class="target" id="index-294"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCZ</span></code> is
given in radians/second. The rotation about the axis parallel to <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> is
given by:</p>
<div class="math" id="equation-rotationaboutaxisparalleltoxthroughoffsetpoints">
<p><span class="eqno">(349)<a class="headerlink" href="#equation-rotationaboutaxisparalleltoxthroughoffsetpoints" title="Permalink to this equation">¶</a></span><img src="_images/math/9c10272e480978b06243bd4dc5f3c828953e376b.png" alt="{\rm{OMGX}} = {\rm{SPIN}}"/></p>
</div><p>and the rotation about the axis parallel to <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> is given by:</p>
<div class="math" id="equation-rotationaboutaxisparalleltozthroughoffsetpoints">
<p><span class="eqno">(350)<a class="headerlink" href="#equation-rotationaboutaxisparalleltozthroughoffsetpoints" title="Permalink to this equation">¶</a></span><img src="_images/math/41ee6381aa634abf8d49efa59c79f79ae8b2ede8.png" alt="{\rm{OMGZ}} = {\rm{RPS}}"/></p>
</div></div>
<div class="section" id="harmonic-oscillation">
<span id="harmonicoscillationth"></span><span id="index-295"></span><h6>Harmonic Oscillation<a class="headerlink" href="#harmonic-oscillation" title="Permalink to this headline">¶</a></h6>
<p>This option permits use of independent simple harmonic functions for each
component of linear acceleration and angular velocity. Automatic evaluation of
gravitational components is allowed with this option. The input parameters
relevant to this option are: <span class="target" id="index-296"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCX</span></code>, <span class="target" id="index-297"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCY</span></code>, <span class="target" id="index-298"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCZ</span></code>, <span class="target" id="index-299"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVX</span></code>,
<span class="target" id="index-300"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVY</span></code>, <span class="target" id="index-301"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVZ</span></code>, <span class="target" id="index-302"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TFREQX</span></code>, <span class="target" id="index-303"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TFREQY</span></code>, <span class="target" id="index-304"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TFREQZ</span></code>, <span class="target" id="index-305"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TMAGX</span></code>,
<span class="target" id="index-306"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TMAGY</span></code>, <span class="target" id="index-307"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TMAGZ</span></code>, <span class="target" id="index-308"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TPHIX</span></code>, <span class="target" id="index-309"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TPHIY</span></code>, <span class="target" id="index-310"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TPHIZ</span></code>, <span class="target" id="index-311"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RFREQX</span></code>,
<span class="target" id="index-312"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RFREQY</span></code>, <span class="target" id="index-313"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RFREQZ</span></code>, <span class="target" id="index-314"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMAGX</span></code>, <span class="target" id="index-315"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMAGY</span></code>, <span class="target" id="index-316"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMAGZ</span></code>, <span class="target" id="index-317"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RPHIX</span></code>,
<span class="target" id="index-318"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RPHIY</span></code> and <span class="target" id="index-319"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RPHIZ</span></code>.</p>
<p>Each component of linear acceleration is given by:</p>
<div class="math" id="equation-componentoflinearacceleration">
<p><span class="eqno">(351)<a class="headerlink" href="#equation-componentoflinearacceleration" title="Permalink to this equation">¶</a></span><img src="_images/math/f938a9c9f06b00d56d2b60f8d35d22032c446b7e.png" alt="a = - {f^2} \cdot d \cdot \sin \left( {f \cdot t - \phi } \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/3daf2576f9b26b234f68a5e23fcd520c09823740.png" alt="f" style="vertical-align: -4px"/> is the frequency input (<span class="target" id="index-320"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TFREQX</span></code>, etc.),</li>
<li><img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is the displacement input (<span class="target" id="index-321"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TMAGX</span></code>, etc.),</li>
<li>and <img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> is the phase angle input (<span class="target" id="index-322"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TPHIX</span></code>, etc.).</li>
</ul>
<p>Note the sign change and multiplication by the square of the frequency, which
converts a displacement function to the required linear acceleration. Each
component of angular velocity is given by:</p>
<div class="math" id="equation-componentofangularvelocity">
<p><span class="eqno">(352)<a class="headerlink" href="#equation-componentofangularvelocity" title="Permalink to this equation">¶</a></span><img src="_images/math/d103324533b0946b7b7e0c4aa9aac92dbc4c3e52.png" alt="\omega = f \cdot \alpha \cdot \sin \left( {f \cdot t - \varphi } \right)"/></p>
</div><p>with <img class="math" src="_images/math/3daf2576f9b26b234f68a5e23fcd520c09823740.png" alt="f" style="vertical-align: -4px"/> = <span class="target" id="index-323"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RFREQX</span></code>, <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> = <span class="target" id="index-324"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RMAGX</span></code>, and <img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/>
= <span class="target" id="index-325"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RPHIX</span></code>, etc. Finally, the angular acceleration components are given by:</p>
<div class="math" id="equation-angularaccelerationcomponents">
<p><span class="eqno">(353)<a class="headerlink" href="#equation-angularaccelerationcomponents" title="Permalink to this equation">¶</a></span><img src="_images/math/16cffd6745d6363f3a4532b055a7e0553c8016b3.png" alt="\frac{{\partial \omega }}{{\partial t}} = {f^2} \cdot \alpha \cdot \cos \left( {f \cdot t - \phi } \right)"/></p>
</div><p>where the same input variables as for angular velocity are used to ensure
compatibility.</p>
</div>
<div class="section" id="tabular-specification">
<span id="tabularspecificationth"></span><span id="index-326"></span><h6>Tabular Specification<a class="headerlink" href="#tabular-specification" title="Permalink to this headline">¶</a></h6>
<p>One can specify tabular data for six of the reference frame variables by
providing a data file that will be read by subroutine <strong class="program">motion</strong> during the
calculation. Three of the reference frame variables are always the Cartesian
components of linear acceleration. The other three variables may be the
components of angular acceleration (<span class="target" id="index-327"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 2 or 4) or they may be the
components of angular velocity (<span class="target" id="index-328"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 3 or 5). The remaining three
variables are calculated by numerical differentiation or integration as
appropriate to ensure compatibility. Automatic evaluation of gravitational
components is allowed with this option.</p>
<p>The pertinent input variables are: <span class="target" id="index-329"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCX</span></code>, <span class="target" id="index-330"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCY</span></code>, <span class="target" id="index-331"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCZ</span></code>, <span class="target" id="index-332"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVX</span></code>,
<span class="target" id="index-333"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVY</span></code>, <span class="target" id="index-334"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GRAVZ</span></code>, <span class="target" id="index-335"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ACONV</span></code>, and <span class="target" id="index-336"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMCONV</span></code>.</p>
<p>The values of <span class="target" id="index-337"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 4 or 5 permit the specification of impulsive
intervals as well as smoothly varying accelerations. The same values also permit
the specification of the time-step size to be used at a particular time if
desired. <span class="target" id="index-338"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 2 or 3 permits only smoothly varying motions.</p>
<p>During execution, subroutine <strong class="program">motion</strong> will try to read the necessary data from the
data file <code class="file docutils literal notranslate"><span class="pre">movin</span></code> (the name of this file is user-defined; a full path to its
location can be defined as well).</p>
<p>The file has a free-format structure. The first card must contain an integer
indicating the number of lines that follow it to be skipped by <strong class="program">motion</strong>. This
permits you to annotate the file for your own documentation and inspection.
After these “header” lines must be a sequence of lines. Each line describes the
reference frame variables at a specific time. These times must be in strictly
increasing order!</p>
<p>The time must be the first entry on this line. Time should correspond to the
internal time in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. For restart calculations, time begins from the
selected value, <span class="target" id="index-339"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TREST</span></code>, not from zero. The next three entries are the
<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>-, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-, and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-components of linear acceleration.</p>
<p>The next three entries on the line are the three <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>-, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-, and
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-components of angular velocity in radians per unit time (if
<span class="target" id="index-340"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 3 or 5). The next three entries are the three <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>-,
<img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-, and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-components of angular acceleration in radians per
unit time squared (if <span class="target" id="index-341"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 2 or 4).</p>
<p>The next two entries, which are only read if <span class="target" id="index-342"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> &gt; 3, are the desired
time-step size (this value is only used if it is positive), and the duration
of the impulsive interval. The impulsive interval duration parameter
distinguishes between smooth interpolation points (for which it is
non-positive) and impulsive interval data (for which it is positive).</p>
<p>The subroutine <strong class="program">motion</strong> will convert the units of the data in the input
file by multiplying linear acceleration values by the input variable
<span class="target" id="index-343"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ACONV</span></code> and angular variables by <span class="target" id="index-344"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMCONV</span></code>. The converted values are
printed in the solver summary file <code class="file docutils literal notranslate"><span class="pre">hd3out</span></code> file. Values are
interpolated between available data. Constant values are used before the first
time value or after the last, in which case a message is printed in
<code class="file docutils literal notranslate"><span class="pre">hd3out</span></code> indicating that the data file values have been extrapolated.</p>
<p>As implied above, one may combine impulsive and smoothly varying accelerations
if <span class="target" id="index-345"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> &gt; 3. This is accomplished by specifying positive values for
the impulse duration in some card groups and zero or negative values in
others. The subroutine <strong class="program">motion</strong> interprets this kind of data file by
first interpolating the smooth data point parameters to the present time, then
adding the impulsive values if the present time lies within an impulse. This
permits accelerations that include rapid changes. This may happen, for
example, in response to a control system action on board a spacecraft.
Time-step size control is provided so that <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can anticipate the need to reduce
the time-step size before an acceleration impulse is encountered. This also
keeps <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> from accidentally skipping over the impulsive period because its
selected time-step size is larger than the interval of the impulse. If
automatic time-step selection is enabled, the time-step size will recover to
large values between impulses, greatly reducing the total computational cost.</p>
</div>
</div>
<div class="section" id="coupled-rigid-body-dynamics">
<span id="coupledrigidbodydynamicsth"></span><span id="index-346"></span><h5>Coupled Rigid Body Dynamics<a class="headerlink" href="#coupled-rigid-body-dynamics" title="Permalink to this headline">¶</a></h5>
<p>As described in <a class="reference internal" href="#noninertialreferenceframeth"><span class="std std-ref">Non-Inertial Reference Frame Motion</span></a> above, <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can be used to
study the fluid flow in moving tanks by embedding the tank in a coordinate
system that moves with respect to inertial space. Under some circumstances,
<span class="raw-html"><strong><em>FLOW-3D </em></strong></span> is also able to analyze the motion of this reference frame in a coupled
manner, including the influence of the forces and moments exerted by the
internal fluid on the tank. This is known as the “Coupled Rigid-Body Dynamics”
model and is described in this section.</p>
<p>The basic approach of this model is to treat the fluid region as a part of a
larger rigid body that can move through inertial space (see <a class="reference internal" href="#rigidbodydynamicsalgorithmth"><span class="std std-ref">Rigid Body
Dynamics</span></a>). This body may be subject to a variety
of forces and torques and will respond to them in a well-known manner. Since the
computational mesh is embedded in the rigid body, its motion is identical to
that of the body.</p>
<p>One set of important forces and torques that may be imposed on the body is that
created by the motion of fluid adjacent to it. Several alternative coupling
schemes are selectable by input and are described briefly below. A wide variety
of other forces may also be experienced by the body. <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> divides these forces
into three classes:</p>
<ul class="simple">
<li>Environmental Forces and Torques</li>
<li>Control Forces and Torques</li>
<li>Gravitational Force</li>
</ul>
<p>The first two classes are treated by providing links to two subroutines that can
be programmed for the specific analysis at hand. The distinction between
environmental and control classes is for convenience only and can be arbitrarily
decided by the analyst. The effects of gravity from a point-gravitating body are
automatically calculated, including the effects of the relative movement of the
coordinate system and the body. Since this model is intended for use by the
aerospace community, among others, both the direction and magnitude of gravity
are adjusted throughout the calculation.</p>
<p>In some situations, more than one fluid tank may affect the motion of the rigid
body. These tanks may contain fluids with differing properties (density,
viscosity, etc.). A multiple-tank model is included in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to permit the
investigation of these situations.</p>
<div class="section" id="input-data">
<span id="coupledrigidbodydynamicsinputdata"></span><span id="index-347"></span><h6>Input Data<a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h6>
<p>The coupled rigid-body dynamics model is activated by setting <span class="target" id="index-348"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IACCF</span></code> = 2 in the
<span class="target" id="index-349"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">XPUT</span></code> namelist. It is also necessary to specify the dry mass and moments of
inertia of the rigid body; these are provided in namelist <span class="target" id="index-350"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RBDATA</span></code>. Other
input data may include the initial location, orientation and motion of the body
and the parameters of the gravitating body.</p>
<p>The input parameter <span class="target" id="index-351"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IRBACC</span></code> controls the coupling algorithm to be used and
the manner in which the initial values of linear and angular acceleration are
calculated. Initial evaluation of accelerations is necessary since the fluid
reaction forces are not known at the start of a calculation. IRBACC allows the
analyst to choose between ignoring the fluid and treating it as a frozen mass at
the start of the first fluid time step.</p>
<p>In general, use of the coupled model requires special versions of the control
and environmental force and torque specification routines, <span class="target" id="index-352"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RBCTRL</span></code> and
<span class="target" id="index-353"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RBENVR</span></code>. The distribution version of <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> includes a special purpose
control routine, which can accept a variety of input parameters. There are three
options available in this standard routine. The choice among them is made by
specifying <span class="target" id="index-354"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> as follows:</p>
<blockquote>
<div><p><strong>IATYPE = 0:</strong> No force or torque supplied</p>
<p><strong>IATYPE = 1:</strong> Control force calculated from a spring and damper model</p>
<p><strong>IATYPE = 2:</strong> Control torque calculated from a spring and damper model</p>
<p><strong>IATYPE = 3:</strong> Tabular specification of control force and torque components</p>
</div></blockquote>
<p>The spring and damper coefficients for <span class="target" id="index-355"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 1 or 2 are specified in
the namelist <span class="target" id="index-356"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">MOTN</span></code> as <span class="target" id="index-357"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RADKRB</span></code>, <span class="target" id="index-358"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RDMPRB</span></code> or <span class="target" id="index-359"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">THEKRB</span></code>,
<span class="target" id="index-360"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TDMPRB</span></code>. For <span class="target" id="index-361"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 1 one may also specify an equilibrium radius
via <span class="target" id="index-362"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">REQRB</span></code>. (The equilibrium angle is always zero for <span class="target" id="index-363"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> = 2.)</p>
<p>The tabular input option is similar to tabular specification of reference frame
motion. One can specify tabular data for the six Cartesian components of control
force and torque by providing a data file that will be read by subroutine <strong class="program">rbctrl</strong>
during the calculation. The default name for this file is <code class="file docutils literal notranslate"><span class="pre">thrust.inp</span></code>.</p>
<p>The conversion constants (<span class="target" id="index-364"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ACONV</span></code> and <span class="target" id="index-365"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMCONV</span></code>) may be used in
conjunction with the thrust data file. The force components read from the file
are multiplied by <span class="target" id="index-366"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ACONV</span></code> for use by <strong class="program">RBCTRL</strong>, while the torque
components are multiplied by <span class="target" id="index-367"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMCONV</span></code>.</p>
<p>The file has a free-format structure. The first card must contain an integer
indicating the number of lines that follow it to be skipped by <strong class="program">motion</strong>. This
permits you to annotate the file for your own documentation and inspection.
After these “header” lines must follow a sequence of input lines. Each line
describes the force and torque components at a specific time. These times must
be in strictly increasing order!</p>
<p>The time must be the first entry on this line. Time should correspond to the
internal time in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. For restart calculations, time begins from the
selected value, <span class="target" id="index-368"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TREST</span></code>, not from zero. The next three entries are the
components of the control force (in the order <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>,
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>). The following three entries are the components of control torque
in the same order. The next entry is the desired time-step size. This value is
only used if it is positive. The final entry determines if the line is used as
an interpolation point for smooth force and torque variation or as an
impulsive motion specification. If <span class="target" id="index-369"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IATYPE</span></code> &gt; 3 this entry must always be
present at the end of the line. If the data entry is positive, it indicates
the length of the impulse. Otherwise, the line is interpreted as an
interpolation point in smoothly varying functions.</p>
<p>As implied above, one may combine impulsive and smoothly varying accelerations.
This is accomplished by specifying positive values for the impulse duration in
some lines and zero or negative values in others. <strong class="program">rbctrl</strong> interprets this
kind of data file by first interpolating the smooth data point parameters to the
present time, then adding the impulsive values if the present time lies within
an impulse. This permits accelerations that include rapid changes. This may
happen, for example, in response to a control system action on board a
spacecraft. Time-step size control is provided so that <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> can anticipate the
need to reduce the time-step size before an acceleration impulse is encountered.
This also keeps <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> from accidentally skipping over the impulsive period
because its selected time-step size is larger than the interval of the impulse.
If automatic time-step selection is enabled, the time-step size will recover to
large values between impulses, greatly reducing the total computational cost.</p>
</div>
<div class="section" id="explicit-solution-algorithm-and-stability-limitations">
<span id="explicitsolutionalgorithmth"></span><span id="index-370"></span><h6>Explicit Solution Algorithm and Stability Limitations<a class="headerlink" href="#explicit-solution-algorithm-and-stability-limitations" title="Permalink to this headline">¶</a></h6>
<p>The explicit coupled solution proceeds by (1) solving the fluid flow equations
using the previous solution for the movement of the reference system, (2)
evaluating the resulting fluid forces and torques, (3) adding the control and
environmental effects to produce equations for the motion of the rigid body, and
(4) solving these equations for the new acceleration parameters, center of mass
location, and rigid body orientation (attitude). The new reference frame
parameters are used in the following cycle for the fluid solution. This explicit
form of coupling is known to be unstable if the fluid mass or its inertia
moments exceed those of the rigid body. (This is only an approximate
relationship. We have seen cases where the fluid mass or inertia can be somewhat
larger without instability developing. We also suspect that there will be cases
where the opposite is true.)</p>
</div>
<div class="section" id="implicit-solution-algorithms">
<span id="implicitsolutionalgorithmsth"></span><span id="index-371"></span><h6>Implicit Solution Algorithms<a class="headerlink" href="#implicit-solution-algorithms" title="Permalink to this headline">¶</a></h6>
<p>Two implicit solution algorithms are available. The first algorithm (<span class="target" id="index-372"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IRBACC</span></code> = 2) is analogous to the explicit method, except that the fluid
mass is treated as frozen during step 4. That is, the fluid forces respond to
changes in reference frame acceleration as if the fluid were frozen to the
computational mesh.</p>
<p>This modification eliminates the stability limitation of the explicit solution.
The accuracy of this algorithm depends on the extent to which the “frozen”
approximation is appropriate to the solution.</p>
<p>A refinement to this method is to treat the calculated reference frame motion as
an estimate of the end of cycle result. The fluid solution is then repeated for
the same cycle, using the estimated reference frame motion. New fluid forces are
combined with environmental and control forces to reevaluate the reference frame
motion. Iterations are continued until a convergence criterion on the
accelerations is met. This is the iterative implicit algorithm (<span class="target" id="index-373"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IRBACC</span></code> =
3). Again, its accuracy depends on the validity of the “frozen” approximation.</p>
<p>For additional information on the coupled rigid body dynamics model, including a
complete description of input parameters and output variables, please refer to
References <a class="reference internal" href="zbibliography.html#sicilian-1992" id="id72">[Sic92]</a>, <a class="reference internal" href="zbibliography.html#sicilian-1995" id="id73">[Sic95]</a>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="pressure-solution-algorithm">
<span id="pressuresolutionalgorithmth"></span><span id="index-374"></span><h3>Pressure Solution Algorithm<a class="headerlink" href="#pressure-solution-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The numerical treatment of mass conservation is quite different in compressible
and incompressible flows. However, in either case, the appropriate mass equation
leads to an algorithm for determining cell pressures and updating velocities.
For incompressible flows or flows of limited compressibility (which must use the
implicit pressure solution method), the continuity equation, Eq.
<a class="reference internal" href="#equation-densitytimederivative">(6)</a> or Eq. <a class="reference internal" href="#equation-modifiedcontinuityequation">(8)</a>, can be
directly interpreted as an elliptic condition on the cell pressures and
velocities. For compressible flows, the continuity equation, Eq.
<a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>, is solved as a parabolic equation, i.e., by
a marching algorithm in time. The pressure is then determined by requiring the
equation-of-state density to equal the updated cell density. In this case the
velocities do not need to be updated if the time-step size is small enough to
ensure stability with respect to the propagation of sound waves. Using the
implicit option for compressible flows permits the use of larger time steps, but
may be less accurate for shock and rarefaction wave profiles.</p>
<p>Sometimes adding artificial limited compressibility to the fluid can improve
convergence without introducing significant errors into the solution. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
this can be done in an automated way by setting <span class="target" id="index-375"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IMP</span></code> = 2 (the default is
<span class="target" id="index-376"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IMP</span></code> = 1). See Flow Science Technical Note #55 on the users site at
<a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a> for details of the model.</p>
<div class="section" id="incompressible-sor-method">
<span id="incompressiblesormethodth"></span><h4>Incompressible SOR Method<a class="headerlink" href="#incompressible-sor-method" title="Permalink to this headline">¶</a></h4>
<p>Velocities computed from Eq. <a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a> must
satisfy the following discretized approximation to the limited compressibility
continuity equation, Eq. <a class="reference internal" href="#equation-modifiedcontinuityequation">(8)</a>,</p>
<div class="math" id="equation-incompressiblesormethod1">
<p><span class="eqno">(354)<a class="headerlink" href="#equation-incompressiblesormethod1" title="Permalink to this equation">¶</a></span><img src="_images/math/0ba72d0ac23088ba042fdb191036af2bfa54850b.png" alt="\begin{gathered}
\frac{{{{\left( {\frac{1}{{\rho {c^2}}}} \right)}_{i,j,k}} \cdot {V_{{f_{i,j,k}}}}\left( {p_{i,j,k}^{n + 1} - p_{i,j,k}^n} \right)}}{{\delta t}} + \frac{{\left( {u_{i,j,k}^{n + 1}{\rm{AFR}}_{i,j,k} - u_{i - 1,j,k}^{n + 1}{\rm{AFR}}_{i - 1,j,k}} \right)}}{{\delta {x_i}}} \hfill \\
+ \frac{{\left( {v_{i,j,k}^{n + 1}{\rm{AFB}}_{i,j,k} - v_{i,j - 1,k}^{n + 1}{\rm{AFB}}_{i,j - 1,k}} \right){R_i}}}{{\delta {y_j}}} + \frac{{\left( {w_{i,j,k}^{n + 1}{\rm{AFT}}_{i,j,k} - w_{i,j,k - 1}^{n + 1}{\rm{AFT}}_{i,j,k - 1}} \right)}}{{\delta {z_k}}} \hfill \\
+ \frac{{{\rm{CYL}} \cdot \left( {u_{i,j,k}^{n + 1}{\rm{AFR}}_{i,j,k} + u_{i - 1,j,k}^{n + 1}{\rm{AFR}}_{i - 1,j,k}} \right)}}{{2 \cdot {\rm{XC}}_i}} - {\left( {\frac{{\rm{RSOR}}}{\rho }} \right)_{i,j,k}} = 0 \hfill \\
\end{gathered}"/></p>
</div><p>where <img class="math" src="_images/math/a8106fa2f7b66b2bd51a8da227ab0d54dfd0e364.png" alt="{\rm{XC}}_i" style="vertical-align: -3px"/> is the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> location of the center of cell <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>.
For cylindrical coordinates one has <span class="target" id="index-377"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CYL</span></code> = 1.0 and <img class="math" src="_images/math/b1656667a2957edaca8662b77f6a2c6f2f37df47.png" alt="R_i = {\rm{X}}_{{\rm{IM1}}}/ {\rm{XC}}_i" style="vertical-align: -5px"/>,
in which <img class="math" src="_images/math/3daa1fbcbdc1b66c3e1499839c1ad3b4c3021c06.png" alt="{\rm{X}}_{\rm{IM1}}" style="vertical-align: -3px"/> is the radius (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> location) of the outer edge
of the last real cell in the mesh. In Cartesian geometry <img class="math" src="_images/math/b088717b0570437f03ad62aa89ea8fe965a4b8d7.png" alt="R_i = 1.0" style="vertical-align: -3px"/> for
all <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/>, and <span class="target" id="index-378"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CYL</span></code> = 0.0. The term <span class="target" id="index-379"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RSOR</span></code> <img class="math" src="_images/math/747370e511ef0c317a2e281c789eb5546839d131.png" alt="/ \rho" style="vertical-align: -5px"/> represents
the volume source of fluid in the cell. The compressibility coefficient,
<img class="math" src="_images/math/ce0a864fc2181f8b7b8c8f1cbbff7cc0b2e4cd8c.png" alt="1/ {\left( \rho c \right)}^2" style="vertical-align: -5px"/>, is calculated by the formula for two-fluid
problem</p>
<div class="math" id="equation-incompressiblesormethod2">
<p><span class="eqno">(355)<a class="headerlink" href="#equation-incompressiblesormethod2" title="Permalink to this equation">¶</a></span><img src="_images/math/7d7c4ed9f82a1c31319bb1e3ff40b03696dd5b56.png" alt="{\left( {\frac{1}{{\rho \,{c^2}}}} \right)_{i,j,k}} = \frac{{1 - F_{i,j,k}^2}}{{{{(\rho \,{c^2})}_\upsilon }}} + \frac{{F_{i,j,k}^2}}{{{{(\rho \,{c^2})}_l}}}"/></p>
</div><p>Only the second term exists for one-fluid problems. Subscripts <img class="math" src="_images/math/c7660814d4975114ec4e34bd9165b85496522e7c.png" alt="l" style="vertical-align: 0px"/> and
<img class="math" src="_images/math/914562595ccc9c954f1a9c8f76cb39462856e877.png" alt="v" style="vertical-align: 0px"/> denote fluid #1 and fluid #2, respectively.</p>
<p>Limited compressibility can be used for two purposes, physical and numerical.
By setting the two input parameters, <span class="target" id="index-380"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQL</span></code> <img class="math" src="_images/math/5a77ac3447f3fc320d81a541dbaca74b888349ea.png" alt="= 1/\left( {\rho
{c^2}} \right)_l" style="vertical-align: -5px"/> and <span class="target" id="index-381"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQV</span></code> <img class="math" src="_images/math/c2c271db6aff3f4c92b34ed554f86519a7dfb11f.png" alt="= 1/{\left( {\rho {c^2}} \right)_v}" style="vertical-align: -5px"/>,
one can model limited physical compressibility of the fluids.</p>
<p>By setting <span class="target" id="index-382"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQL</span></code> and <span class="target" id="index-383"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQV</span></code> appropriately, one can also mitigate
the effects of occasional numerical pressure pulses caused by the collapse of
free-surfaces onto obstacle boundaries.</p>
<p>For velocities to satisfy Eq. <a class="reference internal" href="#equation-incompressiblesormethod1">(354)</a>, it is necessary to
adjust the pressure and, hence, the velocities in each computational cell
occupied by fluid. This is done in one of two ways. The simplest method is a
successive over-relaxation (SOR) iterative process. The computational mesh is
swept cell by cell starting with the first non-boundary cell in the mesh.
Sweeping is first carried out on <em>i</em>, then <em>j</em>, and finally on <em>k</em> values.
Calculations are only performed in cells that contain fluid and have no empty
neighbors. The pressure change needed to make the velocities in cell (<em>i</em>, <em>j</em>,
<em>k</em>) satisfy Eq. <a class="reference internal" href="#equation-incompressiblesormethod1">(354)</a> is</p>
<div class="math" id="equation-incompressiblesormethod3">
<p><span class="eqno">(356)<a class="headerlink" href="#equation-incompressiblesormethod3" title="Permalink to this equation">¶</a></span><img src="_images/math/65714f9af311c18105c0a0ae4a2842d210dbd664.png" alt="\delta p = - \frac{S}{{\partial S/\partial p}}"/></p>
</div><p>where <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> is the left-hand side of Eq. <a class="reference internal" href="#equation-incompressiblesormethod1">(354)</a>. Eq.
<a class="reference internal" href="#equation-incompressiblesormethod3">(356)</a> is simply a Newton type of relaxation process
that will produce the value of <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> needed to make <img class="math" src="_images/math/3c332ac11842e0d4f5ae5ffbb8b616a53b1f1914.png" alt="S = 0" style="vertical-align: 0px"/>. In each
cell the velocity values used in evaluating <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> are the most current
values available during the iteration process. Using the result from Eq.
<a class="reference internal" href="#equation-incompressiblesormethod3">(356)</a>, the new estimate for the cell pressure is</p>
<div class="math" id="equation-incompressiblesormethod4">
<p><span class="eqno">(357)<a class="headerlink" href="#equation-incompressiblesormethod4" title="Permalink to this equation">¶</a></span><img src="_images/math/5e913b25637ed652bb81096db6ecbd108e857783.png" alt="{p_{i,j,k}} + \delta p"/></p>
</div><p>and new estimates for the velocities located on the sides of the cell are</p>
<div class="math" id="equation-incompressiblesormethod5">
<p><span class="eqno">(358)<a class="headerlink" href="#equation-incompressiblesormethod5" title="Permalink to this equation">¶</a></span><img src="_images/math/98d0523a6abc179f7f766a7ad7cde1f9b9c69604.png" alt="\begin{gathered}
{u_{i,j,k}} + \frac{{\delta p\delta t}}{{{{(\rho \delta x)}_{i + \frac{1}{2},j,k}}}} \hfill \\
{u_{i - 1,j,k}} - \frac{{\delta t\delta p}}{{{{(\rho \delta x)}_{i - \frac{1}{2},j,k}}}} \hfill \\
{v_{i,j,k}} + \frac{{\delta t\delta p{R_i}}}{{{{(\rho \delta y)}_{i,j + \frac{1}{2},{\rm K}}}}} \hfill \\
{v_{i,j - 1,k}} - \frac{{\delta t\delta p{R_i}}}{{{{(\rho \delta y)}_{i,j - \frac{1}{2},k}}}} \hfill \\
{w_{i,j,k}} + \frac{{\delta t\delta p}}{{{{(\rho \delta z)}_{i,j,k + \frac{1}{2}}}}} \hfill \\
{w_{i,j,k - 1}} - \frac{{\delta \,t\delta p}}{{{{(\rho \delta z)}_{i,j,k - \frac{1}{2}}}}} \hfill \\
\end{gathered}"/></p>
</div><p>where the velocities appearing here are also the most current values available
during the iteration. To start the iteration process, the new estimated
velocities from Eq. <a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a> are used with
the pressures remaining from the previous time step. Of course, velocities
located at zero area faces are not adjusted at this stage.</p>
<p>In cells containing a free-surface, that is, a cell containing fluid, but with
one or more empty neighbors, a different procedure is used. The boundary
condition wanted in these cells is that the pressure is a specified value, say
<img class="math" src="_images/math/e9dc01427caee37db4cd07718063f8b7235f1bcd.png" alt="p_s" style="vertical-align: -4px"/>, at the surface. The surface pressure is set equal to the sum of the
neighboring void region pressure, <img class="math" src="_images/math/fbec4030e53e612291e8e86d66eb1f73f978a3b5.png" alt="{\rm{PR}}" style="vertical-align: 0px"/>, and the surface tension pressure,
<img class="math" src="_images/math/519437c4c31587f023b60aa0c260b611972556c6.png" alt="{\rm{PS}}" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-incompressiblewormethod6">
<p><span class="eqno">(359)<a class="headerlink" href="#equation-incompressiblewormethod6" title="Permalink to this equation">¶</a></span><img src="_images/math/8727482cb69d00e1ec1f9c5ceca28e86016c187a.png" alt="{p_s} = {\rm{PR}}(n) + {\rm{PS}}_{i,j,k}"/></p>
</div><p>where <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> is the index of the adjacent void region. Evaluation of
<img class="math" src="_images/math/519437c4c31587f023b60aa0c260b611972556c6.png" alt="{\rm{PS}}" style="vertical-align: 0px"/> is described in <a class="reference internal" href="#surfacetensionwalladhesionth"><span class="std std-ref">Surface Tension with Wall Adhesion</span></a>. The
surface pressure, <img class="math" src="_images/math/e9dc01427caee37db4cd07718063f8b7235f1bcd.png" alt="p_s" style="vertical-align: -4px"/>, is then imposed on the solution by
extrapolating it to the pressure, <img class="math" src="_images/math/ec9dd17199a3f66c9a201999acb5b7dc5a92a89d.png" alt="p_{i,j,k}" style="vertical-align: -6px"/>, at the center of the
surface cell, assuming a hydrostatic distribution within the cell. The
hydrostatic variation depends on the net acceleration in the direction normal
to the surface, as defined by <img class="math" src="_images/math/13058a6cb3c73791a30ae56b04b5b5c1db16902c.png" alt="{\rm{NF}}" style="vertical-align: 0px"/>. This surface cell pressure is
not changed during the pressure iteration, but is treated as a fixed boundary
value. In this way the actual location of the free-surface within the cell is
explicitly taken into account.</p>
<p>It has been observed that numerical instability can develop due to the
explicit approximation of the void region pressure, <img class="math" src="_images/math/afd789861ea9c08ac33d6ff2d2afac8da7960f5f.png" alt="{\rm{PR}}\left( n
\right)" style="vertical-align: -5px"/>, when high pressure, adiabatic, gas bubbles are present <a class="reference internal" href="zbibliography.html#hirt-1992" id="id74">[Hir92]</a>,
<a class="reference internal" href="zbibliography.html#barkhudarov-chin-1994" id="id75">[BC94]</a> (the adiabatic bubble model is described in
<a class="reference internal" href="#variablepressurevoidregionsth"><span class="std std-ref">Variable Pressure (Adiabatic) Void Region</span></a>). To help eliminate these difficulties, an
implicit bubble model has been added to <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>. The purpose of this addition
was to anticipate bubble pressure changes computed at the end of a cycle and
include them in the usual pressure-velocity iteration process. The implicit
bubble model works well if the “stiffness” of the bubbles is not too large. A
stiff bubble is one whose anticipated and actual pressure changes within one
time step are very different. In other words, a stiff bubble is, by
definition, one in which the end-of-cycle pressure is not well approximated by
the implicit model. When stiff bubbles occur, the solution may have large
pressure changes every cycle and corresponding large fluctuations in
velocities and other quantities (see Ref. <a class="reference internal" href="zbibliography.html#hirt-1992" id="id76">[Hir92]</a> for more details).</p>
<p>For two-fluid problems, all cells are treated as full; that is, pressures and
velocities are adjusted in all fluid cells during iterations. If surface tension
is employed, then pressure <img class="math" src="_images/math/d70793685299d41f5b15c43fb12d1e02111fa317.png" alt="{\rm{PS}}_{i,j,k}" style="vertical-align: -6px"/> is only applied to one of the
fluids so that a discontinuity in pressure across the interface due to surface
tension effects is maintained.</p>
<p>A complete iteration consists of adjusting pressures and velocities in all full
cells according to Eqs. <a class="reference internal" href="#equation-incompressiblesormethod3">(356)</a>,
<a class="reference internal" href="#equation-incompressiblesormethod4">(357)</a> and <a class="reference internal" href="#equation-incompressiblesormethod5">(358)</a>.
Convergence of the iteration is achieved when all cells have <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> values whose
magnitudes are below some small number, <span class="target" id="index-384"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code> <img class="math" src="_images/math/c02cf61b8ebbe79ec164f51421d08e82550447a4.png" alt="\cdot {\text{VF}}_{i,j,k}" style="vertical-align: -6px"/>.</p>
<p>The value of <span class="target" id="index-385"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code> is computed automatically by <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> as a
function of the time-step size at every time cycle. This algorithm is invoked
when the value of the input parameter <span class="target" id="index-386"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSADJ</span></code> is positive. Alternatively, a
constant value of <span class="target" id="index-387"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code> can be used throughout a calculation.</p>
<p>In some cases, convergence of the iteration may be accelerated by multiplying
<img class="math" src="_images/math/511236a0217d6ffcc7cdaf7041108c3b55c2ab46.png" alt="\delta p" style="vertical-align: -4px"/> in Eq. <a class="reference internal" href="#equation-incompressiblesormethod4">(357)</a> by a relaxation
factor, <span class="target" id="index-388"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code>. A value of <span class="target" id="index-389"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> equal to 1.7 or 1.8 is often optimum. In no
case should <span class="target" id="index-390"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> exceed 2.0, because otherwise an unstable iteration results.
For compressible flows <span class="target" id="index-391"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> is set to 1.0. Also, it is recommended to use
<span class="target" id="index-392"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> = 1.0 for incompressible flows when the time-step size is significantly
below the convective stability limit. This may reduce a possible pressure noise
in the solution.</p>
</div>
<div class="section" id="incompressible-line-implicit-sadi-method">
<span id="sadimethodth"></span><span id="index-393"></span><h4>Incompressible Line Implicit SADI Method<a class="headerlink" href="#incompressible-line-implicit-sadi-method" title="Permalink to this headline">¶</a></h4>
<p>The previously described SOR iterative method for computing pressures is simple
and works quite well for many problems. However, there are situations where the
SOR method can be extremely slow to converge. For instance, meshes in which the
cell size in one direction is much larger than in the other directions will
exhibit slow convergence in that direction because the SOR pressure relaxation
is limited by the smaller cell sizes in the transverse directions.</p>
<p>A remedy for this type of slow convergence is to use a more implicit solution
method in the direction of smaller cell sizes. For this purpose, a modified
Alternating-Direction-Implicit (SADI) scheme was developed. SADI is based on a
standard tridiagonal solver for pressures along an <em>i</em>, <em>j</em>, or <em>k</em> column of
mesh cells. This solver is applicable to all boundary conditions including
periodic boundaries.</p>
<p>When periodic boundaries are used in the azimuthal direction in cylindrical
coordinate system, it is recommended to use the ADI pressure solver -and only in
that direction-by setting <span class="target" id="index-394"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IADIY</span></code>=1. This will help eliminate numerical
noise in the pressure and velocity solution that can sometimes occur.
Alternatively, turning off over-relaxation by setting <span class="target" id="index-395"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code>= 1.0 may help
to reduce the noise.</p>
<p>If the SADI method is used in the z-direction, the iteration consists of a sweep
through all <em>i</em> and <em>j</em> indexes and for each (<em>i</em>, <em>j</em>) pair solving implicitly
for the pressures in the <em>k</em>-index direction. Pressure values required in
adjacent columns are always taken to be at their latest iterative values, a
practice not always used with standard ADI methods, but one which improves
convergence.</p>
<p>The SADI method can be used in any combination of directions: any one, any two,
or all three. This means that the more costly implicit sweeps can be limited to
only those directions necessary to improve convergence of the overall iteration.</p>
<p>When only one or two directions are treated implicitly, the over-relaxation
between columns is controlled by the parameter <span class="target" id="index-396"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> used in SOR
over-relaxation. Generally, SADI is not too sensitive to this parameter, and the
default value, <span class="target" id="index-397"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> = 1.7, is usually satisfactory. When SADI is used in
all three directions, the parameter <span class="target" id="index-398"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> has no effect, as the
over-relaxation is fixed at its maximum value in that case.</p>
</div>
<div class="section" id="compressible-solution-method">
<span id="compressiblesolutionmethodth"></span><span id="index-399"></span><h4>Compressible Solution Method<a class="headerlink" href="#compressible-solution-method" title="Permalink to this headline">¶</a></h4>
<p>For compressible flows, the cell pressure is determined by equating the
continuity equation density to the density determined from the
equation-of-state. Both SOR and SADI solutions to this equation are available. For both
algorithms the iteration function used in Eq. <a class="reference internal" href="#equation-incompressiblesormethod3">(356)</a>
is defined as</p>
<div class="math" id="equation-compressiblesolutionmethod1">
<p><span class="eqno">(360)<a class="headerlink" href="#equation-compressiblesolutionmethod1" title="Permalink to this equation">¶</a></span><img src="_images/math/7b49dfa9677424f2711489b77617b99cccd3e79e.png" alt="{S_{\,\,i,j,k}} = \frac{{{V_F}(1 - F)}}{{\rho _2^{\,n}}} \cdot \left( {\rho \,_{i,j,k}^{\,{\rm{eos}}} - \rho _2^{\,n}} \right) + D{T^{n + 1}} + \frac{{{V_F}F}}{{\rho C_1^2}}(P - {P^{\,n}})"/></p>
</div><p>The factor <img class="math" src="_images/math/e326e9e78d654f04acc4da9491efc6f4e3b39877.png" alt="\nabla \cdot {\text{(uA}}\Phi {\text{)}}" style="vertical-align: -5px"/> adjusts for the
compression or expansion of the cell based on the velocities at time <span class="target" id="index-400"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">n</span></code>+1, where</p>
<div class="math" id="equation-compressiblesolutionmethod2">
<p><span class="eqno">(361)<a class="headerlink" href="#equation-compressiblesolutionmethod2" title="Permalink to this equation">¶</a></span><img src="_images/math/9ba73dc62660c766bd3b7c8082595d71b12c5c24.png" alt="D{T^{n + 1}} = \delta t(\nabla \cdot {\mathbf{uA}})_{i,j,k}^{n + 1},{\text{ }}\,\,\,\,\,{\mathbf{uA}} = (u{A_x},{\text{ }}v{A_y},{\text{ }}w{A_z})"/></p>
</div><p><img class="math" src="_images/math/676b50d588de4873ac1af4cebc1a7e768775efd6.png" alt="C_1" style="vertical-align: -3px"/> is the sound speed in fluid #1. Note that for the explicit solution
method <img class="math" src="_images/math/03f3cf6ba207230b5037a45f5bcbd9cecbf5289d.png" alt="u_{i,j,k}^{n + 1} = {\tilde u_{i,j,k}}" style="vertical-align: -8px"/>, the value of velocity
from the explicit momentum equation, which makes <img class="math" src="_images/math/f07fe32467dbe456b03b06a7c1004b71933ddde4.png" alt="DT_{i,j,k}^{n + 1}" style="vertical-align: -8px"/>
independent of the iteration on cell pressures. We define the
equation-of-state density</p>
<div class="math" id="equation-compressiblesolutionmethod3">
<p><span class="eqno">(362)<a class="headerlink" href="#equation-compressiblesolutionmethod3" title="Permalink to this equation">¶</a></span><img src="_images/math/b674afaddee1556dec62f14050d5e10b3a317ff6.png" alt="{\rho ^{\,\,{\rm{eos}}}} = F(i,j,k) \cdot {\rho _1} + \left[ {1 - F(i,j,k)} \right] \cdot {\rho _2}\left[ {{p^{n + 1}}(i,j,k),I_2^n(i,j,k)} \right]"/></p>
</div><p>Note that the equation-of-state density is not adjusted for energy changes from
time level n to level n+1 caused by expansion or compression. Since the
iteration is repeated every time step, the error made in not updating the energy
is at most only one time step behind and is not significant for purposes of
achieving time-step stability. The quantity <img class="math" src="_images/math/f339fa20c86097a5e1467087bc9cce098b4f6057.png" alt="\delta S/\delta p" style="vertical-align: -5px"/> used in
Eq. <a class="reference internal" href="#equation-incompressiblesormethod3">(356)</a> requires the term <span class="target" id="index-401"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">DSDPU</span></code> <img class="math" src="_images/math/f47be798ebfc97e3f2dd7b1182531834584b6030.png" alt="= \delta
D{T_{i,j,k}}/\delta {p_{i,j,k}}" style="vertical-align: -6px"/>, which is evaluated and stored once each cycle.</p>
<p>The SADI solution proceeds as in the incompressible case. The iteration function
can still be treated as a tridiagonal system (retaining latest iterate values
for <img class="math" src="_images/math/0ade178d7d678278864f009b899914bce85a5b3a.png" alt="p" style="vertical-align: -4px"/> in the transverse directions). Convergence is reached in either
case for all cells when</p>
<div class="math" id="equation-compressiblesolutionmethod4">
<p><span class="eqno">(363)<a class="headerlink" href="#equation-compressiblesolutionmethod4" title="Permalink to this equation">¶</a></span><img src="_images/math/51f642304e06bf9ecdf4120dca330f92cde68136.png" alt="\left| {{S_{i,j,k}}} \right| &lt; {\rm{EPSI}} \cdot \delta t \cdot {\rm{VF}}_{i,j,k}."/></p>
</div><p>An option is provided in the SOR solution algorithm that is useful when the
dependency of pressure on density in the equation of state is non-linear
(achieved though a customization of the code). An inner iteration is
implemented to vary the pressure within a cell to satisfy the condition of Eq.
<a class="reference internal" href="#equation-compressiblesolutionmethod4">(363)</a> before proceeding to the next cell. The user
may specify the maximum number of inner iterations (<span class="target" id="index-402"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IITMX</span></code>) and the
relaxation factor, <span class="target" id="index-403"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code>. <span class="target" id="index-404"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code> <img class="math" src="_images/math/ea72d5a3183cb878413d42cc8426b56e94d24286.png" alt="= 1.0" style="vertical-align: 0px"/> is recommended if
<span class="target" id="index-405"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IITMX</span></code> &gt; 1.</p>
<p>Specified velocity and specified pressure boundary conditions can create a
uniform pressure change in the computational domain that is difficult to compute
by either of the available iteration methods. For this situation an additional
algorithm is provided in the compressible solution procedure to give a uniform
global pressure adjustment. The option is activated by setting variable
<span class="target" id="index-406"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IPUN</span></code> equal to 1. If <span class="target" id="index-407"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IPUN</span></code> = 0, no uniform pressure change is
evaluated. This uniform pressure adjustment is calculated by summing over cells
the product of <img class="math" src="_images/math/0a7b69a766dfd19cfa61f2f683453b24bcd7fb42.png" alt="S_{i,j,k}" style="vertical-align: -6px"/> and the cell volume and dividing the result by
the sum over cells of <img class="math" src="_images/math/115c8021bacd0577577d419f56becf47c8a648c7.png" alt="\delta S/ \delta p" style="vertical-align: -5px"/> times the cell volume.</p>
</div>
<div class="section" id="gmres-pressure-velocity-solvers">
<span id="gmrespressurevelocitysolversth"></span><span id="index-408"></span><h4>GMRES Pressure-Velocity Solvers<a class="headerlink" href="#gmres-pressure-velocity-solvers" title="Permalink to this headline">¶</a></h4>
<p>New pressure-velocity solvers have been implemented in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
<a class="reference internal" href="zbibliography.html#ashby-et-al-1990" id="id77">[AMS90]</a>, <a class="reference internal" href="zbibliography.html#barrett-et-al-1994" id="id78">[BBC+94]</a> and <a class="reference internal" href="zbibliography.html#saad-1996" id="id79">[Saa96]</a>.
GMRES stands for
the generalized minimum residual method. In addition to the GMRES solver, a new
optional algorithm-the generalized conjugate gradient (GCG) algorithm-has also
been implemented for solving viscous terms in the new GMRES solver. This new
solver is a highly accurate and efficient method for a wide range of problems.
It possesses good convergence, symmetry and speed properties; however, it does
use more memory than the SOR or SADI methods. The GMRES solver does not use any
over- or under-relaxation.</p>
<p>For more details on the methods used, Flow Science TN68 can be found
on the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a>.</p>
</div>
</div>
<div class="section" id="scalar-advection">
<span id="scalaradvectionth"></span><span id="index-409"></span><h3>Scalar Advection<a class="headerlink" href="#scalar-advection" title="Permalink to this headline">¶</a></h3>
<p>The compressible continuity equation, Eq. <a class="reference internal" href="#equation-generalmasscontinuityequation">(1)</a>,
fluid fraction equation, Eq. <a class="reference internal" href="#equation-fluidinterfacesandfreesurfaces1">(19)</a>, internal
energy equation, Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, and the turbulent energy and
dissipation equations, Eqs. <a class="reference internal" href="#equation-transportequation">(279)</a> and
<a class="reference internal" href="#equation-additionaltransportturbulentdissipation">(284)</a>, all share the common form, in
vector notation,</p>
<div class="math" id="equation-scalaradvection">
<p><span class="eqno">(364)<a class="headerlink" href="#equation-scalaradvection" title="Permalink to this equation">¶</a></span><img src="_images/math/15c8615a2f38848498eca089fad1b7176a1e3afc.png" alt="{V_F}\frac{{\partial \Phi }}{{\partial t}} + \nabla \cdot ({\mathbf{uA}}\Phi ) = {\rm{RHS}}"/></p>
</div><p>which is a scalar advection equation for the quantity <img class="math" src="_images/math/8ee854e4bf288646d3880cc061a7ec158e1ad600.png" alt="\Phi" style="vertical-align: 0px"/> with a right-hand
side, <img class="math" src="_images/math/e32e2791d1499b5b504d78dab2cbd4158f8cc2d4.png" alt="{\rm{RHS}}" style="vertical-align: 0px"/>, that may contain diffusion and source contributions. All five
equations are represented by the same finite-difference algorithm with the
advected quantity, <img class="math" src="_images/math/8ee854e4bf288646d3880cc061a7ec158e1ad600.png" alt="\Phi" style="vertical-align: 0px"/>, located at mesh cell centers. As described below, an
interface sharpening algorithm is used for the flux term <img class="math" src="_images/math/ae03c709b6d80efd716494f4366950d5bef8296a.png" alt="\nabla \cdot
({\mathbf{uA}}\Phi )" style="vertical-align: -5px"/> for those quantities identified with specific fluid types.</p>
<p>Apart from the density, energy, fluid fraction and turbulent transport
equations, <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> has additional conservation equations, similar to Eq.
<a class="reference internal" href="#equation-scalaradvection">(364)</a>, for arbitrary scalar quantities. These quantities can be
used to describe the evolution of passive contaminants in the flow or could be
employed to develop new physical models that require a transport equation, e.g.,
chemical reactions and time-dependent rheological model.</p>
<p>It is important that all of the advected quantities associated with different
fluids are proportional to the advected amount of fluid, <img class="math" src="_images/math/66c91e8d2dd65ef702ca9be2d4c85ea93ef1c3c6.png" alt="\delta F" style="vertical-align: 0px"/> (see
<a class="reference internal" href="#timeadvancementfluidconfigurationth"><span class="std std-ref">Time Advancement of Fluid Configuration</span></a>). Turbulence and arbitrary scalar
quantities in two-fluid problems are not in this category because we assume
these to be continuously distributed across two-fluid interfaces.</p>
<div class="section" id="time-advancement-of-fluid-configuration">
<span id="timeadvancementfluidconfigurationth"></span><span id="index-410"></span><h4>Time Advancement of Fluid Configuration<a class="headerlink" href="#time-advancement-of-fluid-configuration" title="Permalink to this headline">¶</a></h4>
<p>Scalar advection of the fluid fraction <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is governed by Eq.
<a class="reference internal" href="#equation-scalaradvection">(364)</a>. When Eq. <a class="reference internal" href="#equation-scalaradvection">(364)</a> is integrated over a
computational cell, the changes in <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> in a cell reduce to a sum of fluxes
of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> across the cell-faces. Special care, however, must be taken in
computing these fluxes to preserve the sharp definition of fluid boundaries. The
method employed here uses a type of Donor-Acceptor flux approximation. The
essential idea is to use information about <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> downstream as well as
upstream of a flux boundary to establish an approximate interface shape and then
to use this shape in computing the flux.</p>
<p>The basic method developed for use in the Volume-of-Fluid (VOF) technique, which
is used here, may be understood by considering the amount of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> to be
fluxed in the x-direction through a cell-face during a time step of duration
<img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> <a class="reference internal" href="zbibliography.html#hirt-nichols-1981" id="id80">[HN81]</a>. The flux of volume crossing this
face per unit cross-sectional area is <img class="math" src="_images/math/efa30e6242f3d31c103d92a1993fca4c8d8f7e41.png" alt="L = u{A}_x \delta t" style="vertical-align: -3px"/>, where
<img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is the normal velocity at the face and <img class="math" src="_images/math/05eed70db0824167e386ab36f82a4c236f57f086.png" alt="A_x" style="vertical-align: -3px"/> is the area open to
flow. The sign of <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> determines the donor and acceptor cells, i.e., the
cells losing and gaining volume, respectively. For example, if <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is
positive, the upstream or left cell is the donor and the downstream or right
cell the acceptor. The amount of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluxed across the cell-face in one
time step is defined as <img class="math" src="_images/math/66c91e8d2dd65ef702ca9be2d4c85ea93ef1c3c6.png" alt="\delta F" style="vertical-align: 0px"/> times the unobstructed face
cross-sectional area (<img class="math" src="_images/math/e52f04f63fec4166edb346a6cdb2b041a1fcb832.png" alt="\delta y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/ac59b859f86a99e206d1350f2a25968b183176df.png" alt="\delta z" style="vertical-align: 0px"/>), where</p>
<div class="math" id="equation-timeadvancementfluidconfiguration1">
<p><span class="eqno">(365)<a class="headerlink" href="#equation-timeadvancementfluidconfiguration1" title="Permalink to this equation">¶</a></span><img src="_images/math/0cd036735920d77f90bf5ec1a1dc1184aed166bb.png" alt="\begin{gathered}
\delta F = {\rm{MIN}}({F_{AD}}\left| L \right| + CF,{F_D}{V_{F,D}}\delta {x_D}) \\
where \\
{\rm{CF}} = {\rm{MAX}}\left[ {({F_{DM}} - {F_{AD}})\left| L \right| - ({F_{DM}} - {F_D}){V_{F,D}}\delta {x_{D,}}0.0} \right] \\
\end{gathered}"/></p>
</div><p>Single subscripts denote the acceptor (A) and donor (D) cells. The double
subscript, <img class="math" src="_images/math/c5395e957f659da5a8a997340b02c8d9f95ca623.png" alt="AD" style="vertical-align: 0px"/>, refers to either <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/> or <img class="math" src="_images/math/6cc656fef5d44427eff85bab32555f9860c78f1e.png" alt="D" style="vertical-align: 0px"/>, depending on the
orientation of the interface relative to the direction of flow, as explained
below. <img class="math" src="_images/math/8df202f9b7ef56a6aaec37ae73c71648031e33ed.png" alt="F_{DM}" style="vertical-align: -3px"/> is the maximum of <img class="math" src="_images/math/7185c6d70d1f6692ec4ce26d8a09a8bfa346ccc5.png" alt="F_D" style="vertical-align: -3px"/> and the <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value in
the next cell upstream of the donor cell.</p>
<p>Briefly, the <img class="math" src="_images/math/3e25632f71bbe302381d14723b360196a19aca24.png" alt="{\rm{MIN}}" style="vertical-align: 0px"/> feature in Eq.
<a class="reference internal" href="#equation-timeadvancementfluidconfiguration1">(365)</a> prevents the fluxing of more F from
the donor cell than it has to give, while the <img class="math" src="_images/math/7d0abab4f84d7a69174ad57d7e43335c50d23419.png" alt="{\rm{MAX}}" style="vertical-align: 0px"/> feature
accounts for an additional <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> flux, <img class="math" src="_images/math/d0ffd6aca7885d3dd32afcbda0d9d7ce5ce701bd.png" alt="{\rm{CF}}" style="vertical-align: 0px"/>, if the amount of
void (1-<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>) to be fluxed exceeds the void amount available. The
series of figures below provides a pictorial explanation of Eq.
<a class="reference internal" href="#equation-timeadvancementfluidconfiguration1">(365)</a>. The donor and acceptor cells are
defined in (<em>a</em>) of the figure below for fluxing across a vertical cell-face.
When <img class="math" src="_images/math/25d3228f26982c2a78d93805f293b3d8c9b2d0c6.png" alt="AD = D" style="vertical-align: 0px"/>, the flux is an ordinary donor cell value,</p>
<div class="math" id="equation-timeadvancementfluidconfiguration3">
<p><span class="eqno">(366)<a class="headerlink" href="#equation-timeadvancementfluidconfiguration3" title="Permalink to this equation">¶</a></span><img src="_images/math/99b9d139c1bb141aaaf5bcc696cf7e23c42a47d0.png" alt="F = {F_D} \cdot \left| L \right|"/></p>
</div><p>in which the <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value in the donor cell is used to define that portion of
the possible flow area exposed to fluid (see (<em>b</em>) in the figure below). Numerical
stability requires that <img class="math" src="_images/math/434ea00d62b1123f3e22d6f2419ad95934b2144c.png" alt="\left| L \right|" style="vertical-align: -5px"/> be less than <img class="math" src="_images/math/99b41b9a4fae4048fb50c39d1475549c83259300.png" alt="V \delta
x" style="vertical-align: 0px"/>, so that it is not possible to empty the donor cell in this case.</p>
<div class="figure" id="id123">
<span id="timeadvancementfluidconfigurationfig"></span><img alt="Examples of free-surface shapes used in the advection of F." src="_images/time-advancement-fluid-configuration.png" />
<p class="caption"><span class="caption-text">Figure 14: Examples of free-surface shapes used in the advection of F. The
donor-acceptor arrangement is shown in (a) where the dashed line indicated the left
boundary of the total volume being advected. The shaded regions shown in
(b-d) are the actual amounts of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluxed.</span></p>
</div>
<p>When <img class="math" src="_images/math/8215f0372ac2e4c197234e5fcef425069fbada8d.png" alt="AD = A" style="vertical-align: 0px"/>, the value of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> in the acceptor cell is used to
define that portion of the flow area across which <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is flowing. In (<em>c</em>)
of the figure above, all the <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluid in the donor cell is fluxed because
everything lying between the dashed line and the flux boundary moves into the
acceptor cell. This is an example of the <img class="math" src="_images/math/3e25632f71bbe302381d14723b360196a19aca24.png" alt="{\rm{MIN}}" style="vertical-align: 0px"/> test in Eq.
<a class="reference internal" href="#equation-timeadvancementfluidconfiguration1">(365)</a>. In (<em>d</em>) of the figure above, more
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluid than the amount <img class="math" src="_images/math/73bc68c58aaa216312a6c65049ea787ab68bb634.png" alt="FA \left| L \right|" style="vertical-align: -5px"/>, must be fluxed, so
this is an example of the <img class="math" src="_images/math/7d0abab4f84d7a69174ad57d7e43335c50d23419.png" alt="{\rm{MAX}}" style="vertical-align: 0px"/> test.</p>
<p>Whether the acceptor or donor cell is used depends on the mean surface
orientation. The acceptor cell is used when the surface is advected in a
direction normal to itself (as defined by the cell flag <img class="math" src="_images/math/13058a6cb3c73791a30ae56b04b5b5c1db16902c.png" alt="{\rm{NF}}" style="vertical-align: 0px"/>); otherwise,
the donor cell value is used. However, if the acceptor cell is empty of
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> or if the cell upstream of the donor cell is empty, then the acceptor
cell <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value is used to determine the flux regardless of the orientation
of the surface. This means that a donor cell must be nearly full before any
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluid can enter a downstream empty cell.</p>
<p>The reason for testing on surface orientation is that an incorrect steepening
of surface waves will occur if the acceptor cell is always used to compute
fluxes. Consider, for example, a horizontal surface with a small wave moving
in the positive x-direction. A flux based on the downstream (acceptor) value
of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> will eventually steepen the wave into a step discontinuity. In
effect, the acceptor method is numerically unstable because it introduces a
negative diffusion of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> (i.e., a diffusion-like transport with a
negative coefficient). Instabilities do not grow to unbounded values, however,
because of the <img class="math" src="_images/math/3e25632f71bbe302381d14723b360196a19aca24.png" alt="{\rm{MIN}}" style="vertical-align: 0px"/> and <img class="math" src="_images/math/7d0abab4f84d7a69174ad57d7e43335c50d23419.png" alt="{\rm{MAX}}" style="vertical-align: 0px"/> tests used in the
flux definition. On the other hand, when the surface is advecting normal to
itself, a steepening that maintains the step-function character of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>
is exactly what is desired.</p>
<p>Once the flux has been computed by the above method, it is multiplied by the
flux boundary area to get the amount of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> fluid to be subtracted from
the donor cell and added to the acceptor cell. In this way the fluid volume
defined by <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is conserved. When the advection process is repeated for
all cell boundaries in the mesh, the resulting <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> values correspond to
the time-advanced values satisfying Eq. <a class="reference internal" href="#equation-fluidinterfacesandfreesurfaces1">(19)</a>
and still sharply define all interfaces.</p>
<p>In practice, the definition of interfaces may deteriorate somewhat with time if
the fluid motions are violent enough to cause repeated coalescence and breakup
of surfaces, particularly if such processes occur on the scale of a cell size.
Several tests for special cases have been incorporated into the basic <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>-advection routine described above to further improve its interface tracking
ability. For free-surface problems, a mechanism has also been added to help
close up partial voids (i.e., <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> values less than one) in interior fluid
regions. Such regions sometimes appear when fluid surfaces impact on one another
or on solid objects. This closure mechanism also helps mitigate pressure spikes
during fluid impacts on obstacles. An input flag (<span class="target" id="index-411"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IFPK</span></code>) is used to
enable or disable this option, which can only be used with free-surface problems
having no void compressibility, <span class="target" id="index-412"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">RCSQV</span></code> = 0.0. In extreme cases of fluid
breakup it may be necessary to add additional interface sharpening in order to
preserve free-surfaces. The parameter <span class="target" id="index-413"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IFPK</span></code> is used to select this option
too, although it is not recommended for general use, as it usually produces
slightly more jagged free-surfaces.</p>
</div>
<div class="section" id="other-scalar-advection">
<span id="otherscalaradvectionth"></span><span id="index-414"></span><h4>Other Scalar Advection<a class="headerlink" href="#other-scalar-advection" title="Permalink to this headline">¶</a></h4>
<p>The algorithm used for advecting <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is extended to <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/> and <img class="math" src="_images/math/4a17109bb8d820b56ebe0a13d001c35b730abb88.png" alt="\rho
^I" style="vertical-align: -4px"/> for compressible flows. The interface location, and therefore the quantity
of each fluid to be fluxed, is determined as described above. The flux of <img class="math" src="_images/math/505bec53c42fc78b12fcff89dde94cd96fb0770b.png" alt="\rho" style="vertical-align: -4px"/>
(or <img class="math" src="_images/math/9bca7d03e584e6ceb5de9153337b5fb7f49cf14a.png" alt="\rho ^I" style="vertical-align: -4px"/>) is then easily calculated as</p>
<div class="math" id="equation-otherscalaradvection1">
<p><span class="eqno">(367)<a class="headerlink" href="#equation-otherscalaradvection1" title="Permalink to this equation">¶</a></span><img src="_images/math/48c8fceef0fe090f744b1f6fac31308abed4e405.png" alt="\delta \Phi = \delta F{\Phi _1} + (\left| L \right| - \delta F){\Phi _2}"/></p>
</div><p>or equivalently</p>
<div class="math" id="equation-otherscalaradvection2">
<p><span class="eqno">(368)<a class="headerlink" href="#equation-otherscalaradvection2" title="Permalink to this equation">¶</a></span><img src="_images/math/1fae674252cfa51e0171e42830f4649455da8285.png" alt="\delta \Phi = \left| L \right|\left[ {\eta {\Phi _1} + (1 - \eta ){\Phi _2}} \right]"/></p>
</div><p>where <img class="math" src="_images/math/c0a65e336c1e8cfbf106ecda362c737334023cc4.png" alt="\Phi _1" style="vertical-align: -3px"/> and <img class="math" src="_images/math/215baa0be7e0c165f7f9cdbc575ad8bdf82e8144.png" alt="\Phi _2" style="vertical-align: -3px"/> are associated with the two fluids and
<img class="math" src="_images/math/29fb850f94ddc52c1afda48674543252462e4485.png" alt="\eta = \delta F/\left| L \right|" style="vertical-align: -5px"/>. For turbulence quantities in
two-fluid problems, which are distributed over both fluids, the flux is simply equal
to <img class="math" src="_images/math/44ca830a9077ca3668394fae701df6724a63b8eb.png" alt="\Phi \left| L \right|" style="vertical-align: -5px"/>.</p>
<p>The second-order, monotonicity-preserving advection method described in
<a class="reference internal" href="#secondordermonotonicityth"><span class="std std-ref">Second-Order Monotonicity Preserving Method</span></a> can also be applied to the advection of the
fluid fraction, <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>, density, <img class="math" src="_images/math/d77e09b1ac0f59812794adc2b8da7f9a192d32bc.png" alt="r" style="vertical-align: 0px"/>, and/or energy, <img class="math" src="_images/math/496af7d1f086e49a5be0614f2b933a137b0fd0a7.png" alt="I" style="vertical-align: 0px"/>.</p>
</div>
<div class="section" id="determining-surface-normals-and-cell-flags">
<span id="determingsurfacenormalscellflagsth"></span><span id="index-415"></span><h4>Determining Surface Normals and Cell Flags<a class="headerlink" href="#determining-surface-normals-and-cell-flags" title="Permalink to this headline">¶</a></h4>
<p>For application of free-surface boundary conditions and advection of the
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> function, it is necessary to assign the primary normal direction
to the surface. The primary normal in a surface cell is recorded by an
integer value (assigned to array <img class="math" src="_images/math/13058a6cb3c73791a30ae56b04b5b5c1db16902c.png" alt="{\rm{NF}}" style="vertical-align: 0px"/>) that identifies the
neighboring fluid cell that is closest to the direction of the inward normal to the
surface, with the neighbor cell on the opposite side being empty.</p>
<p>When surface tension forces are required, it is necessary to compute more accurate
surface normals. For this purpose the fluid surface is represented locally as a
single-valued height function <img class="math" src="_images/math/79ed5a68f9ef34ac3cdf11f49539eacb2f8f1b92.png" alt="X(y,z)" style="vertical-align: -5px"/>, or <img class="math" src="_images/math/d0fed63ca0f047a3308834ee850d2821e8894b97.png" alt="Y(x,z)" style="vertical-align: -5px"/>, or <img class="math" src="_images/math/7ae67dbc129c43c16bf4dff717124e8cb52dcbd3.png" alt="Z(x,y)" style="vertical-align: -5px"/>,
depending on its orientation. If, for example, the approximate normal points in the
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-direction, then the surface is represented by <img class="math" src="_images/math/7ae67dbc129c43c16bf4dff717124e8cb52dcbd3.png" alt="Z(x,y)" style="vertical-align: -5px"/> and we compute
<img class="math" src="_images/math/4a905bfb7db822bf8dc85be4460c21708de2eb86.png" alt="Z" style="vertical-align: 0px"/> values for the five columns <img class="math" src="_images/math/41b44d4e29db6070c93a0715cfc77515677613fe.png" alt="(i,j)" style="vertical-align: -5px"/>, <img class="math" src="_images/math/6fa3d68e9ae93829ec0c5855db7952ab587b6814.png" alt="(i\pm 1,j)" style="vertical-align: -5px"/> and
<img class="math" src="_images/math/4708df7a2a1802da7cf7351519b7de25aef71935.png" alt="(i,j\pm 1)" style="vertical-align: -5px"/>. From these quantities, finite-difference approximations for
<img class="math" src="_images/math/8e82a4986126b789d5af134fac7c5014e53cbbc8.png" alt="\partial Z/\partial x" style="vertical-align: -5px"/> and <img class="math" src="_images/math/97abd2fe038410457613eb5a608da03fd2c774b0.png" alt="\partial Z /\partial y" style="vertical-align: -5px"/> and the second
derivatives needed for cuervature evaluation can be computed. The approximation used
for <img class="math" src="_images/math/739570df8ee4f20a7bd4af34dc285647475b89c8.png" alt="Z_{i,j}" style="vertical-align: -6px"/> about level <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/> is a sum over a five-cell
column,</p>
<div class="math" id="equation-determiningsurfacenormalsandcellflags">
<p><span class="eqno">(369)<a class="headerlink" href="#equation-determiningsurfacenormalsandcellflags" title="Permalink to this equation">¶</a></span><img src="_images/math/9dfe60beceec156155fb2cbe27c56bd732d5f9ee.png" alt="Z_{i,j} = \sum_{k_s=k_1,k_2}  {F_{i,j,k_s}\delta z_{k_s}}"/></p>
</div><p>where <img class="math" src="_images/math/db59793ceba06bd3cea13ffaeb8a7767c614f94e.png" alt="k_1" style="vertical-align: -3px"/> is the lowest index in the range <img class="math" src="_images/math/fc34720c892631ff1286f1a8f95bcab8b2bb8cdd.png" alt="k-4\leq k_1\leq k" style="vertical-align: -3px"/>
chosen so that there is continuous and unobstructed fluid between cells <img class="math" src="_images/math/db59793ceba06bd3cea13ffaeb8a7767c614f94e.png" alt="k_1" style="vertical-align: -3px"/>
and <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>. The value of <img class="math" src="_images/math/db59793ceba06bd3cea13ffaeb8a7767c614f94e.png" alt="k_1" style="vertical-align: -3px"/> is evaluated in all five columns and the
<em>highest</em> value among them is used in all five, so that columns have the same reference
point.</p>
<p>Index <img class="math" src="_images/math/57333a901de393b71b5eeba79df1a6169f9770ca.png" alt="k_2=k+1" style="vertical-align: -3px"/>. Note that in the central column <img class="math" src="_images/math/41b44d4e29db6070c93a0715cfc77515677613fe.png" alt="(i,j)" style="vertical-align: -5px"/> that cell
is empty, but there could be fluid at that <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-location in any of the other
four columns, <img class="math" src="_images/math/6fa3d68e9ae93829ec0c5855db7952ab587b6814.png" alt="(i\pm 1,j)" style="vertical-align: -5px"/> and <img class="math" src="_images/math/4708df7a2a1802da7cf7351519b7de25aef71935.png" alt="(i,j\pm 1)" style="vertical-align: -5px"/>.</p>
<div class="figure" id="id124">
<span id="column-height-calculationfig"></span><img alt="Illustration of column height calculation." src="_images/column_height_calculation.png" />
<p class="caption"><span class="caption-text">Figure 15: Illustration of the column height calculation procedure in <img class="math" src="_images/math/ed984527d773258987eeac9f41bb458a6b79fdb2.png" alt="x-z" style="vertical-align: 0px"/> plane.</span></p>
</div>
</div>
<div class="section" id="surface-location-within-a-cell">
<span id="surfacelocationcellth"></span><span id="index-416"></span><h4>Surface Location within a Cell<a class="headerlink" href="#surface-location-within-a-cell" title="Permalink to this headline">¶</a></h4>
<p>Once the inward normal direction has been determined, the surface location is
defined by a flat surface normal to this coordinate direction that extends to
the proper height in the three-cell column. In practice, it is necessary to use
a column height somewhat modified from that used in the derivative calculations.
Measured from the center of the neighbor cell in the direction of the inward
normal, the height is equal to the height of the fluid level in the surface cell
plus one half of the height of fluid in the neighbor cell. This prescription
ensures that the surface will lie above the neighbor cell center even if it is
nearly empty.</p>
</div>
<div class="section" id="cleanup-of-misty-fluid-regions">
<span id="cleanupmistyfluidregionsth"></span><span id="index-417"></span><h4>Cleanup of Misty Fluid Regions<a class="headerlink" href="#cleanup-of-misty-fluid-regions" title="Permalink to this headline">¶</a></h4>
<p>For some applications it is important to maintain smooth free-surface shapes to
achieve good solution accuracy. For example, a poorly resolved or jagged
free-surface may produce numerical “noise” in the evaluation of surface tension
forces. These, in turn, could result in an even more jagged free-surface shape.
These fluctuations may eventually lead to the creation of “misty” fluid regions
in which small amounts of fluid are distributed across several adjacent mesh
cells. Since the free-surface cannot be satisfactorily resolved in such regions,
the accuracy of the surface tension solution deteriorates rapidly.</p>
<p>Another example when “misty” regions can degrade the quality of the numerical
solution occurs in flows with excessive splashing and free-surface breakup.
Trying to follow the motion of small fluid droplets in all these regions may
prove to be inefficient and is probably unnecessary.</p>
<p>A provision has been made in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to avoid such situations by artificially
removing fluid #1 in “misty” regions (i.e., clean up the fluid #1 distribution). This
adjustment is controlled by the variable <span class="target" id="index-418"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FCLEAN</span></code>. Fluid #1 in a cell is thrown
away if the <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value in it and in all adjacent cells is below
<span class="target" id="index-419"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FCLEAN</span></code>. A typical value of <span class="target" id="index-420"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FCLEAN</span></code> is between 0.0 and 0.1.</p>
<p>The use of the cleanup algorithm is only recommended in problems with extreme
free-surface deformations, where flow is largely controlled by conditions at the
free-surface. Generally, its application results in only small errors in the
total fluid volume (less than 1%) but yields accurate and efficient solutions.</p>
<p>For two-fluid problems with sharp interfaces, this procedure can be applied to
both fluids, using <span class="target" id="index-421"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FCLEAN</span></code> for fluid #1 and <span class="target" id="index-422"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FCLEAN2</span></code> for
fluid #2. Since the two fluids always complement each other, Whenever one
fluid is removed from a cell, its place is taken by the other fluid.</p>
</div>
<div class="section" id="bookkeeping-adjustments">
<span id="bookeepingadjustmentsth"></span><h4>Bookkeeping Adjustments<a class="headerlink" href="#bookkeeping-adjustments" title="Permalink to this headline">¶</a></h4>
<p>The new <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> values determined by the above method occasionally have values
slightly less than zero or slightly greater than unity. Therefore, after the
scalar advection calculations have been completed, a pass is made through the
mesh to reset values of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> less than zero back to zero, and values of
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> greater than one, back to one.</p>
<p>Additional adjustments in <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> are made when its value is close to 0 or 1.0.
If a cell has an <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> value less than <img class="math" src="_images/math/f0971aa114646a7e429c89f6b033b15ad8508e82.png" alt="\varepsilon _F" style="vertical-align: -3px"/> or greater than
<img class="math" src="_images/math/dadf2697ae68b54757eb05e3b7e4999b3bc43b4e.png" alt="1 - \varepsilon _F" style="vertical-align: -3px"/>, where <img class="math" src="_images/math/d2844ffb3b19337f3afec9b9a473ff82070e3f79.png" alt="\varepsilon _F = 10^{-6}" style="vertical-align: -3px"/>,
then <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is reset to 0.0 or 1.0, respectively. When <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is reset to 0.0,
then all adjacent neighboring full cells become surface cells.</p>
<p>The total fluid volume added or removed by the various adjustments to <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> to
keep it within the allowed range, including those made in <a class="reference internal" href="#cleanupmistyfluidregionsth"><span class="std std-ref">Cleanup of Misty Fluid Regions</span></a>
are reported as the <em>cumulative volume error</em>, both as an absolute quantity and as
percentage of the total fluid #1 volume that has passed through the domain during the
simulation. It is written out as <span class="target" id="index-423"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">VCHGT</span></code> on long prints of the Solver Summary
file as well as to the General History data catalog in the <code class="file docutils literal notranslate"><span class="pre">flsgrf</span></code> file.
The total fluid volume, <img class="math" src="_images/math/775789468539bd2b57d445541475fb8774b1f15a.png" alt="{\rm{VL}}" style="vertical-align: 0px"/>, is also printed. Typically, the cumulative
volume error should be less than one per cent of the total fluid #1 volume.</p>
<p>In addition to the total error, the cumulative volume error is computed in every cell
and reported in <code class="file docutils literal notranslate"><span class="pre">flsgrf</span></code> file as a spatial quantity.
During simulation that volume may be added (or removed if that volume is
negative) to the fluid when conditions allow, i.e., when the value of <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> will
stay within the allowed range and the status of the cell (void, surface, full) will
not change as a result. This helps to improve the overall fluid volume conservation.</p>
</div>
<div class="section" id="locally-implicit-approximation-of-advection">
<span id="locallyimplicitapproximationth"></span><span id="index-424"></span><h4>Locally Implicit Approximation of Advection<a class="headerlink" href="#locally-implicit-approximation-of-advection" title="Permalink to this headline">¶</a></h4>
<p>Explicit (e.g., forward in time) finite-difference approximations used to solve
time-evolution equations are subject to limits on the size of the time
increment. In this type of approximation it is assumed that the values of all
dependent variables are advanced in time through a succession of small time
intervals. Knowing the variable values at all steps, up to and including step n,
they can then be used to estimate the rates-of-change of the variables. This
makes it possible to estimate what the dependent variable values will be at step
<img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>, which corresponds to a small time <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> later,
<img class="math" src="_images/math/cdb654a4b3e7569a1f49ee3309dc1f89009fa81d.png" alt="t^{n+1} = t^n + \delta t" style="vertical-align: -2px"/>.</p>
<p>The need for small <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> in this type of approximation arises because
the rate-of-change of a dependent variable is usually evaluated in terms of
differences between that variable and the values of its immediate neighbors in
space. With an increasing time step size, a variable would be expected to be
influenced not just by its immediate neighbors but by values located
increasingly further away. Therefore, there must be a limit on the size of time
advancement <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> to ensure stability and accuracy.</p>
<p>While explicit finite-difference equations are simple to use, their requirement
for limiting the time-step size <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> can sometimes lead to long
computation times. To overcome this limitation, it may be desirable to resort
to an implicit finite-difference method that eliminates the troublesome
time-step restriction. The basic idea is to include in the approximation of
the rate-of-change of a variable the values of variables at the advanced time level
<img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>. Since the level <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/> values that one is trying to
compute now depend on those same values, the difference equations are said to be
implicit.</p>
<p>A locally implicit method exists in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to approximate advection terms in the
fluid transport equations. The implicit treatment can be applied selectively in
time and space thus minimizing the overhead and inaccuracies associated with
implicit methods in general.</p>
<p>Consider a simple one-dimensional scalar advection equation,</p>
<div class="math" id="equation-onedimensionalscalaradvectionequation">
<p><span class="eqno">(370)<a class="headerlink" href="#equation-onedimensionalscalaradvectionequation" title="Permalink to this equation">¶</a></span><img src="_images/math/c558469f5b864cf36b5eb6235c3bb01c9144672c.png" alt="\frac{{\partial S}}{{\partial t}} + \frac{{\partial (uS)}}{{\partial x}} = 0"/></p>
</div><p>The corresponding upwind finite-difference equation based on donor advection (<img class="math" src="_images/math/3a932b89c52e171c03c95258e31efd3a0d926621.png" alt="u &gt; 0" style="vertical-align: -1px"/>) is,</p>
<div class="math" id="equation-upwindfinitedifferenceeqbasedondonoradvection">
<p><span class="eqno">(371)<a class="headerlink" href="#equation-upwindfinitedifferenceeqbasedondonoradvection" title="Permalink to this equation">¶</a></span><img src="_images/math/ec36e34a027bb23a3e267251f0bc145e6e2e6272.png" alt="S_j^{n + 1} - S_j^n + \delta t{A_j} = 0"/></p>
</div><p>where</p>
<div class="math" id="equation-upwindfinitedifferenceeqdonoradvectionajvalue">
<p><span class="eqno">(372)<a class="headerlink" href="#equation-upwindfinitedifferenceeqdonoradvectionajvalue" title="Permalink to this equation">¶</a></span><img src="_images/math/1a6b59ef037dd0c1ef27b494bf2c07b292c9d0f8.png" alt="{A_j} = \frac{u}{{\delta x}}\left( {{S_j} - {S_{j - 1}}} \right)"/></p>
</div><p>A time level has not been specified in the approximation for the rate-of-change
<img class="math" src="_images/math/42dd6b9d0a708400001bf888c3b10db7d856460c.png" alt="A_j" style="vertical-align: -6px"/>. An explicit approximation using the <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>-level values for
<img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> would have a stability limit requiring <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/> to be less than
<img class="math" src="_images/math/ea4a076c8e16a5751c26dc8a1912a46ac4a363dd.png" alt="\delta x/u" style="vertical-align: -5px"/>.</p>
<p>To add implicitness we now expand <img class="math" src="_images/math/42dd6b9d0a708400001bf888c3b10db7d856460c.png" alt="A_j" style="vertical-align: -6px"/> into a Taylor series with respect
to <img class="math" src="_images/math/f8c0779644b4acecd4664f005f4b17a045cd6a07.png" alt="S_j" style="vertical-align: -6px"/>. Neglecting the terms of the order higher than one, we obtain</p>
<div class="math" id="equation-addimplicitnessaddajintotaylorserieswithrespecttos">
<p><span class="eqno">(373)<a class="headerlink" href="#equation-addimplicitnessaddajintotaylorserieswithrespecttos" title="Permalink to this equation">¶</a></span><img src="_images/math/990667f7d5ec5b1a16fc399cb27d9c7f3f843d3b.png" alt="{A_j} \approx A_j^n + \frac{{\partial A}}{{\partial S}}\left( {S_j^{n + 1} - S_j^n} \right)"/></p>
</div><p>From Eq. <a class="reference internal" href="#equation-upwindfinitedifferenceeqdonoradvectionajvalue">(372)</a> we have</p>
<div class="math" id="equation-revisedupwindfinitediffajvalue">
<p><span class="eqno">(374)<a class="headerlink" href="#equation-revisedupwindfinitediffajvalue" title="Permalink to this equation">¶</a></span><img src="_images/math/6cb2f3ebab01eab37cd8feb4ed38e4d0a60b46d2.png" alt="\frac{{\partial A}}{{\partial S}} = \frac{u}{{\delta x}}"/></p>
</div><p>Now Eq. <a class="reference internal" href="#equation-upwindfinitedifferenceeqbasedondonoradvection">(371)</a> can be recast into</p>
<div class="math" id="equation-addimplicitnessupwindfinitediffeqbasedondononadvection">
<p><span class="eqno">(375)<a class="headerlink" href="#equation-addimplicitnessupwindfinitediffeqbasedondononadvection" title="Permalink to this equation">¶</a></span><img src="_images/math/ceadc6a35e93f84c05186acd64ded9520025c079.png" alt="\left( {S_j^{n + 1} - S_j^n} \right) + \delta t\left( {A_j^n + \frac{{\partial A}}{{\partial S}}\left( {S_j^{n + 1} - S_j^n} \right)} \right) = 0"/></p>
</div><p>The advection flux now contains <img class="math" src="_images/math/ef0ea8ec42ab99cb65c11bf5444cc523a4fb7ed0.png" alt="S_{j}^{n + 1}" style="vertical-align: -8px"/>
adding a degree of implicitness to it. Let us check the stability of this
approximation. An asymptotic <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> test to check unconditional
stability says divide by <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> and let it go to infinity. In this
limit the first term disappears, and the result is a new equation for the
change in <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/>,</p>
<div class="math" id="equation-checkingstabilityupwindfinitediff">
<p><span class="eqno">(376)<a class="headerlink" href="#equation-checkingstabilityupwindfinitediff" title="Permalink to this equation">¶</a></span><img src="_images/math/68246e5159cd9c97cf05770503410a008c353296.png" alt="S_j^{n + 1} - S_j^n + \frac{1}{^{\partial A} / _{\partial S}} A_j^n = 0"/></p>
</div><p>which means that the modified equation is unconditionally stable (as long as the
coefficient <img class="math" src="_images/math/870d1f3301629900228e785db1b31dc51ccdb6f4.png" alt="\partial A/\partial S" style="vertical-align: -5px"/> is not zero). In fact, the resulting
equation looks like the original explicit expression except that the time step
has been replaced by the reciprocal of <img class="math" src="_images/math/870d1f3301629900228e785db1b31dc51ccdb6f4.png" alt="\partial A/\partial S" style="vertical-align: -5px"/> This new
“time step” is precisely the limiting time step for explicit stability,
<img class="math" src="_images/math/ea4a076c8e16a5751c26dc8a1912a46ac4a363dd.png" alt="\delta x/u" style="vertical-align: -5px"/>, therefore, the approximation of Eq.
<a class="reference internal" href="#equation-checkingstabilityupwindfinitediff">(376)</a> is essentially stable.</p>
<p>If we don’t take the limit of infinite time step we have a new, locally
implicit, unconditionally stable, finite-difference equation for the advancement
of <img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/>, which can be written as</p>
<div class="math" id="equation-locallyimplicitunconditionallystablefinitediffeq">
<p><span class="eqno">(377)<a class="headerlink" href="#equation-locallyimplicitunconditionallystablefinitediffeq" title="Permalink to this equation">¶</a></span><img src="_images/math/36692e6e82374c4c2619abf25d93390a1d5e91bd.png" alt="\left[ {\frac{1}{{\delta t}} + \frac{{\partial A}}{{\partial S}}} \right]\left( {S_j^{n + 1} - S_j^n} \right) + A_j^n = 0"/></p>
</div><p>This approximation remains stable for all time-step sizes because it effectively
replaces the time step by a new one that is always less than that necessary for
explicit stability. Equation
<a class="reference internal" href="#equation-locallyimplicitunconditionallystablefinitediffeq">(377)</a> still has the same
steady-state solution, namely <img class="math" src="_images/math/cef7f72e19a738b7997c5ad698aba72560c6bf1d.png" alt="A = 0" style="vertical-align: 0px"/>, when <img class="math" src="_images/math/e7fb8aae5d9fdc76792712b69ab8968ebc2f7052.png" alt="{S^{n+1}} = {S^n}" style="vertical-align: 0px"/>.
Since the flux term in this equation is not coupled to the time <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>
values of the adjacent cells, no iterations are necessary to solve it.</p>
<p>This method is a simple scheme for generating an implicit numerical
approximation of advection fluxes having an unconditional stability. It
maintains the upstream dependence expected of advection, while limiting the flux
to essentially one grid cell per time step. When activated, the method is
applied to all fluid transport equations.</p>
<p>Because the difference approximation only involves the values of neighboring
quantities and does not include an iterative process, the locally implicit
advection may not be very accurate when the time-step size becomes too large,
i.e., an unrestricted implicitness can lead to inaccuracies. Large gradients of
an advected quantity, like fluid fraction at the free surface, may also result
in significant numerical errors in the implicit method.</p>
<p>To reduce these inaccuracies the under-relaxation is limited to only those
locations where a computational instability would occur if not treated
implicitly. In other words, the locally implicit approximation is applied only
in cells only where and when the time-step size exceeds the local stability
limit defined by the velocity in the cell and the cell size. At all other times
and places, the regular conservative explicit approximation is employed.</p>
<p>To prevent inaccuracies in the treatment of free boundaries the implicit
advection method is not applied in cells that contain a moving free surface,
that is, where there is a significant velocity component along the free surface
normal. This limitation means that time-step sizes must be limited in their
usual manner in such cells.</p>
</div>
</div>
<div class="section" id="diffusion-process-heat-conduction-and-heat-transfer">
<span id="diffusionprocessheatconductionheattransferth"></span><span id="index-425"></span><h3>Diffusion Process, Heat Conduction and Heat Transfer<a class="headerlink" href="#diffusion-process-heat-conduction-and-heat-transfer" title="Permalink to this headline">¶</a></h3>
<div class="section" id="diffusion-process">
<span id="diffusionprocessth"></span><h4>Diffusion Process<a class="headerlink" href="#diffusion-process" title="Permalink to this headline">¶</a></h4>
<p>Internal viscous shear (that is, shear forces away from solid boundaries) and
the diffusion of fluid fraction, fluid density, fluid energy density, turbulence
energy, and turbulence dissipation are all treated in analogous ways by <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>.
The diffusion coefficient for each process is proportional to the dynamic
viscosity, <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/>, which may vary in space and time as a result of the turbulence
models included in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> or other models incorporated by the user. To account
for this variation, all diffusion processes are formulated as the divergence of
a flux rather than the more usual Laplacian form.</p>
<p>The explicit difference techniques used for diffusion processes are fairly
straightforward. Both the viscosity and the diffused quantity are evaluated
from old time arrays. This leads to the stability requirements discussed in
<a class="reference internal" href="#stabilityconsiderationsth"><span class="std std-ref">Stability Considerations</span></a>. These limitations can be quite severe in
some circumstances, where an implicit treatment of the viscous momentum
diffusion terms is preferred (see <a class="reference internal" href="#implicitviscousstressheatfluxapproximationsth"><span class="std std-ref">Implicit Viscous Stress</span></a>) The spatial differencing of
scalar quantity diffusion is also quite straightforward. The flux across any
mesh cell-face is evaluated as the first-order difference of cell-centered
quantities on opposite sides of the face multiplied by an averaged product of
diffusion coefficients and cell-face area fractions.</p>
<p>The spatial differencing of viscous stress is necessarily more complicated due
to its vector nature. Briefly, we apply first-order differences to velocity
components to obtain local shear rates, then multiply by averaged products of
viscosity and cell-face area fractions. The results are then differenced to
approximate the net viscous stress. All quantities are evaluated explicitly in
these calculations.</p>
</div>
<div class="section" id="heat-conduction-and-heat-transfer">
<span id="heatconductionheattransferth"></span><span id="index-426"></span><h4>Heat Conduction and Heat Transfer<a class="headerlink" href="#heat-conduction-and-heat-transfer" title="Permalink to this headline">¶</a></h4>
<p>Thermal conduction and heat transfer terms appear in both the fluid energy
density equation, Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>, and the solid temperature
equation, Eq. <a class="reference internal" href="#equation-dynamicstructuretemp">(40)</a>. These terms are treated in analogous
ways by <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> and include two optional implicit formulations to eliminate
associated time-step stability limits. This approximation is included because
there are often large differences in the time scales associated with these
thermal processes and the time scale of the fluid flow itself, particularly in
steady and quasi-steady situations (see <a class="reference internal" href="#implicitviscousstressheatfluxapproximationsth"><span class="std std-ref">Implicit Viscous Stress</span></a>).</p>
<p>To display the approach used, consider a reformulated analog of Eq.
<a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>,</p>
<div class="math" id="equation-heatconductionandheattransfer1">
<p><span class="eqno">(378)<a class="headerlink" href="#equation-heatconductionandheattransfer1" title="Permalink to this equation">¶</a></span><img src="_images/math/85ba0a394ac028c75c172ba998d9b1ab14cfa96e.png" alt="{V_F}\frac{{\partial \rho I}}{{\partial t}} = X + {T_{\rm{DIF}}} + {\rm{HADT}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/85b8e25465280c599f689a2ff74a9ba4b6fcc29a.png" alt="T_{\rm{DIF}}" style="vertical-align: -3px"/> represents thermal conduction within the fluid,</li>
<li><img class="math" src="_images/math/f7e3a3549823c2e6af8237ddc5928ec3a42b2c36.png" alt="{\rm{HADT}}" style="vertical-align: 0px"/> represents heat transfer between the fluid and adjacent solid, and</li>
<li><img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/> represents the remaining terms in Eq. <a class="reference internal" href="#equation-fluidenergyequations1">(21)</a>.</li>
</ul>
<p>We now consider the difference relations used by <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to approximate Eq.
<a class="reference internal" href="#equation-heatconductionandheattransfer1">(378)</a>. As usual, we employ a forward time
difference and first-order-spatial approximations to the energy flux, resulting
in</p>
<div class="math" id="equation-heatconductionandheattransfer2">
<p><span class="eqno">(379)<a class="headerlink" href="#equation-heatconductionandheattransfer2" title="Permalink to this equation">¶</a></span><img src="_images/math/b88ad9e872b0660d853f3472eb4bc2389f142c83.png" alt="{V_{F_{i,j,k}}} \cdot \frac{{(\rho I)_{ijk}^{n + 1} - (\rho I)_{ijk}^n}}{{\delta {t^{n + 1}}}} = X_{ijk}^n - \mathop \sum \limits_{\rm{faces}} \frac{{Ak}}{\delta }(T_{ijk}^n - T_{\rm{adjacent}}^n) - {h_{ijk}}{\rm{WA}}(T_{ijk}^n - {\rm{TW}}_{ijk}^n)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> represents the fluid temperature,</li>
<li><img class="math" src="_images/math/7a17da313601250488de28645b756b88d7e0e803.png" alt="{\rm{TW}}" style="vertical-align: 0px"/> the solid temperature,</li>
<li><img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> a heat transfer coefficient,</li>
<li><img class="math" src="_images/math/862ea6b1f8be3eb8ed7c1d625ab541a2d533b4eb.png" alt="{\rm{WA}}" style="vertical-align: 0px"/> an interfacial area,</li>
<li><img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/>, a cell-face area,</li>
<li><img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>, an averaged heat conduction coefficient, and</li>
<li><img class="math" src="_images/math/f6522a2a7b3c4a689a3e8919cb39e66260a51e83.png" alt="\delta" style="vertical-align: 0px"/>, an appropriate spatial increment.</li>
</ul>
<p>All terms on the right side of Eq. <a class="reference internal" href="#equation-heatconductionandheattransfer2">(379)</a> are
evaluated at the “old” time level, <img class="math" src="_images/math/7abcc587d2b161c6467e7924d2dd1fea20620e82.png" alt="t^n" style="vertical-align: 0px"/>, meaning that an explicit
approximation is used for the heat fluxes. The explicit algorithm implies a
time-step size stability limit (see <a class="reference internal" href="#stabilityconsiderationsth"><span class="std std-ref">Stability Considerations</span></a>). Note that
the explicit approximation conserves energy because the same difference is used
on both sides of any cell-face.</p>
</div>
<div class="section" id="implicit-viscous-stress-and-heat-flux-approximations">
<span id="implicitviscousstressheatfluxapproximationsth"></span><span id="index-427"></span><h4>Implicit Viscous Stress and Heat Flux Approximations<a class="headerlink" href="#implicit-viscous-stress-and-heat-flux-approximations" title="Permalink to this headline">¶</a></h4>
<p>Since the minimum time-step size required for the numerical stability of the
explicit viscous and heat diffusion approximations is estimated over the whole
mesh, it is clear that this time-step size limitation could sometimes be too
severe to allow an efficient numerical solution. This may be the case in highly
distorted meshes where the time-step size is controlled by the stability limit
in the smallest cell, even though the variables may not be changing in this
region.</p>
<p>Two implicit solvers have been developed to alleviate the problem. The first one
employs a Jacobi iteration method for the implicit terms in the momentum
equations. The second method is based on the ADI method.</p>
<p>To illustrate these methods, we will simplify the momentum and continuity
equations presented earlier Eqs. <a class="reference internal" href="#equation-finitedifferenceapproximationgeneralform">(324)</a>,
<a class="reference internal" href="#equation-momentumequationapprox1">(325)</a>, <a class="reference internal" href="#equation-momentumequationapprox2">(326)</a> and
<a class="reference internal" href="#equation-incompressiblesormethod1">(354)</a> by omitting the area and volume fractions and
assuming Cartesian two-dimensional geometry. For an incompressible fluid with
constant viscosity, the flow equations are discretized in a uniform (for
simplicity) grid as follows</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox1">
<p><span class="eqno">(380)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox1" title="Permalink to this equation">¶</a></span><img src="_images/math/4bff92a01743dcfcf1c7191894e0cf9ebe509bd1.png" alt="\begin{gathered}
u_{i,j}^{n + 1} = u_{i,j}^n - \delta t({\rm{FUX}} + {\rm{FUY}})_{i,j}^n - \frac{{\delta t}}{\rho }\frac{{p_{i + 1,j}^{n + 1} - p_{i,j}^{n + 1}}}{{\delta x}} \hfill \\
\,\,\,\,\,\,\,\,\,\,\,\,\,\,\, - \delta t \cdot {w_{xi,j}}u_{i,j}^{n + 1} + \delta t \cdot fx_{i,j}^n + \frac{{\mu \delta t}}{\rho }\left( {\frac{{u_{i + 1,j}^{n + 1} - 2u_{i,j}^{n + 1} + u_{i - 1,j}^{n + 1}}}{{\delta {x^2}}} + \frac{{u_{i,j + 1}^{n + 1} - 2u_{i,j}^{n + 1} + u_{i,j - 1}^{n + 1}}}{{\delta {y^2}}}} \right) \hfill \\
\hfill \\
v_{i,j}^{n + 1} = v_{i,j}^n - \delta t({\rm{FVX}} + {\rm{FVY}})_{i,j}^n - \frac{{\delta t}}{\rho }\frac{{p_{i,j + 1}^{n + 1} - p_{i,j}^{n + 1}}}{{\delta y}} \hfill \\
\,\,\,\,\,\,\,\,\,\,\,\,\,\, - \delta t \cdot {w_{yi,j}}v_{i,j}^{n + 1} + \delta t \cdot fy_{i,j}^n + \frac{{\mu \delta t}}{\rho }\left( {\frac{{v_{i + 1,j}^{n + 1} - 2v_{i,j}^{n + 1} + v_{i - 1,j}^{n + 1}}}{{\delta {x^2}}} + \frac{{v_{i,j + 1}^{n + 1} - 2v_{i,j}^{n + 1} + v_{i,j - 1}^{n + 1}}}{{\delta {y^2}}}} \right) \hfill \\
\end{gathered}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-implictviscousstressandheatfluxapprox2">
<p><span class="eqno">(381)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox2" title="Permalink to this equation">¶</a></span><img src="_images/math/33cf305e504781615d5288a0ff22dd6a301fa5b7.png" alt="\frac{{u_{i,j}^{n + 1} - u_{i - 1,j}^{n + 1}}}{{\delta x}} + \frac{{v_{i - 1,j}^{n + 1} - v_{i,j - 1}^{n + 1}}}{{\delta y}} = 0"/></p>
</div><p>Here:</p>
<ul class="simple">
<li><img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> and <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/> are cell indexes in the x and y directions,</li>
<li><img class="math" src="_images/math/8baa18e36a1087dc297e35fe32f270f105923852.png" alt="\delta x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/e52f04f63fec4166edb346a6cdb2b041a1fcb832.png" alt="\delta y" style="vertical-align: -4px"/> cell spacings, and</li>
<li><img class="math" src="_images/math/c159b41ab0134ea5978cc3291e168129df3e01c8.png" alt="{\rm{FUX}}" style="vertical-align: 0px"/>, <img class="math" src="_images/math/0cea27ec4b6ab372a63d430faad075b2b971757e.png" alt="{\rm{FUY}}" style="vertical-align: 0px"/>, <img class="math" src="_images/math/90baf11e6ffbce672a2ace465b9965c72b77083e.png" alt="{\rm{FVX}}" style="vertical-align: 0px"/>, and <img class="math" src="_images/math/2870fa964a6993dfbb2dde38c2a20d6de2b9c21b.png" alt="{\rm{FVY}}" style="vertical-align: 0px"/> are the momentum advection terms described in <a class="reference internal" href="#momentumequationapproximationsth"><span class="std std-ref">Momentum Equation Approximations</span></a>.</li>
<li>The wall shear stresses are assumed to be linear with respect to velocity, with coefficients <img class="math" src="_images/math/5fd5eb1bf485346e3bafd5bc2ae1eb4fd31caa56.png" alt="w_x" style="vertical-align: -3px"/> and <img class="math" src="_images/math/6adc70c32627a50844b3a7cc21f7db7a806dfef2.png" alt="w_y" style="vertical-align: -6px"/>, and <img class="math" src="_images/math/aa7bb4ba48c837bd0c09129ff2fa35fb2e83755f.png" alt="f_x" style="vertical-align: -4px"/> and <img class="math" src="_images/math/569ab83aa4088ae75f450cc65d4008055ee42cfb.png" alt="f_y" style="vertical-align: -6px"/> include all other forces acting on the fluid.</li>
</ul>
<p>The terms with the superscript <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> are evaluated explicitly using the
solution at time <img class="math" src="_images/math/220014a4397e12b4e9deb7805d0dec4fae9a208b.png" alt="{t^n}" style="vertical-align: 0px"/>. The superscript <img class="math" src="_images/math/292fd26561e474624a6351079d5bca2328c6718c.png" alt="{n + 1}" style="vertical-align: -2px"/> denotes terms
evaluated implicitly at time <img class="math" src="_images/math/f593fe03d9b6ba9ad0ed7da3eaafb0745cdd236f.png" alt="{t^{n + 1}} = {t^n} + \delta t" style="vertical-align: -2px"/>.</p>
<p>Since Eqs. <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox1">(380)</a> and
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox2">(381)</a> are coupled between each other and
to the variables in the neighboring cells, an iterative solution method must be
employed to obtain solution for <img class="math" src="_images/math/d9143756eb209402a9ef10f51d3822cec6fbf024.png" alt="u_{i,j}" style="vertical-align: -6px"/>, <img class="math" src="_images/math/863e0b14061b6226f4ca2545d5fc02c04bee7fdb.png" alt="v_{i,j}" style="vertical-align: -6px"/> and
<img class="math" src="_images/math/ef0ee419107bde101d4f7a30726856afe0d5961b.png" alt="p_{i,j}" style="vertical-align: -6px"/> for all <img class="math" src="_images/math/adcc86ea88afc5c1388cc343b757a071a0e756e5.png" alt="0 &lt; i &lt; N_x + 1" style="vertical-align: -3px"/>, <img class="math" src="_images/math/b5cf1557e593f5a1b50e1ca6a33853e0486a65eb.png" alt="0 &lt; j &lt; N_y + 1" style="vertical-align: -6px"/>.</p>
<p>Two iteration loops are defined in the Jacobi iteration method: one for the
viscous terms in the momentum equations, and the other for pressure using the
continuity equation. The second iteration loop is similar to the one described
in <a class="reference internal" href="#pressuresolutionalgorithmth"><span class="std std-ref">Pressure Solution Algorithm</span></a>. Full-pressure convergence is obtained
after <em>each</em> viscous iteration. In other words, each viscous iteration generally
requires many pressure iterations (the average pressure iteration number over
all viscous iterations at a given time step is then computed for the diagnostics
output).</p>
<p>At each viscous iteration <img class="math" src="_images/math/41d265051deb6ed67e9420dd2735fb71252df755.png" alt="kv + 1" style="vertical-align: -2px"/> the momentum equations are solved for
the diagonal implicit terms <img class="math" src="_images/math/d9143756eb209402a9ef10f51d3822cec6fbf024.png" alt="u_{i,j}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/863e0b14061b6226f4ca2545d5fc02c04bee7fdb.png" alt="v_{i,j}" style="vertical-align: -6px"/> (for <img class="math" src="_images/math/f193748db74cfed474f7af8b151e3f3a104ba1f8.png" alt="kv =
1" style="vertical-align: 0px"/> the solution from the previous time step is used):</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox3">
<p><span class="eqno">(382)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox3" title="Permalink to this equation">¶</a></span><img src="_images/math/2c013090b67926e7bdb4e2878c39315cd441d3c7.png" alt="\begin{gathered}
u_{i,j}^{kv + 1} = {D_{xi,j}}\left[ {u_{i,j}^* - \frac{{\delta t}}{\rho }\frac{{p_{i + 1,j}^{kv} - p_{i,j}^{kv}}}{{\delta x}} + \frac{{\mu \delta t}}{\rho }\left( {\frac{{u_{i + 1,j}^{kv} + u_{i - 1,j}^{kv}}}{{\delta {x^2}}} + \frac{{u_{i,j + 1}^{kv} + u_{i,j - 1}^{kv}}}{{\delta {y^2}}}} \right)} \right] \hfill \\
v_{i,j}^{kv + 1} = {D_{yi,j}}\left[ {v_{i,j}^* - \frac{{\delta t}}{\rho }\frac{{p_{i,j + 1}^{kv} - p_{i,j}^{kv}}}{{\delta y}} + \frac{{\mu \delta t}}{\rho }\left( {\frac{{v_{i + 1,j}^{kv} + v_{i - 1,j}^{kv}}}{{\delta {x^2}}} + \frac{{v_{i,j + 1}^{kv} + v_{i,j - 1}^{kv}}}{{\delta {y^2}}}} \right)} \right] \hfill \\
{D_{xi,j}} = \frac{1}{{1 + \frac{{2\mu \delta t}}{\rho }\left( {\frac{1}{\delta {x^2}} + \frac{1}{\delta {y^2}} } \right) + \delta t \cdot {w_{xi,j}}}} \hfill \\
{D_{yi,j}} = \frac{1}{{1 + \frac{{2\mu \delta t}}{\rho }\left( {\frac{1}{\delta {x^2}} + \frac{1}{\delta {y^2}} } \right) + \delta t \cdot {w_{yi,j}}}} \hfill \\
\end{gathered}"/></p>
</div><p>Here <img class="math" src="_images/math/620ea9e9c1e6070b42539c1229724ebb2ce19b47.png" alt="u_{i,j}^*" style="vertical-align: -8px"/> and <img class="math" src="_images/math/3ff8d87fa386ad6a5649d249f3d6ab5771182800.png" alt="v_{i,j}^*" style="vertical-align: -8px"/> include all respective explicit terms in Eqs.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox1">(380)</a> and <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox2">(381)</a>.</p>
<p>Substituting the <img class="math" src="_images/math/41d265051deb6ed67e9420dd2735fb71252df755.png" alt="kv + 1" style="vertical-align: -2px"/> level velocity from Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox3">(382)</a> into Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox2">(381)</a> yields an equation for pressure.
Similar to the standard SOR method described in
<a class="reference internal" href="#pressuresolutionalgorithmth"><span class="std std-ref">Pressure Solution Algorithm</span></a>, a pressure adjustment is made in each
control volume to satisfy the zero-divergence condition</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox4">
<p><span class="eqno">(383)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox4" title="Permalink to this equation">¶</a></span><img src="_images/math/74a880a5868abc0afe29f6b7b0fd741538fcb855.png" alt="\delta p_{i,j}^{kp + 1} = p_{i,j}^{kp + 1} - p_{i,j}^{kp} = - \frac{{\omega S_{i,j}^{kp}}}{{{{\left( {\frac{{\partial S}}{{\partial p}}} \right)}_{i,j}}}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/533a9e4eaaa9576d59d7fb90e61c01a2899f612c.png" alt="S" style="vertical-align: 0px"/> is the left-hand side of Eq. <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox2">(381)</a>,</li>
<li><img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> is the relaxation factor defined by the input parameter <span class="target" id="index-428"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGA</span></code>, and</li>
<li><img class="math" src="_images/math/2a299fef06403c9ed8c303d1c24a5c2454c21d11.png" alt="kp" style="vertical-align: -4px"/> is the pressure iteration number.</li>
</ul>
<p>The corresponding adjustments of pressure and velocity components differ from
those given in Eq. <a class="reference internal" href="#equation-incompressiblesormethod5">(358)</a> in that <img class="math" src="_images/math/af55151ad4603068abcc3f785b26f6d8eb822544.png" alt="D_x" style="vertical-align: -3px"/> and
<img class="math" src="_images/math/18b5f593ee0a73ef2c72a5b358476e36117eab0e.png" alt="D_y" style="vertical-align: -6px"/> are present in the equations:</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox5">
<p><span class="eqno">(384)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox5" title="Permalink to this equation">¶</a></span><img src="_images/math/960099e1ae147f5fc2bf9cf5424f7761c338e745.png" alt="\begin{gathered}
u_{i,j}^{kp + 1} = u_{i,j}^{kp} + {D_{xi,j}}\frac{{\delta t\delta p}}{{\rho \,\delta x}} \hfill \\
u_{i - 1,j}^{kp + 1} = u_{i - 1,j}^{kp} - {D_{xi - 1,j}}\frac{{\delta t\delta p}}{{\rho \,\delta x}} \hfill \\
v_{i,j}^{kp + 1} = v_{i,j}^{kp} + {D_{yi,j}}\frac{{\delta t\delta p}}{{\rho \,\delta y}} \hfill \\
v_{i,j - 1}^{kp + 1} = v_{i,j - 1}^{kp} - {D_{yi,j - 1}}\frac{{\delta t\delta p}}{{\rho \,\delta y}} \hfill \\
\end{gathered}"/></p>
</div><p>and</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox6">
<p><span class="eqno">(385)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox6" title="Permalink to this equation">¶</a></span><img src="_images/math/a202dabfce3eafa8a5a86c900af5a8c9fffaf299.png" alt="\frac{{\partial S}}{{\partial p}} = {{D_{xi,j}}\frac{{\delta t}}{{\rho \,\delta x^2}} + {D_{xi - 1,j}}\frac{{\delta t}}{{\rho \,\delta x^2}} + {D_{yi,j}}\frac{{\delta t}}{{\rho \,\delta y_2}} + {D_{yi,j - 1}}\frac{{\delta t}}{{\rho \,\delta y^2}}}"/></p>
</div><p>After pressure iterations are completed for a given viscous iteration
<img class="math" src="_images/math/e474e2458548e6fce2ceb58c149b623c69fbf15e.png" alt="kv" style="vertical-align: 0px"/>, the converged solution is used to solve Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox3">(382)</a> for the next viscous iteration
<img class="math" src="_images/math/41d265051deb6ed67e9420dd2735fb71252df755.png" alt="kv + 1" style="vertical-align: -2px"/>.</p>
<p>The solution is converged when both viscous and pressure iterations have
converged. The convergence criterion for the pressure iterations, <span class="target" id="index-429"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code>,
is the same as for the explicit viscous algorithm. <span class="target" id="index-430"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code> is generally a function
of the time-step size. An additional multiplier for <span class="target" id="index-431"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code>,
<span class="target" id="index-432"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSADJ</span></code>, can be used to tighten (<span class="target" id="index-433"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSADJ</span> <span class="pre">&lt;</span> <span class="pre">1.0</span></code>) or loosen (<span class="target" id="index-434"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSADJ</span> <span class="pre">&gt;</span> <span class="pre">1.0</span></code>) convergence. The default value of <span class="target" id="index-435"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSADJ</span></code> is 1.0.</p>
<p>The successive under-relaxation (SUR), or Jacobi, viscous iterations are
deemed converged when the normalized velocity change between successive
iterations does not exceed <img class="math" src="_images/math/181b2d902e397c11902f641282c5ce79ce173899.png" alt="0.01 \times" style="vertical-align: 0px"/> <span class="target" id="index-436"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code>. An additional
multiplier, <span class="target" id="index-437"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSVIS</span></code>, can be used to tighten or loosen convergence. The
default value of <span class="target" id="index-438"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSVIS</span></code> is 1.0.</p>
<p>In the line implicit (ADI) viscous solver, momentum and pressure equations are
solved together within the same iteration; there is no division into separate
pressure and velocity iterations. In an iteration <img class="math" src="_images/math/0b58395f2d5cd93eabf1279d0acaa57f40f1866b.png" alt="k + 1" style="vertical-align: -2px"/> a pass is made
through the grid to evaluate <img class="math" src="_images/math/511236a0217d6ffcc7cdaf7041108c3b55c2ab46.png" alt="\delta p" style="vertical-align: -4px"/> using velocities from the
previous iteration <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>:</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox7">
<p><span class="eqno">(386)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox7" title="Permalink to this equation">¶</a></span><img src="_images/math/7c936b92acd759523b3d748e7b7ccc3b7cf4a8d9.png" alt="\delta p_{i,j}^{k + 1} = p_{i.j}^{k + 1} - p_{i.j}^k = - \frac{{\omega S_{i,j}^k}}{{{{\left( {\frac{{\partial S}}{{\partial p}}} \right)}_{i,j}}}}"/></p>
</div><p>where the denominator is evaluated from Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox6">(385)</a> and <img class="math" src="_images/math/af55151ad4603068abcc3f785b26f6d8eb822544.png" alt="D_x" style="vertical-align: -3px"/> and <img class="math" src="_images/math/18b5f593ee0a73ef2c72a5b358476e36117eab0e.png" alt="D_y" style="vertical-align: -6px"/>
defined in Eq. <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox3">(382)</a>. Note that <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/>
in Eq. <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox7">(386)</a> defaults to 1.0. It is not
recommended to use values greater than 1.0.</p>
<p>Then the momentum equations are solved with the latest pressures from Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox7">(386)</a>, employing a tridiagonal matrix
solver. First, a pass is made in the x-direction using the <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>-th level
velocity components to evaluate the <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-derivatives:</p>
<div class="math" id="equation-implictviscousstressandheatfluxapprox8">
<p><span class="eqno">(387)<a class="headerlink" href="#equation-implictviscousstressandheatfluxapprox8" title="Permalink to this equation">¶</a></span><img src="_images/math/ffb15435a8df91fe97afac1ff72db3a43d81fcf2.png" alt="\begin{gathered}
u_{i,j}^{k + 1} + \frac{{\mu \delta t}}{\rho }\left( {\frac{{u_{i + 1,j}^{k + 1} - 2u_{i,j}^{k + 1} - u_{i - 1,j}^{k + 1}}}{{\delta {x^2}}} + \frac{{u_{i,j + 1}^k - 2u_{i,j}^{k + 1} + u_{i,j - 1}^k}}{{\delta {y^2}}}} \right) + {w_x}u_{i,j}^{k + 1} = u_{i,j}^* - \frac{{\delta t}}{\rho }\frac{{p_{i + 1,j}^{k + 1} - p_{i,j}^{k + 1}}}{{\delta x}} \hfill \\
\\
v_{i,j}^{k + 1} + \frac{{\mu \delta t}}{\rho }\left( {\frac{{v_{i + 1,j}^{k + 1} - 2v_{i,j}^{k + 1} + v_{i - 1,j}^{k + 1}}}{{\delta {x^2}}} + \frac{{v_{i,j + 1}^k - 2v_{i,j}^{k + 1} + v_{i,j - 1}^k}}{{\delta {y^2}}}} \right) + {w_y}v_{i,j}^{k + 1} = v_{i,j}^* - \frac{{\delta t}}{\rho }\frac{{p_{i,j + 1}^{k + 1} - p_{i,j}^{k + 1}}}{{\delta y}} \hfill \\
\end{gathered}"/></p>
</div><p>Equations <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox8">(387)</a> are solved for the terms
with superscript <img class="math" src="_images/math/0b58395f2d5cd93eabf1279d0acaa57f40f1866b.png" alt="k + 1" style="vertical-align: -2px"/>. A pass is then made in the y-direction using the
velocity components from the x-direction pass to evaluate the x-direction
derivatives. A pass in the z-direction is added in three-dimensional problems.</p>
<p>An under-relaxation factor <span class="target" id="index-439"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGVS</span></code> is used in Eq.
<a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox8">(387)</a> to improve convergence of the
viscous iterations. <span class="target" id="index-440"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGVS</span></code> currently defaults
to 1.0 to minimize numerical noise. This method is activated when <span class="target" id="index-441"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IMPVIS</span></code>=2.</p>
<p>Time level <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> velocities are used as the first guess for the iteration
process. The solution is converged when the continuity equation residual is
smaller than <span class="target" id="index-442"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSI</span></code> everywhere in the grid, and the normalized momentum
equation residual is less than 1.0<sup>-8</sup> <img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/> <span class="target" id="index-443"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSVIS</span></code>.
<span class="target" id="index-444"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSVIS</span></code> is an input variable with the default value of 1.0. The momentum
equation residual (in the x-direction) is normalized by the maximum of
<img class="math" src="_images/math/29e2f96d66cae1667522d0990df8f654cba8ef52.png" alt="\left| {u_{i,j}^{n + 1}{D_{xi,j}}} \right|" style="vertical-align: -8px"/> and the modulus of the
right-hand side of Eq. <a class="reference internal" href="#equation-implictviscousstressandheatfluxapprox8">(387)</a>.</p>
<p>The ADI iteration method is activated by setting <span class="target" id="index-445"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IMPVIS</span></code> = 2. It converges faster
and gives a more accurate solution than the SUR method in cases when viscous
friction is a dominant force. This will apply to highly viscous flows of
semi-solid metals, polymers and amorphous materials, when the simulation would
typically run at a time-step size a few orders of magnitude above the viscous
stability limit.</p>
<p>The SUR method is more efficient than the ADI solver in pressure-driven
flows, in which viscous stresses are secondary to pressure forces and the
time-step size is only a couple orders of magnitude above the viscous stability
limit.</p>
<p>An ADI iteration method is used for the solution of the thermal energy
equation, which is solved simultaneously in fluid and obstacles. An
over-relaxation procedure employed in this iteration algorithm improves the rate of
convergence. The degree of over-relaxation is controlled by <span class="target" id="index-446"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">OMEGHT</span></code>, with
the default set for an optimum convergence. Iterations are considered
converged when the maximum residual of the energy equation normalized by
temperature is less than <span class="target" id="index-447"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSIHT</span></code> = 1.0e-04 <img class="math" src="_images/math/b1843c713c800b463022026d2b2f46a1bbee5797.png" alt="\times" style="vertical-align: 0px"/> <span class="target" id="index-448"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSHTC</span></code>.
The default value for <span class="target" id="index-449"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">EPSHTC</span></code> is 1.0.</p>
<p>The convergence criteria in both thermal and viscous solutions are set
automatically during a calculation and may vary from time step to time step.</p>
<p>The implicit viscous option cannot be used in conjunction with turbulence
models because those models involve other kinds of diffusive processes that
are not treated implicitly.</p>
<p>The implicit solution method eliminates the restrictions imposed on
<img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> by conduction and heat transfer processes. The following
remarks, however, may be useful to realize the differences between explicit and
implicit approximations. The maximum time-step size that ensures a numerically
stable transient explicit solution can be interpreted as a period of time over
which a heat wave propagates in space by no more than one cell. When larger time
steps are used in the implicit algorithms, these waves are allowed to travel
farther in one time step. Over that period of time, several heat waves may pass
through the same location in the flow, therefore fluid energy and temperature at
this location may experience a complicated transient behavior over that same
period of time. However, the temporal partial derivative in the energy equation
is approximated with a first-order differencing scheme, which effectively
assumes linear energy variation during one time step. Therefore the use of large
time steps in the implicit scheme leads to smoothing, or diffusing, of the
solution, and to a certain loss of accuracy in the transient solution. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>
the size of the time step for the implicit solution is controlled automatically
to ensure accuracy and efficiency of the implicit solution. The time-step size
is adjusted so that the number of iterations does not exceed <span class="target" id="index-450"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">IDTHT</span></code> (default is
20).</p>
</div>
</div>
<div class="section" id="boundary-conditions">
<span id="boundaryconditionsth"></span><span id="index-451"></span><h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>In addition to the free-surface pressure boundary condition described earlier
(see Eq. <a class="reference internal" href="#equation-incompressiblewormethod6">(359)</a>), it is also necessary to set conditions
at all mesh boundaries and at surfaces of all internal obstacles.</p>
<span class="target" id="index-452"></span><div class="section" id="free-slip-vs-non-slip-boundaries">
<span id="freeslipvsnonslipboundariesth"></span><span id="index-453"></span><h4>Free-Slip vs. Non-Slip Boundaries<a class="headerlink" href="#free-slip-vs-non-slip-boundaries" title="Permalink to this headline">¶</a></h4>
<p>As a general rule all rigid and free boundary surfaces are treated as free-slip
boundaries – that is, as surfaces having zero tangential stresses. This
condition is imposed by setting to zero all velocity derivatives that are
computed using one or more velocity components from cell-faces having a zero
flow area (or a face outside the fluid in free-surface problems).</p>
<p>No-slip conditions are imposed using the wall shear-stress options described in
the <a class="reference internal" href="#turbulenceboundaryconditionsth"><span class="std std-ref">Turbulence Boundary Conditions</span></a>. At mesh boundaries a symmetry condition can be
specified such that free-slip conditions will be used there even when the wall
shear-stress option is requested.</p>
<p>At mesh boundaries it is also possible to have a non-zero tangential wall
velocity. This option is useful for various types of sliding wall and spinning
container problems.</p>
<span class="target" id="index-454"></span></div>
<div class="section" id="turbulence-model-boundary-conditions">
<span id="turbulencemodelboundaryconditionsth"></span><span id="index-455"></span><h4>Turbulence Model Boundary Conditions<a class="headerlink" href="#turbulence-model-boundary-conditions" title="Permalink to this headline">¶</a></h4>
<p>At all boundaries, except for rigid no-slip boundaries, the turbulence energy
and dissipation functions are treated as analogous to other cell-centered
quantities such as density. At symmetry boundaries no special conditions are
needed, as there are zero velocity derivatives across the boundary, and hence
zero turbulence production. Also, there is a zero flow area that automatically
ensures no advective or diffusive fluxes.</p>
<p>At rigid, no-slip boundaries, special considerations are necessary because
numerical resolution is usually too coarse to resolve details of a laminar
boundary layer region. The wall shear-stress model based on a turbulent (power
law) velocity profile has already been discussed (see
<a class="reference internal" href="#turbulenceboundaryconditionsth"><span class="std std-ref">Turbulence Boundary Conditions</span></a>). To be consistent with this, it is necessary
to define wall boundary values for the turbulence energy and turbulence
dissipation functions.</p>
<p>Within the context of the FAVOR<sup>TM</sup> method, in which rigid walls may cut at any
angle through a mesh cell, it is not obvious how these boundary conditions are
to be satisfied. We have elected to use the following procedure.</p>
<p>The turbulence energy and dissipation values are set in all cells having one or
more faces partially or wholly blocked by a no-slip, rigid boundary. Wall
boundary values are deduced from the assumed velocity profile (logarithmic law
approximation) and the assumption of a local equilibrium between turbulent
production and decay processes. <a class="reference internal" href="#turbulenceboundaryconditionsth"><span class="std std-ref">Turbulence Boundary Conditions</span></a> describes the
method by which this is accomplished, which includes an approximate treatment
for wall orientation and multiple wall effects.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#turbulenceboundaryconditionsth"><span class="std std-ref">Turbulence Boundary Conditions</span></a> in the <a class="reference internal" href="#auxiliarymodelsth"><span class="std std-ref">Auxiliary Models</span></a> section.</p>
</div>
<span class="target" id="index-456"></span></div>
<div class="section" id="free-surface-boundaries">
<span id="freesurfaceboundariesth"></span><span id="index-457"></span><h4>Free-Surface Boundaries<a class="headerlink" href="#free-surface-boundaries" title="Permalink to this headline">¶</a></h4>
<p>The normal stress, i.e., specified pressure, condition at a free surface is
satisfied by the pressure setting scheme described in
<a class="reference internal" href="#incompressiblesormethodth"><span class="std std-ref">Incompressible SOR Method</span></a>. (Free-surface boundary conditions only exist
in single fluid problems.)</p>
<p>Tangential stresses at a free-surface are zero because all velocity derivatives
that involve velocity components outside the surface are set to zero. Velocities
must be set on every cell boundary between a surface cell and an empty cell,
however, to correctly account for fluid advection. This is done in two steps.
First, every velocity component on a face adjacent to an empty cell is set equal
to the value on the opposite face of the surface cell. If the faces opposite one
another are both adjacent to empty cells, then the velocity set at these faces
is the average of the two values previously defined there. In the second step, a
virtual pressure adjustment is made to the surface cell that attempts to drive
the velocity divergence of the cell toward zero. Only velocities on sides open
to empty cells are adjusted in this process. The cell’s velocity divergence may
not actually be driven to zero because the adjustment is also proportional to
the fractional amount of fluid in the cell. This procedure improves momentum
distribution at free-surfaces and eliminates spurious velocity components that
we occasionally observed in previous algorithms.</p>
<p>Advective fluxes of turbulent quantities and all diffusive fluxes into empty
cells are set to zero since there is no fluid in those cells to either supply or
receive the fluxed quantities.</p>
<p>In applying the above boundary conditions, care is taken to keep the flow
consistent with internal obstacles.</p>
<span class="target" id="index-458"></span></div>
<div class="section" id="internal-obstacle-boundaries">
<span id="internalobstacleboundariesth"></span><span id="index-459"></span><h4>Internal Obstacle Boundaries<a class="headerlink" href="#internal-obstacle-boundaries" title="Permalink to this headline">¶</a></h4>
<p>The definition of obstacles within a mesh is accomplished by defining the
fractional cell areas and volumes of these cells partially occupied by obstacles
(the FAVOR<sup>TM</sup> method) and by flagging those mesh cells that are entirely occupied
by obstacles. The quantity chosen as a flag is the volume fraction
<img class="math" src="_images/math/f376b1e7ae86bcd34bddb1a644c5ffa16fdfbc41.png" alt="{\rm{VF}}_{ijk}" style="vertical-align: -6px"/>. When this quantity is zero, the cell is entirely within an
obstacle and all fluid calculations in the cell are eliminated.</p>
<p>All interior fractional areas/volumes initially default to unity corresponding
to a fully open mesh. The fractional areas of mesh boundaries defined to be
rigid free-slip or no-slip walls are automatically set to zero.</p>
<p>When obstacles are defined in the input file, using the <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> geometry builder
or STL data, the area/volume fractions are automatically calculated before the
hydrodynamic calculations are carried out.</p>
<p>In the program no velocities or pressures are computed in full obstacle cells,
and all velocity components on faces of obstacle cells are automatically set to
zero.</p>
<p>Because of the formulation of the viscous stresses, which include fractional
areas, all internal obstacles and mesh boundaries are represented as free-slip
boundaries in the basic stress tensor. However, no-slip effects have been added
separately, as previously mentioned, through the wall shear-stress algorithm.</p>
</div>
<div class="section" id="surface-tension-with-wall-adhesion">
<span id="surfacetensionwalladhesionth"></span><span id="index-460"></span><h4>Surface Tension with Wall Adhesion<a class="headerlink" href="#surface-tension-with-wall-adhesion" title="Permalink to this headline">¶</a></h4>
<p>Surface tension effects are included in calculations by defining the surface
tension coefficient <span class="target" id="index-461"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">SIGMA</span></code> (units are force per unit length). It can be used in
one fluid-flows with free-surface or two-fluid problems with sharp interface between them.</p>
<p>Wall adhesion is controlled by the contact angle, <span class="target" id="index-462"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CANGLE</span></code>, in degrees. This is
the angle in the fluid between the wall tangent and the fluid surface tangent.</p>
<p>To compute the net surface tension force acting on a surface cell, we view the
cell as a control volume and calculate the net surface tension stresses acting
at the sides of the cell. We assume that surface tension forces can be replaced
by an equivalent surface pressure. To be specific, suppose the inward surface
normal is pointing in the negative z-direction (i.e., <img class="math" src="_images/math/a0a204001b36a10f4862bca8117e205817107227.png" alt="{\rm{NF}} = 5" style="vertical-align: 0px"/>). The
surface tension stresses acting on fluid across the cell-faces normal to the x
and y directions will, in general, have components in all three coordinate
directions. In terms of an equivalent surface pressure, these forces must be
equal to this pressure times the projected surface area in each coordinate
direction. The equivalent surface pressure is, therefore, the net force in the
direction of the surface normal divided by area of the surface.</p>
<p>To compute the net force, consider first the cell-face located in
the positive x-direction. Surface tension forces act tangent to the surface and
can be resolved into components directed along two principal tangent directions.
We select one surface tangent to lie in the cell-face so that forces in this direction
do not contribute to the net force across the face. It is the force in the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>
directions of the second principal tangent that we must calculate. The
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-direction component of this force, for example, can be shown to be</p>
<div class="math" id="equation-surfacetensionwithwalladhesion1">
<p><span class="eqno">(388)<a class="headerlink" href="#equation-surfacetensionwithwalladhesion1" title="Permalink to this equation">¶</a></span><img src="_images/math/be5b53508e4c67665bd76e5ea1c27cb9fb50294f.png" alt="{S_z} = \sigma \int {\cos (\theta )\left[ {\frac{{dy}}{{\cos (\phi )}}} \right]}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/f2e62171924bac3b973bb702eb391f3d4bb42625.png" alt="\sigma" style="vertical-align: 0px"/> is the surface tension coefficient,</li>
<li><img class="math" src="_images/math/3f2fed604982fac0106624a80d0210ef44c1e258.png" alt="\theta" style="vertical-align: 0px"/> is the angle of the second principal tangent with respect to the <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>-axis, and</li>
<li><img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> is the angle of the first principal tangent with respect to the <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-axis.</li>
<li>The factor <img class="math" src="_images/math/163579afd3309a84032d708a19b6276c9a9379fc.png" alt="dy/\cos (\phi )" style="vertical-align: -5px"/> is the length of the surface intersecting the cell-face and must be included because <img class="math" src="_images/math/3e821331961a936174f714f67bb5669fca7b828b.png" alt="s" style="vertical-align: 0px"/> is a force per unit length.</li>
</ul>
<p>Estimates of <img class="math" src="_images/math/3f2fed604982fac0106624a80d0210ef44c1e258.png" alt="\theta" style="vertical-align: 0px"/> and <img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> are computed from the columnar sums described
earlier (see <a class="reference internal" href="#surfacelocationcellth"><span class="std std-ref">Surface Location within a Cell</span></a>). In this case (<img class="math" src="_images/math/a0a204001b36a10f4862bca8117e205817107227.png" alt="{\rm{NF}} = 5" style="vertical-align: 0px"/>) the
appropriate sums are the <img class="math" src="_images/math/7ae67dbc129c43c16bf4dff717124e8cb52dcbd3.png" alt="Z(x,y)" style="vertical-align: -5px"/> quantities. At cell-faces perpendicular to the
<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>-axis we have approximately,</p>
<div class="math" id="equation-surfacetensionwithwalladhesion2">
<p><span class="eqno">(389)<a class="headerlink" href="#equation-surfacetensionwithwalladhesion2" title="Permalink to this equation">¶</a></span><img src="_images/math/63ef0f8be405ebddbb7aab9c7808b8acce9911e7.png" alt="{S_z} = \frac{{\sigma \delta y\left( {\frac{{\partial Z}}{{\partial x}}} \right)}}{{{{\left[ {1 + {{\left( {\frac{{\partial Z}}{{\partial x}}} \right)}^2} + {{\left( {\frac{{\partial Z}}{{\partial y}}} \right)}^2}} \right]}^{\frac{1}{2}}}}}"/></p>
</div><p>At faces perpendicular to the <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>-axis, the two angles are interchanged
because the force integrations are with respect to <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>. For other values
of <img class="math" src="_images/math/13058a6cb3c73791a30ae56b04b5b5c1db16902c.png" alt="{\rm{NF}}" style="vertical-align: 0px"/> suitable changes must be made in the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> direction quantities used in these prescriptions.</p>
<p>When wall boundaries are present, an additional modification is necessary. For
instance, if a wall intersects the cell-face where the stresses in Eq.
<a class="reference internal" href="#equation-surfacetensionwithwalladhesion2">(389)</a> are computed, these stresses are
multiplied by the fraction of the face open to flow. For the remaining
(closed) area fraction, we assume the fluid adheres to the wall with the
contact angle, <span class="target" id="index-463"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CANGLE</span></code>. Stresses associated with this wall adhesion are
given by Eq. <a class="reference internal" href="#equation-surfacetensionwithwalladhesion1">(388)</a> in which <img class="math" src="_images/math/3f2fed604982fac0106624a80d0210ef44c1e258.png" alt="\theta" style="vertical-align: 0px"/> is
replaced by <span class="target" id="index-464"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">CANGLE</span></code> and the contribution is multiplied by the wall area
fraction. The evaluation of the force arising from wall adhesion takes into
account the slope of the wall.</p>
<p>Once all the force components have been evaluated, the net force in the direction normal
to the surface is computed and divided by the area of the surface to obtain the equivalent
surface tension pressure. To complete this final computation the column sums are also used
to estimate the surface normal and the surface area.</p>
<p>An alternative to a wetting condition based on the static contact angle is the option
to <em>pin</em> the fluid surface contact line to the surface of a solid geometry component. When
activated, the interface stays at the location of the initial contact with such surface.
Instead of its motion computed based on the balance of forces, its velocity is effectively
set to zero, with the local pressures and velocities computed accordingly.</p>
<span class="target" id="index-465"></span></div>
<div class="section" id="mesh-block-boundaries">
<span id="meshboundariesth"></span><span id="index-466"></span><h4>Mesh Block Boundaries<a class="headerlink" href="#mesh-block-boundaries" title="Permalink to this headline">¶</a></h4>
<p>At the mesh boundaries a variety of conditions may be set using the layer of
fictitious cells surrounding the mesh. Consider, for example, the boundary
separating the <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/> and <img class="math" src="_images/math/d2f8d5fa59da3f7f2eed1f3cddf84d9d2280c0f5.png" alt="i = 2" style="vertical-align: 0px"/> layer of cells. The <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/>
cells are fictitious in the sense that variable values are set, not calculated,
in these cells to satisfy boundary conditions. If this boundary is to be a rigid
wall, the normal velocity there must be zero. The tangential velocity can be set
to any value for a no-slip type of wall. Thus, for a rigid wall the boundary
conditions are, for all <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/></p>
<div class="math" id="equation-meshboundaries1">
<p><span class="eqno">(390)<a class="headerlink" href="#equation-meshboundaries1" title="Permalink to this equation">¶</a></span><img src="_images/math/f2303df5bd95e52321583881d244db146bd8e84e.png" alt="\begin{gathered}
{u_{1,j,k}} = 0.0 \hfill \\
{p_{1,j,k}} = {p_{2,j,k}} \hfill \\
{F_{1,j,k}} = {F_{2,j,k}} \hfill \\
{\rho _{1,j,k}} = {\rho _{2,j,k}} \hfill \\
{(\rho I)_{1,j,k}} = {(\rho I)_{2,j,k}} \hfill \\
\end{gathered}"/></p>
</div><p>Free-slip conditions are set automatically by ensuring that all velocity
derivatives across the wall are zero. No-slip wall conditions, including
specified wall velocities, are imposed through the wall shear-stress model
described earlier. Conditions given by Eq. <a class="reference internal" href="#equation-meshboundaries1">(390)</a> are imposed on
the velocities obtained from the momentum equations and after each pass through
the mesh during the pressure iteration.</p>
<p>At fixed velocity or fixed pressure boundaries one must specify inflow values
for <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> and <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/>, tangential velocities and the normal velocity for
the former, or pressure for the latter type of boundary condition. These may be
specified as time-dependent functions for each edge of the computational mesh.</p>
<p>It is important to note that scalar quantities are defined at the centers of the
boundary cells which are half a cell away from the actual mesh boundary
location. This affects the gradients of these quantities near the boundaries,
which may be especially important for temperature and pressure calculations. The
same applies to the tangential velocities at all open mesh boundaries (for the
wall type boundaries the tangential velocities are defined at the edge of the
boundary itself). Of course, the normal boundary velocities are always set at
the edge of the boundary.</p>
<p>Time-independent boundary conditions are set using tabular input of the BC
values vs. time. Values are linearly interpolated at intermediate times.</p>
<p>Fixed pressure boundaries are treated somewhat differently from the fixed
velocity case. When a fixed pressure boundary is requested, the mesh generator
creates one additional layer of boundary mesh cells in which the pressures are
defined. Three types of specified pressures are possible. If the pressure is the
local static pressure, then across this extra layer of cells, zero
velocity-derivative conditions are imposed similar to the continuative condition
described next. If the pressure is an upstream stagnation pressure, then a zero
normal velocity is imposed at the mesh boundary to approximate stagnation
conditions.</p>
<p>For compressible flows, the state of the gas at the boundary is
defined by pressure and temperature, with density computed from the equation
of state. If the stagnation option is used for pressure, then the boundary temperature
must also be defined at the stagnation condition. Finally, a hydrostatic pressure
distribution in one of the coordinate directions may be imposed for incompressible
problems.</p>
<p>Continuative outflow boundaries, where fluid is to flow smoothly out of the mesh
causing no upstream effects, are always a problem for low speed or
incompressible flow calculations. Potentially, any prescription can affect the
entire flow field. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the continuative boundary conditions used at the
<img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/> boundary, when the flow is directed out of the computational
domain, are the vanishing of all normal derivatives, which are (for all
<img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/>)</p>
<div class="math" id="equation-meshboundaries2">
<p><span class="eqno">(391)<a class="headerlink" href="#equation-meshboundaries2" title="Permalink to this equation">¶</a></span><img src="_images/math/30ba48686d38aeda99c634efa0d5e3dfd86613f7.png" alt="\begin{gathered}
{u_{1,j,k}} = {u_{2,j,k}} \hfill \\
{v_{1,j,k}} = {v_{2,j,k}} \hfill \\
{w_{1,j,k}} = {w_{2,j,k}} \hfill \\
{p_{1,j,k}} = {p_{2,j,k}} \hfill \\
{F_{1,j,k}} = {F_{2,j,k}} \hfill \\
{\rho _{1,j,k}} = {\rho _{2,j,k}} \hfill \\
{(\rho I)_{1,j,k}} = {(\rho I)_{2,j,k}} \hfill \\
\end{gathered}"/></p>
</div><p>These conditions, however, are only imposed after applying the momentum
equations and <em>not</em> after each pass through the pressure iteration. Omitting
these conditions during the pressure adjustment provides additional “softness”
at the boundary that helps to minimize upstream effects.</p>
<p>If the flow at a continuative boundary is directed into the computational
domain, then all conditions given by Eq. <a class="reference internal" href="#equation-meshboundaries2">(391)</a> are applied
except for the normal velocity component, which is set to zero to make inward
flow more difficult. When using the continuative boundary condition, the user
should be careful to ensure that it is adequate for his purposes. In general, it
should not be trusted if there is a significant flow entering a grid at this
type of boundary (see discussion below).</p>
<p>For periodic boundary conditions, e.g. in the x-direction, both the <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/>
and <img class="math" src="_images/math/6a749c47131f62f011313f4326417f496062c39a.png" alt="i = {\rm{IMAX}}" style="vertical-align: 0px"/> boundaries must be set to reflect the periodicity.
This is most easily done when the period length is chosen equal to the
distance from the boundary between the <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/> and 2 cells to the
boundary between the <img class="math" src="_images/math/9307df0621b70040cf9cc2bf99e76bbaadd9a191.png" alt="i = {\rm{IMAX}}- 2" style="vertical-align: 0px"/> and <img class="math" src="_images/math/b683a566459fefb1fe2b96deaeb06d328fa91ba7.png" alt="{\rm{IMAX}} - 1" style="vertical-align: 0px"/>
cells. That is, two layers of cells, <img class="math" src="_images/math/6a749c47131f62f011313f4326417f496062c39a.png" alt="i = {\rm{IMAX}}" style="vertical-align: 0px"/> and <img class="math" src="_images/math/790e7fb32c3fc1a78affef26b35224f1fb8409ce.png" alt="i =
{\rm{IMAX}} - 1" style="vertical-align: 0px"/>, are reserved for setting periodic boundary conditions at the
far side of the mesh. The mesh generator automatically accounts for this extra
layer of cells and requires no special considerations on the part of the user.
The conditions for periodic flow in the x-direction are then, at <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/>
for all <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/></p>
<div class="math" id="equation-meshboundaries3">
<p><span class="eqno">(392)<a class="headerlink" href="#equation-meshboundaries3" title="Permalink to this equation">¶</a></span><img src="_images/math/197cf0db12321a41ba8406aa5b593fb16185be46.png" alt="\begin{gathered}
{u_{1,j,k}} = {u_{{\rm{IM2}},j,k}} \hfill \\
{v_{1,j,k}} = {v_{{\rm{IM2}},j,k}} \hfill \\
{w_{1,j,k}} = {w_{{\rm{IM2}},j,k}} \hfill \\
{F_{1,j,k}} = {F_{{\rm{IM2}},j,k}} \hfill \\
{\rho _{1,j,k}} = {\rho _{{\rm{IM2}},j,k}} \hfill \\
{(\rho I)_{1,j,k}} = {(\rho I)_{{\rm{IM2}},j,k}} \hfill \\
\end{gathered}"/></p>
</div><p>and, for all <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>, <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/></p>
<div class="math" id="equation-meshboundaries4">
<p><span class="eqno">(393)<a class="headerlink" href="#equation-meshboundaries4" title="Permalink to this equation">¶</a></span><img src="_images/math/e73eea8dd1f4a83ec391582d3bc5439d27dc1aaf.png" alt="\begin{gathered}
{u_{{\rm{IM1}},j,k}} = {u_{2,j,k}} \hfill \\
{v_{{\rm{IM1}},j,k}} = {v_{2,j,k}} \hfill \\
{w_{{\rm{IM1}},j,k}} = {w_{2,j,k}} \hfill \\
{p_{{\rm{IM1}},j,k}} = {p_{2,j,k}} \hfill \\
{{\rm{PS}}_{{\rm{IM1}},j,k}} = {{\rm{PS}}_{2,j,k}} \hfill \\
{F_{{\rm{IMAX}},j,k}} = {F_{3,j,k}} \hfill \\
{v_{{\rm{IMAX}},j,k}} = {v_{3,j,k}} \hfill \\
{w_{{\rm{IMAX}},j,k}} = {w_{3,j,k}} \hfill \\
{\rho _{{\rm{IMAX}},j,k}} = {\rho _{3,j,k}} \hfill \\
{(\rho I)_{{\rm{IMAX}},j,k}} = {(\rho I)_{3,j,k}} \hfill \\
\end{gathered}"/></p>
</div><p>where <img class="math" src="_images/math/f6df53995f1ec079cc372be94fdfb15c37058056.png" alt="{\rm{IM1}} = {\rm{IMAX}} - 1" style="vertical-align: 0px"/> and <img class="math" src="_images/math/63028b38493cb37af6bac90194b0b9546de3f693.png" alt="{\rm{IM2}} = {\rm{IMAX}}
- 2" style="vertical-align: 0px"/>. These conditions are imposed on velocities computed from the momentum
equations and after each pressure iteration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using cylindical coordinates, periodic boundary conditions can only be set in the Y- and Z-directions.</p>
</div>
<p>Boundary conditions similar to these are used at all other mesh boundaries. Of
course, the appropriate normal and tangential velocities must be used in each
case.</p>
<p>At fixed pressure boundaries the user has the option of setting either the
static pressure, <img class="math" src="_images/math/5ab9c11eb69bbfdc107b5c8d86c4cb31669cf2a0.png" alt="{\rm{PBC}} = p" style="vertical-align: -4px"/>, or the full (stagnation) pressure,
<img class="math" src="_images/math/840b9a2e857f87e04e4ecbc13968a226da09a230.png" alt="{\rm{PBC}} = p + r{u^2}/2" style="vertical-align: -5px"/>. The choice is made by using the input
variable <span class="target" id="index-467"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PBCTYP</span></code> (see discussion below).</p>
<p>For convenience to the user, the program has been written so that any of the
above boundary conditions can be imposed by setting input numbers. For
example, for the <img class="math" src="_images/math/ce5f1ac85f64eb0cd6da57f4dcbe49b6e0ff4ea2.png" alt="i = 1" style="vertical-align: 0px"/> boundary the quantity <img class="math" src="_images/math/5a66b456fa48c7b39068699c24be9b7f705f21dd.png" alt="{\rm{IBCT}}" style="vertical-align: 0px"/> is an
integer set according to the table:</p>
<blockquote id="quantitywlboundaryconditions">
<div><blockquote>
<div><table border="1" class="colwidths-given longtable docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>IBCT</strong></th>
<th class="head"><strong>Boundary Condition</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>1</strong></td>
<td><strong>Symmetry plane</strong></td>
</tr>
<tr class="row-odd"><td><strong>2</strong></td>
<td><strong>Rigid, no slip wall, if IWSH=1</strong></td>
</tr>
<tr class="row-even"><td><strong>3</strong></td>
<td><strong>Continuative</strong></td>
</tr>
<tr class="row-odd"><td><strong>4</strong></td>
<td><strong>Periodic</strong></td>
</tr>
<tr class="row-even"><td><strong>5</strong></td>
<td><strong>Specified pressure</strong></td>
</tr>
<tr class="row-odd"><td><strong>6</strong></td>
<td><strong>Specified velocity</strong></td>
</tr>
<tr class="row-even"><td><strong>7</strong></td>
<td><strong>Grid Overlay (GO) boundary</strong></td>
</tr>
<tr class="row-odd"><td><strong>8</strong></td>
<td><strong>Outflow</strong></td>
</tr>
<tr class="row-even"><td><strong>9</strong></td>
<td><strong>Inter-block boundary</strong></td>
</tr>
<tr class="row-odd"><td><strong>10</strong></td>
<td><strong>Surface wave boundary</strong></td>
</tr>
<tr class="row-even"><td><strong>11</strong></td>
<td><strong>Specified volume flow rate boundary</strong></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
<p>In a similar fashion, the other boundaries are controlled by the input
parameters,</p>
<table border="1" class="colwidths-given longtable docutils" id="boundariescontrolledbyinputparameters">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Parameter</strong></th>
<th class="head"><strong>Mesh Boundary</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>IBCT(1)</strong></td>
<td><strong>i=1</strong></td>
</tr>
<tr class="row-odd"><td><strong>IBCT(2)</strong></td>
<td><strong>I=IMAX</strong></td>
</tr>
<tr class="row-even"><td><strong>IBCT(3)</strong></td>
<td><strong>j=1</strong></td>
</tr>
<tr class="row-odd"><td><strong>IBCT(4)</strong></td>
<td><strong>j=JMAX</strong></td>
</tr>
<tr class="row-even"><td><strong>IBCT(5)</strong></td>
<td><strong>k=1</strong></td>
</tr>
<tr class="row-odd"><td><strong>IBCT(6)</strong></td>
<td><strong>k=KMAX</strong></td>
</tr>
</tbody>
</table>
<p>Other special conditions may be added by the user in the location reserved for
this purpose at the end of boundary condition subroutine <strong class="program">bc</strong>.</p>
<span class="target" id="index-468"></span><div class="section" id="pressure-boundary-conditions">
<span id="pressureboundaryconditionsth"></span><span id="index-469"></span><h5>Pressure Boundary Conditions<a class="headerlink" href="#pressure-boundary-conditions" title="Permalink to this headline">¶</a></h5>
<p>The ability to specify a pressure condition at one or more boundaries of a
computational region is an important and useful computational tool. Pressure
boundaries represent such things as confined reservoirs of fluid, ambient
laboratory conditions, and applied pressures arising from mechanical devices.</p>
<p>Generally, a pressure condition cannot be used at a boundary where velocities
are also specified, because velocities are influenced by pressure gradients. The
only exception is when pressures are necessary to specify the fluid properties,
e.g., density crossing a boundary through an equation-of-state.</p>
<p>There are typically two types of pressure conditions, referred to as static or
stagnation pressure conditions. In a static condition, the pressure is more or
less continuous across the boundary and the velocity at the boundary is assigned
a value based on a zero normal-derivative condition across the boundary.</p>
<p>In contrast, a stagnation pressure condition assumes stagnation conditions
outside the boundary so that the velocity upstream from the boundary is zero.
This assumption requires a pressure drop across the boundary for flow to enter
the computational region.</p>
<p>Since the static pressure condition says nothing about fluid velocities outside
the boundary (other than it is supposed to be the same as the velocity at the
boundary), it is less specific than the stagnation pressure condition. In this
sense the stagnation pressure condition is generally more physical and is
recommended for most applications.</p>
<p>As an example, consider the problem of flow in a section of a pipe. If the
upstream end of the computational region coincides with the physical entrance to
the pipe, then a stagnation condition should be used to represent the external
ambient conditions as a large reservoir of stationary fluid. On the other hand,
if the upstream boundary of the computing region is inside the pipe, and many
diameters away from the entrance, then the static pressure condition would be a
more reasonable approximation to the flow conditions at that location.</p>
<span class="target" id="index-470"></span></div>
<div class="section" id="continuative-boundary-conditions">
<span id="continuativeboundaryconditionth"></span><span id="index-471"></span><h5>Continuative Boundary Conditions<a class="headerlink" href="#continuative-boundary-conditions" title="Permalink to this headline">¶</a></h5>
<p>In many simulations there is a need to have fluid flow out one or more
boundaries of the computational domain. At such “outflow” boundaries the
question arises of what constitutes a good boundary condition.</p>
<p>In compressible flows, when the flow speed at the outflow boundary is
supersonic, it makes little difference how the boundary conditions are
specified, since flow disturbances cannot propagate upstream. In low speed and
incompressible flows, however, disturbances introduced at an outflow boundary
can have an effect on the entire computational region. It is this possibility
that is discussed below.</p>
<p>The simplest and most commonly used outflow condition is that of a
“continuative” boundary. A continuative boundary condition consists of zero
normal derivatives at the boundary for all quantities. The zero-derivative
condition is intended to represent a smooth continuation of the flow through the
boundary.</p>
<p>It must be stressed that the continuative boundary condition has no physical
basis; rather, it is a mathematical statement that may or may not provide the
desired flow behavior. In particular, if flow is observed to enter the
computational region across such a boundary, then the computations may be wrong
because nothing has been specified about flow conditions existing outside the
boundary.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, a special enhancement to continuative boundaries is used to improve
their behavior. If flow attempts to enter the computational region across this
type of boundary it must do so by starting from condition of rest. This practice
helps to reduce inflow and often results in a reasonable approximation of a
smooth outflow condition. Nevertheless, a continuative boundary condition must
always be viewed with suspicion.</p>
<p>As a general rule, a physically meaningful boundary condition, such as a
specified pressure condition, should be used at outflow boundaries whenever
possible. When a continuative condition must be used, it should be placed as far
from the main flow region as is practical so that any adverse influence on the
main flow will be minimal.</p>
<span class="target" id="index-472"></span></div>
<div class="section" id="outflow-boundary-conditions">
<span id="outflowboundaryconditionsth"></span><span id="index-473"></span><h5>Outflow Boundary Conditions<a class="headerlink" href="#outflow-boundary-conditions" title="Permalink to this headline">¶</a></h5>
<p>Better outflow boundary conditions exist for some classes of flow problems. For
example, for wave propagation problems, special boundary treatments have been
devised that try to determine the speed and direction of waves approaching the
boundary and then set boundary conditions in such a way as to allow their
continuation through the boundary with a minimum of reflection. An early and
useful example of this type of treatment, sometime called a radiation boundary
condition, is described by <a class="reference internal" href="zbibliography.html#orlanski-1976" id="id81">[Orl76]</a>.</p>
<p>The outflow boundary condition allows users to numerically investigate the
effects of wave interactions with structures. This capability permits a
reduction in the extent of the computing mesh needed for accurate computations.</p>
<p>Open boundaries in low-speed flow calculations are difficult to define because
they can, in principle, influence the entire computational region. For wave
propagation problems, it is natural to seek a boundary condition that will allow
outgoing waves to smoothly leave the computational mesh with minimum reflection.
This problem is analogous to wave absorption in experimental wave tanks, where
one wants to eliminate the reflection of waves from the downstream end of the
tank. In these tanks a variety of techniques are used, but nearly all of them
employ some sort of energy dissipation (e.g., porous beaches). Regardless of the
method employed, the length of absorption must be at least as long as the
longest waves to be trapped.</p>
<p>In a computational wave tank, we are not limited by physical dimensions, so we
can imagine a mathematical continuation of the flow in the tank beyond the end
of the computed region. This is the spirit of the Sommerfeld radiation boundary
condition, which is a simple mathematical continuation having the form of
outgoing waves:</p>
<div class="math" id="equation-outflowboundaries1">
<p><span class="eqno">(394)<a class="headerlink" href="#equation-outflowboundaries1" title="Permalink to this equation">¶</a></span><img src="_images/math/60f04b70dd3fbeb45270eba2bdfa5d2177173a2e.png" alt="\frac{{\partial Q}}{{\partial t}} + c\frac{{\partial Q}}{{\partial x}} = 0"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> is any quantity,</li>
<li>positive <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> is directed out of the boundary and</li>
<li><img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is the local phase speed of the assumed wavelike flow.</li>
</ul>
<p>To use this idea as a boundary condition, the flow should consist of wavelike
disturbances that are propagating toward the boundary. The waves don’t have to
be directed normal to the boundary, they don’t have to be linear, and no
assumption about wavelength is necessary. The mathematical expression in Eq.
<a class="reference internal" href="#equation-outflowboundaries1">(394)</a> is simply a statement that any flow quantity <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/>
at the boundary will translate across the boundary with speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/>. If
there is no time variation, this condition reduces to the “continuative”
boundary condition of zero normal derivative.</p>
<p>To use Eq. <a class="reference internal" href="#equation-outflowboundaries1">(394)</a> as a basis for an “outflow” boundary
condition in a three-dimensional computation, we must apply it to every flow
variable at every location on the outflow boundary. The phase speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is
unlikely to be a constant because different quantities will be moving in
different directions (e.g., surface waves don’t move with the same velocity as a
fluid particle) and waves may strike a boundary at different times from
different directions. To account for this, we make a further assumption that Eq.
<a class="reference internal" href="#equation-outflowboundaries1">(394)</a> is not only valid at the boundary, but also at one
control volume removed from the boundary. The phase speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is assumed
to have the same value at both locations. This assumption allows us to use
numerical approximations for Eq. <a class="reference internal" href="#equation-outflowboundaries1">(394)</a> at two locations: one
to determine the value of <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> and the other to compute a boundary value
for the quantity <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/>.</p>
<p>The outflow boundary condition can be used for incompressible fluid flows that
are confined or have free-surfaces. It can also be used for fully compressible
flows.</p>
<p>Equation <a class="reference internal" href="#equation-outflowboundaries1">(394)</a> is a first-order wave equation that describes
wave propagation in the positive x-direction. Because it is first-order, it
requires only one initial condition to specify a starting condition. In
contrast, a second-order wave equation requires two initial conditions and can
have waves propagating in both the positive and negative directions. The
restriction to a first-order expression simplifies the implementation of the
condition in the <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> computer program because it requires no additional
storage for more time levels of information at the boundary.</p>
<p>The outflow boundary condition used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> will be illustrated in terms of
the right (maximum x) boundary of the computational region. Let <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> be the
index of the spatial location on or outside the boundary where we need a value
of some quantity <img class="math" src="_images/math/63a49bc6a730cec2e3e15896b3e086423d1aad32.png" alt="q" style="vertical-align: -4px"/>. This value is the boundary condition we are seeking.
We assume <img class="math" src="_images/math/0f8de12f361c9c3f641a08d1aed687d8ed9516ec.png" alt="q_i^n" style="vertical-align: -5px"/> is a known value of <img class="math" src="_images/math/63a49bc6a730cec2e3e15896b3e086423d1aad32.png" alt="q" style="vertical-align: -4px"/> at this point at time
level <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>. This value may have been used to compute <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>
time-level quantities in the interior of the grid. What we are seeking, then, is a
condition that will give us the next value, <img class="math" src="_images/math/f6084837cb64f87a6240f8db24bd40abca135547.png" alt="q_i^{n + 1}" style="vertical-align: -5px"/>, which is needed
to begin the next cycle of computation.</p>
<p>We begin with a second-order (in space and time) difference approximation for
the Sommerfeld condition, Eq. <a class="reference internal" href="#equation-outflowboundaries1">(394)</a>,</p>
<div class="math" id="equation-outflowboundaries2">
<p><span class="eqno">(395)<a class="headerlink" href="#equation-outflowboundaries2" title="Permalink to this equation">¶</a></span><img src="_images/math/e4b949e70568774b2b4b65408edc9ab7bd12e9b4.png" alt="\frac{1}{2}\left( {q_i^{n + 1} - q_i^n} \right) + \frac{1}{2}\left( {q_{i - 1}^{n + 1} - q_{i - 1}^n} \right) + \frac{{c\delta t}}{{\delta x}}\left[ {\frac{1}{2}\left( {q_i^{n + 1} - q_{i - 1}^{n + 1}} \right) + \frac{1}{2}\left( {q_i^n - q_{i - 1}^n} \right)} \right] = 1"/></p>
</div><p>The first two terms are time derivatives centered about <img class="math" src="_images/math/649d305e02f85883e810e301a8ae4a064563ff18.png" alt="n + 1/2" style="vertical-align: -5px"/>. One
term is at location <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> and the other at <img class="math" src="_images/math/e92e658397afe3e269d018a5274766e1ecd2b3fd.png" alt="i - 1" style="vertical-align: 0px"/>, so their average
is centered about x location <img class="math" src="_images/math/daf464af8b3ef9fc9bfef68a15590fe84980f69a.png" alt="i - 1/2" style="vertical-align: -5px"/>. The last term contains an
average of two x-derivatives centered about <img class="math" src="_images/math/daf464af8b3ef9fc9bfef68a15590fe84980f69a.png" alt="i - 1/2" style="vertical-align: -5px"/> at times <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>
and <img class="math" src="_images/math/e65ea93d8365181e92fa379fdf8813c3928f953e.png" alt="n + 1" style="vertical-align: -2px"/>. This term is also centered about <img class="math" src="_images/math/daf464af8b3ef9fc9bfef68a15590fe84980f69a.png" alt="i - 1/2" style="vertical-align: -5px"/> and
<img class="math" src="_images/math/649d305e02f85883e810e301a8ae4a064563ff18.png" alt="n + 1/2" style="vertical-align: -5px"/>. In this expression we have assumed constant grid spacing,
<img class="math" src="_images/math/8baa18e36a1087dc297e35fe32f270f105923852.png" alt="\delta x" style="vertical-align: 0px"/>, and time interval, <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/>.</p>
<p>Rearranging this expression,</p>
<div class="math" id="equation-outflowboundaries3">
<p><span class="eqno">(396)<a class="headerlink" href="#equation-outflowboundaries3" title="Permalink to this equation">¶</a></span><img src="_images/math/37d77cfcf1558911a5170e4e23f4c92ea74f3698.png" alt="q_i^{n + 1} = q_{i - 1}^n + \frac{{1 - C}}{{1 + C}}(q_i^n - q_{i - 1}^{n + 1})"/></p>
</div><p>where <img class="math" src="_images/math/164ddb1fb7fb13c6b18f2df8e75f1ca546c93c49.png" alt="C = \frac{{c\delta t}}{{\delta x}}" style="vertical-align: -6px"/>. Next we rewrite Eq.
<a class="reference internal" href="#equation-outflowboundaries3">(396)</a> by shifting the <img class="math" src="_images/math/2eabea196133c2d241781ade873a6c93e8dc2a11.png" alt="i" style="vertical-align: 0px"/> index one node to the left
and solve for the coefficient involving <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/>, which gives us the
prescription for the phase speed, or in this case, a function of the phase
speed,</p>
<div class="math" id="equation-outflowboundaries4">
<p><span class="eqno">(397)<a class="headerlink" href="#equation-outflowboundaries4" title="Permalink to this equation">¶</a></span><img src="_images/math/9bbfffb1d283feeadac611096be3ddabe8e9ab3f.png" alt="\frac{{1 - C}}{{1 + C}} = \frac{{q_{i - 1}^{n + 1} - q_{i - 1}^{n + 1}}}{{q_{i - 1}^n - q_{i - 2}^{n + 1}}}"/></p>
</div><p>Substituting the expression in Eq. <a class="reference internal" href="#equation-outflowboundaries4">(397)</a> into Eq.
<a class="reference internal" href="#equation-outflowboundaries3">(396)</a> gives the needed boundary value for <img class="math" src="_images/math/bba647ed9a45147b0ed725fcc8fb4e2fc0645f2c.png" alt="q_i^{n +
1}" style="vertical-align: -5px"/>. In order to use this expression, however, there are two limiting cases that
must be considered.</p>
<p>Because we are only interested in outgoing waves and want to suppress incoming
flow, the value of the non-dimensional phase speed <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> must not be
negative. Furthermore, computational stability requires that <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> be less
than or equal to unity. This completes the specification of the outflow boundary
condition: it is Eqs. <a class="reference internal" href="#equation-outflowboundaries3">(396)</a> and <a class="reference internal" href="#equation-outflowboundaries4">(397)</a> with
the restrictions given by</p>
<div class="math" id="equation-outflowboundaries5">
<p><span class="eqno">(398)<a class="headerlink" href="#equation-outflowboundaries5" title="Permalink to this equation">¶</a></span><img src="_images/math/118c9acd94f22aab43a5bc191850341deb488c0d.png" alt="0 \leq C \leq 1"/></p>
</div><p>Note that any Fourier wave with a component in the x-direction, and arbitrary
phase speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/>, is a solution of Eq. <a class="reference internal" href="#equation-outflowboundaries3">(396)</a> and
exhibits no damping.</p>
<span class="target" id="index-474"></span></div>
<div class="section" id="wave-absorbing-layer-sponge-layer-at-open-boundary">
<span id="spongelayerth"></span><span id="index-475"></span><h5>Wave-absorbing Layer (Sponge Layer) at Open Boundary<a class="headerlink" href="#wave-absorbing-layer-sponge-layer-at-open-boundary" title="Permalink to this headline">¶</a></h5>
<p>In general, there are two technique categories to reduce reflection of periodic wave at an open boundary:
the radiation boundary condition and the absorbing layer or sponge layer method. The radiation boundary condition
presented in the preceding section may not work effectively for nonlinear wave or dispersed wave situation
because it is theoretically based on linear wave assumption. Different from the radiation boundary condition,
the absorbing layer method uses a region with additional
damping to dissipate wave before it reaches the open boundary and gets reflected.
This region, called wave-absorbing layer or sponge layer,
starts somewhere in the downstream area of the computational domain and ends at the open boundary, as shown in the figure below.
The method is theoretically simple and works effectively in practice. It is found that the combination the sponge
layer with the radiation boundary condition behaves the best to minimize wave reflection from the open boundary.</p>
<div class="figure" id="id125">
<span id="spongelayerfigure"></span><a class="reference internal image-reference" href="_images/sponge-layer.png"><img alt="_images/sponge-layer.png" src="_images/sponge-layer.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 16: Sponge layer to absorb wave motion at open boundary</span></p>
</div>
<p>In the wave-absorbing layer, the Navier-Stokes equation is modified as</p>
<div class="math" id="equation-spongelayerequation">
<p><span class="eqno">(399)<a class="headerlink" href="#equation-spongelayerequation" title="Permalink to this equation">¶</a></span><img src="_images/math/849e6cc001afcf4d72c51bcf9d093578f916dae2.png" alt="\frac{\partial {\mathbf{U}}}{\partial t} + \mathbf{U} \cdot \nabla  \mathbf{U} = - \frac{1}{\rho} + \nabla \cdot \nabla (\nu \mathbf{U}) - c (\mathbf{U} - \mathbf{U}_{str})"/></p>
</div><p>The last term <img class="math" src="_images/math/603d54aeeecc75cea8baa11424dd2caccd658a91.png" alt="- c (\mathbf{U} - \mathbf{U}_{str})" style="vertical-align: -5px"/> at the right hand side of the equation is the artificial damping force to dissipate wave motion,</p>
<p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is the damping coefficient with unit of 1/time, and</li>
<li><img class="math" src="_images/math/06444ab5b6f774be0fe47963bc2428817a5567ec.png" alt="\mathbf{U}_{str}" style="vertical-align: -3px"/> is the background stream velocity.</li>
</ul>
<p>It is noted that the damping force is applied only to the wave motion while the background current is not affected.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, a wave-absorbing layer can be defined either directly at an open mesh block boundary with
outflow or continuative boundary condition or by a special geometry component called wave-absorbing
component. A wave-absorbing component is completely open to fluid flow but exerts the damping force to
wave motion.The damping coefficient can be a
constant inside the absorbing layer or increases linearly with the distance from the starting side of
the absorbing layer
in the downstream direction.  <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> is evaluated by</p>
<div class="math" id="equation-spongelayerdampingcoefficientequation">
<p><span class="eqno">(400)<a class="headerlink" href="#equation-spongelayerdampingcoefficientequation" title="Permalink to this equation">¶</a></span><img src="_images/math/1b50cdfe773473955deb7f09ae9e82fdd9267b23.png" alt="c = c_0 + s \cdot \frac{c_1-c_0} {d}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/df3cac5e0887fb66bb456c30659e38cf12901d4e.png" alt="c_0" style="vertical-align: -3px"/> and <img class="math" src="_images/math/4ce46ebb8cda4a0eb63424226362ec5685dd2d18.png" alt="c_1" style="vertical-align: -3px"/> are the damping coefficient at the starting and end sides of the sponge layer, respectively.</li>
<li><img class="math" src="_images/math/3e821331961a936174f714f67bb5669fca7b828b.png" alt="s" style="vertical-align: 0px"/> is the distance in the downstream direction and measured from a point at the starting side of the absorbing layer.</li>
<li><img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is the thickness of the sponge layer in downstream direction.</li>
</ul>
<p>It is found that a gradual increase of the damping coefficient in the downstream direction usually works better to reduce wave
reflection. The default values of <img class="math" src="_images/math/df3cac5e0887fb66bb456c30659e38cf12901d4e.png" alt="c_0" style="vertical-align: -3px"/> and <img class="math" src="_images/math/4ce46ebb8cda4a0eb63424226362ec5685dd2d18.png" alt="c_1" style="vertical-align: -3px"/> are 0.0 and 1.0 <img class="math" src="_images/math/41bc8842e7d7afa7c11b6d9befdf200a56fdb79b.png" alt="s^{-1}" style="vertical-align: 0px"/>, respectively.
The recommended value of <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> is one wavelength.</p>
<p>If <img class="math" src="_images/math/06444ab5b6f774be0fe47963bc2428817a5567ec.png" alt="\mathbf{U}_{str}" style="vertical-align: -3px"/> is not defined by users, it is calculated by the code by averaging the
mean fluid velocity of the sponge layer over a time scale that is either user-specified or
code-determined.  If determined by code, the time scale is equal to the period of the wave that is
simulated. It is divided into certain number of sub-time steps.
<img class="math" src="_images/math/06444ab5b6f774be0fe47963bc2428817a5567ec.png" alt="\mathbf{U}_{str}" style="vertical-align: -3px"/> is recalculated when time increases by one sub-time step. The time step of
flow computation must be smaller than the sub-time step for an accurate calculation of
<img class="math" src="_images/math/06444ab5b6f774be0fe47963bc2428817a5567ec.png" alt="\mathbf{U}_{str}" style="vertical-align: -3px"/> .  Since <img class="math" src="_images/math/06444ab5b6f774be0fe47963bc2428817a5567ec.png" alt="\mathbf{U}_{str}" style="vertical-align: -3px"/>   is updated during computation, it may
vary or fluctuate with time.</p>
<span class="target" id="index-476"></span></div>
<div class="section" id="periodic-linear-wave-generator">
<span id="periodiclinearwavegeneratorth"></span><span id="index-477"></span><h5>Periodic Linear Wave Generator<a class="headerlink" href="#periodic-linear-wave-generator" title="Permalink to this headline">¶</a></h5>
<p>A periodic, linear, surface wave can be generated at a mesh boundary. The
model is based on Airy’s linear wave theory <a class="reference internal" href="zbibliography.html#airy-1845" id="id82">[Air45]</a>. As shown in the
figure below, the linear wave is assumed to come from a flat bottom reservoir
into the computational domain. A linear wave is characterized by the wave
amplitude <img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/>, wavelength <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/>, angular frequency <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> and wave
number <img class="math" src="_images/math/390ec01b193bcc1f1d8b3731e826efea2bda5503.png" alt="k = 2\pi /\lambda" style="vertical-align: -5px"/>. A uniform current may also exist, and its
undisturbed velocity component in the wave propagation direction is <img class="math" src="_images/math/6ed7015aac7187b7e41401e98f980deff368ac65.png" alt="U =
{\rm{const}}" style="vertical-align: 0px"/>. For the equations in this section, a reference system (<em>x</em>,
<em>z</em>) is established with its origin fixed at the mean free surface, +x going
in the wave propagation direction and +z in the upward direction (when using
the code, users can place the coordinate origin at any location but +z must be
in the upward direction).</p>
<div class="figure" id="id126">
<span id="schematicdiagramlinearwaveflatbottomreservoir"></span><a class="reference internal image-reference" href="_images/linear-wave-from-flat-bottom-reservoir.png"><img alt="Schematic diagram showing a linear wave coming from a flat bottom reservoir on the left into the computational domain through the mesh boundary" src="_images/linear-wave-from-flat-bottom-reservoir.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 17: Schematic diagram showing a linear wave coming from a flat bottom reservoir
on the left into the computational domain through the mesh boundary</span></p>
</div>
<p>The linear wave theory is based on the following assumptions:</p>
<ul class="simple">
<li>fluid is incompressible, inviscid, irrational, two-dimensional flow;</li>
<li>the wave amplitude (<img class="math" src="_images/math/89ee6ff675182b6882c4204ed78d702d7466508f.png" alt="A" style="vertical-align: 0px"/>) is small compared to the mean water depth (<img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/>) and wavelength (<img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/>).</li>
</ul>
<p>With the above assumptions, the problem can be reduced to a linear potential
flow problem. Please refer to <a class="reference internal" href="zbibliography.html#lamb-1945" id="id83">[Lam45]</a> and <a class="reference internal" href="zbibliography.html#dean-dalrymple-1991" id="id84">[DD91]</a>
for more details. The free surface elevation <img class="math" src="_images/math/99f68e8b1324faa721392db340a01f44af853bc6.png" alt="\eta \left( {x,t} \right)" style="vertical-align: -5px"/>
measured in the vertical direction from mean water surface, the velocity
potential <img class="math" src="_images/math/644e6759c1b4248a43b782c15ec65dfc65ae2793.png" alt="\varphi (x,z,t)" style="vertical-align: -5px"/>, and velocity components in x and z directions
<img class="math" src="_images/math/341d581fd361e4f2299c6fe0762dc094b4469ed3.png" alt="u(x,z,t)" style="vertical-align: -5px"/> and <img class="math" src="_images/math/dea1ea9bbad43098b37e342aebc68b06edf9bdeb.png" alt="w(x,z,t)" style="vertical-align: -5px"/> are obtained as</p>
<div class="math" id="equation-periodiclinearwavegenerator1">
<p><span class="eqno">(401)<a class="headerlink" href="#equation-periodiclinearwavegenerator1" title="Permalink to this equation">¶</a></span><img src="_images/math/300c9f5bb329535c50e2227b066ae4919b400918.png" alt="\eta &amp;= A\,\cos (kx - \omega t + \phi ) \hfill \\
\\
\varphi (x,z,t) &amp;= xU + \frac{{A\omega \,\,\cosh [k(z + h)]\,\,\sin (kx - \omega t + \phi )}}{{k\,\sinh (kh)}} \hfill \\
\\
u(x,z,t) &amp;= U + \frac{{A\omega \,\,\cosh [k(z + h)]\,\,\cos (kx - \omega t + \phi )}}{{\sinh (kh)}} \hfill \\
\\
w(x,z,t) &amp;= \frac{{A\omega \,\,\sinh [k(z + h)]\,\,\sin (kx - \omega t + \phi )}}{{\sinh (kh)}} \hfill \\"/></p>
</div><p>where <img class="math" src="_images/math/43c39ebe6079883ede9bb3a94e9a1674af72de6e.png" alt="\phi" style="vertical-align: -4px"/> is the phase shift angle, <img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/> is time.</p>
<p>The dispersion equation in terms of wave speed <img class="math" src="_images/math/8d853f49f9dc4bb4c0efe1663427ab87d358656e.png" alt="c = \omega /k" style="vertical-align: -5px"/> is given by</p>
<div class="math" id="equation-periodiclinearwavegenerator2">
<p><span class="eqno">(402)<a class="headerlink" href="#equation-periodiclinearwavegenerator2" title="Permalink to this equation">¶</a></span><img src="_images/math/3dcbde544986bdbe4592c85f2f24b2aca8e7d7e5.png" alt="{(c - U)^2} = \frac{g}{k}\tanh (kh)"/></p>
</div><p>This relationship indicates that the wave frequency and wave length are not
independent but are related: Users can specify either wave frequency or wave
length; the other quantity is then calculated by the dispersion equation.</p>
<p>The linear wave theory assumes a flat bottom reservoir and this assumption is
required to generate the wave at the mesh boundary. Once the wave enters the
computational domain, the bottom surface no longer needs to be flat, and flow
can be inviscid, laminar or turbulent, in which case the wave may deviate from
the analytical solution given by the equations above. Since the full
Navier-Stokes equations are solved inside the domain, nonlinear effects may develop.</p>
<p>An irregular or random wave can also be simulated by defining multiple linear
wave components with different wave amplitudes, frequencies, and initial phases
at a mesh boundary. These wave components are superimposed at the boundary and
propagates into the domain to form the desired wave (irregular or random wave).</p>
<span class="target" id="index-478"></span></div>
<div class="section" id="stokes-wave-generator">
<span id="stokeswavegeneratorth"></span><span id="index-479"></span><h5>Stokes Wave Generator<a class="headerlink" href="#stokes-wave-generator" title="Permalink to this headline">¶</a></h5>
<p>A fifth-order Stokes wave can be generated at a mesh boundary. The model is
based on the fifth-order Stokes wave theory developed by Fenton <a class="reference internal" href="zbibliography.html#fenton-1985" id="id85">[Fen85]</a>.
Different from the linear (Airy) wave theory for <em>small</em>-amplitude progressive
surface waves, the Stokes wave theory is a nonlinear theory for
<em>limited</em>-amplitude progressive surface waves. It allows higher wave amplitude
than the linear wave theory.</p>
<div class="figure" id="id127">
<span id="stokeswavefromflatbottomreservoir"></span><a class="reference internal image-reference" href="_images/stokes-wave-from-flat-bottom-reservoir.png"><img alt="Stokes wave entering the left side of a computational domain from a reservoir with flat bottom." src="_images/stokes-wave-from-flat-bottom-reservoir.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 18: Stokes wave entering the left side of a computational domain from a reservoir
with flat bottom.</span></p>
</div>
<p>As shown in the figure above, a wave train is assumed to come from a flat
bottom reservoir into the computational domain through the mesh boundary. The
reference system (x, z) is established with its origin fixed at the bottom, +x
going in the wave propagation direction and +z in the upward direction (when
using the code, users can place the coordinate origin at any location but +z
must be in the upward direction). The wave is characterized by the wave height
<img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> (measured vertically from trough to peak), wavelength <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> and
wave period <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/>. The undisturbed water depth is <em>d=const</em>. Water
elevation <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> is time-dependent and measured along +z from the bottom to the
water surface. A current may exist and its x-component of undisturbed velocity
is <em>U=const</em>. The angular wave frequency <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> and the wave speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/>
are related to other parameters as</p>
<div class="math" id="equation-stokeswavegenerator1">
<p><span class="eqno">(403)<a class="headerlink" href="#equation-stokeswavegenerator1" title="Permalink to this equation">¶</a></span><img src="_images/math/62ae63420c95587651ceb9da563410992504c453.png" alt="\omega = \frac{{2\pi }}{T} = ck \quad \text{and} \quad c = \frac{\lambda }{T}"/></p>
</div><p>where <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/> is the wave number,</p>
<div class="math" id="equation-stokeswavegenerator2">
<p><span class="eqno">(404)<a class="headerlink" href="#equation-stokeswavegenerator2" title="Permalink to this equation">¶</a></span><img src="_images/math/678e301ea6d975edb089cac25e73256e769f841c.png" alt="k = \frac{2\pi }{\lambda}"/></p>
</div><p>The Stokes wave theory assumes potential flow, namely the fluid flow is
incompressible and irrotational. The stream function <img class="math" src="_images/math/22e7bbdc5bdeef74134a5feb0a44f7269c104e83.png" alt="\psi" style="vertical-align: -4px"/> thus exists and
satisfies the Laplace equation</p>
<div class="math" id="equation-stokeswavegenerator3">
<p><span class="eqno">(405)<a class="headerlink" href="#equation-stokeswavegenerator3" title="Permalink to this equation">¶</a></span><img src="_images/math/23e5dccdf5ff503289adc05b4235cddba7748cbc.png" alt="{\nabla ^2}\psi = 0"/></p>
</div><p>Fluid velocity components in x and z are given by</p>
<div class="math" id="equation-stokeswavegenerator4">
<p><span class="eqno">(406)<a class="headerlink" href="#equation-stokeswavegenerator4" title="Permalink to this equation">¶</a></span><img src="_images/math/257c8addf54d18226e9003e1285d41f51838179d.png" alt="u = \frac{{\partial \psi }}{{\partial x}} \quad \text{and} \quad v= - \frac{{\partial \psi }}{{\partial z}}"/></p>
</div><p>With the further assumption that a wave crest exists at x=0 at t=0, the Laplace
equation for <img class="math" src="_images/math/22e7bbdc5bdeef74134a5feb0a44f7269c104e83.png" alt="\psi" style="vertical-align: -4px"/>, along with its boundary conditions at the free surface and
the bottom, are solved using a perturbation method. The perturbation parameter
is the dimensionless wave amplitude <img class="math" src="_images/math/f4cc70d7e6eec024b44766f0eded068c9af2d354.png" alt="\varepsilon = {{kH} / 2}" style="vertical-align: -5px"/>, also known as the
wave steepness. The solution for the water elevation and velocity with
fifth-order accuracy with respect to <img class="math" src="_images/math/8d43774b9306502f07b6c7deaa6595cc0702fffd.png" alt="\varepsilon" style="vertical-align: 0px"/> is</p>
<div class="math" id="equation-stokeswavegenerator5">
<p><span class="eqno">(407)<a class="headerlink" href="#equation-stokeswavegenerator5" title="Permalink to this equation">¶</a></span><img src="_images/math/c3310aa16e0dc729f1388a0e0dc7ee2c796dea84.png" alt="\eta (x,t) = d + \frac{\varepsilon }{k}\cos kX + \frac{{{\varepsilon ^2}}}{k}{B_{22}}\cos 2kX + \frac{{{\varepsilon ^3}}}{k}{B_{31}}\left( {\cos kX - \cos 3kX} \right) \hfill \\
\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\, + \frac{{{\varepsilon ^4}}}{k}\left( {{B_{42}}\cos 2kX + {B_{44}}\cos 4kX} \right) + \,\, \hfill \\
\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\,\frac{{{\varepsilon ^5}}}{k}\left[ { - \left( {{B_{53}} + {B_{55}}} \right)\cos kX + {B_{53}}\cos 3kX + {B_{55}}\cos 5kX} \right]\,\,, \hfill \\
\\
u(x,z,t) = U + {C_0}{\left( {\frac{g}{{{k^3}}}} \right)^{1/2}}\sum\limits_{i = 1}^5 {{\varepsilon ^i}} \sum\limits_{j = 1}^i {{A_{ij}}jk\cosh jkz\cos jkX},\, \hfill \\
\\
w(x,z,t) = {C_0}{\left( {\frac{g}{{{k^3}}}} \right)^{1/2}}\sum\limits_{i = 1}^5 {{\varepsilon ^i}} \sum\limits_{j = 1}^i {{A_{ij}}jk\sinh jkz\sin jkX} \hfill \\"/></p>
</div><p>where <img class="math" src="_images/math/9ab1ef8e318430f35e818d5a3bb244a82f0387d5.png" alt="X = x - ct" style="vertical-align: 0px"/> and <img class="math" src="_images/math/4f700e8ff2a35bc86b30e1723ab4fda48f0e0868.png" alt="kX = kx - \omega \,t" style="vertical-align: 0px"/>. The coefficient
<img class="math" src="_images/math/0186e448465c8bbafee6e8541db7a9f7e476de03.png" alt="A_{ij}" style="vertical-align: -6px"/>, <img class="math" src="_images/math/f4d79d803d8c4609724aabaf1e74e087ba07e2ac.png" alt="B_{ij}" style="vertical-align: -6px"/> and <img class="math" src="_images/math/58a1e01c71cb9264c743fe9074e31feba5f4d812.png" alt="C_0" style="vertical-align: -3px"/> are nonlinear functions of
<img class="math" src="_images/math/d4ff2145732da2a514c719c78895790cb64aad02.png" alt="kd" style="vertical-align: 0px"/> and are presented in <a class="reference internal" href="zbibliography.html#fenton-1985" id="id86">[Fen85]</a>. It can be seen that the linear
wave theory is the first-order approximation of the Stokes theory. In other
words, the fifth-order Stokes theory is four-orders of <img class="math" src="_images/math/8d43774b9306502f07b6c7deaa6595cc0702fffd.png" alt="\varepsilon" style="vertical-align: 0px"/> higher in
accuracy than the linear wave theory.</p>
<p>The wave number and wave frequency are not independent parameters but satisfy
the nonlinear equation</p>
<div class="math" id="equation-stokeswavegenerator6">
<p><span class="eqno">(408)<a class="headerlink" href="#equation-stokeswavegenerator6" title="Permalink to this equation">¶</a></span><img src="_images/math/ecdb6481890d52a32f9d775d83c80f53d8ba8095.png" alt="{\left( {\frac{k}{g}} \right)^{1/2}}U - \frac{\omega }{{{{\left( {gk} \right)}^{1/2}}}} + {C_0} + {\left( {\frac{{kH}}{2}} \right)^2}{C_2} + {\left( {\frac{{kH}}{2}} \right)^4}{C_4} = 0"/></p>
</div><p>where <img class="math" src="_images/math/58a1e01c71cb9264c743fe9074e31feba5f4d812.png" alt="C_0" style="vertical-align: -3px"/>, <img class="math" src="_images/math/723abc3987a25d28ffee527ca8290b4b4fc58308.png" alt="C_2" style="vertical-align: -3px"/> and <img class="math" src="_images/math/1a2580b862ba49aab5692f2bf95deddaebbf0a1b.png" alt="C_4" style="vertical-align: -3px"/> are nonlinear functions of
<img class="math" src="_images/math/d4ff2145732da2a514c719c78895790cb64aad02.png" alt="kd" style="vertical-align: 0px"/> <a class="reference internal" href="zbibliography.html#fenton-1985" id="id87">[Fen85]</a>. It is found that the dispersion equation
for linear wave is the first-order approximation of this relation without
considering the last two terms at the left-hand side. As a result of this
relation, when generating wave at a mesh boundary, the users cannot provide both
wave length and wave period as input parameters at the same time. If a wave
length is given, then the wave period (or wave frequency) is obtained easily
from this equation. If wave period is known, instead, the wave length (or wave
number) is calculated from the above equation iteratively. The first
approximation of <img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/> used in the iterations is <a class="reference internal" href="zbibliography.html#fenton-1988" id="id88">[Fen88]</a>.</p>
<div class="math" id="equation-stokeswavegenerator7">
<p><span class="eqno">(409)<a class="headerlink" href="#equation-stokeswavegenerator7" title="Permalink to this equation">¶</a></span><img src="_images/math/450ac2327d1db32b2e679a5c3e69b9acb1d45294.png" alt="k = \frac{{\alpha + {\beta ^2}{\text{sec}}{{\text{h}}^{\text{2}}}\beta }}{{(\tanh \beta + \beta \,{\text{sec}}{{\text{h}}^{\text{2}}}\beta \,)d}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-stokeswavegenerator8">
<p><span class="eqno">(410)<a class="headerlink" href="#equation-stokeswavegenerator8" title="Permalink to this equation">¶</a></span><img src="_images/math/e4a16f41e66261d9decfd2b60be89ca12fd84318.png" alt="{\text{where}} \quad \alpha = {\omega ^2} d  / g
 \quad {\text{and}} \quad \beta = \alpha \sqrt {\coth \left(\alpha \right) } ."/></p>
</div><p>This theory is applicable to waves in both deep and shallow water, but
restrictions exist. The parameter <img class="math" src="_images/math/8d43774b9306502f07b6c7deaa6595cc0702fffd.png" alt="\varepsilon" style="vertical-align: 0px"/> must be a small number, namely
the wave’s steepness must be small. Furthermore, the theory cannot work for
waves that are long compared to the water depth. A reasonable upper limit for
the wave length is <img class="math" src="_images/math/cd49bb56204ac0c3235aaf9cd592661068a85fb7.png" alt="T{\left( {g / d} \right)}^{1/2} \approx {\lambda / d}
\approx 10" style="vertical-align: -5px"/> <a class="reference internal" href="zbibliography.html#fenton-1985" id="id89">[Fen85]</a>. Beyond this limit, other theories (e.g., Fenton’s
Fourier series method and McCowan’s solitary wave theory in the following
sections) should be used. Finally, this theory is not valid for breaking
waves. Users can also follow the figure below <a class="reference internal" href="zbibliography.html#lemehaute-1976" id="id90">[LeM76]</a>,
<a class="reference internal" href="zbibliography.html#usarmy-corps-of-eng-2006" id="id91">[USACoEngineers06]</a> for the applicability ranges for linear wave,
Stokes wave and other wave theories.</p>
<p>Waves in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> are generated at mesh boundaries. After entering the
computational domain, a wave may transform to any type of wave with or without
breaking. Once the wave enters the computational domain, the bottom no longer
needs to be flat, and flow can be inviscid, laminar or turbulent, in which
case the wave may deviate from the analytical solution given by the equations
above. The wave may also break inside the computational domain.</p>
<div class="figure" id="id128">
<span id="applicabilityrangesofvariouswavetheories"></span><a class="reference internal image-reference" href="_images/applicability-ranges-of-various-wave-theories.png"><img alt="Applicability ranges of various wave theories" src="_images/applicability-ranges-of-various-wave-theories.png" style="width: 4.1in;" /></a>
<p class="caption"><span class="caption-text">Figure 19: Applicability ranges of various wave theories</span></p>
</div>
<span class="target" id="index-480"></span></div>
<div class="section" id="stokes-and-cnoidal-waves-generator-fourier-series-method">
<span id="stokescnoidalwavesgeneratorth"></span><span id="index-481"></span><h5>Stokes and Cnoidal Waves Generator (Fourier Series Method)<a class="headerlink" href="#stokes-and-cnoidal-waves-generator-fourier-series-method" title="Permalink to this headline">¶</a></h5>
<p>Cnoidal wave is a nonlinear oscillatory wave in shallow water, which has
sharper crests and flatter troughs than a Stokes wave. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, it is
generated using Fenton’s Fourier series method <a class="reference internal" href="zbibliography.html#fenton-1999" id="id92">[Fen99]</a>. In fact, this
method is suitable for both Cnoidal and Stokes waves, and it provides
higher-order accuracy than Fenton’s fifth-order theory for Stokes waves. It is thus
the recommended generator for both Stokes and Cnoidal waves.</p>
<p>In this method, the problem is defined in the same way as the Stokes wave
problem in the preceding section. It is assumed that a steady-state wave train
exists in a flat-bottom reservoir outside the computational domain, and it
propagates into the computational domain through a mesh boundary (refer to the
<a class="reference internal" href="#stokeswavefromflatbottomreservoir"><span class="std std-ref">figure in the Stokes wave section</span></a>).
The wave profile and water velocity are obtained in the reservoir to provide
the boundary condition for a wave simulation.</p>
<p>Let <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/> and <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> represent the undisturbed water depth and the wave
height (measured vertically from wave trough to wave crest), respectively. A
stationary reference system (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>) is established in such a
way that its origin is fixed at the bottom, <img class="math" src="_images/math/94db0b74c6389ed9ec19e79fc2c326373f6acab6.png" alt="+x" style="vertical-align: -2px"/> goes horizontally in
the wave propagation direction, and <img class="math" src="_images/math/18e4e400cc2ce8da80a7358df7596c1d2f6b93f2.png" alt="+z" style="vertical-align: -2px"/> directs vertically upward (when
using the code, users can place the coordinate origin at any location but +z
must be in the upward direction). A current is assumed to exist and its
x-component <img class="math" src="_images/math/c8178738d3727b04dac1d59cbfcd05d75a6e6a09.png" alt="\bar u" style="vertical-align: 0px"/> is a constant. The wave speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> and the
angular wave frequency <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> are related to other parameters as</p>
<div class="math" id="equation-cnoidalwavesgenerator01">
<p><span class="eqno">(411)<a class="headerlink" href="#equation-cnoidalwavesgenerator01" title="Permalink to this equation">¶</a></span><img src="_images/math/504427765791d7d572ccb45b985e9c8402704270.png" alt="c = \frac{\lambda }{T}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-cnoidalwavesgenerator02">
<p><span class="eqno">(412)<a class="headerlink" href="#equation-cnoidalwavesgenerator02" title="Permalink to this equation">¶</a></span><img src="_images/math/d73bf1639674f629c4cde3a753421feef1e33d82.png" alt="\omega  = \frac{{2\pi }}{T} = ck"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> is the wavelength,</li>
<li><img class="math" src="_images/math/aa979d26cb76b1e0cea68bfa22eb7c087ac7d65d.png" alt="k" style="vertical-align: 0px"/> is the wave number, <img class="math" src="_images/math/ecbdc6c5c97f324493357b08c95c0cf0e000fbe0.png" alt="k = {{2\pi} / \lambda }" style="vertical-align: -5px"/>, and</li>
<li><img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is the wave period.</li>
</ul>
<p>In this problem, the given variables are <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/>, <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>, <img class="math" src="_images/math/c8178738d3727b04dac1d59cbfcd05d75a6e6a09.png" alt="\bar u" style="vertical-align: 0px"/>,
and <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> or <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> (<img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> and <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> are related to each other thus cannot
be given independently). A solution of the wave is obtained first in a moving
reference system (<img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/>, <img class="math" src="_images/math/4a905bfb7db822bf8dc85be4460c21708de2eb86.png" alt="Z" style="vertical-align: 0px"/>) that travels with the wave at speed
<img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> (note this solution is non-transient). A coordinate transformation is
then conducted to find the transient solution of the wave in the stationary
system (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>). The transformation equations are,</p>
<div class="math" id="equation-cnoidalwavesgenerator03">
<p><span class="eqno">(413)<a class="headerlink" href="#equation-cnoidalwavesgenerator03" title="Permalink to this equation">¶</a></span><img src="_images/math/b4575596b62e8ac5ae718a97785828cc5db01dad.png" alt="{\text {coordinates: }} \: x = X + ct {\text , } \quad Z = z"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-cnoidalwavesgenerator04">
<p><span class="eqno">(414)<a class="headerlink" href="#equation-cnoidalwavesgenerator04" title="Permalink to this equation">¶</a></span><img src="_images/math/c2f096290360993b130230b8cf9c2db8ba9e4bfb.png" alt="{\text {water velocity: }} \: u = U + c {\text , } \quad w = W"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> and <img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/> denote the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> components of water velocity in system (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>), respectively;</li>
<li><img class="math" src="_images/math/cc8525efbda543301dd00b825755d76dbcd84de7.png" alt="U" style="vertical-align: 0px"/> and <img class="math" src="_images/math/45211f792aabf6b50fe2d7c047f4bd830dc5fd90.png" alt="W" style="vertical-align: 0px"/> denote those in system (<img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/>, <img class="math" src="_images/math/4a905bfb7db822bf8dc85be4460c21708de2eb86.png" alt="Z" style="vertical-align: 0px"/>), respectively.</li>
</ul>
<p>For the water current, transformation of its x-velocities between the two systems is</p>
<div class="math" id="equation-cnoidalwavesgenerator05">
<p><span class="eqno">(415)<a class="headerlink" href="#equation-cnoidalwavesgenerator05" title="Permalink to this equation">¶</a></span><img src="_images/math/ddad623ae0ba6bf62227a575c197b6f1e83f25ff.png" alt="\bar u = \bar U + c"/></p>
</div><p>where <img class="math" src="_images/math/a7413a1cb2ab6c056b63f23e8b59f4b280f6ece9.png" alt="\bar U" style="vertical-align: 0px"/> is the x-velocity of the current in (<img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/4a905bfb7db822bf8dc85be4460c21708de2eb86.png" alt="Z" style="vertical-align: 0px"/>) system.</p>
<p>It is assumed that the flow is incompressible and irrotational. A stream function
<img class="math" src="_images/math/9c6c2cd50e1beadfb643287b9ce159b7265ff80d.png" alt="\psi (X,Z)" style="vertical-align: -5px"/> therefore exists in (<img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/>, <img class="math" src="_images/math/4a905bfb7db822bf8dc85be4460c21708de2eb86.png" alt="Z" style="vertical-align: 0px"/>) and satisfies
the Laplace equation,</p>
<div class="math" id="equation-cnoidalwavesgenerator06">
<p><span class="eqno">(416)<a class="headerlink" href="#equation-cnoidalwavesgenerator06" title="Permalink to this equation">¶</a></span><img src="_images/math/661877179b5029f8ba5cd7db8770269982d15024.png" alt="{\nabla ^2}\psi (X,Z) = 0"/></p>
</div><p><img class="math" src="_images/math/cc8525efbda543301dd00b825755d76dbcd84de7.png" alt="U" style="vertical-align: 0px"/> and <img class="math" src="_images/math/45211f792aabf6b50fe2d7c047f4bd830dc5fd90.png" alt="W" style="vertical-align: 0px"/> are related to <img class="math" src="_images/math/9c6c2cd50e1beadfb643287b9ce159b7265ff80d.png" alt="\psi (X,Z)" style="vertical-align: -5px"/> as</p>
<div class="math" id="equation-cnoidalwavesgenerator07">
<p><span class="eqno">(417)<a class="headerlink" href="#equation-cnoidalwavesgenerator07" title="Permalink to this equation">¶</a></span><img src="_images/math/87987185091a5e7d7a0cbdde1bbe3ec1d90a2e2d.png" alt="\psi (X,Z) {\text , } \quad W = - \frac{{\partial \psi }}{{\partial X}}"/></p>
</div><p>Two kinematic boundary conditions exist for equation
<a class="reference internal" href="#equation-cnoidalwavesgenerator06">(416)</a>,</p>
<div class="math" id="equation-cnoidalwavesgenerator08">
<p><span class="eqno">(418)<a class="headerlink" href="#equation-cnoidalwavesgenerator08" title="Permalink to this equation">¶</a></span><img src="_images/math/e119505831841cbfa3169582f17ed54986ddb158.png" alt="\psi (X,0) = 0 \quad {\text{at bottom}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-cnoidalwavesgenerator09">
<p><span class="eqno">(419)<a class="headerlink" href="#equation-cnoidalwavesgenerator09" title="Permalink to this equation">¶</a></span><img src="_images/math/471bd3bfce172a03878b0d69a6defbbce88863f3.png" alt="\psi (X,\eta (X)) = Q {\text{ (at free surface }} Z = \eta (X){\text{)}}"/></p>
</div><p>where <img class="math" src="_images/math/ffe9616beb8c7daa27d7ba6f96e0d38f980e3ef9.png" alt="Q" style="vertical-align: -4px"/> is the volume flow rate in <img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/> direction per unit length
in <img class="math" src="_images/math/2baf7cf7dc3371befb37812a8b64e9ea70d4c874.png" alt="Y" style="vertical-align: 0px"/>, <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> is water elevation measured from the bottom to the
water surface. The Bernoulli equation on the free surface provides the third
boundary condition, which is a dynamic boundary condition,</p>
<div class="math" id="equation-cnoidalwavesgenerator10">
<p><span class="eqno">(420)<a class="headerlink" href="#equation-cnoidalwavesgenerator10" title="Permalink to this equation">¶</a></span><img src="_images/math/e5ce19a10359b30367a1e04dbad5a481e048dd23.png" alt="\frac{1}{2}\left[ {{{\left( {\frac{{\partial \psi }}{{\partial X}}} \right)}^2} + {{\left( {\frac{{\partial \psi }}{{\partial Z}}} \right)}^2}} \right] + g\eta = R{\text{, (on free surface }}Z = \eta (X){\text{)}}"/></p>
</div><p>where <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> is a constant and <img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/> is the absolute value of the
gravitational acceleration.</p>
<p>Assuming further that <img class="math" src="_images/math/dad9ed2a3f4b1a87a44e234f1447e467bde39814.png" alt="X = 0" style="vertical-align: 0px"/> and <img class="math" src="_images/math/a78d659926faabb595f8f1311d191d128ce3242e.png" alt="X = \lambda /2" style="vertical-align: -5px"/> correspond to the
crest and trough of the wave, respectively, we use a Fourier series to represent
<img class="math" src="_images/math/9c6c2cd50e1beadfb643287b9ce159b7265ff80d.png" alt="\psi (X,Z)" style="vertical-align: -5px"/>,</p>
<div class="math" id="equation-cnoidalwavesgenerator11">
<p><span class="eqno">(421)<a class="headerlink" href="#equation-cnoidalwavesgenerator11" title="Permalink to this equation">¶</a></span><img src="_images/math/ea8f2a30c27f42875d11b48d450bcc2153a0ab8e.png" alt="\psi (X,Z) = \bar UZ + \sqrt {\frac{g}{{{k^3}}}} \sum\limits_{j = 1}^N {{B_j}\frac{{\sinh jkZ}}{{\cosh jkd}}\cos jkX}"/></p>
</div><p>where <img class="math" src="_images/math/2d07ab63c85c0671e63fcaf9e7db77d824cc4273.png" alt="{B_j}\left( {j = 1,2, \ldots N} \right)" style="vertical-align: -6px"/> are dimensionless
coefficients, <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> is a finite integer.</p>
<p>It is seen that Eq. <a class="reference internal" href="#equation-cnoidalwavesgenerator11">(421)</a> satisfies the Laplace equation
<a class="reference internal" href="#equation-cnoidalwavesgenerator06">(416)</a> and the boundary condition
<a class="reference internal" href="#equation-cnoidalwavesgenerator08">(418)</a> automatically. The other boundary conditions
<a class="reference internal" href="#equation-cnoidalwavesgenerator09">(419)</a> and <a class="reference internal" href="#equation-cnoidalwavesgenerator10">(420)</a> are used to find
<img class="math" src="_images/math/bc1843b472660339c723431e8db29de5093b497b.png" alt="B_j" style="vertical-align: -6px"/>. The truncation of the terms higher than <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/>-th order is the
only mathematical approximation.</p>
<p>The problem is solved numerically. Divide the wave from <img class="math" src="_images/math/dad9ed2a3f4b1a87a44e234f1447e467bde39814.png" alt="X = 0" style="vertical-align: 0px"/> to
<img class="math" src="_images/math/a78d659926faabb595f8f1311d191d128ce3242e.png" alt="X = \lambda /2" style="vertical-align: -5px"/> into <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> equal intervals, and let <img class="math" src="_images/math/a2f3da10027f2ebc331856f53987ab5904134cc3.png" alt="j = 1,2,
\ldots N+1" style="vertical-align: -4px"/> denote the discrete points. The <img class="math" src="_images/math/bef21c7bb1099e9b75b613525fd95501e947d98a.png" alt="X" style="vertical-align: 0px"/> coordinate of point
<img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/> is <img class="math" src="_images/math/46a6659a6d6656d13fd034fe8b94505c6458bb39.png" alt="{X_n} = {\left( {n-1} \right) \lambda}  / {\left( {2N} \right)}" style="vertical-align: -5px"/>, which
gives <img class="math" src="_images/math/b6981b520b7b1615ae3ebc40cf70337ca4d9a047.png" alt="k{X_n} = {{(n - 1)\pi }/N}" style="vertical-align: -5px"/>. At point <img class="math" src="_images/math/dc50b6bc4de97b0c974cd4ba9d5243ef3192864a.png" alt="n" style="vertical-align: 0px"/>, substitution
of Eq. <a class="reference internal" href="#equation-cnoidalwavesgenerator11">(421)</a> into <a class="reference internal" href="#equation-cnoidalwavesgenerator09">(419)</a> and
<a class="reference internal" href="#equation-cnoidalwavesgenerator10">(420)</a> yields</p>
<div class="math" id="equation-cnoidalwavesgenerator12">
<p><span class="eqno">(422)<a class="headerlink" href="#equation-cnoidalwavesgenerator12" title="Permalink to this equation">¶</a></span><img src="_images/math/c1f2d3fd9af511f52e2c00bae481f5a5e2246222.png" alt="\bar U\sqrt {k/g} \left({k \eta _n}\right) + \sum\limits_{j = 1}^N {{B_j}\frac{{\sinh jk{\eta _n}}}{{\cosh jkd}}\cos jk{X_n}}  - Q\sqrt {{k^3}/g} = 0"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-cnoidalwavesgenerator13">
<p><span class="eqno">(423)<a class="headerlink" href="#equation-cnoidalwavesgenerator13" title="Permalink to this equation">¶</a></span><img src="_images/math/871ce47a1a222bc45abf8bad5580e50f23d95902.png" alt="\begin{gathered}
\frac{1}{2}{\left( {U\sqrt {k/g} + \sum\limits_{j = 1}^N {j{B_j}\frac{{\cosh jk{\eta _n}}}{{\cosh jkd}}\cos jk{X_n}} } \right)^2} \hfill \\
+ \frac{1}{2}{\left( {\sum\limits_{j = 1}^N {j{B_j}\frac{{\sinh jk{\eta _n}}}{{\cosh jkd}}\sin jk{X_n}} } \right)^2} + k{\eta _n} - {Rk}/ g
 = 0 \hfill \end{gathered}"/></p>
</div><p>Going through all the <img class="math" src="_images/math/df07e88bb025c63f334b2812a6f53c929a538f65.png" alt="N+1" style="vertical-align: -2px"/> points, Eqs. <a class="reference internal" href="#equation-cnoidalwavesgenerator12">(422)</a>
and <a class="reference internal" href="#equation-cnoidalwavesgenerator13">(423)</a> provide <img class="math" src="_images/math/bbc4f9e3a764d5ef1bde8aa7d819a7fe9c563d4a.png" alt="2N+2" style="vertical-align: -2px"/> nonlinear equations for
<img class="math" src="_images/math/083611b1e20f9cb069afffaa8ae817de4ef90bf2.png" alt="2N+5" style="vertical-align: -2px"/> unknown dimensionless variables: <img class="math" src="_images/math/b6f461d906ad7c86225c6c2d85639f67735d5c39.png" alt="{k{\eta _n}}" style="vertical-align: -4px"/> for
<img class="math" src="_images/math/693684b9ae944868a9039f730603c862da3c36e3.png" alt="n = 1,2,{\text{ }} \ldots N+1" style="vertical-align: -4px"/>; <img class="math" src="_images/math/bc1843b472660339c723431e8db29de5093b497b.png" alt="B_j" style="vertical-align: -6px"/> for <img class="math" src="_images/math/24f556e1a7b3c241e0f6a0e0144d9b20a29de695.png" alt="j = 1,2, \ldots
N" style="vertical-align: -4px"/>; <img class="math" src="_images/math/85d1c17a5afec7c5b7dddfd1ad5f0d5418f5b4b6.png" alt="\bar U\sqrt {k/g}" style="vertical-align: -5px"/>; <img class="math" src="_images/math/d4ff2145732da2a514c719c78895790cb64aad02.png" alt="kd" style="vertical-align: 0px"/>; <img class="math" src="_images/math/f064d9fc87b90a5b4efb849f2593e2610f3bd15f.png" alt="Q\sqrt {{k^3}/g}" style="vertical-align: -5px"/>; and <img class="math" src="_images/math/7d17b781c4bf9c8ed7903b3dbd887adada4428f0.png" alt="{{Rk} /g}" style="vertical-align: -5px"/>.
Three more equations are available for closure
of the problem. The first one is the equation for mean water depth <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>
using the trapezoidal rule of integration:</p>
<div class="math" id="equation-cnoidalwavesgenerator14">
<p><span class="eqno">(424)<a class="headerlink" href="#equation-cnoidalwavesgenerator14" title="Permalink to this equation">¶</a></span><img src="_images/math/3dfcdd70b47f1139bcee7b3bcbdbcdf896db2a26.png" alt="\frac{1}{{2N}}\left( {k{\eta _1} + k{\eta _{N + 1}}} \right) + \frac{1}{N}\sum\limits_{n = 2}^N {k{\eta _n} - kd = 0}"/></p>
</div><p>The second one is for the relation between wave height <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> and water
elevation,</p>
<div class="math" id="equation-cnoidalwavesgenerator15">
<p><span class="eqno">(425)<a class="headerlink" href="#equation-cnoidalwavesgenerator15" title="Permalink to this equation">¶</a></span><img src="_images/math/9bcfa5d93893f5ec758c4489ec596bcbd33f207f.png" alt="k{\eta _1} - k{\eta _{N + 1}} - kd\frac{H}{d} = 0"/></p>
</div><p>If the wavelength <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> is known and period <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> unknown, the last one
is,</p>
<div class="math" id="equation-cnoidalwavesgenerator16">
<p><span class="eqno">(426)<a class="headerlink" href="#equation-cnoidalwavesgenerator16" title="Permalink to this equation">¶</a></span><img src="_images/math/f635a2361795ba159f808b789cfe63c6fe5305a0.png" alt="kd - 2\pi \frac{d}{\lambda } = 0 \quad {\text{ (if }} \lambda {\text { is known)}}"/></p>
</div><p>If the wave length <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> is unknown but <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/> is known, then equation
<a class="reference internal" href="#equation-cnoidalwavesgenerator16">(426)</a> cannot be used. Instead the following equation
obtained by combination of equations <a class="reference internal" href="#equation-cnoidalwavesgenerator01">(411)</a>,
<a class="reference internal" href="#equation-cnoidalwavesgenerator02">(412)</a> and <a class="reference internal" href="#equation-cnoidalwavesgenerator05">(415)</a> is used as the
last equation to close the problem,</p>
<div class="math" id="equation-cnoidalwavesgenerator17">
<p><span class="eqno">(427)<a class="headerlink" href="#equation-cnoidalwavesgenerator17" title="Permalink to this equation">¶</a></span><img src="_images/math/a04c686fecd1f0a74ff60ed6fb9e875ef8b3679d.png" alt="- \sqrt {kd} \bar U \sqrt {k/g} + kd \frac{{\bar u}}{{\sqrt {gd} }} - \frac{{2\pi }}{{T\sqrt {g/d} }} = 0
\quad {\text{ (if }} T {\text{ is known)}}"/></p>
</div><p>Note that equations <a class="reference internal" href="#equation-cnoidalwavesgenerator14">(424)</a> to
<a class="reference internal" href="#equation-cnoidalwavesgenerator17">(427)</a> are not simplified any further because <img class="math" src="_images/math/d4ff2145732da2a514c719c78895790cb64aad02.png" alt="kd" style="vertical-align: 0px"/>
and <img class="math" src="_images/math/b6f461d906ad7c86225c6c2d85639f67735d5c39.png" alt="{k{\eta _n}}" style="vertical-align: -4px"/> are treated as unknown variables in the numerical
solution.</p>
<p>In summary, the known variables are <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/>, <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>, <img class="math" src="_images/math/c8178738d3727b04dac1d59cbfcd05d75a6e6a09.png" alt="\bar u" style="vertical-align: 0px"/>, and
either <img class="math" src="_images/math/5941b8ddfa8ffbe89c234337752eea007f00ef41.png" alt="\lambda" style="vertical-align: -1px"/> or <img class="math" src="_images/math/3220cefb5db8f2913afbedb55591cb3437ae3113.png" alt="T" style="vertical-align: 0px"/>. There are totally <img class="math" src="_images/math/083611b1e20f9cb069afffaa8ae817de4ef90bf2.png" alt="2N+5" style="vertical-align: -2px"/> unknown
dimensionless variables and the same number of nonlinear equations, forming a
closed problem. The <img class="math" src="_images/math/083611b1e20f9cb069afffaa8ae817de4ef90bf2.png" alt="2N+5" style="vertical-align: -2px"/> unknown variables are: <img class="math" src="_images/math/b6f461d906ad7c86225c6c2d85639f67735d5c39.png" alt="{k{\eta _n}}" style="vertical-align: -4px"/>
(for <img class="math" src="_images/math/693684b9ae944868a9039f730603c862da3c36e3.png" alt="n = 1,2,{\text{ }} \ldots N+1" style="vertical-align: -4px"/>), <img class="math" src="_images/math/bc1843b472660339c723431e8db29de5093b497b.png" alt="B_j" style="vertical-align: -6px"/> (for j=1,2,…N),
<img class="math" src="_images/math/d764f3b452e7e59ee9f3ac2bc09cbd201b46bd84.png" alt="\bar U \sqrt {k/g}" style="vertical-align: -5px"/>, <img class="math" src="_images/math/d4ff2145732da2a514c719c78895790cb64aad02.png" alt="kd" style="vertical-align: 0px"/>, <img class="math" src="_images/math/f064d9fc87b90a5b4efb849f2593e2610f3bd15f.png" alt="Q\sqrt {{k^3}/g}" style="vertical-align: -5px"/>,
and <img class="math" src="_images/math/7d17b781c4bf9c8ed7903b3dbd887adada4428f0.png" alt="{{Rk} /g}" style="vertical-align: -5px"/>. If wave length is known, the <img class="math" src="_images/math/083611b1e20f9cb069afffaa8ae817de4ef90bf2.png" alt="2N+5" style="vertical-align: -2px"/>
equations are <a class="reference internal" href="#equation-cnoidalwavesgenerator12">(422)</a> to <a class="reference internal" href="#equation-cnoidalwavesgenerator16">(426)</a>.
If wave period is known instead, then the equations are
<a class="reference internal" href="#equation-cnoidalwavesgenerator12">(422)</a> to <a class="reference internal" href="#equation-cnoidalwavesgenerator15">(425)</a> plus
<a class="reference internal" href="#equation-cnoidalwavesgenerator17">(427)</a>.</p>
<p>The nonlinear equation system is iteratively solved using Newton’s method. Once
the unknown variables are obtained, the transient water velocity in the
stationary system (x, z) is calculated using the following equations, which are
derived from Eqs. <a class="reference internal" href="#equation-cnoidalwavesgenerator03">(413)</a>, <a class="reference internal" href="#equation-cnoidalwavesgenerator04">(414)</a>,
<a class="reference internal" href="#equation-cnoidalwavesgenerator07">(417)</a> and <a class="reference internal" href="#equation-cnoidalwavesgenerator11">(421)</a>,</p>
<div class="math" id="equation-cnoidalwavesgenerator18">
<p><span class="eqno">(428)<a class="headerlink" href="#equation-cnoidalwavesgenerator18" title="Permalink to this equation">¶</a></span><img src="_images/math/f31e05f5e32babe8a6686fc5e2410f913dacdb2c.png" alt="u(x,z,t) = \bar u + \sqrt {\frac{g}{k}} \sum\limits_{j = 1}^N {j{B_j}\frac{{\cosh jkz}}{{\cosh jkd}}\cos jk(x - ct)}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-cnoidalwavesgenerator19">
<p><span class="eqno">(429)<a class="headerlink" href="#equation-cnoidalwavesgenerator19" title="Permalink to this equation">¶</a></span><img src="_images/math/4b386bfd5b3a4c230a991689711885c94537051f.png" alt="w(x,z,t) = \sqrt {\frac{g}{k}} \sum\limits_{j = 1}^N {j{B_j}\frac{{\sinh jkz}}{{\cosh jkd}}\sin jk(x - ct)}"/></p>
</div><p>Water elevation <img class="math" src="_images/math/481b038200ba21e0b319856681bf7208ff746f04.png" alt="\eta (x,t)" style="vertical-align: -5px"/> is calculated using the Fourier
transformation,</p>
<div class="math" id="equation-cnoidalwavesgenerator20">
<p><span class="eqno">(430)<a class="headerlink" href="#equation-cnoidalwavesgenerator20" title="Permalink to this equation">¶</a></span><img src="_images/math/86ddf015bba47d6d08b5a979e54819043a061078.png" alt="\eta (x,t) = \frac{{{E_1}}}{2} + \sum\limits_{j = 2}^{N + 1} {{E_j}\cos \,\left[ {(j - 1)k(x - ct)} \right]}"/></p>
</div><p>where <img class="math" src="_images/math/9f82ffa2e79f68ff86d311aa7e290c53140eaa79.png" alt="E_j" style="vertical-align: -6px"/> is calculated by numerical integration,</p>
<div class="math" id="equation-cnoidalwavesgenerator21">
<p><span class="eqno">(431)<a class="headerlink" href="#equation-cnoidalwavesgenerator21" title="Permalink to this equation">¶</a></span><img src="_images/math/9c169b9aeefbad6ed32eb52cbc57dc19e2a4a16d.png" alt="E_j = \frac{2}{N} \sum\limits_{n = 1}^{N + 1} &quot;\,\eta_n \cos \frac{(j-1)(n-1)\pi}{N} \quad {\text{ (for }} j=1,\,2,\,...,\,N+1 {\text{)}}"/></p>
</div><p><img class="math" src="_images/math/eecac9c4ffe9571b46215c4ae39bdf35327d021b.png" alt="\sum &quot;" style="vertical-align: -5px"/> represents a trapezoidal-type summation with factors of
<img class="math" src="_images/math/382986b563c4866b877e4543475de9da0be442dc.png" alt="\frac {1}{2}" style="vertical-align: -6px"/> multiplying the first and the last terms.</p>
<span class="target" id="index-482"></span></div>
<div class="section" id="solitary-wave-generator">
<span id="solitarywavesgeneratorth"></span><span id="index-483"></span><h5>Solitary Wave Generator<a class="headerlink" href="#solitary-wave-generator" title="Permalink to this headline">¶</a></h5>
<blockquote id="solitarywavegenerator">
<div><img alt="Add alternative text" src="_images/solitary-wave-generator.png" />
</div></blockquote>
<p>Solitary wave is a nonlinear non-oscillatory wave. It has a single crest and
no trough and is completely above the undisturbed water level. A shoaling
Cnoidal wave can be approximately treated as a solitary wave as the crests
becomes sharper and shorter while the troughs are flatter and longer. A
tsunami wave caused by an earthquake or a large-scale landslide is often
described by a solitary wave. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, the solitary wave solution is based on
McCowan’s theory <a class="reference internal" href="zbibliography.html#mccowan-1891" id="id93">[McCowan91]</a>. It has a higher order accuracy than
Boussinesq’s theory <a class="reference internal" href="zbibliography.html#boussinesq-1871" id="id94">[Bou71]</a> and is recommended by Munk
<a class="reference internal" href="zbibliography.html#munk-1949" id="id95">[Mun49]</a> after detailed examinations.</p>
<p>Similarly to other nonlinear waves in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, it is assumed that the solitary
wave exists in a flat bottom reservoir and propagates into the computational
domain through the mesh boundary. The undisturbed water depth of the reservoir
is a constant, <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>. The wave height is <img class="math" src="_images/math/817712962c15ea8a6612607ea77981092eb5361c.png" alt="H" style="vertical-align: 0px"/> (measured vertically
from undisturbed water surface to crest). A reference system (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>,
<img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>) is established with its origin fixed at the bottom, <img class="math" src="_images/math/94db0b74c6389ed9ec19e79fc2c326373f6acab6.png" alt="+x" style="vertical-align: -2px"/>
going horizontally in the wave propagation direction and <img class="math" src="_images/math/18e4e400cc2ce8da80a7358df7596c1d2f6b93f2.png" alt="+z" style="vertical-align: -2px"/> directing
vertically upward (when using the code, users can place the coordinate origin
at any location but +z must be in the upward direction). A current may exist
and its x-component of undisturbed velocity is a constant <img class="math" src="_images/math/c8178738d3727b04dac1d59cbfcd05d75a6e6a09.png" alt="\bar u" style="vertical-align: 0px"/>.
Equations for water elevation <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/>, x-velocity <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/>, z-velocity
<img class="math" src="_images/math/63b261498f1ce77b5d3bb714fc972594cf790948.png" alt="w" style="vertical-align: 0px"/>, and wave speed <img class="math" src="_images/math/0eb5e361bb43732fc188aa3fcfa15e874464e4ed.png" alt="c" style="vertical-align: 0px"/> are <a class="reference internal" href="zbibliography.html#munk-1949" id="id96">[Mun49]</a></p>
<div class="math" id="equation-solitarywavegenerator01">
<p><span class="eqno">(432)<a class="headerlink" href="#equation-solitarywavegenerator01" title="Permalink to this equation">¶</a></span><img src="_images/math/fbc4c3c3de7634f93b556d602bec84e809b0b9e9.png" alt="\frac{\eta }{d} = \frac{N}{M}\frac{{\sin \left[ {M\left( {1 + \frac{\eta }{d}} \right)} \right]}}{{\cos \left[ {M\left( {1 + \frac{\eta }{d}} \right)} \right] + \cosh \left( {M\frac{X}{d}} \right)}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-solitarywavegenerator02">
<p><span class="eqno">(433)<a class="headerlink" href="#equation-solitarywavegenerator02" title="Permalink to this equation">¶</a></span><img src="_images/math/a4c2c96dfc964b4358fd94d43b1143f8dd8015bf.png" alt="\frac{{u\left( {x,z,t} \right) - \bar u}}{{{c_0}}} = N\frac{{1 + \cos \left( {\frac{{Mz}}{d}} \right)\cosh \left( {\frac{{MX}}{d}} \right)}}{{{{\left[ {\cos \left( {\frac{{Mz}}{d}} \right) + \cosh \left( {\frac{{MX}}{d}} \right)} \right]}^2}}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-solitarywavegenerator03">
<p><span class="eqno">(434)<a class="headerlink" href="#equation-solitarywavegenerator03" title="Permalink to this equation">¶</a></span><img src="_images/math/5bb92725cba25baf4c58f2241816fad2621c5c20.png" alt="\frac{{w\left( {x,z,t} \right)}}{{{c_0}}} = N\frac{{\sin \left( {\frac{{Mz}}{d}} \right)\sinh \left( {\frac{{MX}}{d}} \right)}}{{{{\left[ {\cos \left( {\frac{{Mz}}{d}} \right) + \cosh \left( {\frac{{MX}}{d}} \right)} \right]}^2}}}"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-solitarywavegenerator04">
<p><span class="eqno">(435)<a class="headerlink" href="#equation-solitarywavegenerator04" title="Permalink to this equation">¶</a></span><img src="_images/math/66e514fdbfe5bd342b0e2b2dc7557a27d9fe58db.png" alt="c = \bar u + {c_0}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/cddef4040d13dd4ca5f819f093f4c8a56fbdb9fb.png" alt="{c_0} = \sqrt {g\left( {d + H} \right)}" style="vertical-align: -5px"/> is wave speed in still water,</li>
<li><img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/> is the absolute value of gravitational acceleration,</li>
<li><img class="math" src="_images/math/9ab1ef8e318430f35e818d5a3bb244a82f0387d5.png" alt="X = x - ct" style="vertical-align: 0px"/>,</li>
<li><img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/> is time,</li>
<li><img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> and <cite>N</cite> satisfy</li>
</ul>
<div class="math" id="equation-solitarywavegenerator05">
<p><span class="eqno">(436)<a class="headerlink" href="#equation-solitarywavegenerator05" title="Permalink to this equation">¶</a></span><img src="_images/math/716d666e49e8ebea03797fd2c0ae8e64372ceb09.png" alt="\varepsilon = \frac{N}{M}{\text{tan}}\left[ {\frac{1}{2}M\left( {1 + \varepsilon } \right)} \right]"/></p>
</div><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="math" id="equation-solitarywavegenerator06">
<p><span class="eqno">(437)<a class="headerlink" href="#equation-solitarywavegenerator06" title="Permalink to this equation">¶</a></span><img src="_images/math/b4a4bba4d2effa08efa51fc9eef38598080e1ac7.png" alt="N = \frac{2}{3}{\text{si}}{{\text{n}}^2}\left[ {M\left( {1 + \frac{2}{3}\varepsilon } \right)} \right]"/></p>
</div><ul class="simple">
<li><img class="math" src="_images/math/a426dd62a09df8f3c4459f9538050dae36f02e56.png" alt="\varepsilon = H/d" style="vertical-align: -5px"/>.</li>
</ul>
<p>Equations <a class="reference internal" href="#equation-solitarywavegenerator01">(432)</a> to <a class="reference internal" href="#equation-solitarywavegenerator06">(437)</a> are
nonlinear and are solved using Newton-Raphson method. The initial estimates of
<img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> and <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> are <img class="math" src="_images/math/9e0c5c6b0b61e6df0fe9ddab54eeeefec320a47b.png" alt="M = \sqrt {3\varepsilon }" style="vertical-align: -3px"/> and <img class="math" src="_images/math/2aa220849acecfd241a74f9282880218dbcbc61b.png" alt="N =
2\varepsilon" style="vertical-align: 0px"/>. The initial estimate of <img class="math" src="_images/math/c3b40ca7a85ef8b0c3be0aeca73572407422e4a5.png" alt="\eta" style="vertical-align: -4px"/> is from Boussinesq’s solution for
solitary wave <a class="reference internal" href="zbibliography.html#boussinesq-1871" id="id97">[Bou71]</a>,</p>
<div class="math" id="equation-solitarywavegenerator07">
<p><span class="eqno">(438)<a class="headerlink" href="#equation-solitarywavegenerator07" title="Permalink to this equation">¶</a></span><img src="_images/math/a1a01bd560b1be3baca90b5c76c0b045f5e160ba.png" alt="\frac{\eta }{d} = \varepsilon {\text{sec}}{{\text{h}}^2}\left( {\sqrt {\frac{{3\varepsilon }}{4}} \frac{X}{d}} \right) \qquad {\text {(initial estimate)}}"/></p>
</div><span class="target" id="index-484"></span></div>
<div class="section" id="random-wave">
<span id="randomwavesgeneratorth"></span><span id="index-485"></span><h5>Random Wave<a class="headerlink" href="#random-wave" title="Permalink to this headline">¶</a></h5>
<p>A Random wave is treated as a superposition of many linear component waves of
different amplitudes, periods and initial phases. In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, these component
waves exist in a flat-bottom reservoir and propagate simultaneously into the
computational domain through the mesh boundary. Their water elevations and
velocities at the mesh boundary are summed up respectively to obtain the
boundary condition for the random wave simulation. For example, water elevation
of the random wave is expressed as</p>
<div class="math" id="equation-randomwave01">
<p><span class="eqno">(439)<a class="headerlink" href="#equation-randomwave01" title="Permalink to this equation">¶</a></span><img src="_images/math/22995ce41d1339b8193e48de82ff888e917e7e93.png" alt="\eta = \mathop \sum \limits_{j = 1}^N {a_j}\cos \left( {{k_j}x - {\omega _j}t + {\varphi _j}} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> is the total number of linear component waves;</li>
<li><img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/> is time;</li>
<li><img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> is coordinate in the wave propagation direction;</li>
<li><img class="math" src="_images/math/f155e0cffbcd56a885a0504a6ac77ce124a13e7e.png" alt="a_j" style="vertical-align: -6px"/> is wave amplitude;</li>
<li><img class="math" src="_images/math/5e6889753d8b19a2289ff1899f1b384047c91dc9.png" alt="\omega _j" style="vertical-align: -6px"/> is angular frequency,</li>
<li><img class="math" src="_images/math/052215d5912d64d963a1f59ee964d96ac9abf419.png" alt="k_j" style="vertical-align: -6px"/> is wavelength,</li>
<li><img class="math" src="_images/math/b9eed2649824d2332f90f7957cd5558d6214f4f9.png" alt="\varphi _j" style="vertical-align: -6px"/> is initial phase, and</li>
<li>subscript <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/> represents the <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>-th component wave.</li>
</ul>
<p>Wave energy spectrum <img class="math" src="_images/math/ced8deeb5b0a50a9be62aeb7d12a762f314bc503.png" alt="E(\omega )" style="vertical-align: -5px"/> is used to calculate parameters of the
component waves. Divide the range of the angular frequency <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> equally into
<img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> intervals, each of which represents a linear wave component. The
mid-point value of <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> in the <img class="math" src="_images/math/a1e091236d8d55ca4607703c4e3573307cdaff56.png" alt="j" style="vertical-align: -4px"/>-th interval is used as <img class="math" src="_images/math/418c8ec46f44f6e12217a8fef447c002f5489f50.png" alt="\omega
_j" style="vertical-align: -6px"/>. <img class="math" src="_images/math/f155e0cffbcd56a885a0504a6ac77ce124a13e7e.png" alt="a_j" style="vertical-align: -6px"/> is calculated by</p>
<div class="math" id="equation-randomwave02">
<p><span class="eqno">(440)<a class="headerlink" href="#equation-randomwave02" title="Permalink to this equation">¶</a></span><img src="_images/math/3982f96ae5ea3b48d47c43e4999a2f1a6e31e578.png" alt="{a_j} = \sqrt {2E\left( {{\omega _j}} \right)\Delta \omega } \qquad \left( {j = 1,2, \ldots N} \right)"/></p>
</div><p>where <img class="math" src="_images/math/fd5e77cf2b95fc9867bab0c6e7946e0aa0edad3a.png" alt="\Delta \omega" style="vertical-align: 0px"/> is the <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> interval. Since the component
waves are linear, <img class="math" src="_images/math/052215d5912d64d963a1f59ee964d96ac9abf419.png" alt="k_j" style="vertical-align: -6px"/> is a function of <img class="math" src="_images/math/b9eed2649824d2332f90f7957cd5558d6214f4f9.png" alt="\varphi _j" style="vertical-align: -6px"/> and water
depth and is calculated using the dispersion equation for linear wave.
<img class="math" src="_images/math/b9eed2649824d2332f90f7957cd5558d6214f4f9.png" alt="\varphi _j" style="vertical-align: -6px"/> is a real number randomly selected between 0 and 2<img class="math" src="_images/math/c4af1691ed83a8e3de5f44b73aa2743be75dc2ae.png" alt="\pi" style="vertical-align: 0px"/>.</p>
<p>In <span class="raw-html"><strong><em>FLOW-3D </em></strong></span>, 1000 linear component waves are considered for a random wave
simulation (i.e., N=1000). The range of <img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> is selected with its low and
high limits corresponding to 50s and 0.5s wave periods, respectively.
Pierson-Moskowitz (P-M) spectrum <a class="reference internal" href="zbibliography.html#pierson-moskowitz-1964" id="id98">[PM64]</a> and JONSWAP spectrum
<a class="reference internal" href="zbibliography.html#hasselmann-et-al-1973" id="id99">[HBB+73]</a> are built into the solution. Users can select either
of them or define their own wave energy spectrum using an external data file.</p>
<ol class="arabic">
<li><p class="first">Pierson-Moskowitz (P-M) spectrum</p>
<p>The P-M spectrum <a class="reference internal" href="zbibliography.html#pierson-moskowitz-1964" id="id100">[PM64]</a> is for fully developed sea (wave energy is balanced
between increase from wind and loss to turbulence). It requires that the
fetch length, which is the length of the sea surface where wind blows, is
sufficiently large and the wind duration is sufficiently long. The only
parameter in the P-M spectrum is the wind speed. The P-M spectrum is</p>
<div class="math" id="equation-randomwave03">
<p><span class="eqno">(441)<a class="headerlink" href="#equation-randomwave03" title="Permalink to this equation">¶</a></span><img src="_images/math/8ae0d5ff1964cb1d098f089f7fe79d0597e3927c.png" alt="E\left( \omega  \right) = \frac{{\alpha {g^2}}}{{{\omega ^5}}}exp\left[ { - \frac{5}{4}{{\left( {\frac{{{\omega _p}}}{\omega }} \right)}^4}} \right]"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/5621b094bad1454f0dcd88c9de40d7067af05569.png" alt="{\omega _p} = \frac{{0.855g}}{{{U_{10}}}}" style="vertical-align: -8px"/> is the angular frequency at the spectrum peak;</li>
<li><img class="math" src="_images/math/ec11abd073ac1d9e3c269d1cd6e73fae41cc6d17.png" alt="U_{10}" style="vertical-align: -3px"/> is the wind speed 10m above the mean sea level;</li>
<li><img class="math" src="_images/math/580dc479e838461857f32b7b6a38cf528e717f09.png" alt="g" style="vertical-align: -4px"/> is the gravitational acceleration;</li>
<li><img class="math" src="_images/math/b68f059c884f0fcdd3a4a34f0106464936d4d4ac.png" alt="\alpha = 0.0081" style="vertical-align: 0px"/> is a scaling parameter.</li>
</ul>
</li>
<li><p class="first">JONSWAP spectrum</p>
<p>The JONSWAP spectrum is for fetch-limited sea. It was developed by the Joint
North Sea Wave Project <a class="reference internal" href="zbibliography.html#hasselmann-et-al-1973" id="id101">[HBB+73]</a>. Its expression is</p>
<div class="math" id="equation-randomwave04">
<p><span class="eqno">(442)<a class="headerlink" href="#equation-randomwave04" title="Permalink to this equation">¶</a></span><img src="_images/math/497505eb4449c132b337eab6fd54ad3f2597ba82.png" alt="E\left( \omega \right) = \frac{{\alpha {g^2}}}{{{\omega ^5}}}\exp\left[ { - \frac{5}{4}{{\left( {\frac{{{\omega _p}}}{\omega }} \right)}^4}} \right]{\gamma ^{\exp\left[ { - \frac{{{{\left( {\omega - {\omega _P}} \right)}^2}}}{{2{\sigma ^2}\omega _P^2}}} \right]}}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/cf7185bc5e07577c9b71dd9e075ef2dd7d8ca188.png" alt="{\omega _p} = 22{\left[ {\frac{{{g^2}}}{{{U_{10}}F}}} \right]^{1/3}}" style="vertical-align: -12px"/>;</li>
<li><img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is the fetch length;</li>
<li><img class="math" src="_images/math/ae7d9476e1b36e405275bd275a3000241d18352f.png" alt="\alpha = 0.076{\left[ {\frac{{U_{10}^2}}{{Fg}}} \right]^{0.22}}" style="vertical-align: -12px"/>;</li>
<li><img class="math" src="_images/math/0a9c286987ad5fd2f65853d796ca3f4366ae29ec.png" alt="\gamma" style="vertical-align: -4px"/> is the peak enhancement factor,</li>
<li><img class="math" src="_images/math/0ba4be214d64258d3c375efe4f0966bc9432b9dd.png" alt="1 \leq \gamma \leq 7" style="vertical-align: -4px"/>, and typically</li>
<li><img class="math" src="_images/math/95e478ba01c7a74575d01111cc8080bd5e87cc23.png" alt="\gamma = 3.3" style="vertical-align: -4px"/>;</li>
<li><img class="math" src="_images/math/2591b2d3af10be8e5ff6807202729c1687ab2090.png" alt="\sigma = 0.07" style="vertical-align: 0px"/> for <img class="math" src="_images/math/20406538c5266a0761e4a9a7f015bb4c3cfcea44.png" alt="\omega \leq \omega _p" style="vertical-align: -6px"/>, and</li>
<li><img class="math" src="_images/math/0de0768a2a02cd9472a0b3345ca79d8eb423f22f.png" alt="\sigma = 0.09" style="vertical-align: 0px"/> for <img class="math" src="_images/math/8dbe5d10d49f39969dfcf1615035b1eb52c577ac.png" alt="\omega \geq \omega _p" style="vertical-align: -6px"/>.</li>
</ul>
</li>
</ol>
<span class="target" id="index-486"></span></div>
<div class="section" id="rating-curve-and-natural-inlet-boundary">
<span id="ratingcurvenaturalinlet"></span><span id="index-487"></span><h5>Rating Curve and Natural Inlet Boundary<a class="headerlink" href="#rating-curve-and-natural-inlet-boundary" title="Permalink to this headline">¶</a></h5>
<p>Rating curve is the relation between fluid elevation and water volume flow rate at a cross section of a river.
A user-provided rating curve can be applied to a volume flow rate boundary or a pressure boundary to specify
water elevation corresponding to the provided or calculated volume flow rate. For example, in a flood wave
simulation, a rating curve can be used to determine the upstream water elevation based on the time-dependent
water discharge. The figures below shows an example of volume flow rate vs time (left figure) and rating curve (right figure).</p>
<div class="figure align-center" id="id129">
<span id="ratingcurvesample"></span><a class="reference internal image-reference" href="_images/Rating_curve.png"><img alt="Computational cell showing locations of components of strain rate tensor" src="_images/Rating_curve.png" style="width: 6in;" /></a>
<p class="caption"><span class="caption-text">Figure 20: An example of volume flow rate vs time (left figure) and rating curve (right figure)</span></p>
</div>
<p>If at an inlet boundary the volume flow rate (either constant or time-dependent) is given but the rating curve is
unknown, then a natural inlet algorithm can be employed to evaluate water elevation, and such a boundary is a natural
inlet boundary. In such a case, water depth in each boundary cell is set the same as that in the immediate downstream
interior cell. This is to make sure there is no significant jump of water elevation near the inlet boundary. The flow
categories at the boundary can be chosen as subcritical flow, supercritical flow, critical flow or unknown.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="model-reference.html#rating-curves"><span class="std std-ref">Rating curve</span></a> section in the <a class="reference internal" href="model-reference.html"><span class="doc">Model Reference</span></a> chapter.</li>
<li><a class="reference internal" href="model-reference.html#natural-inlets"><span class="std std-ref">Natural inlet</span></a> section in the <a class="reference internal" href="model-reference.html"><span class="doc">Model Reference</span></a> chapter.</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="stability-considerations">
<span id="stabilityconsiderationsth"></span><span id="index-488"></span><h3>Stability Considerations<a class="headerlink" href="#stability-considerations" title="Permalink to this headline">¶</a></h3>
<p>There are several restrictions on time-step size in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> that must be observed
to avoid numerical instabilities. If the user requests the automatic time-step
selection in the input data, the code will adjust the time step to be as large
as possible without violating stability conditions or exceeding the
user-supplied maximum time-step size. Time-step size will also be reduced when
pressure and/or temperature iterations exceed corresponding nominal values that
depend on the iteration options. Generally, the time step will float up or down
with 5% changes per cycle unless a stability condition is violated, in which
case a larger reduction may occur. It is recommended that the automatic
time-step option be used whenever possible to achieve optimum results.</p>
<p>The time-step size can also be changed, even if a constant value has been
requested, when the fluid fraction advection exceeds an amount equal to twice
the volume of the cell times the stability factor <img class="math" src="_images/math/8f2620146652ffe778758f644e78fc2d754a6252.png" alt="{\rm{CON}}" style="vertical-align: 0px"/> (or 0.85
times the volume of the cell if this is smaller). In this case the solution is
returned to its state at the beginning of the cycle before continuing, and the
cycle is repeated with the time step cut in half.</p>
<p>If the user disables the automatic time-step control, then he must select time
steps to satisfy the following criteria. First, fluid must not be permitted to
flow across more than one computational cell in one time step. This advective
transport depends not only on the velocity but also on the fractional
area/volume open to flow. The basic stability condition is</p>
<div class="math" id="equation-stabilityconsiderations1">
<p><span class="eqno">(443)<a class="headerlink" href="#equation-stabilityconsiderations1" title="Permalink to this equation">¶</a></span><img src="_images/math/27bf4c24a8e6ac26fcd5d26765197613559e4d4c.png" alt="\delta t &lt; {\rm{CON}} \cdot \min \left( {\frac{{{V_F}\delta {x_i}}}{{{A_x}u}},{\text{ }}\frac{{{V_F}\delta {y_j}}}{{{R_i}{A_y}v}},{\text{ }}\frac{{{V_F}\delta {z_k}}}{{{A_z}w}}} \right)"/></p>
</div><p>where (<em>u</em>, <em>v</em>, <em>w</em>) are velocity magnitudes and a factor of
<img class="math" src="_images/math/d38591c6336c11bbb4646c69910d7eb1e86488ce.png" alt="{\rm{CON}} = 0.45" style="vertical-align: 0px"/> is typically used to account for “worst case”
situations suggested by a simplified stability analysis. For compressible flow
applications, the <img class="math" src="_images/math/8f2620146652ffe778758f644e78fc2d754a6252.png" alt="{\rm{CON}}" style="vertical-align: 0px"/> factor is decreased to 0.25.</p>
<p>A cell with a large open face area and a small volume could restrict the time
step to small values if there is significant flow in this cell. Should this
happen, and it can be determined by monitoring the mesh locations controlling
the time step as printed in the output file, it may be necessary to modify the
mesh/obstacle arrangement. An algorithm to automatically adjust these ratios by
making small “errors” in all volumes is available. A value of <a class="reference internal" href="input-variable-summary-units.html#componentgeneralparameters"><span class="std std-ref">AVRCK</span></a>
no larger than 2.0 is recommended, <em>e.g.</em>, <span class="target" id="index-489"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">AVRCK</span></code> = 5.0 or 3.1.</p>
<p>A stability condition is also associated with the setting of pressure at free surfaces in one-fluid flows. Free surface pressure
is calculated from the position of the free surface within a cell and the body force, e.g., gravity. It is implemented
in an explicit fashion, that is, pressure at free surface is kept constant during a time step. The time step size stability
condition is associated with the propagation of surface waves. If an acceleration <img class="math" src="_images/math/fe0b8224cb971a4fc314c5797164574c3f2e4d06.png" alt="{\rm{G}}" style="vertical-align: 0px"/> is applied to
the fluid in the direction normal to the free surface, there can be surface waves
with speeds of order <img class="math" src="_images/math/564d511342bede7393210b5afcd690833134bd33.png" alt="\sqrt {{\rm{G}} h}" style="vertical-align: -2px"/> where <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> is the depth
of fluid or the length of the wave. In practice, the larger of the cell sizes in the normal
direction, <img class="math" src="_images/math/475bf7beb1bd461afa3a9e058687eeda5f9a0222.png" alt="\delta {z}" style="vertical-align: 0px"/>, and tangential directions is used for <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/>.
The calculated wave speed using <img class="math" src="_images/math/287f8adc72babf3e4b81f4266f4392176081a8bd.png" alt="h" style="vertical-align: 0px"/> then covers both shallow and deep water waves. When the cell size is larger in the normal direction,
then <img class="math" src="_images/math/475bf7beb1bd461afa3a9e058687eeda5f9a0222.png" alt="\delta {z}" style="vertical-align: 0px"/> is used to calculate the wave speed, resulting in a shallow-water like wave speed evaluation. Otherwise, the largest of the cell sizes
in the free surface plane is used, yielding a wave speed close to that of a deep-water wave with the wave length close to twice that cell size.</p>
<p>The actual condition is that surface waves should not propagate more than
one cell in one time step. For example, if <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> is the normal direction to
the surface and <img class="math" src="_images/math/121b7b6ebb211f242cc6c174138914144992fbbd.png" alt="{\rm{G_z}}" style="vertical-align: -3px"/> is the acceleration in <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/> direction, then</p>
<div class="math" id="equation-stabilityconsiderations21">
<p><span class="eqno">(444)<a class="headerlink" href="#equation-stabilityconsiderations21" title="Permalink to this equation">¶</a></span><img src="_images/math/16480676e8599302d0a4360b34ee6d44e44363c1.png" alt="\delta t &lt; \frac{\sqrt{V_F}} {\sqrt{2{\rm{G_z}} \delta{z_k} \left(\frac{A_x}{\delta{x_i^2}} {\max \left(1,\frac{\delta{x_i}}{\delta{z_k}}\right)} + \frac{A_y R_i^2}{\delta{y_j^2}} {\max \left(1,\frac{\delta{y_j}}{R_i\delta{z_k}}\right)} \right)}}"/></p>
</div><p>The <img class="math" src="_images/math/5160278257c7e3d5b11502d44ee590ac8266dcd7.png" alt="\max" style="vertical-align: 0px"/> operator in the denominator signifies the distinction between
shallow (<img class="math" src="_images/math/d868b55d4adc537622385d53861f6f8f6274f968.png" alt="=1" style="vertical-align: 0px"/>) and deep water (<img class="math" src="_images/math/880eafd5edf690e7e273b40ddbf80af0428f39ff.png" alt="=\frac{\delta{x}}{\delta{z}}" style="vertical-align: -6px"/>)
wave speed.  Similar limits must be imposed in the <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/> and <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>
directions for each cell containing a free-surface. When the explicit pressure
solver is used for shallow water flows, the time step stability limit is
controlled by the surface  wave speed which can be readily evaluated from the
depth of the fluid, <img class="math" src="_images/math/dc46edec2517c72be29c6e49d8a89ef44f970d6e.png" alt="F\delta {z}" style="vertical-align: 0px"/>, where <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> is the fluid fraction
in the cell</p>
<div class="math" id="equation-stabilityconsiderations22">
<p><span class="eqno">(445)<a class="headerlink" href="#equation-stabilityconsiderations22" title="Permalink to this equation">¶</a></span><img src="_images/math/4dab1b4a69d42b701ff47aa59fd38346a34b917a.png" alt="\delta t &lt; 0.5\frac{{\min \left\{ {\delta {x_i},\frac{{\delta {y_j}}}{{{R_i}}}} \right\}}}{{\sqrt {F\delta {z_k} \cdot {\rm{G_z}}} }}"/></p>
</div><p>A linear analysis indicates that the time step must be further limited when a
non-zero value of dynamic viscosity is used. This condition is</p>
<div class="math" id="equation-stabilityconsiderations3">
<p><span class="eqno">(446)<a class="headerlink" href="#equation-stabilityconsiderations3" title="Permalink to this equation">¶</a></span><img src="_images/math/eb4cb238bcc9dead6aaee78c2992d2ea586fc3ea.png" alt="\delta t = \frac{{0.25}}{{\max \left[ {{\rm{RM}} \cdot \frac{\mu }{\rho }\left( {\frac{1}{{DXS}} + \frac{{R_i^2}}{{\delta y_j^2}} + \frac{1}{{\delta z_k^2}}} \right)} \right]}}"/></p>
</div><p>where <img class="math" src="_images/math/b45288b3387df1294a75bf9d93e6d2e31958d33c.png" alt="{\rm{DXS}} = \delta x_i^2(1 - 0.334 \cdot {\rm{CYL}})" style="vertical-align: -5px"/>, and
<img class="math" src="_images/math/1940fdf9faba97cd6ed82019219d0e2442eb121a.png" alt="{\rm{RM}}" style="vertical-align: 0px"/> is the maximum multiplier used on <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> for all types of
diffusional processes. The restriction physically means that no quantity
should diffuse more than approximately one mesh cell in one time step. For
safety, an extra factor of 0.5 has been incorporated in the right side of Eq.
<a class="reference internal" href="#equation-stabilityconsiderations3">(446)</a> because the limit is otherwise marginal.</p>
<p>When the surface tension option is exercised, a time-step limit must be imposed
for these forces. Defining</p>
<div class="math" id="equation-stabilityconsiderations4">
<p><span class="eqno">(447)<a class="headerlink" href="#equation-stabilityconsiderations4" title="Permalink to this equation">¶</a></span><img src="_images/math/8eb15d57fb756734276bf9ac8fdcd6aa770b9ce3.png" alt="{\rm{DSSX}} = \max \left[ {{{\left( {\frac{1}{{\delta {x_i}}}} \right)}^2} + {{\left( {\frac{{{R_i}}}{{\delta {y_j}}}} \right)}^2},{\text{ }}{{\left( {\frac{1}{{\delta {x_i}}}} \right)}^2} + {{\left( {\frac{1}{{\delta {z_k}}}} \right)}^2},{\text{ }}{{\left( {\frac{{{R_i}}}{{\delta {y_j}}}} \right)}^2} + {{\left( {\frac{1}{{\delta {z_k}}}} \right)}^2}} \right]"/></p>
</div><p>and</p>
<div class="math" id="equation-stabilityconsiderations5">
<p><span class="eqno">(448)<a class="headerlink" href="#equation-stabilityconsiderations5" title="Permalink to this equation">¶</a></span><img src="_images/math/4c7b204da7fb249db23f2ba49e7d2254e69cd34d.png" alt="{\rm{DSM}} = \min \left\{ {\delta {x_i},\delta {y_j}/{R_i},\delta {z_k}} \right\}"/></p>
</div><p>the limit condition is</p>
<div class="math" id="equation-stabilityconsiderations6">
<p><span class="eqno">(449)<a class="headerlink" href="#equation-stabilityconsiderations6" title="Permalink to this equation">¶</a></span><img src="_images/math/273a03fc8c63580c0a900958e8d2d72ebe20835e.png" alt="\delta {t^2} &lt; \frac{{{\rm{DSM}} \cdot \rho }}{{16\sigma \cdot {\rm{DSSX}}}}"/></p>
</div><p>One more parameter must also be set correctly to ensure stability. This
parameter controls the relative amounts of donor-cell and centered differencing
used for the momentum advection terms shown in Eq.
<a class="reference internal" href="#equation-generalformapproximationflow3d">(331)</a>. When <img class="math" src="_images/math/e59a5450e2806fb0d5def5b7626243b3537c3a97.png" alt="\alpha = 1.0" style="vertical-align: 0px"/> is used, the
above stability conditions are sufficient. Generally, one should always use a
value for <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> such that</p>
<div class="math" id="equation-stabilityconsiderations7">
<p><span class="eqno">(450)<a class="headerlink" href="#equation-stabilityconsiderations7" title="Permalink to this equation">¶</a></span><img src="_images/math/753482a09dc1369eafa481d072326c76e82edf3b.png" alt="\delta t \cdot \max \left( {\frac{{\left| u \right|}}{{\delta {x_i}}},{\text{ }}\frac{{{R_i}\left| v \right|}}{{\delta {y_j}}},{\text{ }}\frac{{\left| w \right|}}{{\delta {z_k}}}} \right) &lt; \alpha \leq 1.0"/></p>
</div><p>For instance, if condition of Eq. <a class="reference internal" href="#equation-stabilityconsiderations1">(443)</a> is satisfied,
then we must have <img class="math" src="_images/math/e213c3cef7b4b752dd3b3f990379fe816618a057.png" alt="\alpha &gt; {\rm{CON}}" style="vertical-align: -1px"/>. In no case should <img class="math" src="_images/math/db68c1b58b0e0840702a7a6539a5253887a9cd69.png" alt="\alpha" style="vertical-align: 0px"/> exceed 1.0.</p>
</div>
<div class="section" id="discrete-particle-dynamics">
<span id="discreteparticledynamicsth"></span><span id="index-490"></span><h3>Discrete Particle Dynamics<a class="headerlink" href="#discrete-particle-dynamics" title="Permalink to this headline">¶</a></h3>
<p>The Lagrangian particle model in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> describes the movement of discrete particles in fluid and void,
interacting with fluid and walls. Particles may participate in heat transfer, carry electrical charge,
transfer momentum back to the fluid, solidify and melt, and evaporate. Multiple particle classes exist,
each describing particles of a certain type:</p>
<ol class="arabic simple">
<li>Marker particle class includes massless particles;</li>
<li>Mass particle class includes solid particles;</li>
<li>Liquid particle class includes particles made up of fluid #1;</li>
<li>Gas particle class includes particles that represent bubbles;</li>
<li>Void particle class includes gas particles that represent collapsed void regions, i.e. collapsed bubbles;</li>
<li>Probe particle class includes particles that represent history probes, both stationary and moving;</li>
<li>Mass/momentum source particle class includes particles that represent mass/momentum sources;</li>
<li>User particle classes (up to 10) are provided for customizations of the particle model.</li>
</ol>
<p>Particles are assumed to be much smaller than a cell size; they do not interact with each other and
do not displace fluid volume. Each material particles can represent a cloud of several identical
physical particles using the concept of <em>macro</em>-particles whereupon the mass, heat capacity, charge and
surface area of a macro-particle is increased accordingly.</p>
<div class="section" id="marker-particles">
<span id="markerparticlesth"></span><span id="index-491"></span><h4>Marker Particles<a class="headerlink" href="#marker-particles" title="Permalink to this headline">¶</a></h4>
<p>Sometimes it is desirable to mark specific regions of fluid so that the
evolution (i.e., location and shape) of these regions can be followed. For this
purpose, there is a marker (i.e., zero mass) particle class. Marker
particles can also be useful for flow visualization. By having the
capability for markers to diffuse relative to the fluid, they may be used to
model pollutant dispersal or other types of scalar transport in turbulent flows.</p>
<p>Marker particles do not affect the fluid dynamics. They move with the mean
flow and, if the option is selected, diffuse with the diffusion coefficient
<img class="math" src="_images/math/23c272242f6523fd797a20dd5d89f030077c6d73.png" alt="D = {\rm{PMARKER\_RM}} \cdot \nu + {\rm{PMARKER\_DIFF}}" style="vertical-align: -2px"/>, where <span class="target" id="index-492"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PMARKER_RM</span></code> is the
inverse Schmidt number, <img class="math" src="_images/math/6f0271089ab36d5f12ee5fe3eef8d89debc5529f.png" alt="\nu" style="vertical-align: 0px"/> is the kinematic fluid viscosity and <span class="target" id="index-493"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PMARKER_DIFF</span></code> is
a constant particle diffusion coefficient.  Note that the kinematic viscosity
here includes the eddy viscosity estimated by the <a class="reference internal" href="#turbulencemodelsth"><span class="std std-ref">Turbulence Models</span></a>,
so it can vary in both space and time.</p>
<p>The program allows for rectangular blocks of particles to be initialized within
the computing mesh. Additionally, sources of particles may be defined. Each
source occupies a certain volume in space and produces particles at a specified
rate.</p>
<p>Marker particles move with the local interpolated mesh velocities <img class="math" src="_images/math/f098d2388dc18887305f27724046fb5f9df34d2a.png" alt="u_p" style="vertical-align: -6px"/>,
<img class="math" src="_images/math/cff990ba22745a0280b7ca2d258ad95943f08d41.png" alt="v_p" style="vertical-align: -6px"/>, <img class="math" src="_images/math/86fceed5f78b66f24cd31ad1fddadb0ed10b0269.png" alt="w_p" style="vertical-align: -6px"/> such that the increment in position in a time step
<img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/> is <img class="math" src="_images/math/bac79d4f173b9c3821a1458026de872b5c949e07.png" alt="{u_p} \delta t" style="vertical-align: -6px"/>, <img class="math" src="_images/math/0358716311a27f0ad246c4db734d8009f4c4f31a.png" alt="{v_p} \delta t" style="vertical-align: -6px"/>,
<img class="math" src="_images/math/0c73c8a4f70d2180197ebc17a7865690c3acf542.png" alt="{w_p} \delta t" style="vertical-align: -6px"/>. Particle velocities are interpolated from the
neighboring cell edge velocities using a linear interpolation.</p>
<p>Particles that cross continuative, outflow, fixed velocity, or constant pressure
boundaries are deleted; while particles crossing a periodic boundary are
reinserted at the opposite side of the mesh.</p>
<p>When the particle diffusion coefficient, <span class="target" id="index-494"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PMARKER_DIFF</span></code>, is positive,
each particle is given an additional increment in position which is added to the
mean flow increment before the new coordinate calculation and boundary condition
tests are performed. The idea behind this diffusional increment is to consider
the particle as a point source. After a time interval, <img class="math" src="_images/math/4419e69da61926925598ac23ac058a37bff9dfc9.png" alt="\delta t" style="vertical-align: 0px"/>, this
point source should diffuse in all directions, forming a small cloud with a
Gaussian mass distribution in each direction (i.e., it is a “Gaussian puff”).
However, the particle is to remain a discrete point. So, rather than replacing
it with a distribution, the Gaussian cloud is interpreted as a probability map
for moving the particle. Using a random number generator, a new location for the
particle is selected with a probability corresponding to the mass distribution
within the cloud. In this way a Monte Carlo approximation is generated for the
local diffusion of each particle. Three random numbers are selected for each
particle to compute random shifts in each of the three coordinate directions.
Repetition of this process over many time steps, together with the mean flow
advection, will produce a solution for the scalar transport equation
(see also  Eq. <a class="reference internal" href="#equation-scalartransport1">(43)</a>)</p>
<div class="math" id="equation-markerparticles1">
<p><span class="eqno">(451)<a class="headerlink" href="#equation-markerparticles1" title="Permalink to this equation">¶</a></span><img src="_images/math/f1990b6e9cafe3eb0c42d28936b1b341bd8185d5.png" alt="\frac{{\partial C}}{{\partial t}} + \frac{1}{{{V_F}}}\left[ {u{A_x}\frac{{\partial C}}{{\partial x}} + v{A_y}\frac{{\partial C}}{{\partial y}} + w{A_z}\frac{{\partial C}}{{\partial z}}} \right] = \frac{1}{{{V_F}}}\left[ {\frac{\partial }{{\partial x}}\left( {{A_x}D\frac{{\partial C}}{{\partial x}}} \right) + R\frac{\partial }{{\partial y}}\left( {{A_y}DR\frac{{\partial C}}{{\partial y}}} \right) + \frac{\partial }{{\partial z}}\left( {{A_z}D\frac{{\partial C}}{{\partial z}}} \right)} \right]"/></p>
</div><p>in which <img class="math" src="_images/math/f36bc2958f48e5ef97d30c652ce7900197e83da8.png" alt="C" style="vertical-align: 0px"/> is the concentration of marker particles. Of course, the
accuracy of the solution will improve as the number of particles per unit volume
is increased.</p>
<p>Two additional points regarding the Monte Carlo diffusion approximation should
be noted. First, the random number generator is based on a uniform distribution
in the interval (0,1). This number, <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, is transformed into a uniform
distribution in the interval (-1,1) by the arithmetic operation <img class="math" src="_images/math/565716d68b93cf005732e16a8e83625de53fba37.png" alt="2x - 1" style="vertical-align: 0px"/>,
and then an inverse error function must be computed to get the desired Gaussian
distribution. Unfortunately, system routines for inverse error functions are
time consuming and, when used three times for every particle in every time step,
can significantly increase computational costs. To minimize this problem, a
pre-computed table of inverse error functions is used. In the particle moving routine
this table is used to interpolate for the inverse error function for each random
number, which requires much less time than a system routine.</p>
<p>A second point to note is that the random number generator is initialized the
same way for every calculation, so that the particle solution is repeatable. However,
when run on multiple cores, each core initializes its own generator independent of
the other cores. This is necessary to enable parallelization of the particle solver.
As a result, the particle motion solution may vary with the change in the number of
cores (but remains the same for the same number of cores).</p>
<p>For some applications, the user may wish to run particle transport calculations
in a steady flow, for example, to investigate the sensitivity of pollutant
dispersal to different source locations or different diffusion rates. In such
cases it makes no sense to continue the fluid dynamic solution. In this case,
only the equations for particle motion are solved in the frozen flow field
resulting in a considerable savings in computer time.</p>
</div>
<div class="section" id="material-mass-liquid-and-gas-particles">
<span id="massparticlesth"></span><span id="index-495"></span><h4>Material (Mass, Liquid, and Gas) Particles<a class="headerlink" href="#material-mass-liquid-and-gas-particles" title="Permalink to this headline">¶</a></h4>
<p>The mass particle class describes particles made of solid material such as dust or sand grains.
Liquid and gas particle classes represent fluid #1 droplets and gas bubbles, respectively. Together
with the solid mass particles, they are called <em>material</em> particles. Their motion is governed
by Newton’s 2nd law and they can carry electric charge and heat. Multiple material particle
classes can be included in a simulation. Each particle is assumed to be a sphere of diameter <img class="math" src="_images/math/af338b0f36c212027ca29e7d652f140b32f24dbd.png" alt="d" style="vertical-align: 0px"/>.</p>
<p>The dynamics of a material particle is governed by the equation of motion</p>
<div class="math" id="equation-massparticles1">
<p><span class="eqno">(452)<a class="headerlink" href="#equation-massparticles1" title="Permalink to this equation">¶</a></span><img src="_images/math/26dfca1201f92e6e0082bd37dcaa62e0ba1ba813.png" alt="\frac{d\mathbf{u}_p}{dt} = - \frac{1}{\rho _p}\nabla P + \mathbf{g} + \beta \left( \mathbf{u} - \mathbf{u}_p \right)\left| {\mathbf{u} - \mathbf{u}_p} \right| \cdot \frac{\rho }{\rho_p} + \frac{m_{added}}{m _p} \left(\frac{d\mathbf{u}}{dt} - \frac{d\mathbf{u}_p}{dt} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/46da6d39e123e2f91f9fecee32d610dd1d0e1a28.png" alt="\mathbf{u}_p" style="vertical-align: -6px"/> and <img class="math" src="_images/math/af81fbbd5f77828a1aaad90f3f99632ce27d703b.png" alt="{\rho _p}" style="vertical-align: -6px"/> are particle mean velocity and density, respectively,</li>
<li><img class="math" src="_images/math/5bcad0776f1cc4cd1669a7343bbc8bdf80f4b432.png" alt="\mathbf{g}" style="vertical-align: -4px"/> includes gravity and other body forces,</li>
<li><img class="math" src="_images/math/dd781290bb86d4b2e998dea60a15c5364f4d82e1.png" alt="\mathbf{u}" style="vertical-align: 0px"/> and <img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> are fluid velocity and pressure,</li>
<li><img class="math" src="_images/math/58f961270cf905208364b40799bc1ab9d5b3ed34.png" alt="\beta" style="vertical-align: -4px"/> is a coefficient related to drag (see below),</li>
<li><img class="math" src="_images/math/685b31deb4e2165d702c307da8e2db230b52da24.png" alt="m_p" style="vertical-align: -6px"/> is particle mass,</li>
<li><img class="math" src="_images/math/2e6e24b245b9e3d463f4f2c8cd1145f53fe933a6.png" alt="m_{added}" style="vertical-align: -3px"/> is the added fluid mass. For a spherical particle, the added mass is assumed to be equal to half the mass of the displaced fluid, <img class="math" src="_images/math/6392886d286afc49c12aab04a8640dbe2a181b99.png" alt="\frac{1}{2}\rho \frac{\pi d^3}{6}" style="vertical-align: -6px"/>.</li>
</ul>
<p>A material particle’s diffusion is evaluated according to the
Monte Carlo technique and added to the mean trajectory as described in
<a class="reference internal" href="#markerparticlesth"><span class="std std-ref">Marker Particles</span></a>. Note that particles do not interact with each other.
The effects of the particle motion on fluid flow are described in the next section.</p>
<p>A drag force model that is based on an empirically derived function that ties the value
of the drag coefficient to the relative velocity of fluid in steady-state flow around a spherical body
is adopted to calculate the resistance force [<a class="reference internal" href="zbibliography.html#batchelor-1983" id="id102">[Bat83]</a>]</p>
<div class="math" id="equation-massparticles2">
<p><span class="eqno">(453)<a class="headerlink" href="#equation-massparticles2" title="Permalink to this equation">¶</a></span><img src="_images/math/cb5444621e8356d4027fa28a4451702b37b561da.png" alt="C_D = \left( {\frac{{24}}{{\operatorname{Re} }} + \frac{6}{{1 + \sqrt {\operatorname{Re} } }} + 0.4} \right)"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/> is the drag coefficient, <img class="math" src="_images/math/e2c701757b7d5ddc2f10fcf6a78672153ec4c88b.png" alt="C_D=\frac{8|F_D|}{\rho U^2 \pi d^2}" style="vertical-align: -9px"/>, with <img class="math" src="_images/math/58f961270cf905208364b40799bc1ab9d5b3ed34.png" alt="\beta" style="vertical-align: -4px"/> = <img class="math" src="_images/math/40ce1471f3eea3c242fa9a083a077234f1cc8fc0.png" alt="\frac{3}{4d} C_D" style="vertical-align: -6px"/>,</li>
<li><img class="math" src="_images/math/7185c6d70d1f6692ec4ce26d8a09a8bfa346ccc5.png" alt="F_D" style="vertical-align: -3px"/> is the drag force,</li>
<li><img class="math" src="_images/math/b95deea5d69aeaca46946b45215272be8f0f3e30.png" alt="U = |{\mathbf{u}} - {\mathbf{u'}}|" style="vertical-align: -5px"/>.</li>
</ul>
<p>The Reynolds number is <img class="math" src="_images/math/cc6b438eab3b65b8f00a4aed5e216f3e81d41471.png" alt="\operatorname{Re} = \frac{{d\rho U}}{\mu }" style="vertical-align: -9px"/>, with <img class="math" src="_images/math/bbdfba3f34876c71a27706eb12b647f73eb32d69.png" alt="\mu" style="vertical-align: -4px"/> the fluid viscosity.</p>
<p>If the particle is not a sphere, a multiplier can be used for the drag coefficient <img class="math" src="_images/math/257fb351c94813d1da6f0305ac48ee38ffb415b2.png" alt="C_D" style="vertical-align: -3px"/>
(one for each particle class) to account for the shape effect.</p>
<p>For small Reynolds numbers the drag force given by Eq. <a class="reference internal" href="#equation-massparticles2">(453)</a>
approaches the Stokes analytical solution for viscous laminar flow around a sphere.</p>
<p>A multiple-species particles model can be applied to simulate particles of
variable size and density. For instance, this feature could be used to
model foreign inclusions in liquid metals or dust particles in the air.</p>
</div>
<div class="section" id="fluid-particles-with-heat-transfer-and-phase-change">
<span id="massparticlesthermalenergyphasechangeth"></span><span id="index-496"></span><h4>Fluid Particles with Heat Transfer and Phase Change<a class="headerlink" href="#fluid-particles-with-heat-transfer-and-phase-change" title="Permalink to this headline">¶</a></h4>
<p>All material particles can undergo heat transfer with the surrounding fluid, but
particles in the Fluid class can also experience phase change from liquid to vapor
and from liquid to solid.  Particles in the Fluid class represent drops of fluid with the properties of fluid #1,
i.e., the fluid described by non-zero values of the volume-of-fluid function <img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/>.</p>
<p>When coupled with the two-fluid phase change model (<a class="reference internal" href="model-reference.html#condensationevaporationtwofluidsmr"><span class="std std-ref">Two-fluid Model</span></a>),
these drops undergo phase change for condensation and evaporation. In this case fluid #2
would represent either the vapor of fluid #1 or a mixture of the vapor and a non-condensable
gas. As heat transfer and phase change progress the size of a fluid particle may change.
A particle could evaporate completely. However, it cannot be created due to condensation.</p>
<p>In addition, if the solidification model is activated (<a class="reference internal" href="model-reference.html#solidificationsectionmr"><span class="std std-ref">Solidification</span></a>),
fluid particles can freeze and re-melt.</p>
<p>If a fluid particle (in liquid state if solidification is used)
enters into a computational control volume containing continuous liquid, i.e.,
<img class="math" src="_images/math/d59b7cc086cf6a4c9a0e8246bfbbd29d4467a990.png" alt="F" style="vertical-align: 0px"/> &gt; 0.0, it is converted into fluid #1: its mass,
momentum and energy are added to those of the continuous fluid and the
particle is deleted.</p>
<p>Liquid particles do not bounce off walls. In fact, upon contact with a wall,
they are converted fluid #1 as well.</p>
<p>However, if a fluid particle is in solid state, then it continues to remain a particle
upon entering fluid #1 or hitting a wall. It will only be converted to fluid #1 when,
and if, it melts.</p>
<p>Particles of any class can be generated at particle sources and/or initial particle blocks.
For applications such as spray cooling, a special spray-bar source is
available to generate these fluid particles (see <a class="reference internal" href="model-reference.html#massmomentumsourcesmr"><span class="std std-ref">Mass-Momentum Sources</span></a> for details).
A spray bar is conceptually a cylindrical pipe with a series of holes around its
circumference at uniformly spaced axial positions. Specification of a flow rate for a bar is
converted to particles under the assumption that continuous liquid jets exiting the holes
in the bar are unstable and breakup into droplets whose most probable diameter
(according to a theoretical prediction of Lord Rayleigh) is 1.89 times the
diameter of the holes. If particles are emitted at spray bar in solid state, then their
size matches that of the spray holes. The particles are assigned to originate at specific
hole locations by a Monte Carlo sampling technique that ensures that the
specified flow rate will be met over sufficient number of cycles of computation.</p>
</div>
<div class="section" id="particle-fluid-momentum-interaction">
<span id="particlefluidinteractionth"></span><h4>Particle/Fluid Momentum Interaction<a class="headerlink" href="#particle-fluid-momentum-interaction" title="Permalink to this headline">¶</a></h4>
<p>The particle motion is influenced by the fluid flow through the drag forces and added mass.
The reverse effect of the particles on the fluid can be neglected if the forces that
particle exert on the fluid are small compared to other forces and fluid
inertia. This can usually be assumed if particle mass and volume is small compared to the
mass of fluid in any given region and particle concentrations are also small.
This is the default setting in the particle model.</p>
<p>In cases when there are significant interactions between the continuous and
dispersed materials that arise because of the momentum exchange due to</p>
<p>drag and added mass, a fully coupled particle/fluid interaction model should be used.</p>
<p>A secondary interaction effect is the displacement of fluid volume by particle
volume. These effects are <em>not</em> taken into account in the particle model, so the
volume concentration of the particles is assumed to be relatively small. Particle/fluid
momentum exchange is considered a more important factor because it can be
significant even when the volume of particles is small.</p>
<p>The equations describing the motion of the fluid and particles must be solved
simultaneously. An implicit numerical method is used to couple the momentum of
the particles and fluid together.</p>
<p>Consider the momentum equations for a small control volume (i.e., grid cell) and
a single particle that appears in that volume. The particle momentum equation is
used to advance the particle velocity from time <img class="math" src="_images/math/f00d575a41393876638c1cc1d734f1177829d9a7.png" alt="t" style="vertical-align: 0px"/> to <img class="math" src="_images/math/cf489f91a9e68cbcfbf53e9204f1f5935b48ff9b.png" alt="t + \delta
t" style="vertical-align: -2px"/>. The new velocity can be expressed in terms of all known quantities except
for the fluid, which appears in the coupling term. Next, this velocity can be
algebraically substituted into the corresponding coupling term in the fluid
momentum equation to produce an expression for the new fluid velocity. A similar
substitution can be done for all particles that influence the fluid element.
Because the fluid velocities that appear in the drag expressions are linear
(quadratic drag terms are linearized), it is a trivial matter to collect all the
occurrences of the new velocity together in order to obtain a solution for it in
terms of the remaining known quantities. Once this has been done for the entire
grid, and a solution for the new velocities is obtained, they can then be used
to compute the drag force needed for updating the particle velocities.</p>
<p>This, then, is the strategy:</p>
<ol class="arabic simple">
<li>Compute new particle velocities in terms of the as yet unknown fluid velocities.</li>
<li>Substitute those velocities into the momentum exchange terms in the fluid equations and solve for the new fluid velocities.</li>
<li>Return to the particles and update their velocities to reflect the new fluid velocities. More details can be found in the Flow Science Technical Note #50 in the users site at <a class="reference external" href="http://users.flow3d.com/technical-notes/">http://users.flow3d.com/technical-notes/</a> <a class="reference internal" href="zbibliography.html#hirt-1999" id="id103">[Hir99]</a>.</li>
</ol>
</div>
<div class="section" id="particle-wall-interaction">
<span id="particlewallinteractionth"></span><span id="index-497"></span><h4>Particle/Wall Interaction<a class="headerlink" href="#particle-wall-interaction" title="Permalink to this headline">¶</a></h4>
<p>Material particles (except for liquid ones) reflect off solid geometry boundaries with
a coefficient of restitution <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/>. After reflection the particle velocity
component normal to the wall is equal to <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> times the normal velocity
<em>before</em> the reflection. For example, if <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> = 0.0, then particles do not
reflect at the walls, with the normal velocity reduced to zero, or to the wall velocity, if the interaction
is with a GMO component.  When <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> = 1.0, then no particle kinetic energy loss occurs
during reflection. When <img class="math" src="_images/math/c4b1f4d9462b05032bd840b98b1de290be0021dc.png" alt="R" style="vertical-align: 0px"/> &lt; 0.0, particles stick to walls upon first contact and become
stationary (or moving with a GMO component).</p>
<p>Marker particles always reflect off walls with a zero restitution coefficient, i.e., their coordinates
are reset to the that of the wall and the normal velocity component is reset to zero.</p>
<p>Liquid particles do not bounce off walls. In fact, upon contact with a wall,
they are converted to fluid #1.</p>
<p>At partially blocked faces, <img class="math" src="_images/math/64d3a0455e0707b292f8b26c91b81806ce8e70b8.png" alt="0.0 &lt; AF &lt; 1.0" style="vertical-align: -1px"/>, where <img class="math" src="_images/math/b58de1220bc8da08812e2cb06e84f24549bd699f.png" alt="AF" style="vertical-align: 0px"/> is the area fraction, particles are always
transmitted, irrespective of the value of the restitution coefficient.</p>
<p>Particles reflect off symmetry mesh boundaries without a loss of momentum.</p>
<span class="target" id="index-498"></span></div>
</div>
<div class="section" id="rigid-body-dynamics-algorithm-for-non-inertial-reference-frame-model">
<span id="rigidbodydynamicsalgorithmth"></span><span id="index-499"></span><h3>Rigid Body Dynamics Algorithm for Non-Inertial Reference Frame Model<a class="headerlink" href="#rigid-body-dynamics-algorithm-for-non-inertial-reference-frame-model" title="Permalink to this headline">¶</a></h3>
<p>As previously mentioned in <a class="reference internal" href="#rigidbodydynamicsnirfth"><span class="std std-ref">Rigid Body Dynamics</span></a>, the non-inertial reference frame method is
for analysis of flow in a moving container. Computational mesh is fixed with
the container in a non-inertial reference frame while fictitious forces are
applied on fluid to account the non-inertial effects. If motion of the
container is not prescribed but dynamically coupled with the flow inside the
container, a rigid body dynamics algorithm is employed to solve the container
motion to obtain the fictitious force. Coupling between the body motion and
fluid dynamics can be either explicit or implicit, as described below.</p>
<p>The model described in Rigid Body Dynamics involves a high degree of mutual
coupling. Therefore, a general solution should consider the equations for all
parts of the problem simultaneously. Such a solution, however, is very difficult
to implement, particularly without specification of the details of the
environmental and control forces and torques. Here, we shall outline a
sequential, explicitly coupled solution, which, while not universally valid, is
widely applicable and efficient within its range of validity. This explicit
algorithm has been generalized to permit an iterative implicit coupling, which
extends the solution to some additional situations.</p>
<p>We choose to decompose the solution into the following six steps:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#rbd-step1"><span class="std std-ref">Evaluation of Environmental Forces and Torques</span></a></li>
<li><a class="reference internal" href="#rbd-step2"><span class="std std-ref">Evaluation of Control Forces and Torques</span></a></li>
<li><a class="reference internal" href="#rbd-step3"><span class="std std-ref">Solution of the Fluid Dynamics Equations</span></a></li>
<li><a class="reference internal" href="#rbd-step4"><span class="std std-ref">Solution of the Dynamic Equations for the Rigid-Body Center of Mass</span></a></li>
<li><a class="reference internal" href="#rbd-step5"><span class="std std-ref">Solution of the Dynamic Equations for the Rotation of the Rigid Body</span></a></li>
<li><a class="reference internal" href="#rbd-step6"><span class="std std-ref">Integration of the Kinematic Equations for the Rigid-Body Attitude</span></a></li>
</ol>
<p>These six steps are combined into a cyclic algorithm that advances the total
solution through time. Each step uses previous results from the others,
forming an explicit algorithm. The iterative implicit solution adds a seventh
step, <a class="reference internal" href="#convergencetestingth"><span class="std std-ref">Convergence Testing</span></a>, and repeats the basic six steps until convergence is
achieved.</p>
<div class="section" id="evaluation-of-environmental-forces-and-torques">
<span id="rbd-step1"></span><h4>Evaluation of Environmental Forces and Torques<a class="headerlink" href="#evaluation-of-environmental-forces-and-torques" title="Permalink to this headline">¶</a></h4>
<p>This step is clearly very problem-dependent. The results of this step are three
net force components and three net torque components. These components are in
the body-fixed Cartesian coordinate system. Typically, these may represent
forces arising from aerodynamic drag, solar wind and/or geomagnetic effects.
This routine can also incorporate the torque due to gravitational gradients or
the fictitious forces and torques that compensate for an earth-fixed reference
frame. Three components of gravitational acceleration (in the inertial
coordinate system) are also evaluated by <strong class="program">rbenvr</strong> and stored. These
values are calculated at the location of the rigid-body center of mass and do
not account for variations of gravity through the body.</p>
<p>The location of the rigid-body center of mass (in inertial coordinates) and the
rigid-body attitude are available for the evaluation of these forces and
torques. For some purposes the gravitating body coordinates may be simpler to
use. Vector quantities can readily be transformed between inertial and
body-fixed coordinates by use of the transformation matrix and its inverse.
Additional input that may be required to evaluate control functions can be
specified through the <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> user data namelist <span class="target" id="index-500"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">USRDAT</span></code> or the “dummy”
variables in namelist <span class="target" id="index-501"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">XPUT</span></code>.</p>
</div>
<div class="section" id="evaluation-of-control-forces-and-torques">
<span id="rbd-step2"></span><h4>Evaluation of Control Forces and Torques<a class="headerlink" href="#evaluation-of-control-forces-and-torques" title="Permalink to this headline">¶</a></h4>
<p>This step is directly analogous to Step 1. The two are separated to simplify the
combination of models for various phenomena. The control forces and torques are
transferred through body-fixed components, which are stored in variables
separate from the environmental force and torque components. To provide an
elementary control capability, we have developed a skeleton version which treats
a few special cases.</p>
</div>
<div class="section" id="solution-of-the-fluid-dynamics-equations">
<span id="rbd-step3"></span><h4>Solution of the Fluid Dynamics Equations<a class="headerlink" href="#solution-of-the-fluid-dynamics-equations" title="Permalink to this headline">¶</a></h4>
<p>Decomposition of the analysis as described is motivated by the desire to retain
the fluid analysis capabilities of <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> intact. Only peripheral changes to the
usual solution algorithm are needed by this approach.</p>
<p>It is important to note that we are choosing to consider the fluid as a separate
entity in our solution algorithm. Thus, when we consider the rigid body, we are
specifically excluding any onboard liquids. The fluid part of the analysis is
handled explicitly in Step 3.</p>
<p>All usual <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> models and solution methods are available for the solution of
the fluid component of the simulation. The continuity, volume-of-fluid and
momentum equations are solved to determine the location and velocity of the
fluid within the body-fixed reference frame.</p>
<p>The influence of the gravitating body must be added through transient evaluation
of the local gravitational field since the apparent direction of this force will
vary as the rigid body rotates, and its strength may vary as the center of mass
moves. This acceleration must be incorporated in the fluid equations directly
since it influences both the fluid and the rigid body. We have simplified this
calculation by using the gravitational vector at the rigid-body center of mass
throughout the fluid. Thus we can account for neither displacement of the fluid
from the rigid-body mass centroid nor the variation of gravity within the fluid
region. The gravitating body force is accounted for by modifying the components
of linear acceleration used by the fluid-flow solution calculated by the
rigid-body center of mass motion algorithm in Step 4. This is accomplished in
subroutine <strong class="program">motion</strong>. The constant gravity components <span class="target" id="index-502"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GX</span></code>, <span class="target" id="index-503"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GY</span></code> and
<span class="target" id="index-504"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">GZ</span></code> are not used by this model and generally should not be combined with
the coupled rigid-body dynamics model.</p>
<p>The net force and torque exerted on the rigid body by the fluid are calculated
in subroutine <strong class="program">feval</strong>. The components of these vectors are resolved in the
body-fixed Cartesian coordinate system (even if the fluid calculation uses
cylindrical coordinates). The torque is converted to that about the rigid-body
center of mass for use in Step 5. Force moments for other purposes are evaluated
about the origin of the body-fixed coordinates and are still available in the
<code class="file docutils literal notranslate"><span class="pre">flsgrf</span></code> data file.</p>
<p>Since the fluid-dynamic calculation occurs before the rigid-body dynamics, we
must deal with an initialization difficulty. The flow analysis requires
knowledge of the rotation and acceleration of the rigid body. To resolve this
difficulty, we temporarily assume (for the first cycle only) either that the
fluid mass acts as if frozen in position or that the body acceleration can be
calculated by ignoring the fluid. This permits evaluation of approximate values
of the rigid-body acceleration and rotation for the purpose of solving the flow
equations during the first cycle.</p>
</div>
<div class="section" id="solution-of-the-dynamic-equations-for-the-rigid-body-center-of-mass">
<span id="rbd-step4"></span><h4>Solution of the Dynamic Equations for the Rigid-Body Center of Mass<a class="headerlink" href="#solution-of-the-dynamic-equations-for-the-rigid-body-center-of-mass" title="Permalink to this headline">¶</a></h4>
<p>Standard analysis shows that the equations for the motion of any rigid body can
be separated into an equation for the motion of the center of mass of the body
and independent dynamic equations for the rotation of the body about the mass
center <a class="reference internal" href="zbibliography.html#batchelor-1983" id="id104">[Bat83]</a>, <a class="reference internal" href="zbibliography.html#goldstein-1950" id="id105">[Gol50]</a>, <a class="reference internal" href="zbibliography.html#wertz-1978" id="id106">[Wer78]</a>. In our
algorithm we identify the rigid body as excluding the fluid mass for the
specific purpose of allowing this separation. Therefore, Step 4 solves the
linear momentum equation:</p>
<div class="math" id="equation-linearmomentumequationrigidbody">
<p><span class="eqno">(454)<a class="headerlink" href="#equation-linearmomentumequationrigidbody" title="Permalink to this equation">¶</a></span><img src="_images/math/1c76c47e2f1ca575f1d944cb634a18480e34e2f1.png" alt="M\frac{{d{{{\mathbf{V'}}}_{\rm{CM}}}}}{{dt}} = {{\mathbf{F'}}_e} + {{\mathbf{F'}}_c} + {{\mathbf{F'}}_g} + \sum {{\mathbf{F'}}_f}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/8bac8bbfe6e55ddb37935a5456cbf7e6088df12c.png" alt="{\mathbf{V'}}_{\rm{CM}}" style="vertical-align: -3px"/> is the velocity of the center of mass of the dry rigid body. This velocity is relative to the inertial reference frame and is resolved in the (<img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/>, <img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/>) coordinates.</li>
<li><img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> is the total dry mass of the rigid body,</li>
<li><img class="math" src="_images/math/120e34c660f66d60fd2a0b64ddc01d8d67488a03.png" alt="{{\mathbf{F'}}_e}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/b1101db355bd6d4c7299b0d29e9dcc9db9d475d9.png" alt="{{\mathbf{F'}}_c}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/54ae9e76e330650c531852f52993d6b8408917a0.png" alt="{{\mathbf{F'}}_f}" style="vertical-align: -6px"/> are the environmental, control and fluid forces that are evaluated in Steps 1-3, respectively, and</li>
<li><img class="math" src="_images/math/d60ee0f1daf7544ffedd9d6bffa86ae63e40c777.png" alt="{{\mathbf{F'}}_g}" style="vertical-align: -6px"/> is the force due to the gravitating body.</li>
</ul>
<p>Note that the environmental, control and fluid force vectors are resolved in the
inertial reference frame in this equation. This requires application of the
attitude transformation (see Step 6) to the components stored in common since
those components are in the body-fixed reference frame. The gravitational force
is, of course, already evaluated in the inertial reference frame.</p>
<p>For the explicit coupling algorithm, we use a simple first-order forward
difference technique to integrate the momentum equation. The technique is
explicit in that the most recently calculated values of the forces are used at
each cycle. The difference technique is motivated by the difficulty of
calculating the fluid force, which normally involves many nonlinear equations.
This makes the use of more accurate integration techniques of questionable
value.</p>
<p>The implicit algorithm uses a “frozen fluid” approximation to estimate the
acceleration to be used for the next iteration. This approximation adds the
“frozen fluid” mass (which is taken to equal the total liquid mass) times the
acceleration vector to both sides of the momentum equation. The term on the
left-hand side is treated implicitly (that is with the new estimate of the
acceleration), while the right-hand side is treated explicitly. This removes the
limitation on fluid/rigid mass ratio, since the resulting equation uses the
total (fluid + rigid) mass in calculating the new estimate of acceleration. Once
converged, the original equation is almost satisfied, since the old and new
accelerations are nearly equal.</p>
<p>The center-of-mass velocity is used to integrate directly for the position of
the rigid-body center of mass relative to the inertial reference frame
coordinates (<img class="math" src="_images/math/74e1130ab646438f0c5350dde870108bcdf69aed.png" alt="x'" style="vertical-align: 0px"/>, <img class="math" src="_images/math/982c77ca2e128612c6df039f91bd85d4cd8f25ff.png" alt="y'" style="vertical-align: -4px"/>, <img class="math" src="_images/math/b01adb8b1d934cf11c397f9fb37952052f1dc453.png" alt="z'" style="vertical-align: 0px"/>). This position is then
converted to spherical coordinates. Finally, the influence of the gravitating
body rotation is accounted for in calculating longitude and latitude relative
to the gravitating body.</p>
</div>
<div class="section" id="solution-of-the-dynamic-equations-for-the-rotation-of-the-rigid-body">
<span id="rbd-step5"></span><h4>Solution of the Dynamic Equations for the Rotation of the Rigid Body<a class="headerlink" href="#solution-of-the-dynamic-equations-for-the-rotation-of-the-rigid-body" title="Permalink to this headline">¶</a></h4>
<p>The separation of translational and rotational momentum used in Step 4 to
evaluate the position of the rigid-body center of mass results in the angular
momentum conservation equation:</p>
<div class="math" id="equation-angularmomentumconservationequationrigidbody">
<p><span class="eqno">(455)<a class="headerlink" href="#equation-angularmomentumconservationequationrigidbody" title="Permalink to this equation">¶</a></span><img src="_images/math/008001e623fb948652c9a65a2532d650955d1abd.png" alt="\left[ J \right] \cdot \frac{{d\omega }}{{dt}} = {{\mathbf{T}}_e} + {{\mathbf{T}}_c} - \omega \times \left[ J \right] \cdot \omega + \sum {{\mathbf{T}}_f}"/></p>
</div><p>where:</p>
<ul class="simple">
<li><img class="math" src="_images/math/b64db90c456c64f90e29b5ddda0aeb36783b580b.png" alt="J" style="vertical-align: 0px"/> is the dry-rigid-body inertial matrix,</li>
<li><img class="math" src="_images/math/5fff10136b6b599d18963a900c6d7f37edca8f08.png" alt="\omega" style="vertical-align: 0px"/> is the angular velocity and</li>
<li><img class="math" src="_images/math/9997f3d7714551590ce07bf2e07dd246d0c390b3.png" alt="{{\mathbf{T}}_e}" style="vertical-align: -3px"/>, <img class="math" src="_images/math/6e5268ab4f0d79ed331d0c6a606ae1149f914d3a.png" alt="{{\mathbf{T}}_c}" style="vertical-align: -3px"/> and <img class="math" src="_images/math/2bdbf4af12f61aa7e540e786ce4814554f9a27b6.png" alt="{{\mathbf{T}}_f}" style="vertical-align: -6px"/> are the torques due to environment, control and fluid forces, respectively.</li>
</ul>
<p>Note that this equation is written in the body-fixed reference frame although
the angular velocity is that with respect to the inertial reference frame. This
accounts for the “additional” cross product term, which is absent if the
equation is written in the inertial frame. The inertia matrix and torques are
also resolved along the body-fixed (<img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>, <img class="math" src="_images/math/f73d84aaab67d15ec35a137d8053810c7d622838.png" alt="z" style="vertical-align: 0px"/>) coordinate system.</p>
<p>Equation <a class="reference internal" href="#equation-angularmomentumconservationequationrigidbody">(455)</a> is solved in a
manner analogous to the linear momentum equation in Step 4. Thus, we use an
explicit, forward-time formulation or a “frozen fluid” approximation, depending
on the time algorithm selected. The results of this step are the components of
the angular velocity and angular acceleration of the dry rigid body in the
body-fixed reference frame. These components are available for Steps 1-3 of the next
cycle.</p>
</div>
<div class="section" id="integration-of-the-kinematic-equations-for-the-rigid-body-attitude">
<span id="rbd-step6"></span><h4>Integration of the Kinematic Equations for the Rigid-Body Attitude<a class="headerlink" href="#integration-of-the-kinematic-equations-for-the-rigid-body-attitude" title="Permalink to this headline">¶</a></h4>
<p>There are several popular representations of the attitude of a rigid body
<a class="reference internal" href="zbibliography.html#goldstein-1950" id="id107">[Gol50]</a>. We choose to describe the attitude by the full
transformation matrix. The matrix <img class="math" src="_images/math/398d182975de4c2b22c2c1291626b8650a4ae15c.png" alt="\left[ A \right]" style="vertical-align: -5px"/> is defined to
transform an arbitrary vector <img class="math" src="_images/math/b86c76afde98bef6ba2eff477fc6444aafed5d71.png" alt="\mathbf{G}'" style="vertical-align: 0px"/> from inertial coordinates to body-fixed
coordinates through the equation</p>
<div class="math" id="equation-integrationkinematiceqforrigidbodyattitude1">
<p><span class="eqno">(456)<a class="headerlink" href="#equation-integrationkinematiceqforrigidbodyattitude1" title="Permalink to this equation">¶</a></span><img src="_images/math/075a1b53484b64f2826de4474fe81135ff72a386.png" alt="\mathbf{G}' = \left[ A \right] \cdot \mathbf{G}"/></p>
</div><p>As shown in reference <a class="reference internal" href="zbibliography.html#goldstein-1950" id="id108">[Gol50]</a>, the components of <img class="math" src="_images/math/f2b9537a592493713f8a3d13f3ca12c6fd57e2e8.png" alt="\left[ A
\right]" style="vertical-align: -5px"/> are then the direction cosines between the axes of the two systems</p>
<div class="math" id="equation-integrationkinematiceqforrigidbodyattitude2">
<p><span class="eqno">(457)<a class="headerlink" href="#equation-integrationkinematiceqforrigidbodyattitude2" title="Permalink to this equation">¶</a></span><img src="_images/math/b774fa4ab3c50050e4977c96446a911f0f7438de.png" alt="{A_{ij}} = {x_i} \cdot {x'_j}"/></p>
</div><p>where we have switched to subscripted unit vectors to simplify the notation. As
usual, <img class="math" src="_images/math/7ce109baff5d590a77d85d3bb917cbbbbf2dddfc.png" alt="x_1" style="vertical-align: -3px"/> is equal to <img class="math" src="_images/math/4b3baa22a61a12caef19e4537e9ab6334b5b25f1.png" alt="x" style="vertical-align: 0px"/>, <img class="math" src="_images/math/c8b8166dfe097f429d861fc3830af0adfe1254d7.png" alt="x_2" style="vertical-align: -3px"/> is equal to <img class="math" src="_images/math/39c736105504f69471e131097dde8021cf6a58e0.png" alt="y" style="vertical-align: -4px"/>,
etc.</p>
<p>By definition, this matrix must be orthogonal, and therefore its inverse is
equal to its transpose, and we have the relationship</p>
<div class="math" id="equation-integrationkinematiceqforrigidbodyattitude3">
<p><span class="eqno">(458)<a class="headerlink" href="#equation-integrationkinematiceqforrigidbodyattitude3" title="Permalink to this equation">¶</a></span><img src="_images/math/a80930585eb0ce863937a40d5961770f67367629.png" alt="\mathbf{G}' = \left[ {{A^T}} \right] \cdot \mathbf{G}"/></p>
</div><p>The kinematic equation relating the transformation matrix <img class="math" src="_images/math/f2b9537a592493713f8a3d13f3ca12c6fd57e2e8.png" alt="\left[ A
\right]" style="vertical-align: -5px"/> to the rigid-body velocity is</p>
<div class="math" id="equation-integrationkinematiceqforrigidbodyattitude4">
<p><span class="eqno">(459)<a class="headerlink" href="#equation-integrationkinematiceqforrigidbodyattitude4" title="Permalink to this equation">¶</a></span><img src="_images/math/a6ff1d4017ced80874e6d82adf9c657b419662f3.png" alt="\frac{{d\left[ A \right]}}{{dt}} = \left[ {\Omega '} \right] \cdot \left[ A \right]"/></p>
</div><p>where</p>
<div class="math" id="equation-integrationkinematiceqforrigidbodyattitude5">
<p><span class="eqno">(460)<a class="headerlink" href="#equation-integrationkinematiceqforrigidbodyattitude5" title="Permalink to this equation">¶</a></span><img src="_images/math/c4dc81997163028f7f0707c27c6f4dfb33d61b36.png" alt="\left[ {\Omega '} \right] =
 \begin{bmatrix}
{0} &amp; {\omega _z} &amp; {- {\omega _y}} \\
{ - {\omega _z}} &amp; {0} &amp; {{\omega _x}} \\
{{\omega _y}} &amp; { - {\omega _x}} &amp; {0}
\end{bmatrix}"/></p>
</div><p>Step 6 of our algorithm implements a first-order, forward-time difference
approximation to determine the variation of the transformation matrix
<img class="math" src="_images/math/398d182975de4c2b22c2c1291626b8650a4ae15c.png" alt="\left[ A \right]" style="vertical-align: -5px"/> with time.</p>
<p>One potential problem with this approach is the accumulation of errors in the
matrix elements. The most serious difficulty associated with these errors is the
potential for generating non-orthogonal matrices. To ensure that this does not
occur, we orthogonalize the matrix at the completion of every cycle using a
simple Gram-Schmidt orthonormalization procedure on the implied inertial
coordinates. That is, we define the approximate inertial unit vectors as the
column vectors of the transformation matrix <img class="math" src="_images/math/398d182975de4c2b22c2c1291626b8650a4ae15c.png" alt="\left[ A \right]" style="vertical-align: -5px"/>. These
vectors are orthonormalized in the usual way, and the transformation matrix
columns are replaced with the modified unit vectors. This ensures that
<img class="math" src="_images/math/398d182975de4c2b22c2c1291626b8650a4ae15c.png" alt="\left[ A \right]" style="vertical-align: -5px"/> represents a physical rotation transformation at all
times. Therefore, the errors are limited to incorrect rotation angles.
Accumulated error magnitudes are evaluated as part of the orthonormalization
procedure.</p>
<p>The result of Step 6 is the current value of the transformation matrix. The
matrix can be used directly to transform between the inertial and body-fixed
reference frames as necessary in Steps 1-5.</p>
</div>
<div class="section" id="convergence-testing">
<span id="convergencetestingth"></span><span id="index-505"></span><h4>Convergence Testing<a class="headerlink" href="#convergence-testing" title="Permalink to this headline">¶</a></h4>
<p>This algorithm is for the explicit coupling method. The implicit method,
however, requires a final step, which is the testing of the current
accelerations and forces for convergence. Actually, the convergence test is made
only on the acceleration components, and we assume that the force and torque
components must also be converged. The user can supply a convergence criterion
(<span class="target" id="index-506"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">ACCEPS</span></code>). The change in each acceleration component between iterations must be
less than this parameter times an appropriate normalization velocity for
convergence to be achieved. The user may also specify a maximum number of
iterations. If convergence is not achieved within this limit, the calculation is
aborted and an error message generated.</p>
</div>
</div>
<div class="section" id="simplified-solidification-shrinkage-algorithm">
<span id="simplifiedshrinkagealgorithmth"></span><span id="index-507"></span><h3>Simplified Solidification Shrinkage Algorithm<a class="headerlink" href="#simplified-solidification-shrinkage-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The Simplified Solidification Shrinkage (SSS) model is based on the solution of
metal and mold energy equations. No fluid flow equations are solved by the
model. Porosity is predicted by first evaluating the volume of solidification
shrinkage in each isolated liquid region in the casting at each time step. This
volume is then subtracted from the top of the liquid region in accordance with
the amount of liquid metal available in the mesh cells from which the fluid is
to be removed. The volume is subtracted if no feeding occurs through mesh
boundaries. The “top” of a <em>liquid</em> region is defined by the direction of
gravity and centrifugal forces (in centrifugal casting), which can be time
dependent (as in tilt pour casting). Feeding is then assumed in the direction of
the combined body force.</p>
<p>When the minimum solid fraction in a liquid metal region reaches the coherency
point, <span class="target" id="index-508"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FSCO</span></code>, the direction of feeding changes from along body force to along the
temperature gradient - from hot to cold. This mode of feeding is called
interdendritic feeding. An option exists to use only that kind of feeding, which
is useful for thin-wall castings, where the mushy zone may not be resolved well
by the computational mesh.</p>
<p>A liquid region is considered isolated if it is surrounded by mold walls,
solidified metal, and/or free-surfaces. The feeding is controlled by the value
of the solidification drag force, <img class="math" src="_images/math/ffb7b1abf45a71f719a352b87ed61797dc384487.png" alt="F = F_du" style="vertical-align: -3px"/>, where <img class="math" src="_images/math/93f4dc1c4f3d427d88a10855db5dc5f3e2f6b2b8.png" alt="u" style="vertical-align: 0px"/> is the local
liquid metal velocity and <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/> is the solidification drag coefficient. The
latter is a function of the local solid fraction (see <a class="reference internal" href="#solidifictiondragmodelth"><span class="std std-ref">Solidification</span></a>). If the drag coefficient multiplied by the
time-step size, <img class="math" src="_images/math/eca33d796197123783d345e5496b0f074d7ab2c6.png" alt="F_ddt" style="vertical-align: -3px"/>, is above 10<sup>6</sup>, then no feeding occurs.
Otherwise the shrinkage that occurred during the period of <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/> is fully
fed. This feeding criterion can be controlled by using the input variable
<span class="target" id="index-509"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TSDRG</span></code>, which is used as a multiplier when computing <img class="math" src="_images/math/cc73c5d59d70cca49172396fd567c57c723ad2de.png" alt="F_d" style="vertical-align: -3px"/>.</p>
<p>If an isolated liquid region does not have a free-surface, then volumetric
shrinkage in it will result in the opening of an internal cavity at the top of
the liquid region.</p>
<p>The SSS model uses the following assumptions:</p>
<ul class="simple">
<li>Volumetric expansion is included in the model, but only when space is available for expansion.</li>
<li>The mold is rigid.</li>
<li>The liquid metal free-surface is normal to the direction of body forces.</li>
<li>Feeding occurs instantaneously.</li>
<li>If no compressibility is defined, internal cavities open immediately as soon as a liquid region is separated from the feeder. When compressibility is defined, then cavities open as soon as the local pressure reaches the critical value.</li>
<li>Shrinkage is always fed through open mesh boundaries as long as the fluid fraction (<span class="target" id="index-510"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">FBCT</span></code>) at these boundaries is above zero and the fluid temperature at the boundaries is above solidus (<span class="target" id="index-511"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">TS1</span></code>). The feeding occurs <em>irrespective</em> of the orientation of the boundaries relative to the feeding direction. This allows to model applied pressure at inlets designed to reduce porosity in the casting (e.g., in squeeze casting).</li>
</ul>
<p>At any given time increment <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/>, the total amount of shrinkage,
<img class="math" src="_images/math/b9867e2265005bba31cf072c0b3d20de88c076e8.png" alt="\Delta V" style="vertical-align: 0px"/>, is defined by the current liquid and solid phase densities,
<img class="math" src="_images/math/c6be78c94e774f3c87c594e6c3f2e6a47b01a7df.png" alt="\rho _l" style="vertical-align: -4px"/> and <img class="math" src="_images/math/d5c2f29ca6f35099e3db11f5e15f2634d163f8ef.png" alt="\rho _s" style="vertical-align: -4px"/> respectively,</p>
<div class="math" id="equation-simplifiedshrinkagealgorithm1">
<p><span class="eqno">(461)<a class="headerlink" href="#equation-simplifiedshrinkagealgorithm1" title="Permalink to this equation">¶</a></span><img src="_images/math/6ae89c889ac6cb181d316ec49a99840aba8bc4a6.png" alt="\Delta V = d{V_l}\left( {1 - \frac{{{\rho _l}}}{{{\rho _s}}}} \right)"/></p>
</div><p>where <img class="math" src="_images/math/0112cc4a70555edc7ecd7734d083062fd4e23c80.png" alt="d{V_l}" style="vertical-align: -3px"/> is the volume of liquid metal that solidified in the time <img class="math" src="_images/math/bc74a02354d0c23e919469c336a741ec2710b084.png" alt="dt" style="vertical-align: 0px"/>.</p>
<p>The volume changes in the liquid phase during cooling, before it begins to
solidify, are also taken into account.</p>
<p>The simplified model accounts for the compressibility of the fluid
as pressure descreases due to shrinkage, stretching the metal before pores actually open.
A linear relationship between volume and pressure changes is used, with the bulk modulus,
<img class="math" src="_images/math/1f95110560cf9695123aef81c197fb7715dfe919.png" alt="K" style="vertical-align: 0px"/>, as the coefficient of proportionality.</p>
<div class="math" id="equation-simplifiedshrinkagealgorithm2">
<p><span class="eqno">(462)<a class="headerlink" href="#equation-simplifiedshrinkagealgorithm2" title="Permalink to this equation">¶</a></span><img src="_images/math/76eabf65c26eca7131919d374d0cc647c3bec6f6.png" alt="\Delta P = -K \frac{\Delta V}{V}"/></p>
</div><p>where <img class="math" src="_images/math/ac901cc1eadd206ba38280fd4ade4f50966c6bcb.png" alt="\Delta P" style="vertical-align: 0px"/> is the change in pressure in an isolated liquid volume <img class="math" src="_images/math/f5a322f82f9e644cb83622202e5be0da6a7cbb00.png" alt="V" style="vertical-align: 0px"/> due
the volume change <img class="math" src="_images/math/b9867e2265005bba31cf072c0b3d20de88c076e8.png" alt="\Delta V" style="vertical-align: 0px"/> due to shrinkage. Shrinkage cavities open only after
<img class="math" src="_images/math/c019589f6059cfe1c389d07bb5414a16dae4f3c5.png" alt="P" style="vertical-align: 0px"/> descreases below the critical pressure <img class="math" src="_images/math/35a388c4a4de5dbbbc31b585e8c614e58293ca09.png" alt="P _{crit}" style="vertical-align: -3px"/>, thus applying a large
external pressure can delay and reduce the formation of porosity.</p>
<p>There are no limitations on the actual casting shape or configuration and metal
and mold properties in the SSS model. The accuracy of the model depends on how
important the convective heat transfer is compared to thermal conduction and
whether significant gas evolution in the metal is present. The larger the role
the thermal conduction plays, the better the accuracy of the model. Since no
fluid flow equations are solved, fluid velocities are assumed to be zero. No
dynamic fluid flow phenomena can therefore be modeled with the SSS model except
for heat transfer and volume reduction.</p>
<p>When the implicit algorithm is employed, the use of a large time step may cause
significant inaccuracy in the predictions of the SSS model. This can be
illustrated by considering the example of a one-dimensional plane solidification
front moving in the positive x-direction. Since there is a sharp boundary
between liquid and solid phases, all the volumetric shrinkage occurring at the
front will be fed by the liquid ahead of the front.</p>
<p>In the numerical approximation we divide the domain into small control volumes
(cells). In our example, when the solidification front is inside of a control
volume, the cell behind the front is already solid, while the one ahead of the
front is still liquid. Therefore, each solidifying cell will have a fully liquid
neighbor from which it can be fed. If we restrict the front to advance at most
one cell during each time step, then all shrinkage in each control volume will
be fed. This will be a physically sound solution. However, if the time step is
large, then the solidification front may advance a few cells in one time step
and some of those cells may have no adjacent liquid cells to feed them at the
time of solidification. This will lead to porosity in these cells, which
obviously is not correct.</p>
<p>A sub-time-stepping procedure for the SSS option is used in <span class="raw-html"><strong><em>FLOW-3D </em></strong></span> to reduce the
effect of a large time step on porosity predictions <a class="reference internal" href="zbibliography.html#goldstein-1950" id="id109">[Gol50]</a>. This is
only done in conjunction with the implicit heat transfer algorithm. The
procedure uses a linear interpolation between the previous and the current
values of energy, <img class="math" src="_images/math/519fa4faafcf3aee471580b6ad93fc7734a53189.png" alt="E^n" style="vertical-align: 0px"/> and <img class="math" src="_images/math/248aa6622ae0fbd16f5dbd6e1a380618ce421da2.png" alt="E^{n+1}" style="vertical-align: 0px"/>, respectively, to compute the
solid fraction, volumetric shrinkage and feeding in each control volume at each
sub-time step between times <img class="math" src="_images/math/7abcc587d2b161c6467e7924d2dd1fea20620e82.png" alt="t^n" style="vertical-align: 0px"/> and <img class="math" src="_images/math/3659a985c835be8dc1cddbcdd419d6ad627f2c88.png" alt="t^{n+1}" style="vertical-align: 0px"/>.</p>
</div>
<div class="section" id="reactive-flows-algorithm">
<span id="reactiveflowsalgorithmth"></span><span id="index-512"></span><h3>Reactive Flows Algorithm<a class="headerlink" href="#reactive-flows-algorithm" title="Permalink to this headline">¶</a></h3>
<p>The reactive flow model is designed to operate at the control volume level, i.e.,
it is used to determine new species concentrations within each computational cell at
the end of a time cycle, at <img class="math" src="_images/math/7b19e2a3b1acfa9aa203a69a4eb5f674bdf2a81c.png" alt="t=t_{n+1}" style="vertical-align: -5px"/>.</p>
<p>The convection and diffusion of an arbitrary number of chemical reactants <img class="math" src="_images/math/b5f9459aa4ad4cedf36ade626dc6aa376280f951.png" alt="M \leq 99" style="vertical-align: -3px"/> is
handled by species concentration transport equations. In addition, some species may
be defined as non-transportable, e.g., chemical species attached to rigid surfaces.</p>
<p>A general reactive equation for a species <img class="math" src="_images/math/b6f75c6c86e429d2ecdbb745db38440fb744a6c4.png" alt="C_i" style="vertical-align: -3px"/>, <img class="math" src="_images/math/f9ffafcfa01dac92b6067813c3f0b945764f0043.png" alt="i=1,M" style="vertical-align: -4px"/>, is</p>
<blockquote>
<div><div class="math" id="equation-genericreactiveequation">
<p><span class="eqno">(463)<a class="headerlink" href="#equation-genericreactiveequation" title="Permalink to this equation">¶</a></span><img src="_images/math/844512541c33573b094173416c94569da3ddbc8d.png" alt="R_i = \frac {\partial C_i} {\partial t} = \sum_{j=1,N} {G_j (C_1, C_2,...,C_M)}"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/a7cfc0cbd5e064e1470d76f8dcbaffb4a45fb7c3.png" alt="N" style="vertical-align: 0px"/> is the number of reactions <img class="math" src="_images/math/29fe180d30c479a5174f6d983dafd90f23d87e1b.png" alt="G_j" style="vertical-align: -6px"/> affecting species <img class="math" src="_images/math/b6f75c6c86e429d2ecdbb745db38440fb744a6c4.png" alt="C_i" style="vertical-align: -3px"/>.
Currently, each reaction is approximated as a product of powers of the species concentrations</p>
<blockquote>
<div><div class="math" id="equation-powerreactiveequation">
<p><span class="eqno">(464)<a class="headerlink" href="#equation-powerreactiveequation" title="Permalink to this equation">¶</a></span><img src="_images/math/a44bd5d76f389978ccc5317bcd8606c702a39ed2.png" alt="G_j (C_1, C_2,...,C_M) = k_j C_1^{n_{1_,j}}C_2^{n_{2,j}}...C_M^{n_{M,j}}"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/052215d5912d64d963a1f59ee964d96ac9abf419.png" alt="k_j" style="vertical-align: -6px"/> and <img class="math" src="_images/math/89c1386ff925e0b65a4539dac9a03e427f9b5cba.png" alt="n_{m,j}" style="vertical-align: -6px"/> are constants.</p>
<p>The numerical approximations use a simple, first-order time integration algorithm in which species
evolution rates <img class="math" src="_images/math/92ca596760515bc39bc56442b87ab4a5e67c68c5.png" alt="R_i" style="vertical-align: -3px"/> are evaluated implicitly in
each control volume, with explicit coupling between adjacent control volumes. A linear system of
equations is contructed for <img class="math" src="_images/math/3ecb624cb5edcf0da9f02b0eb6b9868d23a07649.png" alt="R_i(t_{n+1})" style="vertical-align: -5px"/> in a control volume by, first, using the Taylor
expansion of <img class="math" src="_images/math/29fe180d30c479a5174f6d983dafd90f23d87e1b.png" alt="G_j" style="vertical-align: -6px"/> with respect to time and retaining only linear terms:</p>
<blockquote>
<div><div class="math" id="equation-taylorexpansionequation">
<p><span class="eqno">(465)<a class="headerlink" href="#equation-taylorexpansionequation" title="Permalink to this equation">¶</a></span><img src="_images/math/43cc42b0d249e1354f1583ef73c04d7661e9d86e.png" alt="G_j (C_1, C_2,...,C_M)|_{t=t_{n+1}} \approx G_j (C_1, C_2,...,C_M)|_{t=t_n} + \left( \sum_{m=1,M} {\frac{\partial G_j}{\partial C_m} \frac{\partial C_m}{\partial t}} \right) \Delta t"/></p>
</div></div></blockquote>
<p>where <img class="math" src="_images/math/e1abcbb463f541e9aeac576123b26525bd252906.png" alt="\Delta t = t_{n+1} - t_n" style="vertical-align: -5px"/>.</p>
<p>Now, substituting Eq. <a class="reference internal" href="#equation-taylorexpansionequation">(465)</a> into Eq. <a class="reference internal" href="#equation-genericreactiveequation">(463)</a> and taking reaction
rates and linear expansion coefficients at <img class="math" src="_images/math/7b19e2a3b1acfa9aa203a69a4eb5f674bdf2a81c.png" alt="t=t_{n+1}" style="vertical-align: -5px"/> yields</p>
<blockquote>
<div><div class="math" id="equation-implicitreactiveequation">
<p><span class="eqno">(466)<a class="headerlink" href="#equation-implicitreactiveequation" title="Permalink to this equation">¶</a></span><img src="_images/math/ac1545fd4f568416238384f92ab484fd0338dc2b.png" alt="R_i(t_{n+1}) = \sum_{j=1,N} {G_j (C_1, C_2,...,C_M)}|_{t=t_n} + \left( \sum_{j=1,N} {\sum_{m=1,M} {\frac{\partial G_j}{\partial C_m}|_{t=t_{n+1}} R_m(t_{n+1})}} \right) \Delta t"/></p>
</div></div></blockquote>
<p>Equations <a class="reference internal" href="#equation-implicitreactiveequation">(466)</a> constitute a non-linear system since the coefficients for <img class="math" src="_images/math/3ecb624cb5edcf0da9f02b0eb6b9868d23a07649.png" alt="R_i(t_{n+1})" style="vertical-align: -5px"/>
resulting from the Taylor expansions are also evaluated implicitly, and requires an iterative procedure to solve outlined below.</p>
<p>First, the coefficients <img class="math" src="_images/math/ce232c5ff8cf6d3c93f47d077359a13e87f97b25.png" alt="\frac{\partial G_j}{\partial C_m}" style="vertical-align: -8px"/> are computed at the current, known values
of species concentrations <img class="math" src="_images/math/b6f75c6c86e429d2ecdbb745db38440fb744a6c4.png" alt="C_i" style="vertical-align: -3px"/> using Eq. <a class="reference internal" href="#equation-powerreactiveequation">(464)</a>, and the resulting <em>linear</em> equations for <img class="math" src="_images/math/92ca596760515bc39bc56442b87ab4a5e67c68c5.png" alt="R_i" style="vertical-align: -3px"/> are solved directly
using a Gaussian elimination procedure. Then the Taylor expansion coefficients Eq. <a class="reference internal" href="#equation-taylorexpansionequation">(465)</a>
are recalculated using species concentrations updated from the new reaction rates:</p>
<blockquote>
<div><div class="math" id="equation-updatedconcentrationsequation">
<p><span class="eqno">(467)<a class="headerlink" href="#equation-updatedconcentrationsequation" title="Permalink to this equation">¶</a></span><img src="_images/math/f3be6ff8c2a9220736300c3c41929c5ed07e0000.png" alt="C_i = C_i(t_n) + R_i \Delta t"/></p>
</div></div></blockquote>
<p>The complete solution procedure looks as follows:</p>
<ol class="arabic simple">
<li>Calculate the coefficients in the linear Taylor expansion of the terms on the right-hand side of
Eq. <a class="reference internal" href="#equation-taylorexpansionequation">(465)</a> for each <img class="math" src="_images/math/f9ffafcfa01dac92b6067813c3f0b945764f0043.png" alt="i=1,M" style="vertical-align: -4px"/> and <img class="math" src="_images/math/8982c95586dab53e3df7fa3e6f0d4b194fed0747.png" alt="j=1,N" style="vertical-align: -4px"/> using the current values of
species concentrations and Eq. <a class="reference internal" href="#equation-powerreactiveequation">(464)</a>.</li>
<li>Solve for <img class="math" src="_images/math/92ca596760515bc39bc56442b87ab4a5e67c68c5.png" alt="R_i" style="vertical-align: -3px"/> using Gaussian elimination of Eq. <a class="reference internal" href="#equation-implicitreactiveequation">(466)</a></li>
<li>Update species concentrations using the values of <img class="math" src="_images/math/92ca596760515bc39bc56442b87ab4a5e67c68c5.png" alt="R_i" style="vertical-align: -3px"/> obtained in step #2, Eq. <a class="reference internal" href="#equation-updatedconcentrationsequation">(467)</a></li>
<li>Return to step #1 until convergence is reached.</li>
</ol>
<p>Solution is deemed converged for the current control volume when the sum of the squares of the resudials of
all <img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> equations is less then 1.e-06 of the sum of the squares of the <img class="math" src="_images/math/d8a5da8664a68fd885b7c2612b9daad78c4bea56.png" alt="M" style="vertical-align: 0px"/> species concentrations in the cell.</p>
<p>The procedure is repeated for all cells that contain fluid.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><span class="raw-html"><strong><em>FLOW-3D </em></strong></span> and <strong>TruVOF</strong> are registered trademarks in the USA and other countries.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="model-reference.html" class="btn btn-neutral float-right" title="Model Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="troubleshooting.html" class="btn btn-neutral float-left" title="Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Flow Science, Inc

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'12.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>